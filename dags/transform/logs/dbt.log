[0m16:28:04.594343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3CF70440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3CF70230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3CF70260>]}


============================== 16:28:04.608331 | ca0a1c00-248f-4ffe-ade3-1a7c3cc75c48 ==============================
[0m16:28:04.608331 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:28:04.609334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:28:04.613332 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'retail'
[0m16:28:04.615466 [debug] [MainThread]: Command `dbt test` failed at 16:28:04.615466 after 0.19 seconds
[0m16:28:04.615466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3CD55DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3C6E0EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE3BF7A780>]}
[0m16:28:04.616483 [debug] [MainThread]: Flushing usage events
[0m19:09:32.093008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3345ABC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3361CC860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F335B3CEF0>]}


============================== 19:09:32.103111 | 67021e29-138b-400f-afcc-8fb00d956ec0 ==============================
[0m19:09:32.103111 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:09:32.104109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:32.154061 [info ] [MainThread]: dbt version: 1.8.9
[0m19:09:32.155062 [info ] [MainThread]: python version: 3.12.2
[0m19:09:32.155062 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:09:32.156163 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:09:32.164703 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:09:32.166695 [debug] [MainThread]: Command `dbt debug` failed at 19:09:32.166695 after 0.20 seconds
[0m19:09:32.167693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3365A2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3368C6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3361CC860>]}
[0m19:09:32.167693 [debug] [MainThread]: Flushing usage events
[0m19:10:17.494131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F54C2EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F5536750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F54C0740>]}


============================== 19:10:17.498131 | 8d9baa08-db97-4919-a799-a5fde985c4c2 ==============================
[0m19:10:17.498131 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:10:17.499166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:10:17.520128 [info ] [MainThread]: dbt version: 1.8.9
[0m19:10:17.521133 [info ] [MainThread]: python version: 3.12.2
[0m19:10:17.522139 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:10:17.523128 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:10:17.528138 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:10:17.530536 [debug] [MainThread]: Command `dbt debug` failed at 19:10:17.530536 after 0.15 seconds
[0m19:10:17.531536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F5BA8EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F546F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F5E7A1E0>]}
[0m19:10:17.532548 [debug] [MainThread]: Flushing usage events
[0m19:12:00.169781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5E7E43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5ED917C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5E860170>]}


============================== 19:12:00.174351 | 36e65c98-8f31-4bb7-b897-3a5685bfb5cc ==============================
[0m19:12:00.174351 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:12:00.175351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:12:00.202203 [info ] [MainThread]: dbt version: 1.8.9
[0m19:12:00.202203 [info ] [MainThread]: python version: 3.12.2
[0m19:12:00.203201 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:12:00.203201 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:12:00.210094 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:12:00.212047 [debug] [MainThread]: Command `dbt debug` failed at 19:12:00.212047 after 0.15 seconds
[0m19:12:00.212047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5ECA3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5F0D2C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA5EF73F50>]}
[0m19:12:00.213047 [debug] [MainThread]: Flushing usage events
[0m19:12:13.450246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50276C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F504D966F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F504D97A70>]}


============================== 19:12:13.456346 | cadaae0f-5805-4972-b4e7-760ac92681a2 ==============================
[0m19:12:13.456346 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:12:13.457366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:12:13.479538 [info ] [MainThread]: dbt version: 1.8.9
[0m19:12:13.480531 [info ] [MainThread]: python version: 3.12.2
[0m19:12:13.481597 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:12:13.482108 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:12:13.490640 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:12:13.492639 [debug] [MainThread]: Command `dbt debug` failed at 19:12:13.492639 after 0.15 seconds
[0m19:12:13.492639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5017A7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F504D97A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50535C350>]}
[0m19:12:13.494148 [debug] [MainThread]: Flushing usage events
[0m19:15:17.714721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E1573BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E09933E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E0993CB0>]}


============================== 19:15:17.719284 | 00996e0a-6767-4bdc-b4d0-e737b86473e1 ==============================
[0m19:15:17.719284 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:15:17.720277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:15:17.748986 [info ] [MainThread]: dbt version: 1.8.9
[0m19:15:17.749984 [info ] [MainThread]: python version: 3.12.2
[0m19:15:17.750495 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:15:17.751503 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:15:17.758547 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:15:17.760543 [debug] [MainThread]: Command `dbt debug` failed at 19:15:17.760543 after 0.22 seconds
[0m19:15:17.761546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E1842EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E1819C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E16346E0>]}
[0m19:15:17.762546 [debug] [MainThread]: Flushing usage events
[0m19:15:43.962286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A452067F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A453EEC560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4512F6FF0>]}


============================== 19:15:43.967132 | 2ea7ee31-b0a2-4cf5-ac60-9c75bc3f250b ==============================
[0m19:15:43.967132 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:15:43.969438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:15:43.991449 [info ] [MainThread]: dbt version: 1.8.9
[0m19:15:43.992447 [info ] [MainThread]: python version: 3.12.2
[0m19:15:43.993438 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:15:43.994443 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:15:44.000955 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:15:44.003476 [debug] [MainThread]: Command `dbt debug` failed at 19:15:44.002476 after 0.14 seconds
[0m19:15:44.003476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A454347E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A454EAEED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4544C36E0>]}
[0m19:15:44.004467 [debug] [MainThread]: Flushing usage events
[0m19:19:13.717548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323320D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023230989B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323350AF00>]}


============================== 19:19:13.722121 | 95c1b854-ec00-4b2e-9904-6a9bde14820e ==============================
[0m19:19:13.722121 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:19:13.722121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:13.746978 [info ] [MainThread]: dbt version: 1.8.9
[0m19:19:13.747993 [info ] [MainThread]: python version: 3.12.2
[0m19:19:13.748986 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:19:13.748986 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:19:13.756125 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'snowflake_account'
[0m19:19:13.758405 [debug] [MainThread]: Command `dbt debug` failed at 19:19:13.758405 after 0.19 seconds
[0m19:19:13.759399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002322FBEF3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233234560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232335F4080>]}
[0m19:19:13.760396 [debug] [MainThread]: Flushing usage events
[0m19:21:03.855367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EDFC9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EDFCB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EDFCB5F0>]}


============================== 19:21:03.859224 | d8a4ee16-3bb9-4505-b6ce-6f127881f6bd ==============================
[0m19:21:03.859224 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:21:03.860549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:03.883914 [info ] [MainThread]: dbt version: 1.8.9
[0m19:21:03.884911 [info ] [MainThread]: python version: 3.12.2
[0m19:21:03.885861 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:21:03.886889 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:21:10.193420 [info ] [MainThread]: Using profiles dir at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform
[0m19:21:10.194427 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\profiles.yml
[0m19:21:10.195679 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml
[0m19:21:10.197439 [info ] [MainThread]: adapter type: snowflake
[0m19:21:10.198455 [info ] [MainThread]: adapter version: 1.8.4
[0m19:21:10.246652 [info ] [MainThread]: Configuration:
[0m19:21:10.247986 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:21:10.249018 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m19:21:10.250009 [info ] [MainThread]: Required dependencies:
[0m19:21:10.251007 [debug] [MainThread]: Executing "git --help"
[0m19:21:10.283183 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:21:10.283183 [debug] [MainThread]: STDERR: "b''"
[0m19:21:10.284187 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:21:10.286019 [info ] [MainThread]: Connection:
[0m19:21:10.287097 [info ] [MainThread]:   account: kinfmrd-dx73789
[0m19:21:10.287631 [info ] [MainThread]:   user: arzion032
[0m19:21:10.288702 [info ] [MainThread]:   database: E_COMMERCE_PRODUCT
[0m19:21:10.289245 [info ] [MainThread]:   warehouse: Project_Warehouse
[0m19:21:10.290324 [info ] [MainThread]:   role: project_man
[0m19:21:10.290854 [info ] [MainThread]:   schema: products_schema
[0m19:21:10.291917 [info ] [MainThread]:   authenticator: None
[0m19:21:10.292456 [info ] [MainThread]:   oauth_client_id: None
[0m19:21:10.293538 [info ] [MainThread]:   query_tag: None
[0m19:21:10.294067 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:21:10.295113 [info ] [MainThread]:   host: None
[0m19:21:10.295634 [info ] [MainThread]:   port: None
[0m19:21:10.296684 [info ] [MainThread]:   proxy_host: None
[0m19:21:10.297693 [info ] [MainThread]:   proxy_port: None
[0m19:21:10.297693 [info ] [MainThread]:   protocol: None
[0m19:21:10.298694 [info ] [MainThread]:   connect_retries: 1
[0m19:21:10.299701 [info ] [MainThread]:   connect_timeout: None
[0m19:21:10.300700 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:21:10.301701 [info ] [MainThread]:   retry_all: False
[0m19:21:10.301701 [info ] [MainThread]:   insecure_mode: False
[0m19:21:10.302702 [info ] [MainThread]:   reuse_connections: None
[0m19:21:10.303701 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:21:10.710323 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:21:10.711324 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:21:10.712324 [debug] [MainThread]: On debug: select 1 as id
[0m19:21:10.712324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:14.410845 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.698 seconds
[0m19:21:14.411844 [debug] [MainThread]: On debug: Close
[0m19:21:14.537637 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:21:14.539111 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:21:14.540130 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['name']: 'E-Commerce' does not match '^[^\\d\\W]\\w*$'

Error encountered in C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml


[0m19:21:14.542147 [debug] [MainThread]: Command `dbt debug` failed at 19:21:14.542147 after 10.86 seconds
[0m19:21:14.543138 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:21:14.543138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EDD03C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3ED88CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3860D8470>]}
[0m19:21:14.544136 [debug] [MainThread]: Flushing usage events
[0m19:22:30.280210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229628F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229A5F5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022299CA5730>]}


============================== 19:22:30.285103 | b008a67f-b137-41ab-be73-fce661e3905c ==============================
[0m19:22:30.285103 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:22:30.286104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:22:30.311534 [info ] [MainThread]: dbt version: 1.8.9
[0m19:22:30.313115 [info ] [MainThread]: python version: 3.12.2
[0m19:22:30.314149 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:22:30.315137 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:22:31.651717 [info ] [MainThread]: Using profiles dir at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform
[0m19:22:31.652722 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\profiles.yml
[0m19:22:31.653920 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml
[0m19:22:31.658680 [info ] [MainThread]: adapter type: snowflake
[0m19:22:31.660643 [info ] [MainThread]: adapter version: 1.8.4
[0m19:22:31.761793 [info ] [MainThread]: Configuration:
[0m19:22:31.764316 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:22:31.764825 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m19:22:31.765837 [info ] [MainThread]: Required dependencies:
[0m19:22:31.766840 [debug] [MainThread]: Executing "git --help"
[0m19:22:31.819366 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:31.821368 [debug] [MainThread]: STDERR: "b''"
[0m19:22:31.822366 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:22:31.823896 [info ] [MainThread]: Connection:
[0m19:22:31.824904 [info ] [MainThread]:   account: kinfmrd-dx73789
[0m19:22:31.826971 [info ] [MainThread]:   user: arzion032
[0m19:22:31.828498 [info ] [MainThread]:   database: E_COMMERCE_PRODUCT
[0m19:22:31.829512 [info ] [MainThread]:   warehouse: Project_Warehouse
[0m19:22:31.830512 [info ] [MainThread]:   role: project_man
[0m19:22:31.833431 [info ] [MainThread]:   schema: products_schema
[0m19:22:31.835420 [info ] [MainThread]:   authenticator: None
[0m19:22:31.836929 [info ] [MainThread]:   oauth_client_id: None
[0m19:22:31.838943 [info ] [MainThread]:   query_tag: None
[0m19:22:31.840939 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:22:31.842660 [info ] [MainThread]:   host: None
[0m19:22:31.844985 [info ] [MainThread]:   port: None
[0m19:22:31.845997 [info ] [MainThread]:   proxy_host: None
[0m19:22:31.848584 [info ] [MainThread]:   proxy_port: None
[0m19:22:31.850341 [info ] [MainThread]:   protocol: None
[0m19:22:31.851356 [info ] [MainThread]:   connect_retries: 1
[0m19:22:31.854415 [info ] [MainThread]:   connect_timeout: None
[0m19:22:31.855928 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:22:31.858418 [info ] [MainThread]:   retry_all: False
[0m19:22:31.859971 [info ] [MainThread]:   insecure_mode: False
[0m19:22:31.860959 [info ] [MainThread]:   reuse_connections: None
[0m19:22:31.863484 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:22:32.320945 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:22:32.322035 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:22:32.322593 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:32.323145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:33.205986 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.883 seconds
[0m19:22:33.208042 [debug] [MainThread]: On debug: Close
[0m19:22:33.352935 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:22:33.353930 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:22:33.354932 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['name']: 'e-commerce' does not match '^[^\\d\\W]\\w*$'

Error encountered in C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml


[0m19:22:33.356931 [debug] [MainThread]: Command `dbt debug` failed at 19:22:33.355939 after 3.20 seconds
[0m19:22:33.357442 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:22:33.357442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229A7B27E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222B2738350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022299F3FE00>]}
[0m19:22:33.358465 [debug] [MainThread]: Flushing usage events
[0m19:23:02.495877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC8E78170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC833B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC833B5C0>]}


============================== 19:23:02.503880 | 9188a285-6cec-443c-9861-388792af591b ==============================
[0m19:23:02.503880 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:23:02.504877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:02.532407 [info ] [MainThread]: dbt version: 1.8.9
[0m19:23:02.533395 [info ] [MainThread]: python version: 3.12.2
[0m19:23:02.534395 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m19:23:02.535393 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m19:23:03.872991 [info ] [MainThread]: Using profiles dir at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform
[0m19:23:03.873990 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\profiles.yml
[0m19:23:03.874985 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml
[0m19:23:03.876373 [info ] [MainThread]: adapter type: snowflake
[0m19:23:03.876373 [info ] [MainThread]: adapter version: 1.8.4
[0m19:23:03.960508 [info ] [MainThread]: Configuration:
[0m19:23:03.961660 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:23:03.962280 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:23:03.963365 [info ] [MainThread]: Required dependencies:
[0m19:23:03.963900 [debug] [MainThread]: Executing "git --help"
[0m19:23:03.995817 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:23:03.996333 [debug] [MainThread]: STDERR: "b''"
[0m19:23:03.997350 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:23:03.998354 [info ] [MainThread]: Connection:
[0m19:23:03.999342 [info ] [MainThread]:   account: kinfmrd-dx73789
[0m19:23:03.999342 [info ] [MainThread]:   user: arzion032
[0m19:23:04.000341 [info ] [MainThread]:   database: E_COMMERCE_PRODUCT
[0m19:23:04.001351 [info ] [MainThread]:   warehouse: Project_Warehouse
[0m19:23:04.001351 [info ] [MainThread]:   role: project_man
[0m19:23:04.002346 [info ] [MainThread]:   schema: products_schema
[0m19:23:04.003342 [info ] [MainThread]:   authenticator: None
[0m19:23:04.004342 [info ] [MainThread]:   oauth_client_id: None
[0m19:23:04.005340 [info ] [MainThread]:   query_tag: None
[0m19:23:04.006347 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:23:04.007339 [info ] [MainThread]:   host: None
[0m19:23:04.007339 [info ] [MainThread]:   port: None
[0m19:23:04.008343 [info ] [MainThread]:   proxy_host: None
[0m19:23:04.008343 [info ] [MainThread]:   proxy_port: None
[0m19:23:04.009341 [info ] [MainThread]:   protocol: None
[0m19:23:04.010350 [info ] [MainThread]:   connect_retries: 1
[0m19:23:04.011349 [info ] [MainThread]:   connect_timeout: None
[0m19:23:04.012351 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:23:04.013349 [info ] [MainThread]:   retry_all: False
[0m19:23:04.014349 [info ] [MainThread]:   insecure_mode: False
[0m19:23:04.014349 [info ] [MainThread]:   reuse_connections: None
[0m19:23:04.015352 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:04.349517 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:23:04.350513 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:23:04.351512 [debug] [MainThread]: On debug: select 1 as id
[0m19:23:04.351512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:05.301624 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.949 seconds
[0m19:23:05.302668 [debug] [MainThread]: On debug: Close
[0m19:23:05.452782 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:23:05.454665 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:23:05.455671 [debug] [MainThread]: Command `dbt debug` succeeded at 19:23:05.455671 after 3.08 seconds
[0m19:23:05.456668 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:23:05.456668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC914B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC938C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE2217E00>]}
[0m19:23:05.457664 [debug] [MainThread]: Flushing usage events
[0m19:23:49.899181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9458746E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9452572C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A945800B30>]}


============================== 19:23:49.906698 | 9b34ea7c-67cd-4ccd-b7f7-039d13c7955e ==============================
[0m19:23:49.906698 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:23:49.908696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:51.281920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b34ea7c-67cd-4ccd-b7f7-039d13c7955e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A95EE01D30>]}
[0m19:23:51.361796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b34ea7c-67cd-4ccd-b7f7-039d13c7955e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A94555CFE0>]}
[0m19:23:51.364015 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:51.971765 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:23:51.974860 [debug] [MainThread]: Command `dbt run` failed at 19:23:51.974317 after 2.22 seconds
[0m19:23:51.977074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A946001970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9461606B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A94555CFE0>]}
[0m19:23:51.978255 [debug] [MainThread]: Flushing usage events
[0m19:26:46.848975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB920A3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB920A1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB920A0470>]}


============================== 19:26:46.853971 | 31b4eaa0-a594-44b5-a9e2-189f05646367 ==============================
[0m19:26:46.853971 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:26:46.854969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m19:26:46.994407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31b4eaa0-a594-44b5-a9e2-189f05646367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB910A02C0>]}
[0m19:26:47.038918 [debug] [MainThread]: Set downloads directory='C:\Users\User\AppData\Local\Temp\dbt-downloads-rc21csbw'
[0m19:26:47.039920 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:26:47.218761 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:26:47.218761 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:26:47.331571 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:26:47.342596 [info ] [MainThread]: Updating lock file in file path: C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform/package-lock.yml
[0m19:26:47.356701 [debug] [MainThread]: Set downloads directory='C:\Users\User\AppData\Local\Temp\dbt-downloads-_w49w3ma'
[0m19:26:47.359716 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:26:48.290463 [info ] [MainThread]: Installed from version 1.3.0
[0m19:26:48.291463 [info ] [MainThread]: Up to date!
[0m19:26:48.291463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31b4eaa0-a594-44b5-a9e2-189f05646367', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9224A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9224ABA0>]}
[0m19:26:48.294473 [debug] [MainThread]: Command `dbt deps` succeeded at 19:26:48.293470 after 1.56 seconds
[0m19:26:48.294473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB91D63560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92223620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB91D30470>]}
[0m19:26:48.295479 [debug] [MainThread]: Flushing usage events
[0m19:28:34.286622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35EC1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35EC2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35EC29C0>]}


============================== 19:28:34.291626 | bf4bf7fe-532c-4b7f-8217-4a43f4381e99 ==============================
[0m19:28:34.291626 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:28:34.292627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:35.295624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf4bf7fe-532c-4b7f-8217-4a43f4381e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4E682030>]}
[0m19:28:35.340660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf4bf7fe-532c-4b7f-8217-4a43f4381e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4F0E3080>]}
[0m19:28:35.342804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:28:35.693515 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:28:35.695507 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:28:35.696503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf4bf7fe-532c-4b7f-8217-4a43f4381e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4F0F0F20>]}
[0m19:28:37.915017 [error] [MainThread]: Encountered an error:
Parsing Error
  Failed to render models\e-commerce\sources\sources.yml from project transform: Parsing Error
    Env var required but not provided: 'snowflake_schema'
[0m19:28:37.916800 [debug] [MainThread]: Command `dbt run` failed at 19:28:37.916800 after 3.73 seconds
[0m19:28:37.917799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35EC2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4F0E05F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4F35DD60>]}
[0m19:28:37.917799 [debug] [MainThread]: Flushing usage events
[0m19:29:07.158730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028656C547A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286574864B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028656C555B0>]}


============================== 19:29:07.162735 | 524b86cd-8bec-4cbd-9578-2fe3f9deaa31 ==============================
[0m19:29:07.162735 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:29:07.164243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:29:08.166189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866FA20890>]}
[0m19:29:08.211373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867047EC60>]}
[0m19:29:08.213364 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:29:08.532896 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:29:08.535439 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:29:08.536427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867053BB60>]}
[0m19:29:09.778459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.analytics
- models.e-commerce.intermediate
[0m19:29:09.790550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286707FE630>]}
[0m19:29:09.958778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028671B2E6C0>]}
[0m19:29:09.959780 [info ] [MainThread]: Found 1 model, 1 source, 575 macros
[0m19:29:09.960782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286719686E0>]}
[0m19:29:09.965287 [info ] [MainThread]: 
[0m19:29:09.966293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:09.967290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:29:10.046871 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:29:10.047875 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:29:10.047875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:11.042834 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.995 seconds
[0m19:29:11.045358 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:29:11.164549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:29:11.173967 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:29:11.174501 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:29:11.175059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:12.013458 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.838 seconds
[0m19:29:12.016183 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:29:12.128256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867196E4B0>]}
[0m19:29:12.129347 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:29:12.130437 [info ] [MainThread]: 
[0m19:29:12.143399 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:29:12.143924 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:29:12.144963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:29:12.145485 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:29:12.154016 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:29:12.156785 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:29:12.189475 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:29:12.192698 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:29:12.193233 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    'goods-title-link--jump'::STRING, 
    "goods-title-link--jump href"::STRING, 
    "rank-title"::STRING,
    "rank-sub"::STRING,
    "price"::STRING,
    "discount"::STRING,
    "selling_proposition"::STRING,
    "goods-title-link"::STRING,
    "color-count"::INTEGER,
    "blackfridaybelts-bg src"::STRING,
    "blackfridaybelts-content"::STRING
FROM E_COMMERCE_PRODUCT.products_schema.products
  );
[0m19:29:12.193762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:29:12.925102 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5791-0000-fbe3-0001-4c5e000ac196
[0m19:29:12.925102 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
[0m19:29:12.926110 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:29:13.059298 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:29:13.061298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524b86cd-8bec-4cbd-9578-2fe3f9deaa31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286704DEE40>]}
[0m19:29:13.062299 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.92s]
[0m19:29:13.063298 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:29:13.065287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:13.066285 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:29:13.066285 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:29:13.067285 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:29:13.068292 [info ] [MainThread]: 
[0m19:29:13.068292 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m19:29:13.070288 [debug] [MainThread]: Command end result
[0m19:29:13.108431 [info ] [MainThread]: 
[0m19:29:13.109435 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:13.111428 [info ] [MainThread]: 
[0m19:29:13.112434 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:29:13.114454 [info ] [MainThread]: 
[0m19:29:13.116453 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:29:13.119458 [debug] [MainThread]: Command `dbt run` failed at 19:29:13.118456 after 6.06 seconds
[0m19:29:13.119458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286574299A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028657336480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028657182720>]}
[0m19:29:13.121451 [debug] [MainThread]: Flushing usage events
[0m19:34:13.752449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022860020950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228607E5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022860022570>]}


============================== 19:34:13.757020 | 9a5b31c1-a568-476f-ab27-9f2f7b8290ad ==============================
[0m19:34:13.757020 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:34:13.759036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:34:13.762028 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce'
[0m19:34:13.764029 [debug] [MainThread]: Command `dbt run` failed at 19:34:13.764029 after 0.16 seconds
[0m19:34:13.765028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285F912900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022860762930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228608F7E90>]}
[0m19:34:13.765028 [debug] [MainThread]: Flushing usage events
[0m19:35:15.387406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809817B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809817B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809817A70>]}


============================== 19:35:15.392402 | 28f2217e-490a-4eaa-9640-c38ab962adba ==============================
[0m19:35:15.392402 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:35:15.394404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:16.434646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809817D40>]}
[0m19:35:16.481354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809519BE0>]}
[0m19:35:16.483354 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:35:16.797011 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:35:16.872990 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:35:16.873993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F823AEE0F0>]}
[0m19:35:18.032742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.ecommerce.staging
- models.ecommerce.intermediate
- models.ecommerce.analytics
[0m19:35:18.045748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F823B3F530>]}
[0m19:35:18.207599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F823C92A20>]}
[0m19:35:18.208600 [info ] [MainThread]: Found 1 model, 1 source, 575 macros
[0m19:35:18.209603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F823C67770>]}
[0m19:35:18.211610 [info ] [MainThread]: 
[0m19:35:18.212608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:18.213728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:35:18.227760 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:35:18.227760 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:35:18.228764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:19.168499 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.939 seconds
[0m19:35:19.169502 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:35:19.289435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:35:19.298441 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:35:19.300428 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:35:19.300428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:20.072413 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.771 seconds
[0m19:35:20.073413 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:35:20.201146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F823C6BEC0>]}
[0m19:35:20.202151 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:35:20.203155 [info ] [MainThread]: 
[0m19:35:20.209415 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:35:20.210429 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:35:20.211431 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:35:20.212437 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:35:20.222438 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:35:20.224439 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:35:20.250951 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:35:20.252954 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:35:20.253959 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    'goods-title-link--jump'::STRING, 
    "goods-title-link--jump href"::STRING, 
    "rank-title"::STRING,
    "rank-sub"::STRING,
    "price"::STRING,
    "discount"::STRING,
    "selling_proposition"::STRING,
    "goods-title-link"::STRING,
    "color-count"::INTEGER,
    "blackfridaybelts-bg src"::STRING,
    "blackfridaybelts-content"::STRING
FROM E_COMMERCE_PRODUCT.products_schema.products
  );
[0m19:35:20.254953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:20.914836 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5797-0000-fb54-0001-4c5e000a7262
[0m19:35:20.915831 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
[0m19:35:20.915831 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:35:21.031313 [debug] [Thread-1 (]: Database Error in model stg_products (models\ecommerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\ecommerce\staging\stg_products.sql
[0m19:35:21.033314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f2217e-490a-4eaa-9640-c38ab962adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F822A688C0>]}
[0m19:35:21.034311 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.82s]
[0m19:35:21.035855 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:35:21.037854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:21.038868 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:35:21.038868 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:35:21.039857 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:35:21.039857 [info ] [MainThread]: 
[0m19:35:21.040857 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m19:35:21.042853 [debug] [MainThread]: Command end result
[0m19:35:21.073371 [info ] [MainThread]: 
[0m19:35:21.074392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:21.075397 [info ] [MainThread]: 
[0m19:35:21.076391 [error] [MainThread]:   Database Error in model stg_products (models\ecommerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\ecommerce\staging\stg_products.sql
[0m19:35:21.078388 [info ] [MainThread]: 
[0m19:35:21.079388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:35:21.080387 [debug] [MainThread]: Command `dbt run` failed at 19:35:21.080387 after 5.81 seconds
[0m19:35:21.081394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F807305130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F809402960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8094026C0>]}
[0m19:35:21.081394 [debug] [MainThread]: Flushing usage events
[0m19:35:54.293678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE5A8C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE9697800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE9697FE0>]}


============================== 19:35:54.297420 | 84bb2777-f7b6-42b8-ad65-1b6091638bb5 ==============================
[0m19:35:54.297420 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:35:54.298392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:35:54.301471 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'e-commerce'
[0m19:35:54.304495 [debug] [MainThread]: Command `dbt run` failed at 19:35:54.303984 after 0.12 seconds
[0m19:35:54.304495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE8DC25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE93D2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FE893F3E0>]}
[0m19:35:54.305514 [debug] [MainThread]: Flushing usage events
[0m19:36:07.259455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2D32150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2D32990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2D31010>]}


============================== 19:36:07.264462 | 08831735-ed46-4b45-82e7-bdf03f4f97ee ==============================
[0m19:36:07.264462 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:36:07.265458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:08.254153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA8905C0>]}
[0m19:36:08.310044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CBDA6990>]}
[0m19:36:08.312036 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:36:08.625092 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:36:08.701400 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:36:08.702400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAEB59A0>]}
[0m19:36:09.890248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.analytics
- models.e-commerce.staging
[0m19:36:09.902258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CD2CB920>]}
[0m19:36:10.053756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CD2BAAE0>]}
[0m19:36:10.055057 [info ] [MainThread]: Found 1 model, 1 source, 575 macros
[0m19:36:10.056050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CD2B0C20>]}
[0m19:36:10.057057 [info ] [MainThread]: 
[0m19:36:10.058619 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:10.059644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:36:10.071642 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:36:10.072636 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:36:10.072636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:10.896023 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.823 seconds
[0m19:36:10.898024 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:36:11.024310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:36:11.033853 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:36:11.034856 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:36:11.035862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:11.761526 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.726 seconds
[0m19:36:11.765209 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:36:11.893836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CD27CD70>]}
[0m19:36:11.895832 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:36:11.896838 [info ] [MainThread]: 
[0m19:36:11.907378 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:36:11.908378 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:36:11.909893 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:36:11.911905 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:36:11.927783 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:36:11.930471 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:36:11.971022 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:36:11.973547 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:36:11.974547 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    'goods-title-link--jump'::STRING, 
    "goods-title-link--jump href"::STRING, 
    "rank-title"::STRING,
    "rank-sub"::STRING,
    "price"::STRING,
    "discount"::STRING,
    "selling_proposition"::STRING,
    "goods-title-link"::STRING,
    "color-count"::INTEGER,
    "blackfridaybelts-bg src"::STRING,
    "blackfridaybelts-content"::STRING
FROM E_COMMERCE_PRODUCT.products_schema.products
  );
[0m19:36:11.975545 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:12.741524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5798-0000-fbe3-0001-4c5e000ac1a2
[0m19:36:12.741524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
[0m19:36:12.742528 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:36:12.864157 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:36:12.866150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08831735-ed46-4b45-82e7-bdf03f4f97ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B25A4EF0>]}
[0m19:36:12.866150 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.95s]
[0m19:36:12.868149 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:36:12.870145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:12.871154 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:36:12.871154 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:36:12.872155 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:36:12.872155 [info ] [MainThread]: 
[0m19:36:12.873157 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m19:36:12.875155 [debug] [MainThread]: Command end result
[0m19:36:12.906152 [info ] [MainThread]: 
[0m19:36:12.907156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:12.908145 [info ] [MainThread]: 
[0m19:36:12.909155 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:36:12.910143 [info ] [MainThread]: 
[0m19:36:12.911156 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:36:12.912153 [debug] [MainThread]: Command `dbt run` failed at 19:36:12.912153 after 5.76 seconds
[0m19:36:12.913161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2957EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2A626F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257B2A62A80>]}
[0m19:36:12.913161 [debug] [MainThread]: Flushing usage events
[0m19:39:17.412105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC6EAB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC34FED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC34FF3E0>]}


============================== 19:39:17.417179 | 36183ef3-3e04-4b69-b647-b4de541049f4 ==============================
[0m19:39:17.417179 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:39:17.418177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:18.522302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ADEB29070>]}
[0m19:39:18.567264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC6E83230>]}
[0m19:39:18.569263 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:39:18.887934 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:39:19.050447 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m19:39:19.050447 [debug] [MainThread]: Partial parsing: added file: transform://models\ecommerce\sources\sources.yml
[0m19:39:19.051446 [debug] [MainThread]: Partial parsing: added file: transform://models\ecommerce\staging\stg_products.sql
[0m19:39:19.051446 [debug] [MainThread]: Partial parsing: deleted file: transform://models\e-commerce\staging\stg_products.sql
[0m19:39:19.297301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.analytics
- models.e-commerce.intermediate
[0m19:39:19.309870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ADFFE6210>]}
[0m19:39:19.407781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AE15B1910>]}
[0m19:39:19.408779 [info ] [MainThread]: Found 1 model, 1 source, 575 macros
[0m19:39:19.409780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AE14D1D30>]}
[0m19:39:19.411311 [info ] [MainThread]: 
[0m19:39:19.412306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:19.413823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:39:19.425855 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:39:19.426859 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:39:19.426859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:20.370105 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.943 seconds
[0m19:39:20.371120 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:39:20.511463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:39:20.520556 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:39:20.521073 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:39:20.521073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:21.334569 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.813 seconds
[0m19:39:21.335575 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:39:21.463913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ADFFAABD0>]}
[0m19:39:21.464936 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:39:21.465925 [info ] [MainThread]: 
[0m19:39:21.470936 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:39:21.471924 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:39:21.473448 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:39:21.474471 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:39:21.483991 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:39:21.485004 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:39:21.511106 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:39:21.513143 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:39:21.513143 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    'goods-title-link--jump'::STRING, 
    "goods-title-link--jump href"::STRING, 
    "rank-title"::STRING,
    "rank-sub"::STRING,
    "price"::STRING,
    "discount"::STRING,
    "selling_proposition"::STRING,
    "goods-title-link"::STRING,
    "color-count"::INTEGER,
    "blackfridaybelts-bg src"::STRING,
    "blackfridaybelts-content"::STRING
FROM E_COMMERCE_PRODUCT.products_schema.products
  );
[0m19:39:21.514167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:22.328384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba579b-0000-fbbc-0001-4c5e000a226a
[0m19:39:22.329312 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
[0m19:39:22.330312 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:39:22.455598 [debug] [Thread-1 (]: Database Error in model stg_products (models\ecommerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\ecommerce\staging\stg_products.sql
[0m19:39:22.458777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36183ef3-3e04-4b69-b647-b4de541049f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC6740F20>]}
[0m19:39:22.459788 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.98s]
[0m19:39:22.462330 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:39:22.466502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:22.468517 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:39:22.469518 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:39:22.470516 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:39:22.472517 [info ] [MainThread]: 
[0m19:39:22.474030 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m19:39:22.476044 [debug] [MainThread]: Command end result
[0m19:39:22.535475 [info ] [MainThread]: 
[0m19:39:22.537086 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:39:22.538187 [info ] [MainThread]: 
[0m19:39:22.539808 [error] [MainThread]:   Database Error in model stg_products (models\ecommerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\ecommerce\staging\stg_products.sql
[0m19:39:22.541415 [info ] [MainThread]: 
[0m19:39:22.543037 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:39:22.547477 [debug] [MainThread]: Command `dbt run` failed at 19:39:22.546969 after 5.28 seconds
[0m19:39:22.548580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC62BB4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC62BA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AC5FD78C0>]}
[0m19:39:22.549689 [debug] [MainThread]: Flushing usage events
[0m19:46:04.822102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D07B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134FE33080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134F463B00>]}


============================== 19:46:04.828994 | bf08e06f-50ac-4e48-bb34-d05b93673ea3 ==============================
[0m19:46:04.828994 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:46:04.829774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:05.850666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf08e06f-50ac-4e48-bb34-d05b93673ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021368EA3C80>]}
[0m19:46:05.896664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf08e06f-50ac-4e48-bb34-d05b93673ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021368442960>]}
[0m19:46:05.898652 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:46:06.232120 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:46:06.393831 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m19:46:06.394831 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\staging\stg_products.sql
[0m19:46:06.395367 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\sources\sources.yml
[0m19:46:06.395367 [debug] [MainThread]: Partial parsing: deleted file: transform://models\ecommerce\staging\stg_products.sql
[0m19:46:06.601940 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.stg_products' (models\e-commerce\staging\stg_products.sql) depends on a source named 'raw.products' which was not found
[0m19:46:06.603945 [debug] [MainThread]: Command `dbt run` failed at 19:46:06.603945 after 1.94 seconds
[0m19:46:06.604925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134FE82EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021368F963C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136A469370>]}
[0m19:46:06.604925 [debug] [MainThread]: Flushing usage events
[0m19:46:25.724877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AC5EEBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AEFA2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AEC3E4B0>]}


============================== 19:46:25.729462 | 96ebf606-3bed-47f1-839e-b794efec689c ==============================
[0m19:46:25.729462 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:46:25.730988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:26.749980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C6CC0F50>]}
[0m19:46:26.795234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C8040590>]}
[0m19:46:26.797069 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:46:27.110198 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:46:27.259743 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m19:46:27.260743 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\sources\sources.yml
[0m19:46:27.261734 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\staging\stg_products.sql
[0m19:46:27.261734 [debug] [MainThread]: Partial parsing: deleted file: transform://models\ecommerce\staging\stg_products.sql
[0m19:46:27.508786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.analytics
- models.e-commerce.intermediate
[0m19:46:27.521791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C8096A80>]}
[0m19:46:27.617226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C96CD760>]}
[0m19:46:27.618317 [info ] [MainThread]: Found 1 model, 1 source, 575 macros
[0m19:46:27.618923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9726AE0>]}
[0m19:46:27.621108 [info ] [MainThread]: 
[0m19:46:27.622170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:46:27.623234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:46:27.635966 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:46:27.635966 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:46:27.636978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:28.695952 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.059 seconds
[0m19:46:28.696960 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:46:28.814878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:46:28.822878 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:46:28.823877 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:46:28.823877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:29.646923 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.822 seconds
[0m19:46:29.648550 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:46:29.762355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C96E6B70>]}
[0m19:46:29.763356 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:46:29.764355 [info ] [MainThread]: 
[0m19:46:29.770020 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:46:29.771020 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:46:29.772019 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:46:29.773018 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:46:29.780021 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:46:29.782020 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:46:29.808033 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:46:29.810034 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:46:29.811028 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    'goods-title-link--jump'::STRING, 
    "goods-title-link--jump href"::STRING, 
    "rank-title"::STRING,
    "rank-sub"::STRING,
    "price"::STRING,
    "discount"::STRING,
    "selling_proposition"::STRING,
    "goods-title-link"::STRING,
    "color-count"::INTEGER,
    "blackfridaybelts-bg src"::STRING,
    "blackfridaybelts-content"::STRING
FROM E_COMMERCE_PRODUCT.products_schema.products
  );
[0m19:46:29.811028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:46:30.513243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57a2-0000-fc05-0001-4c5e000b105e
[0m19:46:30.513243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
[0m19:46:30.514243 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:46:30.632117 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:46:30.634632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96ebf606-3bed-47f1-839e-b794efec689c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9AF6240>]}
[0m19:46:30.635633 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.86s]
[0m19:46:30.636632 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:46:30.639633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:30.640716 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:46:30.641224 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:46:30.641224 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:46:30.642232 [info ] [MainThread]: 
[0m19:46:30.642232 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m19:46:30.644233 [debug] [MainThread]: Command end result
[0m19:46:30.673811 [info ] [MainThread]: 
[0m19:46:30.674792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:30.675797 [info ] [MainThread]: 
[0m19:46:30.676789 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA.PRODUCTS' does not exist or not authorized.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:46:30.677790 [info ] [MainThread]: 
[0m19:46:30.677790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:30.680839 [debug] [MainThread]: Command `dbt run` failed at 19:46:30.679305 after 5.06 seconds
[0m19:46:30.680839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C9549400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AEC693D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AEC69A00>]}
[0m19:46:30.681853 [debug] [MainThread]: Flushing usage events
[0m19:58:46.785471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AE0960C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AE3F8D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AAA4F350>]}


============================== 19:58:46.790010 | 5c872f3a-fd0d-4140-9316-51f3570a9375 ==============================
[0m19:58:46.790010 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:58:46.791013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:52.030176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C6124C50>]}
[0m19:58:52.075758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C708FE00>]}
[0m19:58:52.077542 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:58:52.501385 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:58:53.941233 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m19:58:53.941233 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m19:58:54.131102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.analytics
- models.e-commerce.staging
[0m19:58:54.135674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C8A9DC40>]}
[0m19:58:54.233751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C8A857C0>]}
[0m19:58:54.234760 [info ] [MainThread]: Found 1 model, 575 macros
[0m19:58:54.235749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C8AA37A0>]}
[0m19:58:54.237758 [info ] [MainThread]: 
[0m19:58:54.238746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:54.239748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m19:58:54.252757 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m19:58:54.253747 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m19:58:54.253747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:55.559149 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.305 seconds
[0m19:58:55.561170 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m19:58:55.679382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m19:58:55.687322 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m19:58:55.688327 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m19:58:55.688327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:56.467740 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.779 seconds
[0m19:58:56.469742 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m19:58:56.597291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C8A51040>]}
[0m19:58:56.598310 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m19:58:56.599310 [info ] [MainThread]: 
[0m19:58:56.605212 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m19:58:56.605212 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m19:58:56.607737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m19:58:56.607737 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m19:58:56.614745 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m19:58:56.615762 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m19:58:56.641469 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m19:58:56.643460 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m19:58:56.643460 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    t."goods-title-link--jump"::STRING, 
    t."goods-title-link--jump href"::STRING, 
    t."rank-title"::STRING,
    t."rank-sub"::STRING,
    t."price"::STRING,
    t."discount"::STRING,
    t."selling_proposition"::STRING,
    t."goods-title-link"::STRING,
    t."color-count"::INTEGER,
    t."blackfridaybelts-bg src"::STRING,
    t."blackfridaybelts-content"::STRING
FROM 
    TABLE(
        INFER_SCHEMA(
            LOCATION => '@e_commerce_product.products_schema.product_stage',
            FILE_FORMAT => (type => 'parquet')
        )
    ) AS t;
[0m19:58:56.644460 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:58:57.504086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57ae-0000-fc08-0001-4c5e000af1c6
[0m19:58:57.504086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 33 unexpected '=>'.
syntax error line 24 at position 6 unexpected 'AS'.
[0m19:58:57.505087 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m19:58:57.633432 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 33 unexpected '=>'.
  syntax error line 24 at position 6 unexpected 'AS'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:58:57.635963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c872f3a-fd0d-4140-9316-51f3570a9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ADC90EC0>]}
[0m19:58:57.635963 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 1.03s]
[0m19:58:57.637948 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m19:58:57.640562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:57.640562 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m19:58:57.641555 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m19:58:57.641555 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m19:58:57.641555 [info ] [MainThread]: 
[0m19:58:57.642562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m19:58:57.644556 [debug] [MainThread]: Command end result
[0m19:58:57.675075 [info ] [MainThread]: 
[0m19:58:57.676074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:58:57.677082 [info ] [MainThread]: 
[0m19:58:57.678084 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 33 unexpected '=>'.
  syntax error line 24 at position 6 unexpected 'AS'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m19:58:57.679083 [info ] [MainThread]: 
[0m19:58:57.680083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:58:57.682075 [debug] [MainThread]: Command `dbt run` failed at 19:58:57.682075 after 11.01 seconds
[0m19:58:57.683078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AD781640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C89AA270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2C894C7D0>]}
[0m19:58:57.683078 [debug] [MainThread]: Flushing usage events
[0m20:00:06.852232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF727A51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF727764B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF727A4500>]}


============================== 20:00:06.857394 | d32c811e-3541-43fc-891d-4bb35b8d1fb9 ==============================
[0m20:00:06.857394 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:00:06.859391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:00:07.901403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF73133AD0>]}
[0m20:00:07.944727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF725A75C0>]}
[0m20:00:07.946461 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:00:08.313061 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:00:08.460192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:08.461187 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m20:00:08.628530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
- models.e-commerce.analytics
[0m20:00:08.634053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0D647FB0>]}
[0m20:00:08.715307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0C312E70>]}
[0m20:00:08.716308 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:00:08.717304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0D61AA20>]}
[0m20:00:08.718302 [info ] [MainThread]: 
[0m20:00:08.719301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:08.721310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:00:08.733416 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:00:08.733416 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:00:08.734377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:09.684196 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.950 seconds
[0m20:00:09.685642 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:00:09.807027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:00:09.815571 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:00:09.815571 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:00:09.816571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:10.805521 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.989 seconds
[0m20:00:10.807524 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:00:10.937039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0C3DC9E0>]}
[0m20:00:10.938040 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:00:10.939055 [info ] [MainThread]: 
[0m20:00:10.944535 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:00:10.945549 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:00:10.946544 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:00:10.947547 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:00:10.954074 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:00:10.954598 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:00:10.981945 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:00:10.982946 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:00:10.984467 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @e_commerce_product.products_schema.product_stage
    (FILE_FORMAT => (type => parquet));
[0m20:00:10.984467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:11.878630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b0-0000-fb54-0001-4c5e000a733a
[0m20:00:11.879630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 26 unexpected '=>'.
[0m20:00:11.879630 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:00:12.030356 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 26 unexpected '=>'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:00:12.032351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32c811e-3541-43fc-891d-4bb35b8d1fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF72811160>]}
[0m20:00:12.032351 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 1.08s]
[0m20:00:12.034358 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:00:12.037401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:12.037401 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:00:12.038410 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:00:12.038410 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:00:12.039394 [info ] [MainThread]: 
[0m20:00:12.039394 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m20:00:12.041396 [debug] [MainThread]: Command end result
[0m20:00:12.069339 [info ] [MainThread]: 
[0m20:00:12.070097 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:00:12.071132 [info ] [MainThread]: 
[0m20:00:12.072118 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 26 unexpected '=>'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:00:12.073121 [info ] [MainThread]: 
[0m20:00:12.074706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:00:12.077675 [debug] [MainThread]: Command `dbt run` failed at 20:00:12.076668 after 5.33 seconds
[0m20:00:12.078667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF73100350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF0C186510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF72EEA0F0>]}
[0m20:00:12.078667 [debug] [MainThread]: Flushing usage events
[0m20:00:30.832164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AA0AF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AA1B9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AA2EB650>]}


============================== 20:00:30.836164 | 7ac73e0f-bac0-4338-b648-575b53b28747 ==============================
[0m20:00:30.836164 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:00:30.838164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:00:31.900350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C2A8C830>]}
[0m20:00:31.948658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C223A4B0>]}
[0m20:00:31.950654 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:00:32.281404 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:00:32.434418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:32.434418 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m20:00:32.606231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.intermediate
- models.e-commerce.analytics
[0m20:00:32.611228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C338D640>]}
[0m20:00:32.693296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C349EC60>]}
[0m20:00:32.693296 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:00:32.694295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C480E480>]}
[0m20:00:32.696823 [info ] [MainThread]: 
[0m20:00:32.697814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:32.699814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:00:32.716043 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:00:32.716576 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:00:32.717667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:34.268769 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.552 seconds
[0m20:00:34.270771 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:00:34.387239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:00:34.396419 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:00:34.396929 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:00:34.397941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:35.173534 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.776 seconds
[0m20:00:35.174533 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:00:35.289737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A8FC96A0>]}
[0m20:00:35.290737 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:00:35.290737 [info ] [MainThread]: 
[0m20:00:35.298253 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:00:35.299254 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:00:35.300251 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:00:35.301255 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:00:35.306770 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:00:35.308778 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:00:35.336949 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:00:35.338938 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:00:35.339934 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    t."goods-title-link--jump"::STRING, 
    t."goods-title-link--jump href"::STRING, 
    t."rank-title"::STRING,
    t."rank-sub"::STRING,
    t."price"::STRING,
    t."discount"::STRING,
    t."selling_proposition"::STRING,
    t."goods-title-link"::STRING,
    t."color-count"::INTEGER,
    t."blackfridaybelts-bg src"::STRING,
    t."blackfridaybelts-content"::STRING
FROM 
    TABLE(
        INFER_SCHEMA(
            LOCATION => '@e_commerce_product.products_schema.product_stage',
            FILE_FORMAT => (type => 'parquet')
        )
    ) AS t;
[0m20:00:35.339934 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:36.091305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b0-0000-fba7-0001-4c5e000ad2ba
[0m20:00:36.092305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 33 unexpected '=>'.
syntax error line 24 at position 6 unexpected 'AS'.
[0m20:00:36.093300 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:00:36.270587 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 33 unexpected '=>'.
  syntax error line 24 at position 6 unexpected 'AS'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:00:36.272591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac73e0f-bac0-4338-b648-575b53b28747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A9B84DD0>]}
[0m20:00:36.273589 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.97s]
[0m20:00:36.274590 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:00:36.277093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:36.278089 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:00:36.278089 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:00:36.279090 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:00:36.279090 [info ] [MainThread]: 
[0m20:00:36.280079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m20:00:36.282087 [debug] [MainThread]: Command end result
[0m20:00:36.312285 [info ] [MainThread]: 
[0m20:00:36.313279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:00:36.314291 [info ] [MainThread]: 
[0m20:00:36.315283 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 33 unexpected '=>'.
  syntax error line 24 at position 6 unexpected 'AS'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:00:36.315283 [info ] [MainThread]: 
[0m20:00:36.316691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:00:36.318700 [debug] [MainThread]: Command `dbt run` failed at 20:00:36.317702 after 5.59 seconds
[0m20:00:36.318700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A9C4D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258AA023BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C47E2ED0>]}
[0m20:00:36.319701 [debug] [MainThread]: Flushing usage events
[0m20:01:16.868074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203557F3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203557F2CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355F59AF0>]}


============================== 20:01:16.872644 | 470a20f7-5e44-4560-8e04-c5bfdc6f183b ==============================
[0m20:01:16.872644 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:01:16.873661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:01:17.866335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036DCB2240>]}
[0m20:01:17.911166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020356110620>]}
[0m20:01:17.912165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:01:18.232978 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:01:18.387232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:01:18.387232 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m20:01:18.554723 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.analytics
- models.e-commerce.staging
[0m20:01:18.559709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203705A7D40>]}
[0m20:01:18.638678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F271E20>]}
[0m20:01:18.640194 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:01:18.641269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F2BAA50>]}
[0m20:01:18.642873 [info ] [MainThread]: 
[0m20:01:18.644446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:18.645538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:01:18.657292 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:01:18.657292 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:01:18.658291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:19.560078 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.901 seconds
[0m20:01:19.561078 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:01:19.685426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:01:19.695027 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:01:19.696023 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:01:19.696023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:20.543723 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.848 seconds
[0m20:01:20.545737 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:01:20.660410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020370730BF0>]}
[0m20:01:20.661420 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:01:20.662421 [info ] [MainThread]: 
[0m20:01:20.667423 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:01:20.668421 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:01:20.669942 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:01:20.670962 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:01:20.679894 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:01:20.681900 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:01:20.710711 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:01:20.712704 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:01:20.712704 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @e_commerce_product.products_schema.product_stage
    (FILE_FORMAT = (TYPE = PARQUET));
[0m20:01:20.713706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:01:21.418166 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b1-0000-fbfa-0001-4c5e000b20e6
[0m20:01:21.418166 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 36 unexpected ';'.
[0m20:01:21.419162 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:01:21.593374 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 36 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:01:21.594402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '470a20f7-5e44-4560-8e04-c5bfdc6f183b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203557F1070>]}
[0m20:01:21.595374 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.92s]
[0m20:01:21.596374 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:01:21.599375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:21.599375 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:01:21.600361 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:01:21.600361 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:01:21.601361 [info ] [MainThread]: 
[0m20:01:21.602361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m20:01:21.603377 [debug] [MainThread]: Command end result
[0m20:01:21.632927 [info ] [MainThread]: 
[0m20:01:21.634915 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:01:21.635914 [info ] [MainThread]: 
[0m20:01:21.637922 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 36 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:01:21.639473 [info ] [MainThread]: 
[0m20:01:21.641491 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:01:21.644487 [debug] [MainThread]: Command `dbt run` failed at 20:01:21.643495 after 4.87 seconds
[0m20:01:21.644487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036DC25B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203704DD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020355C92660>]}
[0m20:01:21.646496 [debug] [MainThread]: Flushing usage events
[0m20:02:11.751805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C5F9EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C88248C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C7AA61E0>]}


============================== 20:02:11.756674 | 63f59b2c-c667-445b-bff1-1d1189a7ec8a ==============================
[0m20:02:11.756674 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:02:11.757673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:12.714751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E0DB6F90>]}
[0m20:02:12.758928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C86B2000>]}
[0m20:02:12.759929 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:02:13.235100 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:02:13.466179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:13.467178 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m20:02:13.729998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m20:02:13.736432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E1B90290>]}
[0m20:02:13.822884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E1D20080>]}
[0m20:02:13.823412 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:02:13.824425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E1DE87A0>]}
[0m20:02:13.825426 [info ] [MainThread]: 
[0m20:02:13.827055 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:02:13.827943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:02:13.841035 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:02:13.841588 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:02:13.842114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:14.674323 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.832 seconds
[0m20:02:14.675323 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:02:14.794431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:02:14.802974 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:02:14.803250 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:02:14.804272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:15.558185 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.755 seconds
[0m20:02:15.560953 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:02:15.692755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E1AD5A30>]}
[0m20:02:15.693763 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:02:15.694750 [info ] [MainThread]: 
[0m20:02:15.700033 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:02:15.702028 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:02:15.703034 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:02:15.703034 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:02:15.710676 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:02:15.711698 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:02:15.737349 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:02:15.739924 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:02:15.739924 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    t.$1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    t.$1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    t.$1:"rank-title"::STRING AS rank_title,
    t.$1:"rank-sub"::STRING AS rank_sub,
    t.$1:"price"::STRING AS price,
    t.$1:"discount"::STRING AS discount,
    t.$1:"selling_proposition"::STRING AS selling_proposition,
    t.$1:"goods-title-link"::STRING AS goods_title_link,
    t.$1:"color-count"::INTEGER AS color_count,
    t.$1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    t.$1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    TABLE(
        infer_schema(
            LOCATION => '@e_commerce_product.products_schema.product_stage',
            FILE_FORMAT => 'PARQUET'
        )
    ) AS t;
[0m20:02:15.740941 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:02:16.459177 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b2-0000-fb54-0001-4c5e000a7346
[0m20:02:16.460179 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 10 unexpected ';'.
[0m20:02:16.461168 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:02:16.579289 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 10 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:02:16.580809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f59b2c-c667-445b-bff1-1d1189a7ec8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E33A85F0>]}
[0m20:02:16.580809 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.88s]
[0m20:02:16.581819 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:02:16.584828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:16.584828 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:02:16.585837 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:02:16.585837 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:02:16.586821 [info ] [MainThread]: 
[0m20:02:16.587821 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m20:02:16.588821 [debug] [MainThread]: Command end result
[0m20:02:16.617446 [info ] [MainThread]: 
[0m20:02:16.618445 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:02:16.619458 [info ] [MainThread]: 
[0m20:02:16.620329 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 10 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:02:16.621344 [info ] [MainThread]: 
[0m20:02:16.622343 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:02:16.624355 [debug] [MainThread]: Command `dbt run` failed at 20:02:16.624355 after 4.97 seconds
[0m20:02:16.625365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C5F9EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0C897B260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0E096A120>]}
[0m20:02:16.625365 [debug] [MainThread]: Flushing usage events
[0m20:03:36.413999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A34C5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A0B7EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A2C49730>]}


============================== 20:03:36.419033 | d68b322d-45df-4208-b5d8-eb08a39c7f73 ==============================
[0m20:03:36.419033 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:03:36.419942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:37.446744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A2D87680>]}
[0m20:03:37.491370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC5D1E20>]}
[0m20:03:37.492959 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:03:37.816768 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:03:37.947424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:37.947424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:37.952424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.analytics
- models.e-commerce.staging
[0m20:03:37.970452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC75FA10>]}
[0m20:03:38.048095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BDAB8680>]}
[0m20:03:38.049099 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:03:38.050096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC7525A0>]}
[0m20:03:38.051097 [info ] [MainThread]: 
[0m20:03:38.053096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:38.054095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:03:38.068148 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:03:38.068148 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:03:38.068148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:38.934898 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.866 seconds
[0m20:03:38.935905 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:03:39.053354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:03:39.062425 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:03:39.062425 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:03:39.063420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:39.824588 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.762 seconds
[0m20:03:39.826598 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:03:39.939985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC60EFC0>]}
[0m20:03:39.940986 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:03:39.942542 [info ] [MainThread]: 
[0m20:03:39.947551 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:03:39.948549 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:03:39.949549 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:03:39.950553 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:03:39.958553 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:03:39.960552 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:03:39.995145 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:03:39.997143 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:03:39.998143 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    t.$1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    t.$1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    t.$1:"rank-title"::STRING AS rank_title,
    t.$1:"rank-sub"::STRING AS rank_sub,
    t.$1:"price"::STRING AS price,
    t.$1:"discount"::STRING AS discount,
    t.$1:"selling_proposition"::STRING AS selling_proposition,
    t.$1:"goods-title-link"::STRING AS goods_title_link,
    t.$1:"color-count"::INTEGER AS color_count,
    t.$1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    t.$1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    TABLE(
        infer_schema(
            LOCATION => '@e_commerce_product.products_schema.product_stage',
            FILE_FORMAT => 'PARQUET'
        )
    ) AS t;
[0m20:03:39.998143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:40.730162 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b3-0000-fbe3-0001-4c5e000ac28a
[0m20:03:40.730679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 10 unexpected ';'.
[0m20:03:40.730679 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:03:40.851715 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 10 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:03:40.853715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd68b322d-45df-4208-b5d8-eb08a39c7f73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BDE40260>]}
[0m20:03:40.853715 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.90s]
[0m20:03:40.855701 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:03:40.857699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:40.858713 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:03:40.858713 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:03:40.859711 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:03:40.859711 [info ] [MainThread]: 
[0m20:03:40.861723 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m20:03:40.862730 [debug] [MainThread]: Command end result
[0m20:03:40.896940 [info ] [MainThread]: 
[0m20:03:40.897943 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:40.898943 [info ] [MainThread]: 
[0m20:03:40.899929 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 10 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:03:40.901932 [info ] [MainThread]: 
[0m20:03:40.901932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:03:40.903927 [debug] [MainThread]: Command `dbt run` failed at 20:03:40.903927 after 4.60 seconds
[0m20:03:40.904924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A3429E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A33782F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BC4C3500>]}
[0m20:03:40.904924 [debug] [MainThread]: Flushing usage events
[0m20:04:03.815615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220021BED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004BD5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220041A0B60>]}


============================== 20:04:03.822211 | 59208892-07cc-4763-901a-1444f9305860 ==============================
[0m20:04:03.822211 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:04:03.823771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:04:04.836685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201DCA1EE0>]}
[0m20:04:04.885230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201DAF03E0>]}
[0m20:04:04.886228 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:04:05.206990 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:04:05.356476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:04:05.357498 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m20:04:05.526715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m20:04:05.532718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201D1C3EC0>]}
[0m20:04:05.622562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201DF3B3E0>]}
[0m20:04:05.623104 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:04:05.624319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201F0F7320>]}
[0m20:04:05.626399 [info ] [MainThread]: 
[0m20:04:05.627393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:04:05.629400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:04:05.641410 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:04:05.642420 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:04:05.642420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:06.697441 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.054 seconds
[0m20:04:06.698446 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:04:06.826708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:04:06.834708 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:04:06.835708 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:04:06.836711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:07.574513 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.738 seconds
[0m20:04:07.576023 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:04:07.693738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201F491F10>]}
[0m20:04:07.694541 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:04:07.695528 [info ] [MainThread]: 
[0m20:04:07.701190 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:04:07.702183 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:04:07.703182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:04:07.704192 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:04:07.710193 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:04:07.712192 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:04:07.738776 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:04:07.740786 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:04:07.741785 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    (
        SELECT $1
        FROM @e_commerce_product.products_schema.product_stage
        (FILE_FORMAT => PARQUET)
    );
[0m20:04:07.741785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:08.333222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b4-0000-fc05-0001-4c5e000b1142
[0m20:04:08.333222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 5 unexpected ';'.
[0m20:04:08.334215 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:04:08.452152 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 5 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:04:08.454152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59208892-07cc-4763-901a-1444f9305860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220044111C0>]}
[0m20:04:08.455151 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.75s]
[0m20:04:08.456153 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:04:08.459153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:08.459153 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:04:08.460142 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:04:08.460142 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:04:08.461149 [info ] [MainThread]: 
[0m20:04:08.462152 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m20:04:08.463143 [debug] [MainThread]: Command end result
[0m20:04:08.492140 [info ] [MainThread]: 
[0m20:04:08.493140 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:04:08.494138 [info ] [MainThread]: 
[0m20:04:08.494138 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 5 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:04:08.496140 [info ] [MainThread]: 
[0m20:04:08.496140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:04:08.498150 [debug] [MainThread]: Command `dbt run` failed at 20:04:08.498150 after 4.85 seconds
[0m20:04:08.499156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004BA2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004BA2C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004BA1A60>]}
[0m20:04:08.499156 [debug] [MainThread]: Flushing usage events
[0m20:05:08.264684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC51E23890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC54A02540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC5479F7D0>]}


============================== 20:05:08.269689 | 5b513865-e2b4-4a3e-95ca-6be7c3efc26f ==============================
[0m20:05:08.269689 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:05:08.270689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:09.246913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6D0C8E00>]}
[0m20:05:09.292119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC5420B140>]}
[0m20:05:09.293770 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:05:09.610644 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:05:09.751110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:09.752112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:09.756105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.analytics
- models.e-commerce.intermediate
[0m20:05:09.774141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6DB80650>]}
[0m20:05:09.859695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6DD02270>]}
[0m20:05:09.860689 [info ] [MainThread]: Found 1 model, 575 macros
[0m20:05:09.860689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6DB26120>]}
[0m20:05:09.863216 [info ] [MainThread]: 
[0m20:05:09.864207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:09.865217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:05:09.878847 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:05:09.878847 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:05:09.879832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:10.687592 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.808 seconds
[0m20:05:10.689592 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:05:10.807605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m20:05:10.816613 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:05:10.816613 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m20:05:10.817613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:11.642044 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.825 seconds
[0m20:05:11.644040 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:05:11.773200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC6DD48470>]}
[0m20:05:11.774200 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:05:11.776195 [info ] [MainThread]: 
[0m20:05:11.780716 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:05:11.781722 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:05:11.782721 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m20:05:11.783721 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:05:11.791801 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:05:11.793808 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:05:11.825707 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:05:11.827696 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:05:11.827696 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    metadata$filename AS file_name,
    metadata$file_row_number AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    (
        SELECT $1
        FROM @e_commerce_product.products_schema.product_stage
        (FILE_FORMAT => PARQUET)
    );
[0m20:05:11.829040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:12.461409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba57b5-0000-fba7-0001-4c5e000ad2c6
[0m20:05:12.461409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 5 unexpected ';'.
[0m20:05:12.462407 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:05:12.681176 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 5 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:05:12.683186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b513865-e2b4-4a3e-95ca-6be7c3efc26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC54271070>]}
[0m20:05:12.684179 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.90s]
[0m20:05:12.685185 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:05:12.688736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:12.688736 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m20:05:12.688736 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m20:05:12.690311 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:05:12.690820 [info ] [MainThread]: 
[0m20:05:12.691830 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m20:05:12.692834 [debug] [MainThread]: Command end result
[0m20:05:12.722722 [info ] [MainThread]: 
[0m20:05:12.723747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:05:12.723747 [info ] [MainThread]: 
[0m20:05:12.724748 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 5 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m20:05:12.725751 [info ] [MainThread]: 
[0m20:05:12.726750 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:05:12.727747 [debug] [MainThread]: Command `dbt run` failed at 20:05:12.727747 after 4.56 seconds
[0m20:05:12.728806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC51E23890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC54626900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC54B476B0>]}
[0m20:05:12.729791 [debug] [MainThread]: Flushing usage events
[0m12:40:16.269597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2939DB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29002F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2939DB650>]}


============================== 12:40:16.281562 | 42fbfdc8-69f4-4ac3-8697-57e86227bf3c ==============================
[0m12:40:16.281562 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:40:16.282557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:16.289231 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m12:40:16.291266 [debug] [MainThread]: Command `dbt run` failed at 12:40:16.291266 after 0.16 seconds
[0m12:40:16.292262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B293A02150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2936233B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2937303B0>]}
[0m12:40:16.292781 [debug] [MainThread]: Flushing usage events
[0m12:40:50.959725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD11062D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0EC04140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD114821B0>]}


============================== 12:40:50.964499 | 69c15ec6-61c6-4477-9008-ad6e66d0ef6f ==============================
[0m12:40:50.964499 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:40:50.965503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:57.714802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD11A297F0>]}
[0m12:40:57.761541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD29C45B20>]}
[0m12:40:57.763536 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:40:58.202864 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:40:59.816611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:59.817611 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m12:40:59.994281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.intermediate
- models.e-commerce.analytics
[0m12:40:59.998290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2BD8B6E0>]}
[0m12:41:00.129275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2ABB1910>]}
[0m12:41:00.130278 [info ] [MainThread]: Found 1 model, 575 macros
[0m12:41:00.131272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2AA2ECF0>]}
[0m12:41:00.133278 [info ] [MainThread]: 
[0m12:41:00.133935 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:00.134957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:41:00.147991 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:41:00.147991 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:41:00.148964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:01.798414 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.650 seconds
[0m12:41:01.800316 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:41:01.930737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:41:01.939271 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:41:01.940276 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:41:01.941276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:02.545354 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.605 seconds
[0m12:41:02.547354 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:41:02.656818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2C00E420>]}
[0m12:41:02.656818 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:41:02.658055 [info ] [MainThread]: 
[0m12:41:02.669587 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:41:02.670589 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:41:02.671596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:41:02.672589 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:41:02.678599 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:41:02.679600 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:41:02.706182 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:41:02.709184 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:41:02.710186 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    CREATE OR REPLACE FILE FORMAT parquet_format
    TYPE = 'parquet';
[0m12:41:02.710186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:03.626340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5b99-0000-fbfa-0001-4c5e000b5052
[0m12:41:03.627340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 4 unexpected 'CREATE'.
[0m12:41:03.628344 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:41:03.765427 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m12:41:03.767948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69c15ec6-61c6-4477-9008-ad6e66d0ef6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD110D5040>]}
[0m12:41:03.767948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 1.09s]
[0m12:41:03.769035 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:41:03.772060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:03.772060 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:41:03.773050 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:41:03.773050 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:41:03.774061 [info ] [MainThread]: 
[0m12:41:03.774061 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m12:41:03.775062 [debug] [MainThread]: Command end result
[0m12:41:03.803052 [info ] [MainThread]: 
[0m12:41:03.804051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:41:03.805049 [info ] [MainThread]: 
[0m12:41:03.806055 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 4 unexpected 'CREATE'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m12:41:03.807052 [info ] [MainThread]: 
[0m12:41:03.808053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:41:03.810052 [debug] [MainThread]: Command `dbt run` failed at 12:41:03.810052 after 12.96 seconds
[0m12:41:03.811064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD11062D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2C0D19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2BE14E60>]}
[0m12:41:03.811064 [debug] [MainThread]: Flushing usage events
[0m12:41:46.380410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DDA17140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E04E7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E04E7020>]}


============================== 12:41:46.385417 | 8ee13293-a6d4-4840-9670-a7f552168f0c ==============================
[0m12:41:46.385417 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:41:46.386422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:47.467386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293F90B4BF0>]}
[0m12:41:47.516384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FA1D5010>]}
[0m12:41:47.518385 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:41:47.879424 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:41:48.053947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:48.054947 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m12:41:48.254471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.intermediate
- models.e-commerce.analytics
[0m12:41:48.260471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FA57CB90>]}
[0m12:41:48.349004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FB9D4320>]}
[0m12:41:48.350006 [info ] [MainThread]: Found 1 model, 575 macros
[0m12:41:48.351013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FB8C5970>]}
[0m12:41:48.352512 [info ] [MainThread]: 
[0m12:41:48.353639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:48.355653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:41:48.367661 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:41:48.367661 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:41:48.368662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:49.386140 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.018 seconds
[0m12:41:49.388141 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:41:49.515635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:41:49.524640 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:41:49.524640 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:41:49.525640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:50.250414 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.725 seconds
[0m12:41:50.252669 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:41:50.372666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FB9C6C60>]}
[0m12:41:50.373685 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:41:50.374676 [info ] [MainThread]: 
[0m12:41:50.382674 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:41:50.383675 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:41:50.384676 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:41:50.384676 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:41:50.391674 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:41:50.393673 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:41:50.422092 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:41:50.425093 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:41:50.425093 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet');
[0m12:41:50.426092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:51.029025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5b99-0000-fbfa-0001-4c5e000b505a
[0m12:41:51.030025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 62 unexpected ';'.
[0m12:41:51.030025 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:41:51.148159 [debug] [Thread-1 (]: Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 62 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m12:41:51.149159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee13293-a6d4-4840-9670-a7f552168f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E0C54E00>]}
[0m12:41:51.150154 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model products_schema.stg_products .............. [[31mERROR[0m in 0.76s]
[0m12:41:51.151159 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:41:51.154156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:51.154156 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:41:51.155150 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:41:51.155150 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:41:51.156155 [info ] [MainThread]: 
[0m12:41:51.157166 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m12:41:51.158163 [debug] [MainThread]: Command end result
[0m12:41:51.186719 [info ] [MainThread]: 
[0m12:41:51.187714 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:41:51.189714 [info ] [MainThread]: 
[0m12:41:51.190706 [error] [MainThread]:   Database Error in model stg_products (models\e-commerce\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 62 unexpected ';'.
  compiled code at target\run\transform\models\e-commerce\staging\stg_products.sql
[0m12:41:51.191705 [info ] [MainThread]: 
[0m12:41:51.192705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:41:51.194707 [debug] [MainThread]: Command `dbt run` failed at 12:41:51.194707 after 4.96 seconds
[0m12:41:51.194707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FB9C6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293FA35BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E12C24B0>]}
[0m12:41:51.195710 [debug] [MainThread]: Flushing usage events
[0m12:42:12.763422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC04C9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC045F0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC3E328D0>]}


============================== 12:42:12.768421 | 54056ce8-6332-402f-a7c6-2f6726e4a02e ==============================
[0m12:42:12.768421 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:42:12.769659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:13.846093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDCF0B5C0>]}
[0m12:42:13.898094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC2FE8C50>]}
[0m12:42:13.900098 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:42:14.238183 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:42:14.450166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:14.451174 [debug] [MainThread]: Partial parsing: updated file: transform://models\e-commerce\staging\stg_products.sql
[0m12:42:14.623740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.staging
- models.e-commerce.intermediate
[0m12:42:14.628734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDE457E00>]}
[0m12:42:14.710190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDD1229C0>]}
[0m12:42:14.711191 [info ] [MainThread]: Found 1 model, 575 macros
[0m12:42:14.711191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDE32F7D0>]}
[0m12:42:14.713194 [info ] [MainThread]: 
[0m12:42:14.714191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:14.715189 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:42:14.729199 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:42:14.730196 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:42:14.730196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:15.585226 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.855 seconds
[0m12:42:15.587220 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:42:15.704365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:42:15.712366 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:42:15.713372 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:42:15.714371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:16.297714 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.583 seconds
[0m12:42:16.298714 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:42:16.409112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDCEAD340>]}
[0m12:42:16.410112 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:42:16.411106 [info ] [MainThread]: 
[0m12:42:16.416100 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:42:16.417102 [info ] [Thread-1 (]: 1 of 1 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:42:16.418119 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:42:16.419105 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:42:16.425128 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:42:16.426117 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:42:16.452663 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:42:16.453664 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:42:16.454666 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:42:16.455657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:17.342941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m12:42:17.363967 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:42:17.681724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54056ce8-6332-402f-a7c6-2f6726e4a02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDCF09D60>]}
[0m12:42:17.682724 [info ] [Thread-1 (]: 1 of 1 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.26s]
[0m12:42:17.684724 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:42:17.686710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:17.686710 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:42:17.687711 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:42:17.687711 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:42:17.687711 [info ] [MainThread]: 
[0m12:42:17.688800 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m12:42:17.689816 [debug] [MainThread]: Command end result
[0m12:42:17.718830 [info ] [MainThread]: 
[0m12:42:17.719826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:17.720826 [info ] [MainThread]: 
[0m12:42:17.721814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:17.722816 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:17.722816 after 5.07 seconds
[0m12:42:17.723827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDE32C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EC04C9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EDE42B560>]}
[0m12:42:17.723827 [debug] [MainThread]: Flushing usage events
[0m12:54:45.236816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABC261B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABE978F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABE61B200>]}


============================== 12:54:45.241810 | bd17d696-9b38-4469-85ad-564ec56cf117 ==============================
[0m12:54:45.241810 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:54:45.242842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:46.345233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD8241BB0>]}
[0m12:54:46.390773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD829E8A0>]}
[0m12:54:46.391757 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:54:46.705575 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:54:46.876448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:54:46.877448 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\intermediate\int_products.sql
[0m12:54:46.878438 [debug] [MainThread]: Partial parsing: added file: transform://models\e-commerce\intermediate\generic_test.yml
[0m12:54:47.100339 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:54:47.102339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD817E900>]}
[0m12:54:47.246335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.analytics
- models.e-commerce.intermediate
[0m12:54:47.252334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD97C1E50>]}
[0m12:54:47.349404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9856C60>]}
[0m12:54:47.349404 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m12:54:47.350416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD8513440>]}
[0m12:54:47.352419 [info ] [MainThread]: 
[0m12:54:47.353418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:47.357402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:54:47.369413 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:54:47.370413 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:54:47.371415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:48.400466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.029 seconds
[0m12:54:48.402473 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:54:48.520071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:54:48.529075 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:54:48.530075 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:54:48.530075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:49.307214 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.777 seconds
[0m12:54:49.309210 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:54:49.421438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD999F230>]}
[0m12:54:49.422439 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:54:49.423446 [info ] [MainThread]: 
[0m12:54:49.429449 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:54:49.429449 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:54:49.431448 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:54:49.431448 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:54:49.439445 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:54:49.440451 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:54:49.466443 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:54:49.468442 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:54:49.469442 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:54:49.470447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:50.335754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.866 seconds
[0m12:54:50.355754 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:54:50.476452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD8202240>]}
[0m12:54:50.477452 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.04s]
[0m12:54:50.478453 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:54:50.479457 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:54:50.480444 [info ] [Thread-3 (]: 2 of 2 START sql view model products_schema.int_products ....................... [RUN]
[0m12:54:50.481410 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m12:54:50.482442 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:54:50.484437 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:54:50.486428 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:54:50.489435 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:54:50.491440 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:54:50.491440 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.int_products
  
   as (
    SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
  );
[0m12:54:50.492443 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:51.512009 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m12:54:51.514007 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:54:51.641127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd17d696-9b38-4469-85ad-564ec56cf117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9CE3DA0>]}
[0m12:54:51.642131 [info ] [Thread-3 (]: 2 of 2 OK created sql view model products_schema.int_products .................. [[32mSUCCESS 1[0m in 1.16s]
[0m12:54:51.643134 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:54:51.645139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:51.646129 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:54:51.646129 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:54:51.647131 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:54:51.647131 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:54:51.648130 [info ] [MainThread]: 
[0m12:54:51.648501 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m12:54:51.650526 [debug] [MainThread]: Command end result
[0m12:54:51.679525 [info ] [MainThread]: 
[0m12:54:51.680525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:51.681514 [info ] [MainThread]: 
[0m12:54:51.681514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:54:51.683516 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:51.683516 after 6.55 seconds
[0m12:54:51.683516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABC261B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD769D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABE5897F0>]}
[0m12:54:51.684517 [debug] [MainThread]: Flushing usage events
[0m12:56:42.975516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2DCB2B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2DCB2B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2DCB2B590>]}


============================== 12:56:42.980026 | ebde251f-833a-4926-bb76-9316c1bbe47f ==============================
[0m12:56:42.980026 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:42.981025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select int_products', 'send_anonymous_usage_stats': 'True'}
[0m12:56:44.094404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F47E4650>]}
[0m12:56:44.142943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F5BCDA60>]}
[0m12:56:44.144939 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:56:44.463506 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:56:44.638360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:44.638360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:44.643360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
- models.e-commerce.analytics
[0m12:56:44.671529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F5BAE060>]}
[0m12:56:44.841353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F71F23F0>]}
[0m12:56:44.841353 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m12:56:44.842357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F594EF30>]}
[0m12:56:44.844370 [info ] [MainThread]: 
[0m12:56:44.845881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:44.850190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:56:44.866759 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:56:44.866759 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:56:44.867762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:45.729094 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.861 seconds
[0m12:56:45.730098 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:56:45.844706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebde251f-833a-4926-bb76-9316c1bbe47f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F5C65E80>]}
[0m12:56:45.845706 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:56:45.846376 [info ] [MainThread]: 
[0m12:56:45.852390 [debug] [Thread-1 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m12:56:45.853387 [info ] [Thread-1 (]: 1 of 1 START test unique_int_products_goods_title_link_jump .................... [RUN]
[0m12:56:45.854388 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m12:56:45.854388 [debug] [Thread-1 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m12:56:45.868609 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m12:56:45.869602 [debug] [Thread-1 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m12:56:45.889851 [debug] [Thread-1 (]: Writing runtime sql for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m12:56:45.891846 [debug] [Thread-1 (]: Using snowflake connection "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m12:56:45.892855 [debug] [Thread-1 (]: On test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    goods_title_link_jump as unique_field,
    count(*) as n_records

from E_COMMERCE_PRODUCT.products_schema.int_products
where goods_title_link_jump is not null
group by goods_title_link_jump
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:45.893856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:47.767578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.874 seconds
[0m12:56:47.784592 [debug] [Thread-1 (]: On test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606: Close
[0m12:56:47.908887 [error] [Thread-1 (]: 1 of 1 FAIL 12 unique_int_products_goods_title_link_jump ....................... [[31mFAIL 12[0m in 2.05s]
[0m12:56:47.909955 [debug] [Thread-1 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m12:56:47.911877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:47.912875 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:56:47.912875 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m12:56:47.913875 [info ] [MainThread]: 
[0m12:56:47.914316 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m12:56:47.915855 [debug] [MainThread]: Command end result
[0m12:56:47.945954 [info ] [MainThread]: 
[0m12:56:47.946467 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:47.947483 [info ] [MainThread]: 
[0m12:56:47.948481 [error] [MainThread]: [31mFailure in test unique_int_products_goods_title_link_jump (models\e-commerce\intermediate\generic_test.yml)[0m
[0m12:56:47.949486 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m12:56:47.950485 [info ] [MainThread]: 
[0m12:56:47.951476 [info ] [MainThread]:   compiled code at target\compiled\transform\models\e-commerce\intermediate\generic_test.yml\unique_int_products_goods_title_link_jump.sql
[0m12:56:47.953478 [info ] [MainThread]: 
[0m12:56:47.954487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:47.955996 [debug] [MainThread]: Command `dbt test` failed at 12:56:47.955996 after 5.14 seconds
[0m12:56:47.957004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2F4CD5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2DCBA3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2DBC6C050>]}
[0m12:56:47.958004 [debug] [MainThread]: Flushing usage events
[0m12:58:34.120590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCCECCC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD094B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD0948D70>]}


============================== 12:58:34.124595 | 4a54c61c-240c-4987-a6fe-b50c2dd6a7c6 ==============================
[0m12:58:34.124595 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:34.124595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:35.149538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE910D0A0>]}
[0m12:58:35.194258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD01E7650>]}
[0m12:58:35.195258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:58:35.504186 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:58:35.657437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:35.657437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:35.662437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.staging
- models.e-commerce.intermediate
[0m12:58:35.689619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE9A7E060>]}
[0m12:58:35.784689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE9C63800>]}
[0m12:58:35.786270 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m12:58:35.787227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE9CABBF0>]}
[0m12:58:35.789227 [info ] [MainThread]: 
[0m12:58:35.790751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:35.794766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:58:35.808855 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:58:35.809850 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:58:35.809850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:37.031283 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.221 seconds
[0m12:58:37.033284 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:58:37.148004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:58:37.156542 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:58:37.157565 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:58:37.157565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:37.876460 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.719 seconds
[0m12:58:37.878479 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:58:37.993483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE9A7D520>]}
[0m12:58:37.994510 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:58:37.994510 [info ] [MainThread]: 
[0m12:58:38.000363 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:58:38.001361 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:58:38.002355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:58:38.003355 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:58:38.009862 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:58:38.010864 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:58:38.036509 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:58:38.038482 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:58:38.039485 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:58:38.039485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:38.838741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m12:58:38.859837 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:58:38.977373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE993A450>]}
[0m12:58:38.978374 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m12:58:38.979374 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:58:38.980375 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:58:38.981375 [info ] [Thread-3 (]: 2 of 2 START sql view model products_schema.int_products ....................... [RUN]
[0m12:58:38.982379 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m12:58:38.983382 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:58:38.986376 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:58:38.987437 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:58:38.991962 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:58:38.993973 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:58:38.994979 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.int_products
  
   as (
    SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
  );
[0m12:58:38.996491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:58:39.970239 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m12:58:39.973239 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:58:40.090154 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a54c61c-240c-4987-a6fe-b50c2dd6a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CEB2DF710>]}
[0m12:58:40.091153 [info ] [Thread-3 (]: 2 of 2 OK created sql view model products_schema.int_products .................. [[32mSUCCESS 1[0m in 1.11s]
[0m12:58:40.092159 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:58:40.093694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:40.094700 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:58:40.094700 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:58:40.094700 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:58:40.094700 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:58:40.096220 [info ] [MainThread]: 
[0m12:58:40.097230 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m12:58:40.098231 [debug] [MainThread]: Command end result
[0m12:58:40.129337 [info ] [MainThread]: 
[0m12:58:40.130843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:40.131863 [info ] [MainThread]: 
[0m12:58:40.132865 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:58:40.134858 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:40.133866 after 6.17 seconds
[0m12:58:40.134858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCCECCC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CE9C6CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCFCF0FB0>]}
[0m12:58:40.136368 [debug] [MainThread]: Flushing usage events
[0m13:00:19.732312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E67AB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E64464B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E5A6CEC0>]}


============================== 13:00:19.737138 | d2848b5c-92c8-47e6-b79c-70702a6554b9 ==============================
[0m13:00:19.737138 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:00:19.738122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:20.816094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E67D22D0>]}
[0m13:00:20.862677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FE4F0A70>]}
[0m13:00:20.864402 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:00:21.189656 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:00:21.268181 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:00:21.269238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E6003E00>]}
[0m13:00:22.321536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:00:22.323544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE062A0>]}
[0m13:00:22.556158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m13:00:22.561151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE81520>]}
[0m13:00:22.657919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFC57CE0>]}
[0m13:00:22.658923 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:00:22.659911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFCAFCB0>]}
[0m13:00:22.661918 [info ] [MainThread]: 
[0m13:00:22.662913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:22.666919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:00:22.681923 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:00:22.682918 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:00:22.684127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:23.602206 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.918 seconds
[0m13:00:23.604210 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:00:23.727660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:00:23.735667 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:00:23.736672 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:00:23.736672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:24.522996 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.786 seconds
[0m13:00:24.523996 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:00:24.636153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E43A0650>]}
[0m13:00:24.637152 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:00:24.638161 [info ] [MainThread]: 
[0m13:00:24.642916 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:00:24.644925 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:00:24.645919 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:00:24.646931 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:00:24.652916 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:00:24.654920 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:00:24.680929 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:00:24.682919 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:00:24.682919 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:00:24.683922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:25.421977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m13:00:25.441977 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:00:25.561562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFDBF980>]}
[0m13:00:25.561562 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.92s]
[0m13:00:25.563563 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:00:25.564564 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:00:25.565562 [info ] [Thread-3 (]: 2 of 2 START sql view model products_schema.int_products ....................... [RUN]
[0m13:00:25.566563 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:00:25.566563 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:00:25.569562 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:00:25.570562 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:00:25.574562 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:00:25.576573 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:00:25.576573 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.int_products
  
   as (
    SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
  );
[0m13:00:25.577578 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:26.998778 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.421 seconds
[0m13:00:27.000782 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:00:27.126885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2848b5c-92c8-47e6-b79c-70702a6554b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235812ABF80>]}
[0m13:00:27.127885 [info ] [Thread-3 (]: 2 of 2 OK created sql view model products_schema.int_products .................. [[32mSUCCESS 1[0m in 1.56s]
[0m13:00:27.128890 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:00:27.130877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:27.130877 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:00:27.131876 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:00:27.131876 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:00:27.131876 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:00:27.132879 [info ] [MainThread]: 
[0m13:00:27.133888 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m13:00:27.134886 [debug] [MainThread]: Command end result
[0m13:00:27.164451 [info ] [MainThread]: 
[0m13:00:27.165452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:27.166969 [info ] [MainThread]: 
[0m13:00:27.167977 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:00:27.169983 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:27.169983 after 7.59 seconds
[0m13:00:27.170977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E64DBEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FEEA82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE615B0>]}
[0m13:00:27.170977 [debug] [MainThread]: Flushing usage events
[0m13:00:59.608877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7485ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD772132F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD77212060>]}


============================== 13:00:59.614103 | 0c0c8e72-a6a0-49c8-a857-b180e631a947 ==============================
[0m13:00:59.614103 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:00:59.615104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:00.597909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD76A60A40>]}
[0m13:01:00.642897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD772B35C0>]}
[0m13:01:00.644909 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:01:00.963455 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:01:01.057658 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:01:01.058656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD103433B0>]}
[0m13:01:02.108098 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:01:02.109095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1048CA40>]}
[0m13:01:02.318168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.analytics
- models.e-commerce.staging
[0m13:01:02.323178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD118EEC90>]}
[0m13:01:02.420994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD119C3CE0>]}
[0m13:01:02.420994 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:01:02.421998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD76AD1040>]}
[0m13:01:02.424009 [info ] [MainThread]: 
[0m13:01:02.424997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:02.429996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:01:02.443992 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:01:02.444992 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:01:02.444992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:03.294275 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.849 seconds
[0m13:01:03.295280 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:01:03.429785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:01:03.437791 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:01:03.438794 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:01:03.439782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:04.210064 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.771 seconds
[0m13:01:04.212064 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:01:04.384414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD11959340>]}
[0m13:01:04.385432 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:01:04.386417 [info ] [MainThread]: 
[0m13:01:04.391386 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:01:04.392395 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:01:04.393395 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:01:04.394388 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:01:04.401387 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:01:04.402386 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:01:04.428401 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:01:04.430385 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:01:04.430385 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:01:04.431396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:01:05.385941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m13:01:05.406974 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:01:05.519973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD10302270>]}
[0m13:01:05.519973 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.13s]
[0m13:01:05.521963 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:01:05.522975 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:01:05.523975 [info ] [Thread-3 (]: 2 of 2 START sql view model products_schema.int_products ....................... [RUN]
[0m13:01:05.524976 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:01:05.524976 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:01:05.527975 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:01:05.528975 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:01:05.531970 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:01:05.533976 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:01:05.533976 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.int_products
  
   as (
    SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
  );
[0m13:01:05.534968 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:01:06.353424 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m13:01:06.355424 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:01:06.478508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c0c8e72-a6a0-49c8-a857-b180e631a947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD11CFBDD0>]}
[0m13:01:06.479519 [info ] [Thread-3 (]: 2 of 2 OK created sql view model products_schema.int_products .................. [[32mSUCCESS 1[0m in 0.95s]
[0m13:01:06.480509 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:01:06.482495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:06.482495 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:01:06.483496 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:01:06.483496 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:01:06.483496 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:01:06.484496 [info ] [MainThread]: 
[0m13:01:06.485506 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m13:01:06.486493 [debug] [MainThread]: Command end result
[0m13:01:06.517538 [info ] [MainThread]: 
[0m13:01:06.518530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:06.519542 [info ] [MainThread]: 
[0m13:01:06.520532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:01:06.522540 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:06.522540 after 7.01 seconds
[0m13:01:06.523528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7F6EF2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD770E4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD76F92930>]}
[0m13:01:06.523528 [debug] [MainThread]: Flushing usage events
[0m13:01:45.734651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9062780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCBA9DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCAD11280>]}


============================== 13:01:45.739433 | d8a58f9f-10b4-4bf6-bfec-850f5118fd1f ==============================
[0m13:01:45.739433 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:01:45.739433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:45.881629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8a58f9f-10b4-4bf6-bfec-850f5118fd1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCB883110>]}
[0m13:01:45.917551 [debug] [MainThread]: Command `dbt clean` succeeded at 13:01:45.917551 after 0.28 seconds
[0m13:01:45.918557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9062780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCBC629F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCB883110>]}
[0m13:01:45.919552 [debug] [MainThread]: Flushing usage events
[0m13:04:54.456125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341153CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341332B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023414087BC0>]}


============================== 13:04:54.460671 | 1690add2-94ce-4195-9221-8821fb077da2 ==============================
[0m13:04:54.460671 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:04:54.462656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:04:55.469442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342C585940>]}
[0m13:04:55.514447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342CE41A60>]}
[0m13:04:55.516128 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:04:55.841595 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:04:55.842619 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:04:55.843619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413029850>]}
[0m13:04:56.903039 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:04:56.905037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342D2E3860>]}
[0m13:04:57.079755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.analytics
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m13:04:57.085754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342D28FB30>]}
[0m13:04:57.251635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342E486150>]}
[0m13:04:57.251635 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:04:57.252645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342E696E10>]}
[0m13:04:57.254645 [info ] [MainThread]: 
[0m13:04:57.255650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:57.258650 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:04:57.274181 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:04:57.275181 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:04:57.275181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:58.150721 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.875 seconds
[0m13:04:58.152719 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:04:58.485365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1690add2-94ce-4195-9221-8821fb077da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023411B10680>]}
[0m13:04:58.486363 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:04:58.486363 [info ] [MainThread]: 
[0m13:04:58.492352 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:04:58.493359 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:04:58.493359 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:04:58.499357 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:04:58.502355 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:04:58.503356 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:04:58.505354 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:04:58.505354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:04:58.506351 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:04:58.509353 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:04:58.510352 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:04:58.511354 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:04:58.512358 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:04:58.513352 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:04:58.513352 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:04:58.522351 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:04:58.524357 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:04:58.525355 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:04:58.527353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:58.527353 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:04:58.528352 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:04:58.528352 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:04:58.528352 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:04:58.529352 [debug] [MainThread]: Command end result
[0m13:04:58.561359 [debug] [MainThread]: Command `dbt compile` succeeded at 13:04:58.561359 after 4.22 seconds
[0m13:04:58.562361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342CF6F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413E85FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413E85610>]}
[0m13:04:58.562361 [debug] [MainThread]: Flushing usage events
[0m13:05:10.637460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E85BDEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E85BDF680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E85BDC3E0>]}


============================== 13:05:10.641964 | d1514a71-bbff-48e2-a693-b313812da996 ==============================
[0m13:05:10.641964 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:05:10.643962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:11.600597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA055EB10>]}
[0m13:05:11.644123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA114D520>]}
[0m13:05:11.646141 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:05:11.963429 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:05:12.126655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:12.126655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:12.131658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
- models.e-commerce.analytics
[0m13:05:12.159535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA08DAEA0>]}
[0m13:05:12.253849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA13C3410>]}
[0m13:05:12.253849 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:05:12.254856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA0E03110>]}
[0m13:05:12.257866 [info ] [MainThread]: 
[0m13:05:12.258859 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:05:12.262849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:05:12.277379 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:05:12.277379 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:05:12.278387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:13.068891 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.790 seconds
[0m13:05:13.071090 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:05:13.180784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:05:13.188784 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:05:13.189791 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:05:13.189791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:14.057331 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.868 seconds
[0m13:05:14.059365 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:05:14.178066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E85C84440>]}
[0m13:05:14.179097 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:05:14.179097 [info ] [MainThread]: 
[0m13:05:14.185007 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:05:14.186032 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:05:14.187024 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:05:14.188033 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:05:14.194037 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:05:14.195038 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:05:14.221033 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:05:14.225031 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:05:14.225031 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:05:14.226032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:15.084340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m13:05:15.105372 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:05:15.225355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA10B2090>]}
[0m13:05:15.225355 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.04s]
[0m13:05:15.227343 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:05:15.228355 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:05:15.229339 [info ] [Thread-3 (]: 2 of 2 START sql view model products_schema.int_products ....................... [RUN]
[0m13:05:15.230354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:05:15.230354 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:05:15.233337 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:05:15.235354 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:05:15.237354 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:05:15.239354 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:05:15.240353 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.int_products
  
   as (
    SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
  );
[0m13:05:15.240353 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:05:16.178549 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.938 seconds
[0m13:05:16.181571 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:05:16.304569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1514a71-bbff-48e2-a693-b313812da996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA29E0FB0>]}
[0m13:05:16.304569 [info ] [Thread-3 (]: 2 of 2 OK created sql view model products_schema.int_products .................. [[32mSUCCESS 1[0m in 1.07s]
[0m13:05:16.306576 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:05:16.307569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:16.308569 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:05:16.309569 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:05:16.309569 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:05:16.309569 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:05:16.311084 [info ] [MainThread]: 
[0m13:05:16.311084 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m13:05:16.313096 [debug] [MainThread]: Command end result
[0m13:05:16.344093 [info ] [MainThread]: 
[0m13:05:16.345097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:16.346101 [info ] [MainThread]: 
[0m13:05:16.347091 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:05:16.349106 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:16.349106 after 5.81 seconds
[0m13:05:16.350091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E880B1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E880B2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA24F9D00>]}
[0m13:05:16.350091 [debug] [MainThread]: Flushing usage events
[0m13:08:20.734965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135B81FED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135B9FCC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135BA4D3EC0>]}


============================== 13:08:20.740779 | 6f4a8380-79ad-4cd6-aba7-2728e7970188 ==============================
[0m13:08:20.740779 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:08:20.741780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:08:20.894500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4a8380-79ad-4cd6-aba7-2728e7970188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135BABB36B0>]}
[0m13:08:20.929954 [debug] [MainThread]: Command `dbt clean` succeeded at 13:08:20.929954 after 0.36 seconds
[0m13:08:20.929954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135BA2EF470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135BA4735C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135BAE25880>]}
[0m13:08:20.930970 [debug] [MainThread]: Flushing usage events
[0m13:08:26.785415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B21A7CB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B21A7C9EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B21A7CB470>]}


============================== 13:08:26.790422 | 0cb99471-d00c-4d29-b1a7-578e6076bc78 ==============================
[0m13:08:26.790422 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:08:26.791408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:27.890659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2324903B0>]}
[0m13:08:27.935231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B232E48EF0>]}
[0m13:08:27.937234 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:08:28.277877 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:08:28.278877 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:08:28.279878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B219CB81D0>]}
[0m13:08:29.355177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:08:29.357162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2338C8B00>]}
[0m13:08:29.525491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
- models.e-commerce.analytics
[0m13:08:29.531489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B23386A600>]}
[0m13:08:29.693664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B234D2E690>]}
[0m13:08:29.693664 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:08:29.694883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B234F373B0>]}
[0m13:08:29.696895 [info ] [MainThread]: 
[0m13:08:29.697897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:08:29.700894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:08:29.716898 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:08:29.716898 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:08:29.717909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:30.579965 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.862 seconds
[0m13:08:30.581965 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:08:30.702432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb99471-d00c-4d29-b1a7-578e6076bc78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2183BC800>]}
[0m13:08:30.703437 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:08:30.704434 [info ] [MainThread]: 
[0m13:08:30.710763 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:08:30.710763 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:08:30.711755 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:08:30.717777 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:08:30.719786 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:08:30.720793 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:08:30.721793 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:08:30.722790 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:08:30.722790 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:08:30.725786 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:08:30.727786 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:08:30.728794 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:08:30.729788 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:08:30.729788 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:08:30.730782 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:08:30.740317 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:08:30.742319 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:08:30.743323 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:08:30.745318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:30.745318 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:08:30.746314 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:08:30.746314 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:08:30.746314 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:08:30.748315 [debug] [MainThread]: Command end result
[0m13:08:30.778343 [debug] [MainThread]: Command `dbt compile` succeeded at 13:08:30.778343 after 4.09 seconds
[0m13:08:30.778343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B21A5E9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B233C3C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B21A739F40>]}
[0m13:08:30.779865 [debug] [MainThread]: Flushing usage events
[0m13:11:46.570096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E98248F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E9825FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E98242C0>]}


============================== 13:11:46.574100 | 407f2463-93fd-487c-9f11-536559467801 ==============================
[0m13:11:46.574100 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:11:46.575095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:46.714644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '407f2463-93fd-487c-9f11-536559467801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218EA182960>]}
[0m13:11:46.742945 [debug] [MainThread]: Command `dbt clean` succeeded at 13:11:46.742945 after 0.33 seconds
[0m13:11:46.742945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E9EA7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E7B7C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E9C6DF40>]}
[0m13:11:46.743946 [debug] [MainThread]: Flushing usage events
[0m13:11:55.680683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002324F4DC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023252F730E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023252F72A20>]}


============================== 13:11:55.685298 | 49ad91f6-5a19-48b3-86a9-693996e53cba ==============================
[0m13:11:55.685298 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:11:55.686300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:56.713025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326BFE7980>]}
[0m13:11:56.758044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326BF3CB00>]}
[0m13:11:56.760033 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:11:57.067586 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:11:57.068577 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:11:57.069591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326BD6AD20>]}
[0m13:11:58.129167 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:11:58.130152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326C31CB00>]}
[0m13:11:58.307289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m13:11:58.313294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326C40A000>]}
[0m13:11:58.479236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326D552300>]}
[0m13:11:58.480244 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:11:58.481236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232527C7470>]}
[0m13:11:58.482236 [info ] [MainThread]: 
[0m13:11:58.483237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:58.487240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:11:58.502239 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:11:58.503239 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:11:58.503239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:59.445181 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.941 seconds
[0m13:11:59.446181 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:11:59.561230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ad91f6-5a19-48b3-86a9-693996e53cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023250B905C0>]}
[0m13:11:59.561230 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:11:59.562231 [info ] [MainThread]: 
[0m13:11:59.569233 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:11:59.570233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:11:59.570233 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:11:59.576231 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:11:59.579230 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:11:59.580232 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:11:59.582237 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:11:59.583234 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:11:59.583234 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:11:59.586232 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:11:59.588232 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:11:59.590231 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:11:59.591231 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:11:59.592234 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:11:59.592234 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:11:59.603234 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:11:59.605235 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:11:59.607239 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:11:59.609232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:59.609232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:11:59.610235 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:11:59.610235 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:11:59.611237 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:11:59.612235 [debug] [MainThread]: Command end result
[0m13:11:59.644235 [debug] [MainThread]: Command `dbt compile` succeeded at 13:11:59.644235 after 4.07 seconds
[0m13:11:59.644235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023252F991F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023252838E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023252F05640>]}
[0m13:11:59.645237 [debug] [MainThread]: Flushing usage events
[0m13:12:22.056785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71599EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E718249280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E717A252E0>]}


============================== 13:12:22.061793 | 50f4745a-eafe-4939-8e8f-bf0ce87d5ba9 ==============================
[0m13:12:22.061793 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:12:22.062785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:12:22.206357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f4745a-eafe-4939-8e8f-bf0ce87d5ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7183F3B90>]}
[0m13:12:22.235568 [debug] [MainThread]: Command `dbt clean` succeeded at 13:12:22.234568 after 0.28 seconds
[0m13:12:22.235568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E717AFC080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71599EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7183F3B90>]}
[0m13:12:22.236571 [debug] [MainThread]: Flushing usage events
[0m13:12:26.125436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017388E0EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738B8464B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017387D158B0>]}


============================== 13:12:26.129378 | bb5da26d-0f25-4aeb-8c94-d37b622485a4 ==============================
[0m13:12:26.129378 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:12:26.130382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:12:26.267517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5da26d-0f25-4aeb-8c94-d37b622485a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738B7EB4A0>]}
[0m13:12:26.361690 [debug] [MainThread]: Set downloads directory='C:\Users\User\AppData\Local\Temp\dbt-downloads-dxonvc0e'
[0m13:12:26.361690 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:12:26.644672 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:12:26.645668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:12:26.670443 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:12:26.674440 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:12:27.694577 [info ] [MainThread]: Installed from version 1.3.0
[0m13:12:27.695580 [info ] [MainThread]: Up to date!
[0m13:12:27.696578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb5da26d-0f25-4aeb-8c94-d37b622485a4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738BA0D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738CAD3680>]}
[0m13:12:27.698577 [debug] [MainThread]: Command `dbt deps` succeeded at 13:12:27.698577 after 1.68 seconds
[0m13:12:27.699574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738B5E6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738CAB11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738B99BDD0>]}
[0m13:12:27.699574 [debug] [MainThread]: Flushing usage events
[0m13:12:34.065327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025983A80890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002598427D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025983A80E90>]}


============================== 13:12:34.069328 | b3e3db0e-37ec-4be4-8dc0-6995f8445230 ==============================
[0m13:12:34.069328 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:12:34.070329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:12:34.102271 [info ] [MainThread]: dbt version: 1.8.9
[0m13:12:34.103273 [info ] [MainThread]: python version: 3.12.2
[0m13:12:34.103273 [info ] [MainThread]: python path: C:\Users\User\AppData\Local\Programs\Python\Python312\python.exe
[0m13:12:34.104271 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m13:12:35.043533 [info ] [MainThread]: Using profiles dir at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform
[0m13:12:35.044531 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\profiles.yml
[0m13:12:35.045532 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Downloads\0MY FILES\DATE ENGINEERING\Retail-Data-Pipeline\dags\transform\dbt_project.yml
[0m13:12:35.047531 [info ] [MainThread]: adapter type: snowflake
[0m13:12:35.048532 [info ] [MainThread]: adapter version: 1.8.4
[0m13:12:35.131531 [info ] [MainThread]: Configuration:
[0m13:12:35.132535 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:12:35.133532 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:12:35.134206 [info ] [MainThread]: Required dependencies:
[0m13:12:35.135232 [debug] [MainThread]: Executing "git --help"
[0m13:12:35.172221 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:12:35.173223 [debug] [MainThread]: STDERR: "b''"
[0m13:12:35.174223 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:12:35.174223 [info ] [MainThread]: Connection:
[0m13:12:35.175225 [info ] [MainThread]:   account: kinfmrd-dx73789
[0m13:12:35.176222 [info ] [MainThread]:   user: arzion032
[0m13:12:35.176222 [info ] [MainThread]:   database: E_COMMERCE_PRODUCT
[0m13:12:35.177225 [info ] [MainThread]:   warehouse: Project_Warehouse
[0m13:12:35.177225 [info ] [MainThread]:   role: project_man
[0m13:12:35.178222 [info ] [MainThread]:   schema: products_schema
[0m13:12:35.179220 [info ] [MainThread]:   authenticator: None
[0m13:12:35.179220 [info ] [MainThread]:   oauth_client_id: None
[0m13:12:35.180221 [info ] [MainThread]:   query_tag: None
[0m13:12:35.180221 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:12:35.182224 [info ] [MainThread]:   host: None
[0m13:12:35.183225 [info ] [MainThread]:   port: None
[0m13:12:35.184222 [info ] [MainThread]:   proxy_host: None
[0m13:12:35.184222 [info ] [MainThread]:   proxy_port: None
[0m13:12:35.185229 [info ] [MainThread]:   protocol: None
[0m13:12:35.185229 [info ] [MainThread]:   connect_retries: 1
[0m13:12:35.186232 [info ] [MainThread]:   connect_timeout: None
[0m13:12:35.187234 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:12:35.188230 [info ] [MainThread]:   retry_all: False
[0m13:12:35.188230 [info ] [MainThread]:   insecure_mode: False
[0m13:12:35.189231 [info ] [MainThread]:   reuse_connections: None
[0m13:12:35.190230 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:12:35.525894 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:12:35.526894 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:12:35.527889 [debug] [MainThread]: On debug: select 1 as id
[0m13:12:35.527889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:36.336492 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.808 seconds
[0m13:12:36.337489 [debug] [MainThread]: On debug: Close
[0m13:12:36.454458 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:12:36.455448 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:12:36.457463 [debug] [MainThread]: Command `dbt debug` succeeded at 13:12:36.457463 after 2.49 seconds
[0m13:12:36.457463 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:12:36.458462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025983B529F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259833F4AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259FE1B7800>]}
[0m13:12:36.458462 [debug] [MainThread]: Flushing usage events
[0m13:12:58.374518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04584A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04D4C200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7FF36F90>]}


============================== 13:12:58.378524 | d146048d-16e2-4320-ac8a-b0abe9b2c4b5 ==============================
[0m13:12:58.378524 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:12:58.380533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:59.475429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1D11DD30>]}
[0m13:12:59.529955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04CEB5C0>]}
[0m13:12:59.531953 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:12:59.858129 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:12:59.860130 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:12:59.860130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1DE7EF00>]}
[0m13:13:01.139240 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:13:01.140242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1E06CA40>]}
[0m13:13:01.306112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.e-commerce.intermediate
- models.e-commerce.staging
[0m13:13:01.313117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1F2B7110>]}
[0m13:13:01.478116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1F20F3E0>]}
[0m13:13:01.479105 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:13:01.480112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1F455B50>]}
[0m13:13:01.481112 [info ] [MainThread]: 
[0m13:13:01.482111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:13:01.486116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:13:01.501122 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:13:01.502131 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:13:01.502131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:02.375168 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.873 seconds
[0m13:13:02.377160 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:13:02.535241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd146048d-16e2-4320-ac8a-b0abe9b2c4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E1E133170>]}
[0m13:13:02.535241 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:13:02.536257 [info ] [MainThread]: 
[0m13:13:02.543020 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:13:02.544013 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:13:02.544013 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:13:02.550033 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:13:02.552018 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:13:02.554023 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:13:02.555017 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:13:02.556012 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:13:02.556012 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:13:02.558519 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:13:02.560521 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:13:02.561520 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:13:02.562519 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:13:02.562519 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:13:02.563522 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:13:02.572521 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:13:02.574523 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:13:02.575525 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:13:02.577532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:02.577532 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:13:02.578528 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:13:02.578528 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:13:02.578528 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:13:02.579537 [debug] [MainThread]: Command end result
[0m13:13:02.611543 [debug] [MainThread]: Command `dbt compile` succeeded at 13:13:02.611543 after 4.35 seconds
[0m13:13:02.611543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04EA3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E04510950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E045109E0>]}
[0m13:13:02.612541 [debug] [MainThread]: Flushing usage events
[0m13:15:19.974352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B5158ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B53F69F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B53F6B440>]}


============================== 13:15:19.980345 | 62802144-3ccd-44fc-a06a-b931b81dad87 ==============================
[0m13:15:19.980345 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:15:19.981353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:15:20.128162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62802144-3ccd-44fc-a06a-b931b81dad87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B53F8D790>]}
[0m13:15:20.159066 [debug] [MainThread]: Command `dbt clean` succeeded at 13:15:20.159066 after 0.32 seconds
[0m13:15:20.160068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B538622A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B53F69F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B53ED6120>]}
[0m13:15:20.161073 [debug] [MainThread]: Flushing usage events
[0m13:15:25.756848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C260FFE960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C263309910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C263308FB0>]}


============================== 13:15:25.760853 | 777a7a8a-1df9-4561-b54e-6f7cb4694850 ==============================
[0m13:15:25.760853 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:15:25.762846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:26.854631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '777a7a8a-1df9-4561-b54e-6f7cb4694850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27CA33D10>]}
[0m13:15:26.897631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '777a7a8a-1df9-4561-b54e-6f7cb4694850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C264FF4FE0>]}
[0m13:15:26.899753 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:15:27.209699 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:15:27.210699 [error] [MainThread]: Encountered an error:
'charmap' codec can't decode byte 0x9d in position 69: character maps to <undefined>
[0m13:15:27.231786 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 323, in get_full_manifest
    loader = cls(
             ^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 273, in __init__
    self.manifest.state_check = self.build_manifest_state_check()
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 1041, in build_manifest_state_check
    project_hashes[name] = FileHash.from_contents(fp.read())
                                                  ^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\encodings\cp1252.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 69: character maps to <undefined>

[0m13:15:27.236778 [debug] [MainThread]: Command `dbt compile` failed at 13:15:27.236778 after 1.58 seconds
[0m13:15:27.237780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C263B62240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C262B3A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27CAE9310>]}
[0m13:15:27.238782 [debug] [MainThread]: Flushing usage events
[0m13:17:36.557057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EEFCB51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EEFCB7B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF03D3EC0>]}


============================== 13:17:36.561072 | e78ad35b-2a02-41ae-852c-f1ebd7dda915 ==============================
[0m13:17:36.561072 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:17:36.563074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:36.704091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e78ad35b-2a02-41ae-852c-f1ebd7dda915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0DC7860>]}
[0m13:17:36.730623 [debug] [MainThread]: Command `dbt clean` succeeded at 13:17:36.730623 after 0.34 seconds
[0m13:17:36.731624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EEFF6C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0DC7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0E70470>]}
[0m13:17:36.731624 [debug] [MainThread]: Flushing usage events
[0m13:17:43.784844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFA13C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFC09DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFC09EFC0>]}


============================== 13:17:43.788849 | 225812f1-f475-4f05-b4f6-0f9892a4c1bb ==============================
[0m13:17:43.788849 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:17:43.789849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:43.792844 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'e-commerce'
[0m13:17:43.795851 [debug] [MainThread]: Command `dbt compile` failed at 13:17:43.795851 after 0.11 seconds
[0m13:17:43.795851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFC8522A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFCC87470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCFCB19190>]}
[0m13:17:43.796835 [debug] [MainThread]: Flushing usage events
[0m13:17:59.078284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019306A97CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019306A97E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019306A97D10>]}


============================== 13:17:59.084321 | 5488be7d-a75c-4aa5-b77d-586b618f2222 ==============================
[0m13:17:59.084321 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:17:59.085960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:18:00.152493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019305D3F4A0>]}
[0m13:18:00.197496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931E68FF50>]}
[0m13:18:00.199480 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:18:00.527262 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:18:00.529262 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:18:00.530260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931F9DB3E0>]}
[0m13:18:01.860917 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:18:01.861903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019320EF4F80>]}
[0m13:18:02.078281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.e-commerce.staging
- models.e-commerce.intermediate
[0m13:18:02.084278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931FDA04D0>]}
[0m13:18:02.245010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019320F06630>]}
[0m13:18:02.246015 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:18:02.247001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019320EF5D60>]}
[0m13:18:02.248012 [info ] [MainThread]: 
[0m13:18:02.250015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:02.254005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:18:02.269011 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:18:02.269011 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:18:02.270015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:03.469477 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.200 seconds
[0m13:18:03.471475 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:18:03.595388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5488be7d-a75c-4aa5-b77d-586b618f2222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019320E836B0>]}
[0m13:18:03.595388 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:18:03.596402 [info ] [MainThread]: 
[0m13:18:03.603109 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:18:03.604103 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:18:03.605114 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:18:03.611110 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:18:03.613113 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:18:03.614107 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:18:03.615111 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:18:03.616101 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:18:03.616101 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:18:03.619119 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:18:03.621115 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:18:03.622109 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:18:03.623117 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:18:03.624110 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:18:03.625111 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:18:03.634124 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:18:03.635103 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:18:03.636113 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:18:03.638102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:03.639109 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:18:03.639109 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:18:03.640110 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:18:03.640110 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:18:03.641105 [debug] [MainThread]: Command end result
[0m13:18:03.672108 [debug] [MainThread]: Command `dbt compile` succeeded at 13:18:03.672108 after 4.70 seconds
[0m13:18:03.673116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019303BA4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001932105E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019305981820>]}
[0m13:18:03.673116 [debug] [MainThread]: Flushing usage events
[0m13:18:52.045920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D597B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D597B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D597620>]}


============================== 13:18:52.049920 | 3cd986d7-37f7-41aa-a724-2e80f031c907 ==============================
[0m13:18:52.049920 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:18:52.051917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:18:52.201148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd986d7-37f7-41aa-a724-2e80f031c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6CD5CB00>]}
[0m13:18:52.229605 [debug] [MainThread]: Command `dbt clean` succeeded at 13:18:52.229605 after 0.30 seconds
[0m13:18:52.229605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D0C51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D64C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D725790>]}
[0m13:18:52.230603 [debug] [MainThread]: Flushing usage events
[0m13:19:01.409147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4501ADF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4501AE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4501AEA80>]}


============================== 13:19:01.416129 | de5a685a-2c55-402a-bc98-22b401dd4f25 ==============================
[0m13:19:01.416129 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:19:01.417133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:02.569321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45036C680>]}
[0m13:19:02.616309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E469314C50>]}
[0m13:19:02.618318 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:19:02.949883 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:19:02.951869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:19:02.951869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E450312FC0>]}
[0m13:19:04.038055 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:19:04.039052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46A799D60>]}
[0m13:19:04.202971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.products.staging
- models.products.intermediate
[0m13:19:04.208679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4693CF440>]}
[0m13:19:04.374449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46A76C200>]}
[0m13:19:04.375454 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:19:04.376449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46A76CB60>]}
[0m13:19:04.378454 [info ] [MainThread]: 
[0m13:19:04.379449 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:04.383454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:19:04.399449 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:19:04.400449 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:19:04.400449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:05.381122 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.980 seconds
[0m13:19:05.383116 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:19:05.501918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5a685a-2c55-402a-bc98-22b401dd4f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46A7878C0>]}
[0m13:19:05.502923 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:19:05.503914 [info ] [MainThread]: 
[0m13:19:05.509907 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:19:05.510911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:19:05.510911 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:19:05.517909 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:19:05.519911 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:19:05.520915 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:19:05.521910 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:19:05.522910 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:19:05.523907 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:19:05.525906 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:19:05.527910 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:19:05.529916 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:19:05.530916 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:19:05.531911 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:19:05.532914 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:19:05.541910 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:19:05.543914 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:19:05.544917 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:19:05.546916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.546916 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:19:05.547925 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:19:05.548920 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:19:05.548920 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:19:05.549912 [debug] [MainThread]: Command end result
[0m13:19:05.583016 [debug] [MainThread]: Command `dbt compile` succeeded at 13:19:05.582017 after 4.28 seconds
[0m13:19:05.583016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44FA23C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44FA211F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E450097E00>]}
[0m13:19:05.584012 [debug] [MainThread]: Flushing usage events
[0m13:23:11.473897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA30D0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA2514830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA25168A0>]}


============================== 13:23:11.478905 | cd5a847a-e479-4e30-89e0-791a66e876e8 ==============================
[0m13:23:11.478905 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:23:11.479908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:11.653275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5a847a-e479-4e30-89e0-791a66e876e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA24C2930>]}
[0m13:23:11.686066 [debug] [MainThread]: Command `dbt clean` succeeded at 13:23:11.686066 after 0.41 seconds
[0m13:23:11.686066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA3156FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA27775F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA3585790>]}
[0m13:23:11.687079 [debug] [MainThread]: Flushing usage events
[0m13:23:17.892765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C44ABB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C44ABB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C43ECB1A0>]}


============================== 13:23:17.897298 | 6025d018-1d02-45c0-be57-cced7540aec2 ==============================
[0m13:23:17.897298 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:23:17.899822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:23:18.910810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C44B33E60>]}
[0m13:23:18.954810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C43F553A0>]}
[0m13:23:18.956796 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:23:19.281644 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:23:19.283644 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:23:19.283644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5C887590>]}
[0m13:23:20.351047 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:23:20.353047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5DEBAE70>]}
[0m13:23:20.525619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.products.intermediate
- models.products
- models.products.staging
[0m13:23:20.533619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5E084AD0>]}
[0m13:23:20.696622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5E108440>]}
[0m13:23:20.696622 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:23:20.697622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5D306060>]}
[0m13:23:20.699627 [info ] [MainThread]: 
[0m13:23:20.700622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:20.704628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:23:20.719613 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:23:20.720617 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:23:20.720617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:21.647885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.927 seconds
[0m13:23:21.648891 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:23:21.766250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6025d018-1d02-45c0-be57-cced7540aec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C44ABB530>]}
[0m13:23:21.767261 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:23:21.768278 [info ] [MainThread]: 
[0m13:23:21.774267 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:23:21.775277 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:23:21.775277 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:23:21.782273 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:23:21.783792 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:23:21.784791 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:23:21.786789 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:23:21.786789 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:23:21.787789 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:23:21.790794 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:23:21.791789 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:23:21.793789 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:23:21.794792 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:23:21.795799 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:23:21.795799 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:23:21.804800 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:23:21.806793 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:23:21.807791 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:23:21.809793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:21.809793 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:23:21.809793 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:23:21.810793 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:23:21.810793 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:23:21.811790 [debug] [MainThread]: Command end result
[0m13:23:21.843815 [debug] [MainThread]: Command `dbt compile` succeeded at 13:23:21.843815 after 4.05 seconds
[0m13:23:21.844836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5F164260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5DB2EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C443D36E0>]}
[0m13:23:21.845816 [debug] [MainThread]: Flushing usage events
[0m13:24:13.958602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EC43EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EEB70170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EE6421B0>]}


============================== 13:24:13.964198 | 4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80 ==============================
[0m13:24:13.964198 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:24:13.964919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:15.028219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244FF3E0380>]}
[0m13:24:15.078058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244FEF10C50>]}
[0m13:24:15.080059 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:24:15.413391 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:24:15.493279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:24:15.494280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EE673E90>]}
[0m13:24:16.548828 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:24:16.549816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244894D7C20>]}
[0m13:24:16.782571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.products.staging
- models.products.intermediate
- models.products
[0m13:24:16.789108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EEE18B00>]}
[0m13:24:16.891499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244894B7E00>]}
[0m13:24:16.891499 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:24:16.892484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244894C8140>]}
[0m13:24:16.895029 [info ] [MainThread]: 
[0m13:24:16.896033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:16.900464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:24:16.916566 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:24:16.916566 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:24:16.917552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:17.900504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.983 seconds
[0m13:24:17.902503 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:24:18.027298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff9b37a-6e2d-4a4c-b17c-8dbe71312b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244ECA10860>]}
[0m13:24:18.028287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:24:18.029307 [info ] [MainThread]: 
[0m13:24:18.035767 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:24:18.036756 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:24:18.036756 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:24:18.042757 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:24:18.044799 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:24:18.045807 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:24:18.047816 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:24:18.048825 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:24:18.048825 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:24:18.051828 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:24:18.052829 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:24:18.052829 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:24:18.055342 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:18.056343 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:24:18.056343 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:18.065893 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:24:18.066896 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:18.067882 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:18.069885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:18.069885 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:24:18.070878 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:24:18.070878 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:24:18.071877 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:24:18.072396 [debug] [MainThread]: Command end result
[0m13:24:18.105545 [debug] [MainThread]: Command `dbt compile` succeeded at 13:24:18.104526 after 4.26 seconds
[0m13:24:18.105545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244FEB1D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244FFDF7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EC43EAE0>]}
[0m13:24:18.106546 [debug] [MainThread]: Flushing usage events
[0m13:24:23.235320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F50E3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F50E38F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F50E3800>]}


============================== 13:24:23.240322 | 1a961957-ff67-40f6-8e59-91db68d2f1f3 ==============================
[0m13:24:23.240322 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:24:23.241172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:23.380961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a961957-ff67-40f6-8e59-91db68d2f1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F51D7B90>]}
[0m13:24:23.410561 [debug] [MainThread]: Command `dbt clean` succeeded at 13:24:23.410561 after 0.27 seconds
[0m13:24:23.411562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F4F711F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F16BF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F50E38F0>]}
[0m13:24:23.411562 [debug] [MainThread]: Flushing usage events
[0m13:24:29.537891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019279FEEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927C720170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927C9C93A0>]}


============================== 13:24:29.542891 | a9f58c7d-c1f7-4e7a-a429-25bf98560282 ==============================
[0m13:24:29.542891 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:24:29.544412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:30.684582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927E730DA0>]}
[0m13:24:30.733290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927EF552E0>]}
[0m13:24:30.735438 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:24:31.049735 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:24:31.050741 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:24:31.052077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927C267500>]}
[0m13:24:32.137722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:24:32.139715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927EACB740>]}
[0m13:24:32.307122 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.products.intermediate
- models.products
- models.products.staging
[0m13:24:32.313238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001921700F9B0>]}
[0m13:24:32.477705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019217019A90>]}
[0m13:24:32.477705 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:24:32.478707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019217034E60>]}
[0m13:24:32.480710 [info ] [MainThread]: 
[0m13:24:32.482217 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:32.486435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:24:32.504992 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:24:32.504992 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:24:32.505995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:33.481781 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.976 seconds
[0m13:24:33.484324 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:24:33.609501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f58c7d-c1f7-4e7a-a429-25bf98560282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019217226360>]}
[0m13:24:33.610506 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:24:33.611506 [info ] [MainThread]: 
[0m13:24:33.617962 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:24:33.618983 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:24:33.618983 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:24:33.624981 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:24:33.626981 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:24:33.628991 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:24:33.629991 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:24:33.629991 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:24:33.630993 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:24:33.633536 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:24:33.634541 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:24:33.635535 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:24:33.636542 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:33.637534 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:24:33.638529 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:33.647544 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:24:33.649535 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:33.651531 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:33.653530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:33.653530 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:24:33.654529 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:24:33.654529 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:24:33.655529 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:24:33.656534 [debug] [MainThread]: Command end result
[0m13:24:33.688615 [debug] [MainThread]: Command `dbt compile` succeeded at 13:24:33.688615 after 4.25 seconds
[0m13:24:33.689615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927C264F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927EA95730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927C9F2B70>]}
[0m13:24:33.689615 [debug] [MainThread]: Flushing usage events
[0m13:24:43.013842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF4A7637A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF4A0023F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF499E56A0>]}


============================== 13:24:43.018983 | 726539e8-a16d-41ec-a3eb-77da0ce30e47 ==============================
[0m13:24:43.018983 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:24:43.019973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:24:43.163517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '726539e8-a16d-41ec-a3eb-77da0ce30e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF4A89FA70>]}
[0m13:24:43.192341 [debug] [MainThread]: Command `dbt clean` succeeded at 13:24:43.192341 after 0.28 seconds
[0m13:24:43.192341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF4A8CAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF4A6EB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF49B1ECF0>]}
[0m13:24:43.193346 [debug] [MainThread]: Flushing usage events
[0m13:24:47.609547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020982A39B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020985AB6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020985AB42C0>]}


============================== 13:24:47.614551 | cf237f78-3ee8-43a0-9bf8-62d758c86d6f ==============================
[0m13:24:47.614551 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:24:47.615543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:48.619607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099E8E4860>]}
[0m13:24:48.664608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020982E27F20>]}
[0m13:24:48.666539 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:24:49.008348 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:24:49.009348 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:24:49.010353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099EC6BEC0>]}
[0m13:24:50.134754 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:24:50.135678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099DF8FBC0>]}
[0m13:24:50.292376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.products
- models.products.staging
- models.products.intermediate
[0m13:24:50.298378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099EEC3860>]}
[0m13:24:50.463822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209A0094A10>]}
[0m13:24:50.464828 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:24:50.465826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099FFEDE80>]}
[0m13:24:50.467821 [info ] [MainThread]: 
[0m13:24:50.468823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:50.472821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:24:50.487838 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:24:50.488844 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:24:50.488844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:51.324224 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.835 seconds
[0m13:24:51.326220 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:24:51.441468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf237f78-3ee8-43a0-9bf8-62d758c86d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020983650950>]}
[0m13:24:51.442472 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:24:51.443456 [info ] [MainThread]: 
[0m13:24:51.449770 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:24:51.450781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:24:51.450781 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:24:51.457765 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:24:51.459779 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:24:51.460777 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:24:51.461776 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:24:51.462781 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:24:51.463783 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:24:51.466781 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:24:51.467770 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:24:51.469781 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:24:51.470771 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:51.471768 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:24:51.471768 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:51.480789 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:24:51.482805 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:51.483801 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:24:51.485799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:51.485799 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:24:51.486805 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:24:51.486805 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:24:51.486805 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:24:51.487800 [debug] [MainThread]: Command end result
[0m13:24:51.518363 [debug] [MainThread]: Command `dbt compile` succeeded at 13:24:51.518363 after 4.01 seconds
[0m13:24:51.519360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209852F4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209859C6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209859C5EB0>]}
[0m13:24:51.519360 [debug] [MainThread]: Flushing usage events
[0m13:31:16.720497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95A7ABC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95B3F0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B957CF6F90>]}


============================== 13:31:16.726925 | bd7067f6-b4f1-4aa8-afe6-7b5b97158e67 ==============================
[0m13:31:16.726925 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:31:16.727936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:16.881592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd7067f6-b4f1-4aa8-afe6-7b5b97158e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95B84F890>]}
[0m13:31:16.909286 [debug] [MainThread]: Command `dbt clean` succeeded at 13:31:16.909286 after 0.36 seconds
[0m13:31:16.910298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95AEC08F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95B87ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95B8BEB70>]}
[0m13:31:16.910298 [debug] [MainThread]: Flushing usage events
[0m13:32:12.242153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205442DB5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054279E8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020544FC36B0>]}


============================== 13:32:12.246686 | 2510294b-df43-47fe-9cda-39282507e13f ==============================
[0m13:32:12.246686 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:32:12.247672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:13.236168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CF77410>]}
[0m13:32:13.279868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542D3CA70>]}
[0m13:32:13.282864 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:32:13.591518 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:32:13.592518 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:32:13.592518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055E32FC20>]}
[0m13:32:14.654852 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:32:14.655853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055CE39430>]}
[0m13:32:14.875535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.products.intermediate
- models.products.staging
[0m13:32:14.884043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055F6CE990>]}
[0m13:32:15.102516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055F6EB3E0>]}
[0m13:32:15.102516 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:32:15.104024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205449A31D0>]}
[0m13:32:15.106030 [info ] [MainThread]: 
[0m13:32:15.107031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:32:15.111031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:32:15.127628 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:32:15.128632 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:32:15.129630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:16.058525 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.930 seconds
[0m13:32:16.060519 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:32:16.177773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2510294b-df43-47fe-9cda-39282507e13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020542D70620>]}
[0m13:32:16.178780 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:32:16.179778 [info ] [MainThread]: 
[0m13:32:16.185918 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:32:16.186918 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:32:16.187916 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:32:16.193919 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:32:16.196441 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:32:16.197440 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:32:16.198440 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:32:16.199446 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:32:16.200447 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:32:16.202441 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:32:16.204954 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:32:16.205959 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:32:16.206959 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:32:16.207969 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:32:16.208973 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:32:16.219302 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:32:16.221303 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:32:16.222309 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:32:16.223815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:16.224824 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:32:16.224824 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:32:16.225824 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:32:16.226829 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:32:16.227826 [debug] [MainThread]: Command end result
[0m13:32:16.262545 [debug] [MainThread]: Command `dbt compile` succeeded at 13:32:16.262545 after 4.12 seconds
[0m13:32:16.262545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205417CF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055F788590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205451D42C0>]}
[0m13:32:16.262545 [debug] [MainThread]: Flushing usage events
[0m13:35:51.675338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF66165550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF66346F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF68E2C320>]}


============================== 13:35:51.680107 | 510e4665-3b8f-42a5-9240-16ef603e1638 ==============================
[0m13:35:51.680107 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:35:51.681427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:35:51.828081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '510e4665-3b8f-42a5-9240-16ef603e1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF68E869C0>]}
[0m13:35:51.859648 [debug] [MainThread]: Command `dbt clean` succeeded at 13:35:51.859648 after 0.31 seconds
[0m13:35:51.859648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF695104D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF69C55FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF69C56930>]}
[0m13:35:51.860665 [debug] [MainThread]: Flushing usage events
[0m13:35:57.216361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E327CFEA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E329DC8B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E329DC8FB0>]}


============================== 13:35:57.220357 | 8235ff46-39ef-4492-aefd-9dc1bf8482b7 ==============================
[0m13:35:57.220357 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:35:57.222893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:58.283381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E342B9EB10>]}
[0m13:35:58.327923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3298B4C20>]}
[0m13:35:58.328928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:35:58.648017 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:35:58.649018 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:35:58.650024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3436C7320>]}
[0m13:35:59.702896 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:35:59.703890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E343B73620>]}
[0m13:35:59.859533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.intermediate
[0m13:35:59.864535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E343AED220>]}
[0m13:36:00.029107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E329B11CA0>]}
[0m13:36:00.029107 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:36:00.030118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E343443CB0>]}
[0m13:36:00.032147 [info ] [MainThread]: 
[0m13:36:00.033141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:36:00.037152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:36:00.053152 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:36:00.053152 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:36:00.054152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:01.016409 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.963 seconds
[0m13:36:01.019414 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:36:01.141479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8235ff46-39ef-4492-aefd-9dc1bf8482b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E342D56540>]}
[0m13:36:01.142474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:36:01.143476 [info ] [MainThread]: 
[0m13:36:01.148856 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:36:01.149870 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:36:01.150869 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:36:01.156869 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:36:01.158066 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:36:01.159871 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:36:01.160870 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:36:01.161866 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:36:01.161866 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:36:01.165869 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:36:01.166869 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:36:01.168868 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:36:01.169867 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:36:01.169867 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:36:01.170872 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:36:01.179871 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:36:01.181858 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:36:01.182858 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:36:01.184855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:01.184855 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:36:01.185858 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:36:01.185858 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:36:01.185858 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:36:01.186854 [debug] [MainThread]: Command end result
[0m13:36:01.217884 [debug] [MainThread]: Command `dbt compile` succeeded at 13:36:01.217884 after 4.11 seconds
[0m13:36:01.218892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32A34C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E344C1F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32618D190>]}
[0m13:36:01.218892 [debug] [MainThread]: Flushing usage events
[0m13:44:54.227511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173480AE9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001734A9F6F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001734A9F5370>]}


============================== 13:44:54.232513 | 8bac7e1a-76c6-4781-9546-03907b70cdea ==============================
[0m13:44:54.232513 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:54.233681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:44:54.383228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bac7e1a-76c6-4781-9546-03907b70cdea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001734A9F5CD0>]}
[0m13:44:54.410227 [debug] [MainThread]: Command `dbt clean` succeeded at 13:44:54.410227 after 0.30 seconds
[0m13:44:54.410227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017347D986B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001734ABF6E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001734A9F5CD0>]}
[0m13:44:54.411225 [debug] [MainThread]: Flushing usage events
[0m13:46:39.544326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029076D40680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029074BBECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029076E30170>]}


============================== 13:46:39.549329 | be097ffc-4b19-4e9f-995d-958b0f15c341 ==============================
[0m13:46:39.549329 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:46:39.550835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:40.621388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029010561A90>]}
[0m13:46:40.668696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029077707F20>]}
[0m13:46:40.669690 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:46:40.989437 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:46:40.991970 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:46:40.992961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290107C5370>]}
[0m13:46:42.045074 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:46:42.046063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290107BEC30>]}
[0m13:46:42.209011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029011B9DEB0>]}
[0m13:46:42.409645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907F76FFB0>]}
[0m13:46:42.410647 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:46:42.411160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290767201A0>]}
[0m13:46:42.413165 [info ] [MainThread]: 
[0m13:46:42.414167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:42.415196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_staging'
[0m13:46:42.421771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:46:42.430844 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_staging"
[0m13:46:42.432800 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:46:42.433784 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_staging"} */
show objects in E_COMMERCE_PRODUCT.products_schema_staging limit 10000
[0m13:46:42.434454 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:46:42.434929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:42.434929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:43.537010 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01ba5bda-0000-fbfa-0001-4c5e000b50ea
[0m13:46:43.538016 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01ba5bda-0000-fc81-0001-4c5e000b60ea
[0m13:46:43.539000 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:46:43.539000 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:46:43.540008 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:46:43.541013 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:46:43.541533 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:46:43.541533 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:46:43.542541 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: Close
[0m13:46:43.543550 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:46:43.664730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be097ffc-4b19-4e9f-995d-958b0f15c341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029011B95940>]}
[0m13:46:43.665730 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:46:43.666730 [info ] [MainThread]: 
[0m13:46:43.671774 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:46:43.673775 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:46:43.674772 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:46:43.680770 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:46:43.682288 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:46:43.684291 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:46:43.684885 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:46:43.685910 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:46:43.685910 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:46:43.688914 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:46:43.690915 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:46:43.692091 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:46:43.693081 [debug] [Thread-5 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:46:43.693599 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m13:46:43.694616 [debug] [Thread-5 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:46:43.703155 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m13:46:43.705147 [debug] [Thread-5 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:46:43.706150 [debug] [Thread-5 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m13:46:43.707159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:43.708152 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_staging' was properly closed.
[0m13:46:43.708152 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:46:43.709142 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:46:43.709142 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:46:43.709142 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m13:46:43.710648 [debug] [MainThread]: Command end result
[0m13:46:43.742023 [debug] [MainThread]: Command `dbt compile` succeeded at 13:46:43.740761 after 4.34 seconds
[0m13:46:43.742023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907746A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029010360D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029076E31130>]}
[0m13:46:43.743013 [debug] [MainThread]: Flushing usage events
[0m13:47:05.482904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165784A0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165784A3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016578B64770>]}


============================== 13:47:05.487903 | 823fe39e-5f9a-4386-966a-f44020791c32 ==============================
[0m13:47:05.487903 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:47:05.488903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:06.588383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657F3D5670>]}
[0m13:47:06.638378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657F520350>]}
[0m13:47:06.640386 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:06.981541 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:47:07.146414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:07.147421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:07.177504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165794C1880>]}
[0m13:47:07.281502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016513918C50>]}
[0m13:47:07.282502 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:47:07.283498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016512582060>]}
[0m13:47:07.285507 [info ] [MainThread]: 
[0m13:47:07.289528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:07.293534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:07.309537 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:07.310523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:07.310523 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:07.313534 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:07.314540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:07.315527 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:07.318534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:08.320222 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.001 seconds
[0m13:47:08.322211 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:08.346308 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.032 seconds
[0m13:47:08.348327 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:08.458355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now create_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m13:47:08.459346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now create_E_COMMERCE_PRODUCT_products_schema_staging)
[0m13:47:08.462882 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE_PRODUCT"
schema: "products_schema_intermediate"
"
[0m13:47:08.463887 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE_PRODUCT"
schema: "products_schema_staging"
"
[0m13:47:08.469467 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:47:08.472422 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PRODUCT_products_schema_staging"
[0m13:47:08.473426 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "create_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
create schema if not exists E_COMMERCE_PRODUCT.products_schema_intermediate
[0m13:47:08.474437 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "create_E_COMMERCE_PRODUCT_products_schema_staging"} */
create schema if not exists E_COMMERCE_PRODUCT.products_schema_staging
[0m13:47:08.474437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:08.475430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:09.257449 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.782 seconds
[0m13:47:09.258461 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_staging: Close
[0m13:47:09.296597 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.822 seconds
[0m13:47:09.297596 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:47:09.407789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:47:09.410310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_staging'
[0m13:47:09.417325 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:47:09.419893 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_staging"
[0m13:47:09.420863 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:47:09.421863 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_staging"} */
show objects in E_COMMERCE_PRODUCT.products_schema_staging limit 10000
[0m13:47:09.422858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:09.422858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:10.257708 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.835 seconds
[0m13:47:10.260232 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:47:10.285315 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.862 seconds
[0m13:47:10.286325 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: Close
[0m13:47:10.397295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016512581AF0>]}
[0m13:47:10.398283 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:47:10.399280 [info ] [MainThread]: 
[0m13:47:10.404994 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:47:10.406004 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema_staging.stg_products ............... [RUN]
[0m13:47:10.406999 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:47:10.407995 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:47:10.414530 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:47:10.416526 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:47:10.447620 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:47:10.450122 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:47:10.451131 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema_staging.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:47:10.451131 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:11.167700 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5bdb-0000-fc76-0001-4c5e000b90fa
[0m13:47:11.167700 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
[0m13:47:11.169210 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:47:11.283923 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:47:11.284923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823fe39e-5f9a-4386-966a-f44020791c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016578BD50D0>]}
[0m13:47:11.285918 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model products_schema_staging.stg_products ...... [[31mERROR[0m in 0.88s]
[0m13:47:11.287918 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:47:11.289442 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:47:11.290455 [info ] [Thread-3 (]: 2 of 2 SKIP relation products_schema_intermediate.int_products ................. [[33mSKIP[0m]
[0m13:47:11.291462 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:47:11.293454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:11.294452 [debug] [MainThread]: Connection 'create_E_COMMERCE_PRODUCT_products_schema_staging' was properly closed.
[0m13:47:11.294452 [debug] [MainThread]: Connection 'create_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:47:11.295453 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:47:11.295453 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_staging' was properly closed.
[0m13:47:11.296450 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:47:11.296450 [info ] [MainThread]: 
[0m13:47:11.297461 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m13:47:11.298450 [debug] [MainThread]: Command end result
[0m13:47:11.333317 [info ] [MainThread]: 
[0m13:47:11.333317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:11.335314 [info ] [MainThread]: 
[0m13:47:11.336318 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:47:11.337314 [info ] [MainThread]: 
[0m13:47:11.338313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:47:11.340343 [debug] [MainThread]: Command `dbt run` failed at 13:47:11.340343 after 5.96 seconds
[0m13:47:11.341336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001651249F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016579396AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165791505C0>]}
[0m13:47:11.341336 [debug] [MainThread]: Flushing usage events
[0m13:50:09.783307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0A711280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0A710A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0A710BC0>]}


============================== 13:50:09.787307 | 76b3d663-87f9-4962-9adf-84f56d75e58f ==============================
[0m13:50:09.787307 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:50:09.788304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:09.927865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76b3d663-87f9-4962-9adf-84f56d75e58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0AE7B6E0>]}
[0m13:50:09.951871 [debug] [MainThread]: Command `dbt clean` succeeded at 13:50:09.951871 after 0.30 seconds
[0m13:50:09.952870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0A28AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0B0284D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0ACC2C30>]}
[0m13:50:09.952870 [debug] [MainThread]: Flushing usage events
[0m13:50:14.660468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1AA70BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1AA739E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1AA70CB0>]}


============================== 13:50:14.665469 | 89a52d3b-9758-4b7c-aab6-e6ccdd553db3 ==============================
[0m13:50:14.665469 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:50:14.666241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:15.633026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B342FEEA0>]}
[0m13:50:15.678016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1B150C50>]}
[0m13:50:15.680022 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:50:15.986223 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:50:15.987223 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:50:15.988211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B34453F80>]}
[0m13:50:17.045053 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:50:17.045676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32F3A9C0>]}
[0m13:50:17.218344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B343879B0>]}
[0m13:50:17.403580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B357DB4D0>]}
[0m13:50:17.404579 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:50:17.405589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B358769F0>]}
[0m13:50:17.407576 [info ] [MainThread]: 
[0m13:50:17.409578 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:50:17.413576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:50:17.420584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:50:17.427591 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:50:17.429590 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:50:17.430588 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:50:17.431521 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:50:17.431521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:17.432536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:18.316981 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.885 seconds
[0m13:50:18.318980 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:50:18.339466 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.907 seconds
[0m13:50:18.341454 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:50:18.456659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_staging'
[0m13:50:18.457666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:50:18.465671 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_staging"
[0m13:50:18.468667 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:50:18.468667 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_staging"} */
show objects in E_COMMERCE_PRODUCT.products_schema_staging limit 10000
[0m13:50:18.469658 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:50:18.469658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:18.470657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:19.092512 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.622 seconds
[0m13:50:19.094521 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: Close
[0m13:50:19.117530 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.647 seconds
[0m13:50:19.118530 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:50:19.230613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B359F1580>]}
[0m13:50:19.231612 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:50:19.232601 [info ] [MainThread]: 
[0m13:50:19.237603 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:50:19.238601 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema_staging.stg_products ............... [RUN]
[0m13:50:19.240598 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:50:19.240598 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:50:19.249598 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:50:19.251600 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:50:19.278608 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:50:19.281608 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:50:19.281608 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema_staging.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:50:19.281608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:19.847493 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5bde-0000-fc82-0001-4c5e000bc00e
[0m13:50:19.848495 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
[0m13:50:19.849479 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:50:19.971821 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:50:19.973686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a52d3b-9758-4b7c-aab6-e6ccdd553db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1AAE12E0>]}
[0m13:50:19.974684 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model products_schema_staging.stg_products ...... [[31mERROR[0m in 0.73s]
[0m13:50:19.975674 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:50:19.976684 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:50:19.977684 [info ] [Thread-3 (]: 2 of 2 SKIP relation products_schema_intermediate.int_products ................. [[33mSKIP[0m]
[0m13:50:19.978689 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:50:19.980685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:19.980685 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:50:19.981684 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:50:19.981684 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_staging' was properly closed.
[0m13:50:19.982675 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:50:19.982675 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:50:19.983689 [info ] [MainThread]: 
[0m13:50:19.983689 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m13:50:19.985686 [debug] [MainThread]: Command end result
[0m13:50:20.016692 [info ] [MainThread]: 
[0m13:50:20.017674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:50:20.017674 [info ] [MainThread]: 
[0m13:50:20.018677 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:50:20.019685 [info ] [MainThread]: 
[0m13:50:20.021680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:50:20.023678 [debug] [MainThread]: Command `dbt run` failed at 13:50:20.023678 after 5.47 seconds
[0m13:50:20.024675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1B0F51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B359F1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B332DD820>]}
[0m13:50:20.024675 [debug] [MainThread]: Flushing usage events
[0m13:51:14.591672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326109E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232632A2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232632A2F60>]}


============================== 13:51:14.597689 | 58161c29-9888-42e1-864c-f4059ab8ef9d ==============================
[0m13:51:14.597689 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:51:14.598673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:14.742195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58161c29-9888-42e1-864c-f4059ab8ef9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023263BE7AD0>]}
[0m13:51:14.772510 [debug] [MainThread]: Command `dbt clean` succeeded at 13:51:14.772510 after 0.31 seconds
[0m13:51:14.772510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326394A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023263C58410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232637D3500>]}
[0m13:51:14.773515 [debug] [MainThread]: Flushing usage events
[0m13:51:21.167776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC01E26150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC049D5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7FCB7230>]}


============================== 13:51:21.172778 | 51c92de5-6975-44a8-a591-b452a4e30515 ==============================
[0m13:51:21.172778 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:51:21.173781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:22.294589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04BF3EF0>]}
[0m13:51:22.340125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04A41490>]}
[0m13:51:22.342133 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:51:22.672863 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:51:22.673854 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:51:22.674864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1DAD6E10>]}
[0m13:51:23.759587 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:51:23.760582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1DA20C50>]}
[0m13:51:23.996868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1EFD79B0>]}
[0m13:51:24.240503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1F029B50>]}
[0m13:51:24.241503 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:51:24.242503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04A90D10>]}
[0m13:51:24.244502 [info ] [MainThread]: 
[0m13:51:24.246504 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:51:24.252549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:51:24.253543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:51:24.271545 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:51:24.274543 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:51:24.275545 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:51:24.275545 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:51:24.276543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:24.276543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:25.194873 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.918 seconds
[0m13:51:25.195880 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:51:25.219458 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.944 seconds
[0m13:51:25.221521 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:51:25.337742 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_staging'
[0m13:51:25.339743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:51:25.347751 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_staging"
[0m13:51:25.349751 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:51:25.350751 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_staging"} */
show objects in E_COMMERCE_PRODUCT.products_schema_staging limit 10000
[0m13:51:25.351740 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:51:25.351740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:25.352742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:26.155644 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.803 seconds
[0m13:51:26.157644 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.805 seconds
[0m13:51:26.159166 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:51:26.160186 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_staging: Close
[0m13:51:26.281726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04BF1370>]}
[0m13:51:26.282720 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:51:26.283710 [info ] [MainThread]: 
[0m13:51:26.289894 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:51:26.290917 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema_staging.stg_products ............... [RUN]
[0m13:51:26.291915 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:51:26.292927 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:51:26.298929 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:51:26.301932 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:51:26.330466 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:51:26.333483 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:51:26.334482 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema_staging.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:51:26.334482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:26.932383 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5bdf-0000-fc7d-0001-4c5e000b40d6
[0m13:51:26.933383 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
[0m13:51:26.933383 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:51:27.051123 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:51:27.052123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c92de5-6975-44a8-a591-b452a4e30515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04305100>]}
[0m13:51:27.053225 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model products_schema_staging.stg_products ...... [[31mERROR[0m in 0.76s]
[0m13:51:27.054129 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:51:27.056113 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:51:27.057120 [info ] [Thread-3 (]: 2 of 2 SKIP relation products_schema_intermediate.int_products ................. [[33mSKIP[0m]
[0m13:51:27.058120 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:51:27.060118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:27.061118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:51:27.061118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:51:27.062118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_staging' was properly closed.
[0m13:51:27.062118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:51:27.063118 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:51:27.063118 [info ] [MainThread]: 
[0m13:51:27.064111 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m13:51:27.066109 [debug] [MainThread]: Command end result
[0m13:51:27.095655 [info ] [MainThread]: 
[0m13:51:27.096661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:27.097661 [info ] [MainThread]: 
[0m13:51:27.097661 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_STAGING.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:51:27.098647 [info ] [MainThread]: 
[0m13:51:27.099647 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:51:27.100646 [debug] [MainThread]: Command `dbt run` failed at 13:51:27.100646 after 6.04 seconds
[0m13:51:27.102154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04A91E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC01E26150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC04A6B470>]}
[0m13:51:27.102154 [debug] [MainThread]: Flushing usage events
[0m13:55:49.152254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8ECCCEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EEED0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EEED23C0>]}


============================== 13:55:49.157157 | 989dc3ec-ff60-4817-b114-cf94310e9155 ==============================
[0m13:55:49.157157 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:55:49.158158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:49.301222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '989dc3ec-ff60-4817-b114-cf94310e9155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EF85F9B0>]}
[0m13:55:49.329675 [debug] [MainThread]: Command `dbt clean` succeeded at 13:55:49.328675 after 0.33 seconds
[0m13:55:49.329675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EEED0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EF8D3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EF8172F0>]}
[0m13:55:49.330673 [debug] [MainThread]: Flushing usage events
[0m13:56:07.943191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C757550A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C75C564B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C722E0CB0>]}


============================== 13:56:07.946901 | 59ac2014-bae9-4662-a56b-38778d7bff94 ==============================
[0m13:56:07.946901 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:56:07.947904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:08.880576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7FD47D70>]}
[0m13:56:08.926923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0F0BE3F0>]}
[0m13:56:08.928924 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:56:09.271608 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:56:09.272608 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:09.273593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0F13B3E0>]}
[0m13:56:10.352409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:56:10.353409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0F1CEDB0>]}
[0m13:56:10.543948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C105E9460>]}
[0m13:56:10.713572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1060A630>]}
[0m13:56:10.713572 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:56:10.714571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1056E5D0>]}
[0m13:56:10.716572 [info ] [MainThread]: 
[0m13:56:10.717571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:10.721578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:56:10.731587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:56:10.734587 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:56:10.737615 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:56:10.738624 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:56:10.738624 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:56:10.739615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:10.739615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:11.809590 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.070 seconds
[0m13:56:11.811596 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:56:11.914636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.175 seconds
[0m13:56:11.916633 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:56:12.026309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now create_E_COMMERCE_PRODUCT_products_schema_products_schema)
[0m13:56:12.027314 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE_PRODUCT"
schema: "products_schema_products_schema"
"
[0m13:56:12.032326 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PRODUCT_products_schema_products_schema"
[0m13:56:12.032326 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "create_E_COMMERCE_PRODUCT_products_schema_products_schema"} */
create schema if not exists E_COMMERCE_PRODUCT.products_schema_products_schema
[0m13:56:12.033328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:12.738624 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.705 seconds
[0m13:56:12.739627 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_products_schema: Close
[0m13:56:12.860156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_products_schema'
[0m13:56:12.861160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:56:12.869160 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_products_schema"
[0m13:56:12.871147 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:56:12.872155 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema_products_schema limit 10000
[0m13:56:12.873144 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:56:12.873144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:12.874155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:13.657929 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.784 seconds
[0m13:56:13.659928 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:56:13.664929 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.791 seconds
[0m13:56:13.665929 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_products_schema: Close
[0m13:56:13.776054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C73BB0860>]}
[0m13:56:13.777047 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:56:13.778049 [info ] [MainThread]: 
[0m13:56:13.783051 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:56:13.784051 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema_products_schema.stg_products ....... [RUN]
[0m13:56:13.785051 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:56:13.786060 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:56:13.794058 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:56:13.795054 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:56:13.821576 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:56:13.824572 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:56:13.825573 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema_products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:56:13.825573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:14.417965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba5be4-0000-fc7d-0001-4c5e000b410e
[0m13:56:14.418967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_PRODUCTS_SCHEMA.PRODUCT_STAGE' does not exist or not authorized.
[0m13:56:14.418967 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:56:14.537755 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_PRODUCTS_SCHEMA.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:56:14.539760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac2014-bae9-4662-a56b-38778d7bff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0F1CD640>]}
[0m13:56:14.540753 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model products_schema_products_schema.stg_products  [[31mERROR[0m in 0.75s]
[0m13:56:14.541563 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:56:14.543592 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:56:14.544576 [info ] [Thread-3 (]: 2 of 2 SKIP relation products_schema_intermediate.int_products ................. [[33mSKIP[0m]
[0m13:56:14.545592 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:56:14.547588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:14.547588 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:56:14.547588 [debug] [MainThread]: Connection 'create_E_COMMERCE_PRODUCT_products_schema_products_schema' was properly closed.
[0m13:56:14.547588 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_products_schema' was properly closed.
[0m13:56:14.549104 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:56:14.549104 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:56:14.550119 [info ] [MainThread]: 
[0m13:56:14.550119 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m13:56:14.552114 [debug] [MainThread]: Command end result
[0m13:56:14.583117 [info ] [MainThread]: 
[0m13:56:14.584120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:14.585112 [info ] [MainThread]: 
[0m13:56:14.586113 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  002003 (02000): SQL compilation error:
  Stage 'E_COMMERCE_PRODUCT.PRODUCTS_SCHEMA_PRODUCTS_SCHEMA.PRODUCT_STAGE' does not exist or not authorized.
  compiled code at target\run\transform\models\staging\stg_products.sql
[0m13:56:14.587115 [info ] [MainThread]: 
[0m13:56:14.588110 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:56:14.590117 [debug] [MainThread]: Command `dbt run` failed at 13:56:14.589112 after 6.75 seconds
[0m13:56:14.590117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0ED61430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C75FB9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0F083E90>]}
[0m13:56:14.591113 [debug] [MainThread]: Flushing usage events
[0m13:56:44.655100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025220B48B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252233A75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522360C200>]}


============================== 13:56:44.660116 | 4137023d-6ae2-438e-af9d-a0d3fb89aa56 ==============================
[0m13:56:44.660116 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:56:44.660923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:56:45.674720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523B436B10>]}
[0m13:56:45.718724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523B3A8C50>]}
[0m13:56:45.720723 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:56:46.036034 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:56:46.113034 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m13:56:46.115025 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:56:46.115881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523DA82120>]}
[0m13:56:47.158659 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:56:47.159659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523C9A9760>]}
[0m13:56:47.371337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523DD23A40>]}
[0m13:56:47.467272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523DBF0350>]}
[0m13:56:47.467272 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:56:47.468267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523DC82990>]}
[0m13:56:47.471262 [info ] [MainThread]: 
[0m13:56:47.472259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:47.476221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:56:47.477242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:56:47.490239 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:56:47.493250 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:56:47.494245 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:56:47.495250 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:56:47.495250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:47.496254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:48.326585 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.831 seconds
[0m13:56:48.328584 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:56:48.329575 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.835 seconds
[0m13:56:48.332575 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:56:48.445370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:56:48.446380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:56:48.455385 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:56:48.457379 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:56:48.458378 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:56:48.459384 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:56:48.459384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:48.460384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:49.366899 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.907 seconds
[0m13:56:49.368899 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:56:49.385410 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.925 seconds
[0m13:56:49.387409 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:56:49.500825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523B6E71A0>]}
[0m13:56:49.501800 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:56:49.502807 [info ] [MainThread]: 
[0m13:56:49.508500 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:56:49.509529 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:56:49.511523 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:56:49.511523 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:56:49.518525 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:56:49.520518 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:56:49.548522 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:56:49.550516 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:56:49.551515 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:56:49.552515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:50.253866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m13:56:50.274889 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:56:50.385936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523C662300>]}
[0m13:56:50.386937 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m13:56:50.387940 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:56:50.389926 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:56:50.390929 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:56:50.391416 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:56:50.392452 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:56:50.396450 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:56:50.397433 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:56:50.417441 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:56:50.419434 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:56:50.419434 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
        );
[0m13:56:50.420449 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:56:54.831139 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.410 seconds
[0m13:56:54.833141 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:56:54.943003 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4137023d-6ae2-438e-af9d-a0d3fb89aa56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523DBD22D0>]}
[0m13:56:54.944020 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.55s]
[0m13:56:54.946015 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:56:54.947009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:54.948014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:56:54.948014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:56:54.949014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:56:54.949014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:56:54.949014 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:56:54.950019 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:56:54.950019 [info ] [MainThread]: 
[0m13:56:54.951019 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m13:56:54.953029 [debug] [MainThread]: Command end result
[0m13:56:54.981564 [info ] [MainThread]: 
[0m13:56:54.982670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:54.983566 [info ] [MainThread]: 
[0m13:56:54.984566 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:56:54.985568 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:54.985568 after 10.44 seconds
[0m13:56:54.986567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252234B8EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025223582D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025222DD0920>]}
[0m13:56:54.987569 [debug] [MainThread]: Flushing usage events
[0m13:59:47.166288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D38195C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D384CB06E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D384CB21B0>]}


============================== 13:59:47.171358 | a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc ==============================
[0m13:59:47.171358 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:59:47.172358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:48.182546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39E4EDBE0>]}
[0m13:59:48.226962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39E514A40>]}
[0m13:59:48.228980 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:59:48.542053 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:59:48.708575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:48.709570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:48.739309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3850F2DE0>]}
[0m13:59:48.835380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39F96CC80>]}
[0m13:59:48.836380 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:59:48.837381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39D9CFD70>]}
[0m13:59:48.838915 [info ] [MainThread]: 
[0m13:59:48.839916 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:48.843908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:59:48.858518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:59:48.859518 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:59:48.862517 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:59:48.862517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:59:48.863517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:59:48.863517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:48.864518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:49.736367 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.873 seconds
[0m13:59:49.738483 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:59:49.852364 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.988 seconds
[0m13:59:49.854389 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:59:49.971206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now create_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m13:59:49.972209 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE_PRODUCT"
schema: "products_schema_intermediate"
"
[0m13:59:49.977317 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:59:49.977317 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "create_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
create schema if not exists E_COMMERCE_PRODUCT.products_schema_intermediate
[0m13:59:49.978629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:50.579074 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.601 seconds
[0m13:59:50.581077 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:59:50.691222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:59:50.691222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:59:50.700082 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:59:50.702085 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:59:50.703083 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:59:50.704084 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:59:50.705080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:50.705080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:51.473222 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.768 seconds
[0m13:59:51.474240 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:59:51.500215 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.795 seconds
[0m13:59:51.502231 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:59:51.612454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39E492540>]}
[0m13:59:51.613474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:59:51.614457 [info ] [MainThread]: 
[0m13:59:51.620492 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:59:51.620492 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:59:51.621485 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:59:51.622486 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:59:51.629029 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:59:51.631018 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:59:51.658597 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:59:51.660598 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:59:51.661600 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:59:51.661600 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:52.467431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m13:59:52.485911 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:59:52.602685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39E451FD0>]}
[0m13:59:52.603686 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.98s]
[0m13:59:52.604683 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:59:52.605692 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:59:52.605692 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:59:52.607209 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:59:52.608228 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:59:52.613219 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:59:52.614219 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:59:52.635244 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:59:52.636255 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:59:52.637756 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (SELECT sp.* 
FROM E_COMMERCE_PRODUCT.products_schema.stg_products AS sp
        );
[0m13:59:52.637756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:55.089217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.451 seconds
[0m13:59:55.091216 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:59:55.205916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c1f8b5-6740-46a5-a64f-dd57ad6c96cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39F9F7E90>]}
[0m13:59:55.205916 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.60s]
[0m13:59:55.207422 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:59:55.209455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:55.210461 [debug] [MainThread]: Connection 'create_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:59:55.210461 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:59:55.211451 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:59:55.211451 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:59:55.212444 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:59:55.212444 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:59:55.213447 [info ] [MainThread]: 
[0m13:59:55.213447 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m13:59:55.215447 [debug] [MainThread]: Command end result
[0m13:59:55.246018 [info ] [MainThread]: 
[0m13:59:55.247527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:55.248539 [info ] [MainThread]: 
[0m13:59:55.249542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:59:55.250547 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:55.250547 after 8.21 seconds
[0m13:59:55.251554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D384C5E180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39E799130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3850F2840>]}
[0m13:59:55.252544 [debug] [MainThread]: Flushing usage events
[0m23:52:05.595708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FB91ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FE0BF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FE0BF290>]}


============================== 23:52:05.606645 | b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a ==============================
[0m23:52:05.606645 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:52:05.607653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:12.007944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FFEA0C50>]}
[0m23:52:12.053424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1973830B0>]}
[0m23:52:12.055423 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:52:12.607938 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:52:14.171387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:52:14.172387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:52:14.201388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1974BE300>]}
[0m23:52:14.389892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1989FDAF0>]}
[0m23:52:14.390894 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m23:52:14.391894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1973DDE80>]}
[0m23:52:14.392889 [info ] [MainThread]: 
[0m23:52:14.393889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:52:14.395882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:52:14.408894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:52:14.411891 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:52:14.414894 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:52:14.415881 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:52:14.415881 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:52:14.416894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:14.416894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:16.178286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.762 seconds
[0m23:52:16.180285 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:52:16.181291 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.764 seconds
[0m23:52:16.184287 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:52:16.308212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3226b6c-b6e3-42fb-be44-9ec3bc0ce45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E197404AD0>]}
[0m23:52:16.309222 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:52:16.309222 [info ] [MainThread]: 
[0m23:52:16.321553 [debug] [Thread-1 (]: Began running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m23:52:16.322564 [info ] [Thread-1 (]: 1 of 1 START test unique_int_products_goods_title_link_jump .................... [RUN]
[0m23:52:16.323560 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606'
[0m23:52:16.323560 [debug] [Thread-1 (]: Began compiling node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m23:52:16.336564 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m23:52:16.338083 [debug] [Thread-1 (]: Began executing node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m23:52:16.359102 [debug] [Thread-1 (]: Writing runtime sql for node "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m23:52:16.361103 [debug] [Thread-1 (]: Using snowflake connection "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"
[0m23:52:16.362105 [debug] [Thread-1 (]: On test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    goods_title_link_jump as unique_field,
    count(*) as n_records

from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where goods_title_link_jump is not null
group by goods_title_link_jump
having count(*) > 1



      
    ) dbt_internal_test
[0m23:52:16.363105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:52:19.968966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.605 seconds
[0m23:52:19.977493 [debug] [Thread-1 (]: On test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606: Close
[0m23:52:20.088582 [error] [Thread-1 (]: 1 of 1 FAIL 12 unique_int_products_goods_title_link_jump ....................... [[31mFAIL 12[0m in 3.77s]
[0m23:52:20.089575 [debug] [Thread-1 (]: Finished running node test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606
[0m23:52:20.091584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:20.091584 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:52:20.092582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:52:20.092582 [debug] [MainThread]: Connection 'test.transform.unique_int_products_goods_title_link_jump.a1cc7cf606' was properly closed.
[0m23:52:20.093583 [info ] [MainThread]: 
[0m23:52:20.093583 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m23:52:20.094587 [debug] [MainThread]: Command end result
[0m23:52:20.124110 [info ] [MainThread]: 
[0m23:52:20.125129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:52:20.125129 [info ] [MainThread]: 
[0m23:52:20.127120 [error] [MainThread]: [31mFailure in test unique_int_products_goods_title_link_jump (models\intermediate\generic_test.yml)[0m
[0m23:52:20.128120 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m23:52:20.128120 [info ] [MainThread]: 
[0m23:52:20.129116 [info ] [MainThread]:   compiled code at target\compiled\transform\models\intermediate\generic_test.yml\unique_int_products_goods_title_link_jump.sql
[0m23:52:20.130143 [info ] [MainThread]: 
[0m23:52:20.131127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:52:20.133121 [debug] [MainThread]: Command `dbt test` failed at 23:52:20.132123 after 14.67 seconds
[0m23:52:20.133121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FE467410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E197434B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1FB91ECF0>]}
[0m23:52:20.134123 [debug] [MainThread]: Flushing usage events
[0m17:30:53.421654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EC413DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E926C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ECA65730>]}


============================== 17:30:53.432717 | 308a007f-f0f4-431b-9901-feef51497a92 ==============================
[0m17:30:53.432717 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:30:53.434716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:30:53.439715 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m17:30:53.441721 [debug] [MainThread]: Command `dbt run` failed at 17:30:53.441721 after 0.16 seconds
[0m17:30:53.441721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EC413DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200EC9D8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ECBBB5F0>]}
[0m17:30:53.442719 [debug] [MainThread]: Flushing usage events
[0m17:31:24.444621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9F14C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA22764B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA2D37BC0>]}


============================== 17:31:24.449611 | 6495d3ff-b26e-41a9-9d47-7443782fea1d ==============================
[0m17:31:24.449611 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:31:24.450616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:31:31.348621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA2D378C0>]}
[0m17:31:31.416151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA2BC9010>]}
[0m17:31:31.419154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:31:31.884846 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:31:33.501393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:33.502403 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:31:33.679950 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:31:33.680942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABB3A5580>]}
[0m17:31:33.812218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABAB7DBB0>]}
[0m17:31:33.946688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABBF37380>]}
[0m17:31:33.947689 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:31:33.948688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABBD9D940>]}
[0m17:31:33.949693 [info ] [MainThread]: 
[0m17:31:33.951206 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:33.955861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:31:33.962899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:31:33.969908 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:31:33.972451 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:31:33.973441 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:31:33.973938 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:31:33.974412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:33.975033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:35.224257 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.249 seconds
[0m17:31:35.225256 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:31:35.230264 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.256 seconds
[0m17:31:35.231785 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:31:35.351006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:31:35.353093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:31:35.361099 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:31:35.363643 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:31:35.364632 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:31:35.364632 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:31:35.365637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:35.365637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:36.001164 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.635 seconds
[0m17:31:36.003185 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:31:36.013726 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.649 seconds
[0m17:31:36.015726 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:31:36.130077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABD3D55E0>]}
[0m17:31:36.131079 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:31:36.131602 [info ] [MainThread]: 
[0m17:31:36.145122 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:31:36.146124 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:31:36.147124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:31:36.148120 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:31:36.157546 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:31:36.158547 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:31:36.188423 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:31:36.190924 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:31:36.190924 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:31:36.191943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:37.074240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.882 seconds
[0m17:31:37.094984 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:31:37.209072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABBC22120>]}
[0m17:31:37.210074 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.06s]
[0m17:31:37.211569 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:31:37.212579 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:31:37.213578 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:31:37.213578 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:31:37.214591 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:31:37.217581 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:31:37.218581 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:31:37.239651 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:31:37.242170 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:31:37.242170 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods_title_link",
        SPLIT("FILE_NAME", '-')[2]) AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER as rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content",
    ),

unique AS 
    (
    SELECT 
        DISTINCT * 
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )
        );
[0m17:31:37.243183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:31:38.095829 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba625b-0000-fc81-0001-4c5e000b63a6
[0m17:31:38.096354 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 36 unexpected 'AS'.
syntax error line 8 at position 36 unexpected ','.
[0m17:31:38.096354 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:31:38.226406 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:31:38.227403 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6495d3ff-b26e-41a9-9d47-7443782fea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABD7ABDD0>]}
[0m17:31:38.227403 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.01s]
[0m17:31:38.228408 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:31:38.231390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:38.231896 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:31:38.231896 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:31:38.232909 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:31:38.232909 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:31:38.233917 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:31:38.233917 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:31:38.234919 [info ] [MainThread]: 
[0m17:31:38.235412 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m17:31:38.236429 [debug] [MainThread]: Command end result
[0m17:31:38.266997 [info ] [MainThread]: 
[0m17:31:38.267997 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:38.270005 [info ] [MainThread]: 
[0m17:31:38.271000 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:31:38.271513 [info ] [MainThread]: 
[0m17:31:38.272527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:31:38.274536 [debug] [MainThread]: Command `dbt run` failed at 17:31:38.274536 after 13.94 seconds
[0m17:31:38.275537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA07BC8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA2D37890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA2D37A40>]}
[0m17:31:38.275537 [debug] [MainThread]: Flushing usage events
[0m17:32:13.747871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658C52B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016588B7F170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658C3430E0>]}


============================== 17:32:13.751812 | c381d370-12e1-4b82-86f4-5cd164e72ebb ==============================
[0m17:32:13.751812 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:13.753802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:14.751303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A5593740>]}
[0m17:32:14.796869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658C6E0A40>]}
[0m17:32:14.798875 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:32:15.117514 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:15.286190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:15.287193 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:32:15.458844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:32:15.459829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A6A20890>]}
[0m17:32:15.616917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A6B8E360>]}
[0m17:32:15.705635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A5863830>]}
[0m17:32:15.705635 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:32:15.706637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A56DF6E0>]}
[0m17:32:15.708633 [info ] [MainThread]: 
[0m17:32:15.709634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:15.713631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:32:15.725148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:32:15.728149 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:32:15.730146 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:32:15.731145 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:32:15.732151 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:32:15.732151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:15.733156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:16.872735 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.139 seconds
[0m17:32:16.873735 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.141 seconds
[0m17:32:16.875735 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:32:16.876741 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:32:16.998079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:32:17.000086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:32:17.008079 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:32:17.011065 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:32:17.011608 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:32:17.012639 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:32:17.012639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:17.013696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:17.693032 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.680 seconds
[0m17:32:17.695027 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:32:17.781281 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.768 seconds
[0m17:32:17.783278 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:32:17.898103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A6E15130>]}
[0m17:32:17.899139 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:32:17.900133 [info ] [MainThread]: 
[0m17:32:17.905309 [debug] [Thread-1 (]: Began running node model.transform.int_products
[0m17:32:17.906320 [debug] [Thread-2 (]: Began running node model.transform.stg_products
[0m17:32:17.906320 [info ] [Thread-1 (]: 1 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:32:17.907311 [info ] [Thread-2 (]: 2 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:32:17.909320 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:32:17.910311 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:32:17.911314 [debug] [Thread-1 (]: Began compiling node model.transform.int_products
[0m17:32:17.911314 [debug] [Thread-2 (]: Began compiling node model.transform.stg_products
[0m17:32:17.917827 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:32:17.920822 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:32:17.921821 [debug] [Thread-1 (]: Began executing node model.transform.int_products
[0m17:32:17.940835 [debug] [Thread-2 (]: Began executing node model.transform.stg_products
[0m17:32:17.948835 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:32:17.968850 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:32:17.970858 [debug] [Thread-2 (]: Using snowflake connection "model.transform.stg_products"
[0m17:32:17.971856 [debug] [Thread-1 (]: Using snowflake connection "model.transform.int_products"
[0m17:32:17.972852 [debug] [Thread-2 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:32:17.973846 [debug] [Thread-1 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods_title_link",
        SPLIT("FILE_NAME", '-')[2]) AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER as rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content",
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:32:17.973846 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:17.974856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:18.712516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba625c-0000-fc76-0001-4c5e000b9436
[0m17:32:18.713511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 36 unexpected 'AS'.
syntax error line 8 at position 36 unexpected ','.
[0m17:32:18.713511 [debug] [Thread-1 (]: On model.transform.int_products: Close
[0m17:32:18.770462 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m17:32:18.792460 [debug] [Thread-2 (]: On model.transform.stg_products: Close
[0m17:32:18.858536 [debug] [Thread-1 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:32:18.860541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658BDC4C50>]}
[0m17:32:18.860541 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.95s]
[0m17:32:18.862530 [debug] [Thread-1 (]: Finished running node model.transform.int_products
[0m17:32:18.907246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c381d370-12e1-4b82-86f4-5cd164e72ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A6D39490>]}
[0m17:32:18.908240 [info ] [Thread-2 (]: 2 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.00s]
[0m17:32:18.909238 [debug] [Thread-2 (]: Finished running node model.transform.stg_products
[0m17:32:18.911236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:18.912257 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:32:18.912257 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:32:18.913246 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:32:18.913246 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:32:18.913246 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:32:18.913246 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:32:18.914761 [info ] [MainThread]: 
[0m17:32:18.915782 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m17:32:18.916779 [debug] [MainThread]: Command end result
[0m17:32:18.947780 [info ] [MainThread]: 
[0m17:32:18.948778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:32:18.949778 [info ] [MainThread]: 
[0m17:32:18.950778 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:32:18.951769 [info ] [MainThread]: 
[0m17:32:18.952771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:32:18.955778 [debug] [MainThread]: Command `dbt run` failed at 17:32:18.954779 after 5.30 seconds
[0m17:32:18.955778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658BD54560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001658BE20AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165A6B7B560>]}
[0m17:32:18.956771 [debug] [MainThread]: Flushing usage events
[0m17:32:39.515330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147EAB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147AF2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147E83410>]}


============================== 17:32:39.520352 | 055fa7bd-8d11-4ea9-87ed-6dc24d474b67 ==============================
[0m17:32:39.520352 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:39.521359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:40.512535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025148030890>]}
[0m17:32:40.557194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147EAB4A0>]}
[0m17:32:40.559197 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:32:40.858799 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:41.023940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:41.024863 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:32:41.196421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:32:41.197421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251624E1D30>]}
[0m17:32:41.321419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025162532600>]}
[0m17:32:41.412407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025161208950>]}
[0m17:32:41.412407 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:32:41.413408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025160FE5A60>]}
[0m17:32:41.415418 [info ] [MainThread]: 
[0m17:32:41.416420 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:41.420420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:32:41.432420 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:32:41.433436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:32:41.433436 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:32:41.436433 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:32:41.437443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:41.437443 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:32:41.440436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:42.277513 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.840 seconds
[0m17:32:42.278512 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:32:42.336516 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.896 seconds
[0m17:32:42.338514 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:32:42.449659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:32:42.452659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:32:42.462659 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:32:42.464661 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:32:42.465659 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:32:42.466659 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:32:42.467659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:42.467659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:43.357928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.891 seconds
[0m17:32:43.359923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m17:32:43.360923 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:32:43.362929 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:32:43.476499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251494E59A0>]}
[0m17:32:43.476499 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:32:43.478500 [info ] [MainThread]: 
[0m17:32:43.483510 [debug] [Thread-1 (]: Began running node model.transform.int_products
[0m17:32:43.483510 [debug] [Thread-2 (]: Began running node model.transform.stg_products
[0m17:32:43.484501 [info ] [Thread-1 (]: 1 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:32:43.485498 [info ] [Thread-2 (]: 2 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:32:43.487501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:32:43.488501 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:32:43.488501 [debug] [Thread-1 (]: Began compiling node model.transform.int_products
[0m17:32:43.489498 [debug] [Thread-2 (]: Began compiling node model.transform.stg_products
[0m17:32:43.495505 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:32:43.497506 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:32:43.499717 [debug] [Thread-1 (]: Began executing node model.transform.int_products
[0m17:32:43.527262 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:32:43.527262 [debug] [Thread-2 (]: Began executing node model.transform.stg_products
[0m17:32:43.548260 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:32:43.549261 [debug] [Thread-1 (]: Using snowflake connection "model.transform.int_products"
[0m17:32:43.550270 [debug] [Thread-1 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods_title_link",
        SPLIT("FILE_NAME", '-')[2]) AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER as rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content"
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:32:43.552267 [debug] [Thread-2 (]: Using snowflake connection "model.transform.stg_products"
[0m17:32:43.552267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:43.553261 [debug] [Thread-2 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:32:43.555259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:44.315695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba625c-0000-fc81-0001-4c5e000b63ae
[0m17:32:44.315695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 36 unexpected 'AS'.
syntax error line 8 at position 36 unexpected ','.
[0m17:32:44.316629 [debug] [Thread-1 (]: On model.transform.int_products: Close
[0m17:32:44.407107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m17:32:44.428133 [debug] [Thread-2 (]: On model.transform.stg_products: Close
[0m17:32:44.443084 [debug] [Thread-1 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:32:44.444087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147745040>]}
[0m17:32:44.445089 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.96s]
[0m17:32:44.446539 [debug] [Thread-1 (]: Finished running node model.transform.int_products
[0m17:32:44.553219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055fa7bd-8d11-4ea9-87ed-6dc24d474b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025160ED2240>]}
[0m17:32:44.554209 [info ] [Thread-2 (]: 2 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.06s]
[0m17:32:44.555217 [debug] [Thread-2 (]: Finished running node model.transform.stg_products
[0m17:32:44.557206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:44.558211 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:32:44.558211 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:32:44.559209 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:32:44.559209 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:32:44.559209 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:32:44.560210 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:32:44.560210 [info ] [MainThread]: 
[0m17:32:44.561474 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m17:32:44.563505 [debug] [MainThread]: Command end result
[0m17:32:44.593510 [info ] [MainThread]: 
[0m17:32:44.595499 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:32:44.595499 [info ] [MainThread]: 
[0m17:32:44.596494 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 36 unexpected 'AS'.
  syntax error line 8 at position 36 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:32:44.597487 [info ] [MainThread]: 
[0m17:32:44.598496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:32:44.600500 [debug] [MainThread]: Command `dbt run` failed at 17:32:44.600500 after 5.18 seconds
[0m17:32:44.600500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251624D3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025147B466F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025145B36930>]}
[0m17:32:44.601506 [debug] [MainThread]: Flushing usage events
[0m17:34:40.568614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F89CBED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F8C69B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F8C69B680>]}


============================== 17:34:40.573625 | 4fba8b48-1dab-4277-9582-93934049eaa5 ==============================
[0m17:34:40.573625 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:34:40.574622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:41.606058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA4D78D10>]}
[0m17:34:41.654054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F8B874B60>]}
[0m17:34:41.655941 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:34:41.982674 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:34:42.157311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:42.158296 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:34:42.352308 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:34:42.353569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F887D2C30>]}
[0m17:34:42.494576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA6D13B30>]}
[0m17:34:42.584595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA6EA7890>]}
[0m17:34:42.585597 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:34:42.586594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA6CDBAA0>]}
[0m17:34:42.588598 [info ] [MainThread]: 
[0m17:34:42.589595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:42.593593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:34:42.606600 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:34:42.606600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:34:42.607601 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:34:42.609611 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:34:42.610607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:42.611605 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:34:42.614597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:43.551733 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.942 seconds
[0m17:34:43.554731 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:34:43.555721 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.941 seconds
[0m17:34:43.558710 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:34:43.684117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:34:43.687120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:34:43.694121 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:34:43.697121 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:34:43.698190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:34:43.699190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:34:43.699680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:43.700316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:44.333024 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m17:34:44.334023 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:34:44.469599 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.770 seconds
[0m17:34:44.471608 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:34:44.584946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA578D9A0>]}
[0m17:34:44.585755 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:34:44.586756 [info ] [MainThread]: 
[0m17:34:44.592340 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:34:44.593342 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:34:44.594336 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:34:44.594336 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:34:44.601340 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:34:44.602339 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:34:44.629341 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:34:44.631344 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:34:44.632343 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:34:44.632343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:34:45.545803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m17:34:45.566811 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:34:45.692548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA56EA4E0>]}
[0m17:34:45.693560 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.10s]
[0m17:34:45.694541 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:34:45.695273 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:34:45.696293 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:34:45.697297 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:34:45.697297 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:34:45.700302 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:34:45.701309 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:34:45.721304 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:34:45.723303 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:34:45.723303 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods_title_link",
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content" 
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:34:45.724298 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:34:46.513805 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba625e-0000-fc51-0001-4c5e000c00f2
[0m17:34:46.513805 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier '"goods_title_link"'
[0m17:34:46.514842 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:34:46.625310 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:34:46.625310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fba8b48-1dab-4277-9582-93934049eaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA71CAB70>]}
[0m17:34:46.627311 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.93s]
[0m17:34:46.628308 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:34:46.630295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:46.631313 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:34:46.631313 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:34:46.632306 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:34:46.632306 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:34:46.633304 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:34:46.633304 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:34:46.634306 [info ] [MainThread]: 
[0m17:34:46.635295 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m17:34:46.636299 [debug] [MainThread]: Command end result
[0m17:34:46.666307 [info ] [MainThread]: 
[0m17:34:46.667304 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:46.668309 [info ] [MainThread]: 
[0m17:34:46.669304 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:34:46.669304 [info ] [MainThread]: 
[0m17:34:46.670305 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:34:46.672649 [debug] [MainThread]: Command `dbt run` failed at 17:34:46.672649 after 6.25 seconds
[0m17:34:46.672649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F8C336E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FA6D1F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F8C2E23C0>]}
[0m17:34:46.673641 [debug] [MainThread]: Flushing usage events
[0m17:35:45.348182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239564146B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239564434A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956442390>]}


============================== 17:35:45.352198 | 0f3189ea-2549-4797-8aa1-6f5c4dc66ca0 ==============================
[0m17:35:45.352198 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:35:45.353197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:35:46.428049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956DA3830>]}
[0m17:35:46.473045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396EA08D70>]}
[0m17:35:46.475050 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:35:46.801080 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:35:46.972606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:46.973606 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:35:47.150045 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:35:47.151564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239710B9700>]}
[0m17:35:47.280170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023971297770>]}
[0m17:35:47.377187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396FFC8230>]}
[0m17:35:47.377187 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:35:47.378174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002397141DBE0>]}
[0m17:35:47.380184 [info ] [MainThread]: 
[0m17:35:47.381182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:47.385181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:35:47.396186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:35:47.400180 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:35:47.402181 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:35:47.403181 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:35:47.403181 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:35:47.404187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:47.404187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:48.241759 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.837 seconds
[0m17:35:48.243753 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:35:48.249932 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.846 seconds
[0m17:35:48.251943 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:35:48.363476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:35:48.366490 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:35:48.374490 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:35:48.377494 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:35:48.377494 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:35:48.378486 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:35:48.379486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:48.379486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:49.064218 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m17:35:49.066218 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:35:49.178630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.799 seconds
[0m17:35:49.180148 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:35:49.299172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023971298E00>]}
[0m17:35:49.300175 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:35:49.301176 [info ] [MainThread]: 
[0m17:35:49.307165 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:35:49.308167 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:35:49.309171 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:35:49.310176 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:35:49.317160 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:35:49.319162 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:35:49.351171 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:35:49.353174 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:35:49.354179 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:35:49.354179 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:50.052175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m17:35:50.073703 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:35:50.187165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396FC71F40>]}
[0m17:35:50.188167 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.88s]
[0m17:35:50.190177 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:35:50.191176 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:35:50.192170 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:35:50.194166 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:35:50.195166 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:35:50.198168 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:35:50.199163 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:35:50.221166 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:35:50.223169 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:35:50.224170 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods-title-link--jump",
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content" 
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:35:50.225166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:51.006943 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba625f-0000-fc76-0001-4c5e000b9442
[0m17:35:51.006943 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier '"goods-title-link--jump"'
[0m17:35:51.007943 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:35:51.134717 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods-title-link--jump"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:35:51.135710 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3189ea-2549-4797-8aa1-6f5c4dc66ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239717AA6C0>]}
[0m17:35:51.136702 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.94s]
[0m17:35:51.137707 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:35:51.140701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:51.140701 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:35:51.141704 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:35:51.141704 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:35:51.142707 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:35:51.143705 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:35:51.143705 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:35:51.144705 [info ] [MainThread]: 
[0m17:35:51.145703 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m17:35:51.146712 [debug] [MainThread]: Command end result
[0m17:35:51.182282 [info ] [MainThread]: 
[0m17:35:51.183288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:35:51.184284 [info ] [MainThread]: 
[0m17:35:51.185287 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods-title-link--jump"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:35:51.187271 [info ] [MainThread]: 
[0m17:35:51.188289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:35:51.190282 [debug] [MainThread]: Command `dbt run` failed at 17:35:51.189271 after 5.95 seconds
[0m17:35:51.190282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956C4E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956942660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023956942960>]}
[0m17:35:51.190282 [debug] [MainThread]: Flushing usage events
[0m17:36:25.024768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9ED76300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9C6EC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9F4595B0>]}


============================== 17:36:25.029770 | b0a06ce8-fda2-4d5f-a4fd-d29649870ff2 ==============================
[0m17:36:25.029770 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:36:25.030775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:26.094039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB7358890>]}
[0m17:36:26.141575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9E6D41D0>]}
[0m17:36:26.143584 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:36:26.456761 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:36:26.620138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:26.621140 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:36:26.794708 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:36:26.796710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB86D94F0>]}
[0m17:36:26.935235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB9C4CC50>]}
[0m17:36:27.027309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB88D3680>]}
[0m17:36:27.028309 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:36:27.029317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB9BEBC20>]}
[0m17:36:27.030307 [info ] [MainThread]: 
[0m17:36:27.031316 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:36:27.035764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:36:27.043554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:36:27.049571 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:36:27.052565 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:36:27.052565 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:36:27.053788 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:36:27.054244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:27.054796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:27.924302 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.870 seconds
[0m17:36:27.925302 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:36:27.930861 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.876 seconds
[0m17:36:27.932385 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:36:28.049980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:36:28.053017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:36:28.059991 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:36:28.062993 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:36:28.063985 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:36:28.063985 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:36:28.064994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:28.064994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:28.931372 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.866 seconds
[0m17:36:28.933370 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:36:28.994099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.929 seconds
[0m17:36:28.995102 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:36:29.115656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB9B10DD0>]}
[0m17:36:29.116657 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:36:29.117662 [info ] [MainThread]: 
[0m17:36:29.122785 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:36:29.123785 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:36:29.124784 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:36:29.125790 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:36:29.132786 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:36:29.134295 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:36:29.159313 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:36:29.161306 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:36:29.162335 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:36:29.163306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:29.882353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m17:36:29.906340 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:36:30.021175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB85BE300>]}
[0m17:36:30.021175 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.90s]
[0m17:36:30.023170 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:36:30.024163 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:36:30.025171 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:36:30.026161 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:36:30.027172 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:36:30.030173 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:36:30.031178 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:36:30.051173 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:36:30.052178 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:36:30.053162 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        "goods_title_link_jump",
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content" 
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:36:30.054170 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:36:30.788100 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6260-0000-fc76-0001-4c5e000b9446
[0m17:36:30.788100 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier '"goods_title_link_jump"'
[0m17:36:30.789100 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:36:30.908416 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods_title_link_jump"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:36:30.908416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a06ce8-fda2-4d5f-a4fd-d29649870ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABA10B8C0>]}
[0m17:36:30.909411 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.88s]
[0m17:36:30.911411 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:36:30.913403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:30.914416 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:36:30.914416 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:36:30.915411 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:36:30.915411 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:36:30.916417 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:36:30.916417 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:36:30.917416 [info ] [MainThread]: 
[0m17:36:30.917416 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m17:36:30.919413 [debug] [MainThread]: Command end result
[0m17:36:30.949405 [info ] [MainThread]: 
[0m17:36:30.950408 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:30.952407 [info ] [MainThread]: 
[0m17:36:30.953401 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier '"goods_title_link_jump"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:36:30.954412 [info ] [MainThread]: 
[0m17:36:30.955404 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:36:30.957406 [debug] [MainThread]: Command `dbt run` failed at 17:36:30.957406 after 6.04 seconds
[0m17:36:30.958406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9E7997F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB85FE6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA9F4B6E40>]}
[0m17:36:30.958406 [debug] [MainThread]: Flushing usage events
[0m17:37:44.094327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A4733A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A4394E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A432E6F0>]}


============================== 17:37:44.099215 | 46dada38-aba8-442b-b30e-e2ae047ee547 ==============================
[0m17:37:44.099215 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:37:44.100210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:45.100049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BC430650>]}
[0m17:37:45.145650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187A3F55490>]}
[0m17:37:45.148184 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:37:45.468391 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:37:45.633267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:45.634270 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:37:45.810912 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:37:45.811679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BEC22A80>]}
[0m17:37:45.936255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BEBDE330>]}
[0m17:37:46.038135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BD9E2510>]}
[0m17:37:46.039136 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:37:46.040136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BECCA0F0>]}
[0m17:37:46.041138 [info ] [MainThread]: 
[0m17:37:46.042804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:37:46.045827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:37:46.054370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:37:46.059918 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:37:46.062902 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:37:46.063907 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:37:46.063907 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:37:46.064914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:46.065903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:46.982300 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.916 seconds
[0m17:37:46.983303 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:37:47.023538 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.958 seconds
[0m17:37:47.024538 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:37:47.142711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:37:47.144709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:37:47.152226 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:37:47.155739 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:37:47.155739 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:37:47.157246 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:37:47.158253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:47.158253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:47.869270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.711 seconds
[0m17:37:47.871277 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:37:47.951610 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.793 seconds
[0m17:37:47.952605 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:37:48.063614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BEE7E720>]}
[0m17:37:48.064620 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:37:48.065620 [info ] [MainThread]: 
[0m17:37:48.071261 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:37:48.072264 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:37:48.073267 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:37:48.074268 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:37:48.080786 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:37:48.081786 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:37:48.110476 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:37:48.112486 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:37:48.113483 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:37:48.114477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:37:48.908669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m17:37:48.929731 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:37:49.044545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BD6D20C0>]}
[0m17:37:49.045549 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m17:37:49.046547 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:37:49.047545 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:37:49.048599 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:37:49.049597 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:37:49.050597 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:37:49.054600 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:37:49.055600 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:37:49.079665 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:37:49.081662 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:37:49.082663 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        "price",
        "discount",
        "selling_proposition",
        "color-count",
        "blackfridaybelts-content" 
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:37:49.083664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:37:49.704562 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6261-0000-fcec-0001-4c5e000c60de
[0m17:37:49.705573 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier '"price"'
[0m17:37:49.705573 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:37:49.816833 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier '"price"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:37:49.817841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46dada38-aba8-442b-b30e-e2ae047ee547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BEEC16D0>]}
[0m17:37:49.817841 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.77s]
[0m17:37:49.819971 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:37:49.821960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:49.821960 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:37:49.822963 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:37:49.822963 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:37:49.823964 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:37:49.823964 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:37:49.824964 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:37:49.824964 [info ] [MainThread]: 
[0m17:37:49.825964 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m17:37:49.827475 [debug] [MainThread]: Command end result
[0m17:37:49.858092 [info ] [MainThread]: 
[0m17:37:49.859115 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:49.860106 [info ] [MainThread]: 
[0m17:37:49.861100 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier '"price"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:37:49.862386 [info ] [MainThread]: 
[0m17:37:49.863403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:37:49.865401 [debug] [MainThread]: Command `dbt run` failed at 17:37:49.864396 after 5.91 seconds
[0m17:37:49.865401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BD712420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BF190860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187BEE00C50>]}
[0m17:37:49.866395 [debug] [MainThread]: Flushing usage events
[0m17:38:55.950604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099A07B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099A052120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099A052870>]}


============================== 17:38:55.955482 | b76ead99-68a0-4dae-95de-2b5f96549cb4 ==============================
[0m17:38:55.955482 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:38:55.956848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:57.013195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B28D8860>]}
[0m17:38:57.063735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B2670350>]}
[0m17:38:57.065735 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:57.394334 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:38:57.568325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:57.568325 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:38:57.753392 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:38:57.754348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B46D3C50>]}
[0m17:38:57.884379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B45C3BC0>]}
[0m17:38:57.974051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B45A6720>]}
[0m17:38:57.975051 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:38:57.976048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B33E9970>]}
[0m17:38:57.978058 [info ] [MainThread]: 
[0m17:38:57.979048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:57.983045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:38:57.996061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:38:57.997049 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:38:57.999049 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:38:58.000048 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:38:58.000048 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:38:58.001047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:58.001047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:59.043276 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.042 seconds
[0m17:38:59.045271 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:38:59.273531 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.273 seconds
[0m17:38:59.275047 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:38:59.390048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:38:59.393055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:38:59.401045 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:38:59.403037 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:38:59.404058 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:38:59.404058 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:38:59.405045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:59.406034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:00.180020 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.774 seconds
[0m17:39:00.182024 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:39:00.391399 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.986 seconds
[0m17:39:00.393403 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:39:00.514749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B471CD40>]}
[0m17:39:00.515641 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:39:00.516640 [info ] [MainThread]: 
[0m17:39:00.522522 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:39:00.523527 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:39:00.524517 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:39:00.525518 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:39:00.532521 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:39:00.533521 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:39:00.559532 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:39:00.561520 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:39:00.562527 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:39:00.562527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:01.284064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m17:39:01.305339 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:39:01.422803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B3092150>]}
[0m17:39:01.423803 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.90s]
[0m17:39:01.424803 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:39:01.425804 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:39:01.426803 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:39:01.428799 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:39:01.428799 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:39:01.431803 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:39:01.432803 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:39:01.452799 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:39:01.453803 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:39:01.454787 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        PRICE,
        DISCOUNT,
        SELLING_PROPOSITION,
        "COLOR-COUNT",
        "BLACKFRIDAYBELTS-CONTENT"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:39:01.455803 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:39:02.114781 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6263-0000-fc81-0001-4c5e000b63da
[0m17:39:02.114781 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier '"COLOR-COUNT"'
[0m17:39:02.115788 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:39:02.231038 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier '"COLOR-COUNT"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:39:02.231038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76ead99-68a0-4dae-95de-2b5f96549cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B4CB8830>]}
[0m17:39:02.232559 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.80s]
[0m17:39:02.233576 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:39:02.236582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:02.236582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:39:02.237581 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:39:02.237581 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:39:02.237581 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:39:02.238576 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:39:02.238576 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:39:02.239576 [info ] [MainThread]: 
[0m17:39:02.240581 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m17:39:02.241581 [debug] [MainThread]: Command end result
[0m17:39:02.272578 [info ] [MainThread]: 
[0m17:39:02.273238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:39:02.274367 [info ] [MainThread]: 
[0m17:39:02.275392 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier '"COLOR-COUNT"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m17:39:02.276381 [info ] [MainThread]: 
[0m17:39:02.277391 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:39:02.279406 [debug] [MainThread]: Command `dbt run` failed at 17:39:02.278395 after 6.44 seconds
[0m17:39:02.279406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B45A5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B282CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020999FE6E10>]}
[0m17:39:02.280385 [debug] [MainThread]: Flushing usage events
[0m17:39:26.175651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CFE59F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C9F20E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CFE5B590>]}


============================== 17:39:26.180645 | e9fdcebb-c0f0-438a-86b0-53d1ccac4818 ==============================
[0m17:39:26.180645 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:39:26.181647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:39:27.173142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CFBB3230>]}
[0m17:39:27.218150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7E81962A0>]}
[0m17:39:27.219154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:39:27.536757 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:39:27.700296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:27.701294 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:39:27.871878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:39:27.873879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA3303E0>]}
[0m17:39:27.998750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA4C8B90>]}
[0m17:39:28.090376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7E9172B10>]}
[0m17:39:28.091377 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:39:28.092379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA48BEC0>]}
[0m17:39:28.094388 [info ] [MainThread]: 
[0m17:39:28.094916 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:28.098946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:39:28.099947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:39:28.113932 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:39:28.116936 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:39:28.117931 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:39:28.117931 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:39:28.118945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:28.118945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:29.042979 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.923 seconds
[0m17:39:29.044982 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:39:29.048892 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.930 seconds
[0m17:39:29.050901 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:39:29.170838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:39:29.173854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:39:29.180845 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:39:29.183852 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:39:29.184836 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:39:29.184836 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:39:29.185834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:29.185834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:29.813436 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.627 seconds
[0m17:39:29.815429 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:39:29.953051 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.768 seconds
[0m17:39:29.955067 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:39:30.068344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA3713A0>]}
[0m17:39:30.068344 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:39:30.069376 [info ] [MainThread]: 
[0m17:39:30.075361 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:39:30.076362 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:39:30.077360 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:39:30.078361 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:39:30.085377 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:39:30.086372 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:39:30.111376 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:39:30.113377 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:39:30.114371 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:39:30.114371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:30.804724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m17:39:30.825727 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:39:30.940799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7E8E62240>]}
[0m17:39:30.940799 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m17:39:30.942802 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:39:30.943795 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:39:30.944795 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:39:30.945799 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:39:30.945799 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:39:30.948799 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:39:30.949799 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:39:30.969799 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:39:30.971791 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:39:30.972785 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(RANK_SUB, 'In ') as rank_sub,
        PRICE,
        DISCOUNT,
        SELLING_PROPOSITION,
        COLOR_COUNT,
        BLACKFRIDAYBELTS_CONTENT
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:39:30.973793 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:39:32.805695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.833 seconds
[0m17:39:32.807689 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:39:32.919974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9fdcebb-c0f0-438a-86b0-53d1ccac4818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA8A3A70>]}
[0m17:39:32.919974 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.97s]
[0m17:39:32.921975 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:39:32.923975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:32.924974 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:39:32.924974 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:39:32.925964 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:39:32.925964 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:39:32.925964 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:39:32.926964 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:39:32.926964 [info ] [MainThread]: 
[0m17:39:32.927973 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m17:39:32.928975 [debug] [MainThread]: Command end result
[0m17:39:32.959974 [info ] [MainThread]: 
[0m17:39:32.960970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:32.961975 [info ] [MainThread]: 
[0m17:39:32.961975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:39:32.963974 [debug] [MainThread]: Command `dbt run` succeeded at 17:39:32.963974 after 6.89 seconds
[0m17:39:32.963974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7C9F20E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CC4B7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7CFBB2BD0>]}
[0m17:39:32.964974 [debug] [MainThread]: Flushing usage events
[0m17:42:09.367131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3744EDFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E376996E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E376994770>]}


============================== 17:42:09.372149 | 95e1e0b8-a125-4dfe-a114-771a0268a292 ==============================
[0m17:42:09.372149 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:42:09.374150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:42:10.369242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37F88C380>]}
[0m17:42:10.415585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37624B4A0>]}
[0m17:42:10.417092 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:42:10.761608 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:42:10.929252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:10.930247 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m17:42:11.141979 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:42:11.142968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311717C20>]}
[0m17:42:11.272078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31173BA10>]}
[0m17:42:11.359757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31046BC50>]}
[0m17:42:11.360750 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m17:42:11.361739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3102B9DF0>]}
[0m17:42:11.362751 [info ] [MainThread]: 
[0m17:42:11.364050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:11.368625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:42:11.373625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m17:42:11.381676 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:42:11.384698 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m17:42:11.385693 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:42:11.385693 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m17:42:11.387208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:11.387208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:12.320149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m17:42:12.322148 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:42:12.328211 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.941 seconds
[0m17:42:12.330211 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m17:42:12.444740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m17:42:12.447273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m17:42:12.455290 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m17:42:12.457827 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m17:42:12.457827 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m17:42:12.458829 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m17:42:12.459828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:12.459828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:13.086040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.626 seconds
[0m17:42:13.087551 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m17:42:13.088568 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.629 seconds
[0m17:42:13.091761 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m17:42:13.314476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311725B80>]}
[0m17:42:13.314476 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:42:13.315479 [info ] [MainThread]: 
[0m17:42:13.320528 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m17:42:13.321539 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m17:42:13.322538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m17:42:13.323531 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m17:42:13.330052 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m17:42:13.331065 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m17:42:13.358612 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m17:42:13.360622 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m17:42:13.361620 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m17:42:13.362622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:14.054264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m17:42:14.075345 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m17:42:14.192674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E310111D30>]}
[0m17:42:14.193681 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m17:42:14.195668 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m17:42:14.195668 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m17:42:14.197191 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m17:42:14.198199 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m17:42:14.199211 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m17:42:14.202210 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m17:42:14.203202 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m17:42:14.223314 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m17:42:14.225282 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m17:42:14.225282 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        PRICE,
        DISCOUNT,
        SELLING_PROPOSITION,
        COLOR_COUNT,
        BLACKFRIDAYBELTS_CONTENT
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m17:42:14.226295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:42:15.997790 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.771 seconds
[0m17:42:15.999808 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m17:42:16.109772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e1e0b8-a125-4dfe-a114-771a0268a292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311C5C4A0>]}
[0m17:42:16.110772 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.91s]
[0m17:42:16.112345 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m17:42:16.114364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:16.114364 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:42:16.115365 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m17:42:16.115365 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m17:42:16.115365 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m17:42:16.116364 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m17:42:16.116364 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m17:42:16.117368 [info ] [MainThread]: 
[0m17:42:16.117368 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m17:42:16.118868 [debug] [MainThread]: Command end result
[0m17:42:16.149491 [info ] [MainThread]: 
[0m17:42:16.151490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:16.151490 [info ] [MainThread]: 
[0m17:42:16.152490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:42:16.154481 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:16.153487 after 6.94 seconds
[0m17:42:16.155490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3117431A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311742E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3117421B0>]}
[0m17:42:16.155490 [debug] [MainThread]: Flushing usage events
[0m18:01:04.580939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D4D1D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D72C23C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D72C1D30>]}


============================== 18:01:04.585431 | 1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999 ==============================
[0m18:01:04.585431 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:01:04.586581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:05.654493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F08797F0>]}
[0m18:01:05.698487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F09F34A0>]}
[0m18:01:05.700436 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:06.004235 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:01:06.179456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:06.180460 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m18:01:06.351099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:01:06.353094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F1EC4170>]}
[0m18:01:06.479166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F1EE2000>]}
[0m18:01:06.574048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F0CEA270>]}
[0m18:01:06.575046 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m18:01:06.576053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F1DA5E20>]}
[0m18:01:06.578047 [info ] [MainThread]: 
[0m18:01:06.579041 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:06.583129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m18:01:06.594146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m18:01:06.597152 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m18:01:06.599157 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m18:01:06.600143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m18:01:06.601159 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m18:01:06.601159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:06.602150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:07.578139 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.976 seconds
[0m18:01:07.580144 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m18:01:07.601034 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.000 seconds
[0m18:01:07.602040 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m18:01:07.726417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m18:01:07.728425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m18:01:07.736422 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m18:01:07.739425 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m18:01:07.739425 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m18:01:07.740431 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m18:01:07.740431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:07.741431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:08.593278 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.853 seconds
[0m18:01:08.595296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.853 seconds
[0m18:01:08.597301 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m18:01:08.599301 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m18:01:08.726776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F1EC59A0>]}
[0m18:01:08.727782 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:01:08.728769 [info ] [MainThread]: 
[0m18:01:08.734577 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m18:01:08.735573 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m18:01:08.736571 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m18:01:08.736571 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m18:01:08.743577 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m18:01:08.745572 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m18:01:08.771583 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m18:01:08.774571 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m18:01:08.775580 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m18:01:08.775580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:09.782466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m18:01:09.804473 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m18:01:09.919685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F09B23C0>]}
[0m18:01:09.920692 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.18s]
[0m18:01:09.921674 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m18:01:09.923033 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m18:01:09.924053 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m18:01:09.925063 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m18:01:09.925063 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m18:01:09.928059 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m18:01:09.930064 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m18:01:09.949049 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m18:01:09.951048 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m18:01:09.952077 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        PRICE,
        DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        BLACKFRIDAYBELTS_CONTENT
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m18:01:09.953050 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:12.697461 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.745 seconds
[0m18:01:12.700479 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m18:01:12.825917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0fcfdb-5bb1-418c-913d-3f9d4a1ec999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F253EC00>]}
[0m18:01:12.826917 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.90s]
[0m18:01:12.828914 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m18:01:12.830919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:12.830919 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m18:01:12.831919 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m18:01:12.831919 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m18:01:12.832920 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m18:01:12.832920 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m18:01:12.832920 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m18:01:12.833927 [info ] [MainThread]: 
[0m18:01:12.834590 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m18:01:12.836127 [debug] [MainThread]: Command end result
[0m18:01:12.865131 [info ] [MainThread]: 
[0m18:01:12.867125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:12.867125 [info ] [MainThread]: 
[0m18:01:12.869127 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:01:12.870131 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:12.870131 after 8.40 seconds
[0m18:01:12.871133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D4D1D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274F0A448C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D66617C0>]}
[0m18:01:12.871133 [debug] [MainThread]: Flushing usage events
[0m18:01:54.060239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B917AF45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B917AF4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B917AF4500>]}


============================== 18:01:54.065236 | fd09629f-848b-47a7-9966-111255d7fd7e ==============================
[0m18:01:54.065236 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:01:54.066239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:55.111149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93073D490>]}
[0m18:01:55.158715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9319AAC90>]}
[0m18:01:55.159704 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:55.482314 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:01:55.646878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:55.647878 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m18:01:55.831864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:01:55.832867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B932EE0680>]}
[0m18:01:55.996865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B932FD3F20>]}
[0m18:01:56.095500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B931D08E30>]}
[0m18:01:56.096501 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m18:01:56.097502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93105C830>]}
[0m18:01:56.099502 [info ] [MainThread]: 
[0m18:01:56.100085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:56.104097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m18:01:56.117100 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m18:01:56.118113 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m18:01:56.118113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m18:01:56.119113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:56.121114 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m18:01:56.124118 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m18:01:56.125116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:57.268041 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.149 seconds
[0m18:01:57.269978 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m18:01:57.287969 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.162 seconds
[0m18:01:57.289961 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m18:01:57.402565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m18:01:57.403565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m18:01:57.413078 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m18:01:57.416081 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m18:01:57.416081 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m18:01:57.417081 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m18:01:57.418081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:57.418081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:58.250490 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.833 seconds
[0m18:01:58.252487 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m18:01:58.309332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m18:01:58.311344 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m18:01:58.446683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B931A949B0>]}
[0m18:01:58.447684 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:01:58.448690 [info ] [MainThread]: 
[0m18:01:58.454112 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m18:01:58.455115 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m18:01:58.456113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m18:01:58.457113 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m18:01:58.463118 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m18:01:58.465117 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m18:01:58.491123 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m18:01:58.493113 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m18:01:58.494115 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m18:01:58.495130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:59.495753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m18:01:59.517773 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m18:01:59.643423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9319D1FD0>]}
[0m18:01:59.644423 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.19s]
[0m18:01:59.645422 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m18:01:59.646425 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m18:01:59.648426 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m18:01:59.649423 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m18:01:59.650423 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m18:01:59.653422 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m18:01:59.655422 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m18:01:59.685423 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m18:01:59.687424 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m18:01:59.688422 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2] AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        PRICE,
        DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling,
        selling_proposition,
        COLOR_COUNT,
        BLACKFRIDAYBELTS_CONTENT
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m18:01:59.689425 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:02:01.239558 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.550 seconds
[0m18:02:01.242568 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m18:02:01.354014 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd09629f-848b-47a7-9966-111255d7fd7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B933472C90>]}
[0m18:02:01.354014 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.71s]
[0m18:02:01.355030 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m18:02:01.358480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:01.358480 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m18:02:01.359476 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m18:02:01.360476 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m18:02:01.360476 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m18:02:01.361475 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m18:02:01.361475 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m18:02:01.362477 [info ] [MainThread]: 
[0m18:02:01.363475 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m18:02:01.364477 [debug] [MainThread]: Command end result
[0m18:02:01.394013 [info ] [MainThread]: 
[0m18:02:01.395023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:01.395023 [info ] [MainThread]: 
[0m18:02:01.396015 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:02:01.398036 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:01.397025 after 7.46 seconds
[0m18:02:01.398036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9332311F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B918671D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B918672390>]}
[0m18:02:01.399035 [debug] [MainThread]: Flushing usage events
[0m21:18:15.769680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F26D88170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F26D664B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F26F33740>]}


============================== 21:18:15.780534 | f99599e7-2d3f-4b6a-8809-f0712fc2105d ==============================
[0m21:18:15.780534 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:18:15.781518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:21.878349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F27CBD0A0>]}
[0m21:18:21.925881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F407E4BC0>]}
[0m21:18:21.927881 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:22.370285 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:18:24.064221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:24.065223 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m21:18:24.241347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:18:24.243354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F41D23AD0>]}
[0m21:18:24.372358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F41C4F380>]}
[0m21:18:24.496137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F40A33C80>]}
[0m21:18:24.496137 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m21:18:24.497136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F40A5BB00>]}
[0m21:18:24.499145 [info ] [MainThread]: 
[0m21:18:24.500146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:24.503962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:18:24.517987 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:18:24.517987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:18:24.519132 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:18:24.520993 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:18:24.521987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:24.522977 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:18:24.526211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:25.643649 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.118 seconds
[0m21:18:25.645391 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:18:25.970698 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.448 seconds
[0m21:18:25.972697 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:18:26.086564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:18:26.089558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:18:26.096557 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:18:26.099557 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:18:26.100552 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:18:26.101552 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:18:26.101552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:26.102557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:26.890260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.788 seconds
[0m21:18:26.892265 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:18:26.923183 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.820 seconds
[0m21:18:26.925174 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:18:27.042948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F41C4F830>]}
[0m21:18:27.043950 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:18:27.043950 [info ] [MainThread]: 
[0m21:18:27.054889 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:18:27.055900 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:18:27.056889 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:18:27.057892 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:18:27.064901 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:18:27.066910 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:18:27.097933 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:18:27.101904 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:18:27.102892 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:18:27.102892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:18:27.840515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m21:18:27.861512 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:18:27.971047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F40722240>]}
[0m21:18:27.972053 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m21:18:27.974043 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:18:27.975053 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:18:27.976039 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:18:27.977042 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:18:27.978042 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:18:27.981038 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:18:27.982041 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:18:28.002042 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:18:28.004041 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:18:28.005040 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        LTRIM(PRICE, '$')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m21:18:28.006048 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:18:31.238624 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba633e-0000-fcd1-0001-4c5e000c913e
[0m21:18:31.239435 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value '1,430.99' is not recognized
[0m21:18:31.240434 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:18:31.374868 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  100038 (22018): Numeric value '1,430.99' is not recognized
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m21:18:31.375872 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99599e7-2d3f-4b6a-8809-f0712fc2105d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F42149460>]}
[0m21:18:31.376873 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 3.40s]
[0m21:18:31.377864 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:18:31.379724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:31.380740 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:18:31.380740 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:18:31.381739 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:18:31.381739 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:18:31.382741 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:18:31.382741 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:18:31.382741 [info ] [MainThread]: 
[0m21:18:31.384007 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m21:18:31.385022 [debug] [MainThread]: Command end result
[0m21:18:31.416035 [info ] [MainThread]: 
[0m21:18:31.417035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:18:31.418036 [info ] [MainThread]: 
[0m21:18:31.419023 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  100038 (22018): Numeric value '1,430.99' is not recognized
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m21:18:31.420020 [info ] [MainThread]: 
[0m21:18:31.420020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:18:31.422031 [debug] [MainThread]: Command `dbt run` failed at 21:18:31.422031 after 15.79 seconds
[0m21:18:31.423022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F41ED3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F41C4F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F40A588C0>]}
[0m21:18:31.423022 [debug] [MainThread]: Flushing usage events
[0m21:20:06.322417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE87B8ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE89D95F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE89D97920>]}


============================== 21:20:06.327417 | 1d161b9c-99e3-4f86-96c0-c56a45e51bc7 ==============================
[0m21:20:06.327417 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:20:06.328418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:07.317468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA2318890>]}
[0m21:20:07.360468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA244DF10>]}
[0m21:20:07.362471 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:20:07.668056 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:20:07.831431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:20:07.831431 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m21:20:08.005473 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:20:08.006874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA4A5BF20>]}
[0m21:20:08.131905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA372B980>]}
[0m21:20:08.222669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA38B8950>]}
[0m21:20:08.222669 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m21:20:08.223672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA4B843E0>]}
[0m21:20:08.225670 [info ] [MainThread]: 
[0m21:20:08.226669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:20:08.230668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:20:08.235684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:20:08.243686 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:20:08.246680 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:20:08.247684 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:20:08.248688 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:20:08.248688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:08.249673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:09.419631 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.171 seconds
[0m21:20:09.421640 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:20:09.493539 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.244 seconds
[0m21:20:09.495528 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:20:09.616543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:20:09.618541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:20:09.626546 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:20:09.628546 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:20:09.629712 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:20:09.630542 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:20:09.631065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:09.631065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:10.411282 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.780 seconds
[0m21:20:10.413283 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:20:10.519274 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m21:20:10.521290 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:20:10.643461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA4C53E30>]}
[0m21:20:10.644466 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:20:10.645472 [info ] [MainThread]: 
[0m21:20:10.651051 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:20:10.651051 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:20:10.652054 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:20:10.653056 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:20:10.659556 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:20:10.661566 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:20:10.688579 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:20:10.690580 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:20:10.691575 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:20:10.691575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:11.582760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m21:20:11.603762 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:20:11.722044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA3582120>]}
[0m21:20:11.723045 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.07s]
[0m21:20:11.723866 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:20:11.724901 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:20:11.725895 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:20:11.726900 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:20:11.727894 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:20:11.730900 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:20:11.731884 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:20:11.751893 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:20:11.754899 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:20:11.754899 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m21:20:11.755883 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:20:15.852139 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.097 seconds
[0m21:20:15.856141 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:20:15.986082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d161b9c-99e3-4f86-96c0-c56a45e51bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA50FBDA0>]}
[0m21:20:15.987095 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.26s]
[0m21:20:15.988075 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:20:15.989861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:15.989861 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:20:15.990869 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:20:15.990869 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:20:15.991867 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:20:15.991867 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:20:15.991867 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:20:15.992868 [info ] [MainThread]: 
[0m21:20:15.992868 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m21:20:15.994859 [debug] [MainThread]: Command end result
[0m21:20:16.023858 [info ] [MainThread]: 
[0m21:20:16.024867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:16.024867 [info ] [MainThread]: 
[0m21:20:16.025867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:20:16.027871 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:16.027871 after 9.80 seconds
[0m21:20:16.027871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8A6F3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE89E2D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEA4BAF0E0>]}
[0m21:20:16.028868 [debug] [MainThread]: Flushing usage events
[0m21:26:58.638689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DA5E0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DAD2E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DAE37950>]}


============================== 21:26:58.643689 | af0cd98b-13aa-44e3-843c-8f33e494cdc8 ==============================
[0m21:26:58.643689 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:26:58.644690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:59.704780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F32150A0>]}
[0m21:26:59.750089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F3D550A0>]}
[0m21:26:59.752084 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:27:00.073927 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:27:00.244137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:00.244137 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m21:27:00.420284 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:27:00.421714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F522B2F0>]}
[0m21:27:00.546537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F520B440>]}
[0m21:27:00.638475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F40B55B0>]}
[0m21:27:00.639479 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m21:27:00.640489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F52D5A90>]}
[0m21:27:00.642478 [info ] [MainThread]: 
[0m21:27:00.643478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:27:00.646997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:27:00.658529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:27:00.660540 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:27:00.663543 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:27:00.663543 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:27:00.664532 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:27:00.665529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:00.666042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:01.650493 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.984 seconds
[0m21:27:01.651493 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:27:01.658253 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.993 seconds
[0m21:27:01.660258 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:27:01.774680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:27:01.777239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:27:01.784233 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:27:01.787791 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:27:01.788787 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:27:01.788787 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:27:01.789790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:01.789790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:02.451870 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.662 seconds
[0m21:27:02.452887 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.663 seconds
[0m21:27:02.453886 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:27:02.456410 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:27:02.572446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F5228470>]}
[0m21:27:02.573461 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:27:02.574447 [info ] [MainThread]: 
[0m21:27:02.579757 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:27:02.580755 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:27:02.581744 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:27:02.582749 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:27:02.589297 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:27:02.590298 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:27:02.616407 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:27:02.618418 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:27:02.619424 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:27:02.619424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:03.284528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m21:27:03.304229 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:27:03.418561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F3CE2300>]}
[0m21:27:03.419565 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m21:27:03.421575 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:27:03.422560 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:27:03.423571 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:27:03.424365 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:27:03.425889 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:27:03.427912 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:27:03.429914 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:27:03.448983 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:27:03.450972 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:27:03.451983 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(column_name, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m21:27:03.452973 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:04.335160 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6347-0000-fcd3-0001-4c5e000cc12e
[0m21:27:04.336166 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 23
invalid identifier 'COLUMN_NAME'
[0m21:27:04.336674 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:27:04.459879 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'COLUMN_NAME'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m21:27:04.460877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0cd98b-13aa-44e3-843c-8f33e494cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140F3528830>]}
[0m21:27:04.461873 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.04s]
[0m21:27:04.462864 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:27:04.465968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:04.466923 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:27:04.466923 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:27:04.467942 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:27:04.467942 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:27:04.467942 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:27:04.468939 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:27:04.468939 [info ] [MainThread]: 
[0m21:27:04.469940 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m21:27:04.471941 [debug] [MainThread]: Command end result
[0m21:27:04.502354 [info ] [MainThread]: 
[0m21:27:04.503359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:27:04.504349 [info ] [MainThread]: 
[0m21:27:04.504349 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 23
  invalid identifier 'COLUMN_NAME'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m21:27:04.505867 [info ] [MainThread]: 
[0m21:27:04.506876 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:27:04.508885 [debug] [MainThread]: Command `dbt run` failed at 21:27:04.508885 after 5.98 seconds
[0m21:27:04.509883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DACF1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140D99B18B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DA5E0170>]}
[0m21:27:04.509883 [debug] [MainThread]: Flushing usage events
[0m21:27:19.147069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD57B579E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD57B57EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD57B57DA0>]}


============================== 21:27:19.151440 | 82da2839-1b6f-4430-a0e5-e9553b69cadb ==============================
[0m21:27:19.151440 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:27:19.153440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:27:20.140728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD57BA3F80>]}
[0m21:27:20.185724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD56F2BDA0>]}
[0m21:27:20.187467 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:27:20.496059 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:27:20.660849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:20.661848 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m21:27:20.830420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:27:20.831504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD70A89100>]}
[0m21:27:20.955441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7201B620>]}
[0m21:27:21.053070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD55676690>]}
[0m21:27:21.053070 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m21:27:21.054065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD70DCCD40>]}
[0m21:27:21.056067 [info ] [MainThread]: 
[0m21:27:21.057066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:27:21.061150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:27:21.072167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:27:21.074166 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:27:21.077162 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:27:21.077162 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:27:21.078166 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:27:21.078166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:21.079168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:21.989817 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.911 seconds
[0m21:27:21.991817 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:27:22.033897 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.954 seconds
[0m21:27:22.035901 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:27:22.163424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:27:22.165424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:27:22.173421 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:27:22.176424 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:27:22.177437 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:27:22.177437 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:27:22.178425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:22.178425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:22.892774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.714 seconds
[0m21:27:22.894778 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:27:23.043031 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.865 seconds
[0m21:27:23.045033 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:27:23.165260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD70A2E6C0>]}
[0m21:27:23.166129 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:27:23.167123 [info ] [MainThread]: 
[0m21:27:23.172999 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:27:23.174000 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:27:23.175012 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:27:23.176011 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:27:23.182998 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:27:23.184006 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:27:23.209036 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:27:23.211035 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:27:23.211035 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:27:23.212045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:24.057525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m21:27:24.078531 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:27:24.193207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD709DE210>]}
[0m21:27:24.194207 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.02s]
[0m21:27:24.196207 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:27:24.197207 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:27:24.198202 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:27:24.199202 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:27:24.199202 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:27:24.202217 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:27:24.203222 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:27:24.222758 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:27:24.224745 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:27:24.225754 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    )


SELECT 
    DISTINCT * 
FROM clean_cols
        );
[0m21:27:24.225754 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:28.671060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.445 seconds
[0m21:27:28.674062 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:27:28.785965 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82da2839-1b6f-4430-a0e5-e9553b69cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7254CBC0>]}
[0m21:27:28.786965 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.59s]
[0m21:27:28.787953 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:27:28.789952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:28.790965 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:27:28.790965 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:27:28.791960 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:27:28.791960 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:27:28.791960 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:27:28.792951 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:27:28.792951 [info ] [MainThread]: 
[0m21:27:28.793966 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m21:27:28.795962 [debug] [MainThread]: Command end result
[0m21:27:28.824956 [info ] [MainThread]: 
[0m21:27:28.825952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:28.826953 [info ] [MainThread]: 
[0m21:27:28.827962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:27:28.828960 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:28.828960 after 9.78 seconds
[0m21:27:28.829957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD70D4B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD72010C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD71EEA9F0>]}
[0m21:27:28.830951 [debug] [MainThread]: Flushing usage events
[0m22:37:12.911581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F38B52EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F38DBBED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3880990D0>]}


============================== 22:37:12.916255 | 5965483d-42b7-4c47-88ea-9eebb0f1e72b ==============================
[0m22:37:12.916255 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:37:12.918298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:37:13.898827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A63B1CD0>]}
[0m22:37:13.942363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A6540710>]}
[0m22:37:13.944348 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:37:14.243698 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:37:14.437217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:14.438217 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:37:14.611772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:37:14.613771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A856FC20>]}
[0m22:37:14.741337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A85861B0>]}
[0m22:37:14.834410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A7288950>]}
[0m22:37:14.834410 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:37:14.835411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A86FC320>]}
[0m22:37:14.837423 [info ] [MainThread]: 
[0m22:37:14.838410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:37:14.842415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:37:14.854924 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:37:14.855930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:37:14.856935 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:37:14.858938 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:37:14.860481 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:37:14.859935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:14.860481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:16.257329 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.396 seconds
[0m22:37:16.258322 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:37:16.262315 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.403 seconds
[0m22:37:16.264316 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:37:16.384254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:37:16.386252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:37:16.393249 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:37:16.395255 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:37:16.396289 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:37:16.397259 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:37:16.397259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:16.398250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:17.292206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.894 seconds
[0m22:37:17.294728 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:37:17.319059 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.921 seconds
[0m22:37:17.320050 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:37:17.435303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8741070>]}
[0m22:37:17.436309 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:37:17.437308 [info ] [MainThread]: 
[0m22:37:17.443293 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:37:17.444292 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:37:17.445292 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:37:17.446294 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:37:17.452292 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:37:17.453292 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:37:17.478817 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:37:17.480808 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:37:17.481810 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:37:17.481810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:37:18.363333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.881 seconds
[0m22:37:18.384332 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:37:18.500664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A890F530>]}
[0m22:37:18.501671 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.05s]
[0m22:37:18.503664 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:37:18.504674 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:37:18.505673 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:37:18.506674 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:37:18.507674 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:37:18.509674 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:37:18.511678 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:37:18.531665 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:37:18.534676 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:37:18.535677 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE(PRICE($), AVG(price) OVER(PARTITION BY category)) AS price,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:37:18.535677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:37:19.127099 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba638d-0000-fcd3-0001-4c5e000cc192
[0m22:37:19.127099 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 23 unexpected '$'.
syntax error line 27 at position 22 unexpected '('.
syntax error line 27 at position 23 unexpected '$'.
syntax error line 27 at position 25 unexpected ','.
[0m22:37:19.128107 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:37:19.253029 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 23 unexpected '$'.
  syntax error line 27 at position 22 unexpected '('.
  syntax error line 27 at position 23 unexpected '$'.
  syntax error line 27 at position 25 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:37:19.254028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5965483d-42b7-4c47-88ea-9eebb0f1e72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8A8C920>]}
[0m22:37:19.255029 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.75s]
[0m22:37:19.256014 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:37:19.258013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:19.259024 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:37:19.260031 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:37:19.260031 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:37:19.260031 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:37:19.261025 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:37:19.261025 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:37:19.262025 [info ] [MainThread]: 
[0m22:37:19.263013 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m22:37:19.264015 [debug] [MainThread]: Command end result
[0m22:37:19.293022 [info ] [MainThread]: 
[0m22:37:19.294020 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:37:19.294020 [info ] [MainThread]: 
[0m22:37:19.295525 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 23 unexpected '$'.
  syntax error line 27 at position 22 unexpected '('.
  syntax error line 27 at position 23 unexpected '$'.
  syntax error line 27 at position 25 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:37:19.296536 [info ] [MainThread]: 
[0m22:37:19.297542 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:37:19.299534 [debug] [MainThread]: Command `dbt run` failed at 22:37:19.299534 after 6.53 seconds
[0m22:37:19.300532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3880990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F38D7308C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F38D7306B0>]}
[0m22:37:19.300532 [debug] [MainThread]: Flushing usage events
[0m22:38:00.924416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017270A2E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172732DE4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172722A2480>]}


============================== 22:38:00.928416 | 95880573-ee27-4bc2-84c1-f822c6f9bf05 ==============================
[0m22:38:00.928416 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:38:00.929421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:01.944607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C371C10>]}
[0m22:38:01.988134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727FE6E3F0>]}
[0m22:38:01.989882 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:38:02.303468 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:38:02.468407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:38:02.468407 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:38:02.641946 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:38:02.642953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727F141490>]}
[0m22:38:02.771077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C5E85F0>]}
[0m22:38:02.865347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C779400>]}
[0m22:38:02.866354 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:38:02.867345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017273590710>]}
[0m22:38:02.868352 [info ] [MainThread]: 
[0m22:38:02.869346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:02.873863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:38:02.886886 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:38:02.887887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:38:02.887887 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:38:02.890875 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:38:02.890875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:02.891883 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:38:02.894885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:03.725518 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.834 seconds
[0m22:38:03.726522 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:38:03.785747 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.891 seconds
[0m22:38:03.787747 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:38:03.906662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:38:03.908667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:38:03.916667 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:38:03.918667 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:38:03.919667 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:38:03.920667 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:38:03.920667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:03.921667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:04.747971 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.827 seconds
[0m22:38:04.749973 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:38:04.788319 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.867 seconds
[0m22:38:04.790319 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:38:04.915282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C74D310>]}
[0m22:38:04.916287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:38:04.916287 [info ] [MainThread]: 
[0m22:38:04.922468 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:38:04.923468 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:38:04.924469 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:38:04.924469 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:38:04.931470 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:38:04.932477 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:38:04.959488 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:38:04.961984 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:38:04.961984 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:38:04.962990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:05.657782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m22:38:05.678818 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:38:05.790408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C43E360>]}
[0m22:38:05.791416 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m22:38:05.792400 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:38:05.793777 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:38:05.794795 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:38:05.795804 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:38:05.795804 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:38:05.798808 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:38:05.799959 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:38:05.819804 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:38:05.822800 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:38:05.823794 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG(price) OVER(PARTITION BY category)) AS price,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:38:05.823794 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:38:06.626012 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba638e-0000-fcd3-0001-4c5e000cc196
[0m22:38:06.627024 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 8
invalid identifier 'GOODS_TITLE_LINK_JUMP'
[0m22:38:06.627024 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:38:06.760507 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'GOODS_TITLE_LINK_JUMP'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:38:06.761505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95880573-ee27-4bc2-84c1-f822c6f9bf05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720DFEAED0>]}
[0m22:38:06.762509 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.97s]
[0m22:38:06.763492 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:38:06.765489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:06.766504 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:38:06.766504 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:38:06.767501 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:38:06.767501 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:38:06.768506 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:38:06.768506 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:38:06.768506 [info ] [MainThread]: 
[0m22:38:06.769507 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m22:38:06.770499 [debug] [MainThread]: Command end result
[0m22:38:06.802865 [info ] [MainThread]: 
[0m22:38:06.803866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:06.804869 [info ] [MainThread]: 
[0m22:38:06.805868 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'GOODS_TITLE_LINK_JUMP'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:38:06.806865 [info ] [MainThread]: 
[0m22:38:06.806865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:38:06.809111 [debug] [MainThread]: Command `dbt run` failed at 22:38:06.809111 after 5.98 seconds
[0m22:38:06.809111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017273482F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727FDECA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720C47E810>]}
[0m22:38:06.810109 [debug] [MainThread]: Flushing usage events
[0m22:39:05.190569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB648B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB62A07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB613ED20>]}


============================== 22:39:05.194563 | a2e6ba72-bd7f-4386-9093-4894ed23726e ==============================
[0m22:39:05.194563 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:39:05.195572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:39:06.156890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCEAD0AA0>]}
[0m22:39:06.201826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCE1C5F10>]}
[0m22:39:06.202820 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:39:06.510399 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:39:06.668560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:39:06.668560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:39:06.697577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB62510A0>]}
[0m22:39:06.790717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF668290>]}
[0m22:39:06.791720 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:39:06.792739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF5D46B0>]}
[0m22:39:06.794742 [info ] [MainThread]: 
[0m22:39:06.795729 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:39:06.799728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:39:06.800739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:39:06.814248 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:39:06.817254 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:39:06.817254 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:39:06.818357 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:39:06.818831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:06.819528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:08.111973 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.293 seconds
[0m22:39:08.113962 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:39:08.115978 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.297 seconds
[0m22:39:08.117978 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:39:08.238238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:39:08.239226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:39:08.247238 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:39:08.249240 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:39:08.250239 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:39:08.251240 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:39:08.251240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:08.252234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:08.950648 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.699 seconds
[0m22:39:08.953659 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:39:09.031011 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.779 seconds
[0m22:39:09.033006 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:39:09.148720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD0B28590>]}
[0m22:39:09.149727 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:39:09.149727 [info ] [MainThread]: 
[0m22:39:09.155327 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:39:09.156343 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:39:09.157341 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:39:09.157341 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:39:09.163345 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:39:09.164346 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:39:09.193364 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:39:09.194368 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:39:09.195366 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:39:09.195366 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:10.041273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m22:39:10.062273 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:39:10.183193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF4E20C0>]}
[0m22:39:10.183193 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.02s]
[0m22:39:10.184192 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:39:10.185187 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:39:10.186192 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:39:10.187208 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:39:10.187208 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:39:10.190213 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:39:10.191208 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:39:10.211758 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:39:10.213752 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:39:10.214762 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG(price) OVER(PARTITION BY category)) AS price,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:39:10.215762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:39:11.048847 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba638f-0000-fd0b-0001-4c5e000ce076
[0m22:39:11.048847 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 8
invalid identifier 'GOODS_TITLE_LINK_JUMP'
[0m22:39:11.049997 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:39:11.180624 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'GOODS_TITLE_LINK_JUMP'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:39:11.180624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e6ba72-bd7f-4386-9093-4894ed23726e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD0E078C0>]}
[0m22:39:11.181623 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.99s]
[0m22:39:11.182626 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:39:11.185456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:11.186460 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:39:11.186460 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:39:11.186460 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:39:11.187481 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:39:11.187481 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:39:11.187481 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:39:11.188475 [info ] [MainThread]: 
[0m22:39:11.189471 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m22:39:11.189780 [debug] [MainThread]: Command end result
[0m22:39:11.219307 [info ] [MainThread]: 
[0m22:39:11.220307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:39:11.221310 [info ] [MainThread]: 
[0m22:39:11.222307 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'GOODS_TITLE_LINK_JUMP'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:39:11.224307 [info ] [MainThread]: 
[0m22:39:11.225317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:39:11.226307 [debug] [MainThread]: Command `dbt run` failed at 22:39:11.226307 after 6.13 seconds
[0m22:39:11.227309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6337D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF5A5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF11FFE0>]}
[0m22:39:11.228324 [debug] [MainThread]: Flushing usage events
[0m22:46:00.399680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012D490AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012D490BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012D490800>]}


============================== 22:46:00.404695 | 96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e ==============================
[0m22:46:00.404695 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:46:00.405695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:01.404972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201469FD0A0>]}
[0m22:46:01.448967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012DDD7CB0>]}
[0m22:46:01.450961 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:46:01.768928 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:46:01.933493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:01.934493 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:46:02.111654 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:46:02.114199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201482FFC20>]}
[0m22:46:02.242768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201483079B0>]}
[0m22:46:02.334817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020147019220>]}
[0m22:46:02.335810 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:46:02.335810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146E5C830>]}
[0m22:46:02.337815 [info ] [MainThread]: 
[0m22:46:02.338809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:02.342936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:46:02.348993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:46:02.355993 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:46:02.358993 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:46:02.359517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:46:02.359517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:46:02.360541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:02.360541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:03.723996 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.364 seconds
[0m22:46:03.725997 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:46:03.744997 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.384 seconds
[0m22:46:03.745996 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:46:03.870556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:46:03.872556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:46:03.880555 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:46:03.882561 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:46:03.883561 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:46:03.884561 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:46:03.884561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:03.885548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:04.685670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.801 seconds
[0m22:46:04.687672 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:46:04.695368 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m22:46:04.697359 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:46:04.808479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201483B2DB0>]}
[0m22:46:04.809474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:46:04.810485 [info ] [MainThread]: 
[0m22:46:04.816463 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:46:04.817467 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:46:04.819473 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:46:04.819473 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:46:04.826465 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:46:04.827468 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:46:04.855474 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:46:04.857481 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:46:04.858476 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:46:04.858476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:05.541609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m22:46:05.564611 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:46:05.682696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020146CDE540>]}
[0m22:46:05.682696 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m22:46:05.683988 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:46:05.686021 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:46:05.686021 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:46:05.687057 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:46:05.688087 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:46:05.691086 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:46:05.692086 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:46:05.712090 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:46:05.715091 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:46:05.715091 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:46:05.716090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:06.556264 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6396-0000-fcd3-0001-4c5e000cc1a2
[0m22:46:06.556264 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:46:06.557263 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:46:06.672451 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:46:06.672451 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e79f0f-3c8c-4d47-99bb-c0c3ffdbfa5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002014856D940>]}
[0m22:46:06.673450 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.99s]
[0m22:46:06.674460 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:46:06.677452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:06.678453 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:46:06.678453 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:46:06.678453 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:46:06.679452 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:46:06.679452 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:46:06.680455 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:46:06.680455 [info ] [MainThread]: 
[0m22:46:06.681699 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m22:46:06.682727 [debug] [MainThread]: Command end result
[0m22:46:06.712859 [info ] [MainThread]: 
[0m22:46:06.713729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:46:06.714714 [info ] [MainThread]: 
[0m22:46:06.715723 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:46:06.716714 [info ] [MainThread]: 
[0m22:46:06.717723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:46:06.718729 [debug] [MainThread]: Command `dbt run` failed at 22:46:06.718729 after 6.47 seconds
[0m22:46:06.719712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012DAD5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012CE08AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012DBD5A60>]}
[0m22:46:06.720713 [debug] [MainThread]: Flushing usage events
[0m22:46:53.679528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF851EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF754F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFAB43EC0>]}


============================== 22:46:53.683528 | da477ce3-ba7e-4995-8564-8d3025edd5b7 ==============================
[0m22:46:53.683528 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:46:53.684536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:54.759194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFF778B60>]}
[0m22:46:54.802196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFAC53E60>]}
[0m22:46:54.804181 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:46:55.111328 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:46:55.271401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:55.271401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:55.300399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E940F6750>]}
[0m22:46:55.394119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E941A4C50>]}
[0m22:46:55.394119 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:46:55.395101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E954F37A0>]}
[0m22:46:55.397115 [info ] [MainThread]: 
[0m22:46:55.398105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:55.402632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:46:55.412655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:46:55.416655 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:46:55.419656 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:46:55.420645 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:46:55.420645 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:46:55.421644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:55.422641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:56.269843 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.847 seconds
[0m22:46:56.271778 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:46:56.273779 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.852 seconds
[0m22:46:56.275777 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:46:56.394515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:46:56.395515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:46:56.403040 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:46:56.406057 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:46:56.406057 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:46:56.407062 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:46:56.407062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:56.408050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:57.120765 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m22:46:57.122769 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:46:57.264678 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.857 seconds
[0m22:46:57.266673 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:46:57.376474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E955DD5E0>]}
[0m22:46:57.377246 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:46:57.378238 [info ] [MainThread]: 
[0m22:46:57.383676 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:46:57.384679 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:46:57.385679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:46:57.385679 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:46:57.393207 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:46:57.394204 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:46:57.421713 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:46:57.424713 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:46:57.424713 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:46:57.425717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:58.082982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m22:46:58.104981 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:46:58.218058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E94002240>]}
[0m22:46:58.219065 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.83s]
[0m22:46:58.220048 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:46:58.221543 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:46:58.222569 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:46:58.223573 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:46:58.223573 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:46:58.227560 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:46:58.228564 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:46:58.249561 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:46:58.251569 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:46:58.252569 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:46:58.253569 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:59.025405 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6396-0000-fcd2-0001-4c5e000cb182
[0m22:46:59.026408 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:46:59.026408 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:46:59.145492 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:46:59.146492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da477ce3-ba7e-4995-8564-8d3025edd5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E95874920>]}
[0m22:46:59.147479 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.92s]
[0m22:46:59.148478 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:46:59.151493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:59.151493 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:46:59.152479 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:46:59.152479 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:46:59.152479 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:46:59.153487 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:46:59.153487 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:46:59.154476 [info ] [MainThread]: 
[0m22:46:59.155489 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m22:46:59.156476 [debug] [MainThread]: Command end result
[0m22:46:59.188569 [info ] [MainThread]: 
[0m22:46:59.189552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:46:59.190556 [info ] [MainThread]: 
[0m22:46:59.191556 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:46:59.192556 [info ] [MainThread]: 
[0m22:46:59.193559 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:46:59.194554 [debug] [MainThread]: Command `dbt run` failed at 22:46:59.194554 after 5.61 seconds
[0m22:46:59.195550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFB067EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA65CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA65FEC0>]}
[0m22:46:59.195550 [debug] [MainThread]: Flushing usage events
[0m22:48:06.184869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238B3CEAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238DC1DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238DBC0830>]}


============================== 22:48:06.188863 | 8ce8c72d-a33d-4f39-b33c-eb7e14c45233 ==============================
[0m22:48:06.188863 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:48:06.189871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:48:07.114519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238B92CC50>]}
[0m22:48:07.157519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A6E2ED20>]}
[0m22:48:07.159968 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:48:07.469030 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:48:07.623760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:07.624760 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:48:07.793328 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:48:07.794366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A8327C20>]}
[0m22:48:07.919879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A83550D0>]}
[0m22:48:08.010590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A71486B0>]}
[0m22:48:08.011590 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:48:08.012589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A71CDA00>]}
[0m22:48:08.013590 [info ] [MainThread]: 
[0m22:48:08.014590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:48:08.018589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:48:08.033587 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:48:08.034597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:48:08.035582 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:48:08.039589 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:48:08.040584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:08.041583 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:48:08.044583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:08.943595 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.903 seconds
[0m22:48:08.944593 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:48:08.957393 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.913 seconds
[0m22:48:08.959383 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:48:09.075725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:48:09.077725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:48:09.085727 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:48:09.088406 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:48:09.089159 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:48:09.090194 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:48:09.090194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:09.091188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:09.782221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.691 seconds
[0m22:48:09.785222 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:48:09.795062 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.704 seconds
[0m22:48:09.796072 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:48:09.913906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A8401970>]}
[0m22:48:09.914902 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:48:09.915900 [info ] [MainThread]: 
[0m22:48:09.921891 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:48:09.921891 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:48:09.923144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:48:09.924170 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:48:09.930176 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:48:09.931158 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:48:09.957173 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:48:09.959160 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:48:09.960177 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:48:09.960177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:10.661948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m22:48:10.681975 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:48:10.813805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A6DF2120>]}
[0m22:48:10.814814 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.89s]
[0m22:48:10.815789 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:48:10.816805 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:48:10.817796 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:48:10.819789 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:48:10.819789 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:48:10.822801 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:48:10.823801 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:48:10.843802 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:48:10.845803 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:48:10.846797 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:48:10.847802 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:48:11.629333 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6398-0000-fd14-0001-4c5e000cf096
[0m22:48:11.630333 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:48:11.630333 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:48:11.755366 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:48:11.756371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ce8c72d-a33d-4f39-b33c-eb7e14c45233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A8A1B4A0>]}
[0m22:48:11.757357 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.94s]
[0m22:48:11.758370 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:48:11.761372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:11.761372 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:48:11.762366 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:48:11.762366 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:48:11.763356 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:48:11.763356 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:48:11.763356 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:48:11.764372 [info ] [MainThread]: 
[0m22:48:11.764372 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m22:48:11.766361 [debug] [MainThread]: Command end result
[0m22:48:11.795366 [info ] [MainThread]: 
[0m22:48:11.796357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:48:11.797371 [info ] [MainThread]: 
[0m22:48:11.798370 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:48:11.799366 [info ] [MainThread]: 
[0m22:48:11.800379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:48:11.802362 [debug] [MainThread]: Command `dbt run` failed at 22:48:11.802362 after 5.72 seconds
[0m22:48:11.803367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238D07CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238DAE20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238DDA8D70>]}
[0m22:48:11.803367 [debug] [MainThread]: Flushing usage events
[0m22:50:42.900132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C3E0EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C6633620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C67EB410>]}


============================== 22:50:42.904936 | a3663bbc-397f-49aa-869f-0317271682a9 ==============================
[0m22:50:42.904936 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:50:42.905940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:50:43.872816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DE4000B0>]}
[0m22:50:43.917815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DE72DF10>]}
[0m22:50:43.919133 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:50:44.240658 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:50:44.412202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:44.413206 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:50:44.586939 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:50:44.587924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0E63BC0>]}
[0m22:50:44.712937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0D70290>]}
[0m22:50:44.803684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DFB98D70>]}
[0m22:50:44.803684 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:50:44.804687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DF72BEC0>]}
[0m22:50:44.806687 [info ] [MainThread]: 
[0m22:50:44.807682 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:50:44.811682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:50:44.812682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:50:44.825682 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:50:44.828238 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:50:44.829250 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:50:44.829250 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:50:44.830249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:44.830249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:45.736153 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.905 seconds
[0m22:50:45.738157 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:50:45.751469 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.921 seconds
[0m22:50:45.753474 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:50:45.868123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:50:45.870126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:50:45.878125 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:50:45.880122 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:50:45.881120 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:50:45.882125 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:50:45.882125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:45.882125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:46.547056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.664 seconds
[0m22:50:46.548055 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:50:46.675300 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.793 seconds
[0m22:50:46.677305 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:50:46.790938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0D38470>]}
[0m22:50:46.791938 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:50:46.792944 [info ] [MainThread]: 
[0m22:50:46.798506 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:50:46.799513 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:50:46.799513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:50:46.800515 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:50:46.808513 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:50:46.810507 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:50:46.835522 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:50:46.837514 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:50:46.838520 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:50:46.839511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:47.575438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m22:50:47.595448 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:50:47.717495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DF862180>]}
[0m22:50:47.718495 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.92s]
[0m22:50:47.719495 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:50:47.720495 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:50:47.721495 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:50:47.722479 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:50:47.723495 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:50:47.726492 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:50:47.727497 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:50:47.746495 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:50:47.749481 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:50:47.749481 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT), 0) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition), 0) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    DISTINCT * 
FROM null_filled
        );
[0m22:50:47.750480 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:50:48.403410 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba639a-0000-fce6-0001-4c5e000cd166
[0m22:50:48.404415 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:50:48.404415 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:50:48.521534 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:50:48.521534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3663bbc-397f-49aa-869f-0317271682a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DF9FDBE0>]}
[0m22:50:48.522533 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.80s]
[0m22:50:48.524527 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:50:48.526522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:48.527519 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:50:48.527519 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:50:48.527519 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:50:48.528517 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:50:48.528517 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:50:48.529517 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:50:48.529517 [info ] [MainThread]: 
[0m22:50:48.530403 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m22:50:48.532435 [debug] [MainThread]: Command end result
[0m22:50:48.563434 [info ] [MainThread]: 
[0m22:50:48.564441 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:50:48.565137 [info ] [MainThread]: 
[0m22:50:48.566152 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:50:48.567155 [info ] [MainThread]: 
[0m22:50:48.568153 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:50:48.570165 [debug] [MainThread]: Command `dbt run` failed at 22:50:48.569154 after 5.81 seconds
[0m22:50:48.570165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C3E0EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C6487440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DF9260C0>]}
[0m22:50:48.570165 [debug] [MainThread]: Flushing usage events
[0m22:52:12.473230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43545C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4379CCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4379CF860>]}


============================== 22:52:12.478331 | e8fa08a2-1ef4-4607-ac5f-30058785fa30 ==============================
[0m22:52:12.478331 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:52:12.479329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:52:13.606768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4397FD0A0>]}
[0m22:52:13.656453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C438227FE0>]}
[0m22:52:13.658074 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:52:14.088222 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:52:14.282299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:14.283299 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:52:14.517110 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:52:14.518102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4513F1B50>]}
[0m22:52:14.649345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4527BA390>]}
[0m22:52:14.786009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C45161B620>]}
[0m22:52:14.787011 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:52:14.788016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C451448C50>]}
[0m22:52:14.790012 [info ] [MainThread]: 
[0m22:52:14.791019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:52:14.795019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:52:14.808008 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:52:14.808008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:52:14.809009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:52:14.812008 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:52:14.812008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:14.813007 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:52:14.816021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:15.774566 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.959 seconds
[0m22:52:15.776576 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:52:15.812565 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.000 seconds
[0m22:52:15.814562 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:52:15.932491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:52:15.936029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:52:15.944835 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:52:15.946879 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:52:15.947882 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:52:15.947882 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:52:15.948881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:15.948881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:16.617250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.668 seconds
[0m22:52:16.619243 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:52:16.760833 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.812 seconds
[0m22:52:16.764105 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:52:16.883169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C451302540>]}
[0m22:52:16.884160 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:52:16.885165 [info ] [MainThread]: 
[0m22:52:16.889774 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:52:16.890773 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:52:16.891773 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:52:16.892779 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:52:16.899774 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:52:16.900773 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:52:16.933773 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:52:16.936771 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:52:16.937764 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:52:16.938773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:17.862154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m22:52:17.884142 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:52:17.996098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4512AE270>]}
[0m22:52:17.997141 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.10s]
[0m22:52:17.998714 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:52:17.999779 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:52:18.000840 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:52:18.001918 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:52:18.002447 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:52:18.006065 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:52:18.006957 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:52:18.027542 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:52:18.031059 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:52:18.031059 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT), 0) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition), 0) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:52:18.032061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:52:18.673936 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba639c-0000-fce6-0001-4c5e000cd16e
[0m22:52:18.674953 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:52:18.674953 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:52:18.790600 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:52:18.791647 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa08a2-1ef4-4607-ac5f-30058785fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C452A6B440>]}
[0m22:52:18.792196 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.79s]
[0m22:52:18.793795 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:52:18.795955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:18.796484 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:52:18.797006 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:52:18.797535 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:52:18.798058 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:52:18.798058 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:52:18.799174 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:52:18.799756 [info ] [MainThread]: 
[0m22:52:18.800844 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m22:52:18.803020 [debug] [MainThread]: Command end result
[0m22:52:18.847055 [info ] [MainThread]: 
[0m22:52:18.848126 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:52:18.849765 [info ] [MainThread]: 
[0m22:52:18.850608 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:52:18.853477 [info ] [MainThread]: 
[0m22:52:18.854636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:52:18.857940 [debug] [MainThread]: Command `dbt run` failed at 22:52:18.857430 after 6.48 seconds
[0m22:52:18.858784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4528D2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4528C3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4373E7110>]}
[0m22:52:18.860214 [debug] [MainThread]: Flushing usage events
[0m22:52:42.066668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029944020C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029946549CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002994654B3B0>]}


============================== 22:52:42.070666 | c1b29cf4-8818-4c73-9779-a85030041dbe ==============================
[0m22:52:42.070666 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:52:42.071664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:43.162479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029946572960>]}
[0m22:52:43.211555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995E10E270>]}
[0m22:52:43.213557 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:52:43.524262 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:52:43.683378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:43.683378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:43.713379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F6EAFC0>]}
[0m22:52:43.810100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F870E60>]}
[0m22:52:43.811103 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:52:43.812104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F939220>]}
[0m22:52:43.814098 [info ] [MainThread]: 
[0m22:52:43.814959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:52:43.818990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:52:43.834013 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:52:43.834013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:52:43.835009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:52:43.838019 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:52:43.839008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:43.839008 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:52:43.842219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:44.750473 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.912 seconds
[0m22:52:44.752478 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:52:44.804358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.962 seconds
[0m22:52:44.806356 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:52:44.931255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:52:44.933264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:52:44.940269 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:52:44.943259 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:52:44.944271 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:52:44.944271 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:52:44.945270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:44.945270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:45.722706 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.776 seconds
[0m22:52:45.724711 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:52:45.736132 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.790 seconds
[0m22:52:45.737127 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:52:45.848981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F870E60>]}
[0m22:52:45.849980 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:52:45.850981 [info ] [MainThread]: 
[0m22:52:45.856982 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:52:45.857981 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:52:45.858940 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:52:45.859966 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:52:45.866970 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:52:45.867956 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:52:45.896959 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:52:45.898963 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:52:45.899959 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:52:45.899959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:46.588768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m22:52:46.610766 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:52:46.718527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F562030>]}
[0m22:52:46.719527 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m22:52:46.720752 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:52:46.721804 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:52:46.722823 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:52:46.722823 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:52:46.723837 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:52:46.726820 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:52:46.727836 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:52:46.748836 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:52:46.751835 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:52:46.752830 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS "category",
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT), 0) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition), 0) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:52:46.753832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:52:47.394297 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba639c-0000-fd14-0001-4c5e000cf09e
[0m22:52:47.395313 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CATEGORY'
[0m22:52:47.395313 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:52:47.513319 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:52:47.513319 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b29cf4-8818-4c73-9779-a85030041dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029960EDE570>]}
[0m22:52:47.514310 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.79s]
[0m22:52:47.515325 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:52:47.517311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:47.518321 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:52:47.518321 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:52:47.519320 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:52:47.519320 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:52:47.520320 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:52:47.520320 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:52:47.521320 [info ] [MainThread]: 
[0m22:52:47.521320 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m22:52:47.523311 [debug] [MainThread]: Command end result
[0m22:52:47.553319 [info ] [MainThread]: 
[0m22:52:47.554326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:52:47.555325 [info ] [MainThread]: 
[0m22:52:47.556310 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:52:47.557310 [info ] [MainThread]: 
[0m22:52:47.557310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:52:47.559309 [debug] [MainThread]: Command `dbt run` failed at 22:52:47.559309 after 5.59 seconds
[0m22:52:47.560311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029944020C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995F452F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299462A25A0>]}
[0m22:52:47.560311 [debug] [MainThread]: Flushing usage events
[0m22:53:41.881041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4A4EEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4C6F2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4C6F37D0>]}


============================== 22:53:41.885619 | f26fd729-93cf-4cd5-ade6-49dcc03e1fd5 ==============================
[0m22:53:41.885619 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:53:41.886612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:53:42.804814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA653197F0>]}
[0m22:53:42.848939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4A1D8770>]}
[0m22:53:42.849927 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:53:43.156560 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:53:43.313325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:53:43.314350 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:53:43.484359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:53:43.485358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA65FC6BD0>]}
[0m22:53:43.610117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA65F6A0C0>]}
[0m22:53:43.697916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA66208BF0>]}
[0m22:53:43.698922 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:53:43.699911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA662A9AC0>]}
[0m22:53:43.700918 [info ] [MainThread]: 
[0m22:53:43.702476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:43.706015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:53:43.714583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:53:43.720582 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:53:43.722582 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:53:43.723106 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:53:43.724130 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:53:43.724130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:43.725124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:44.533149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.809 seconds
[0m22:53:44.535168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:53:44.580944 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.856 seconds
[0m22:53:44.582516 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:53:44.691703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:53:44.695100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:53:44.702621 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:53:44.705643 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:53:44.706633 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:53:44.706633 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:53:44.707864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:44.707864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:45.343994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.636 seconds
[0m22:53:45.346003 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:53:45.487749 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.780 seconds
[0m22:53:45.489765 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:53:45.603513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA674E1C10>]}
[0m22:53:45.604513 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:53:45.605522 [info ] [MainThread]: 
[0m22:53:45.611384 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:53:45.611384 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:53:45.612889 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:53:45.613900 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:53:45.619917 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:53:45.621910 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:53:45.648070 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:53:45.650066 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:53:45.651070 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:53:45.651070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:46.463872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.813 seconds
[0m22:53:46.484487 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:53:46.595520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA65ED2420>]}
[0m22:53:46.596525 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.98s]
[0m22:53:46.598515 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:53:46.599136 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:53:46.600163 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:53:46.601162 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:53:46.601162 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:53:46.603708 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:53:46.605710 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:53:46.625330 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:53:46.628880 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:53:46.628880 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT), 0) OVER(PARTITION BY category)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition), 0) OVER(PARTITION BY category)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:53:46.629872 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:47.265945 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba639d-0000-fce6-0001-4c5e000cd176
[0m22:53:47.265945 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002060 (42601): SQL compilation error:
Invalid function type [COALESCE] for window function.
[0m22:53:47.266963 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:53:47.381159 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [COALESCE] for window function.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:53:47.382681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f26fd729-93cf-4cd5-ade6-49dcc03e1fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA67AAAF30>]}
[0m22:53:47.382681 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.78s]
[0m22:53:47.383691 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:53:47.386970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:47.386970 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:53:47.387970 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:53:47.387970 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:53:47.387970 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:53:47.388971 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:53:47.388971 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:53:47.389958 [info ] [MainThread]: 
[0m22:53:47.389958 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m22:53:47.391961 [debug] [MainThread]: Command end result
[0m22:53:47.431726 [info ] [MainThread]: 
[0m22:53:47.432722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:53:47.434877 [info ] [MainThread]: 
[0m22:53:47.435878 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [COALESCE] for window function.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:53:47.437875 [info ] [MainThread]: 
[0m22:53:47.438876 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:53:47.441878 [debug] [MainThread]: Command `dbt run` failed at 22:53:47.440875 after 5.66 seconds
[0m22:53:47.442388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4A4EEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA678FFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA64A50D70>]}
[0m22:53:47.442897 [debug] [MainThread]: Flushing usage events
[0m22:55:51.412803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600B14A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600F1E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867D83F290>]}


============================== 22:55:51.417803 | 41d9ca17-31b0-4635-ad70-7797f979f401 ==============================
[0m22:55:51.417803 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:55:51.418542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:55:52.339907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018601423FE0>]}
[0m22:55:52.386906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600426240>]}
[0m22:55:52.388439 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:55:52.697251 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:55:52.862230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:52.862230 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:55:53.039787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:55:53.040785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861A2A8FB0>]}
[0m22:55:53.191312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861A2EF350>]}
[0m22:55:53.289924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861BA56930>]}
[0m22:55:53.290849 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:55:53.291850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861A0B5A00>]}
[0m22:55:53.293842 [info ] [MainThread]: 
[0m22:55:53.294835 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:53.299877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:55:53.300880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:55:53.314579 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:55:53.316581 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:55:53.317584 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:55:53.318579 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:55:53.319573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:53.319573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:54.405403 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.085 seconds
[0m22:55:54.406400 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:55:54.439394 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.120 seconds
[0m22:55:54.442393 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:55:54.557080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:55:54.559085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:55:54.567107 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:55:54.570107 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:55:54.570107 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:55:54.571100 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:55:54.571100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:54.572100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:55.321816 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.750 seconds
[0m22:55:55.323814 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:55:55.340185 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.768 seconds
[0m22:55:55.341190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:55:55.450365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861A2EE7E0>]}
[0m22:55:55.451364 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:55:55.452369 [info ] [MainThread]: 
[0m22:55:55.458252 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:55:55.459266 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:55:55.460280 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:55:55.460280 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:55:55.467269 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:55:55.468267 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:55:55.494280 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:55:55.496286 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:55:55.496286 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:55:55.497281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:56.178651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m22:55:56.199652 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:55:56.408585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861A2AA4B0>]}
[0m22:55:56.408585 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.95s]
[0m22:55:56.410585 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:55:56.411575 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:55:56.411575 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:55:56.412585 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:55:56.413585 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:55:56.416585 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:55:56.417590 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:55:56.436585 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:55:56.439587 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:55:56.440590 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT), 0) OVER(PARTITION BY category),0)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:55:56.440590 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:57.025783 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba639f-0000-fcd1-0001-4c5e000c91aa
[0m22:55:57.026783 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 86 unexpected 'AS'.
syntax error line 29 at position 72 unexpected 'OVER'.
[0m22:55:57.026783 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:55:57.147720 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 86 unexpected 'AS'.
  syntax error line 29 at position 72 unexpected 'OVER'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:55:57.147720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d9ca17-31b0-4635-ad70-7797f979f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861BE2A210>]}
[0m22:55:57.148720 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.74s]
[0m22:55:57.149720 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:55:57.152718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:57.152718 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:55:57.153720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:55:57.153720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:55:57.154721 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:55:57.154721 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:55:57.155707 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:55:57.155707 [info ] [MainThread]: 
[0m22:55:57.156715 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m22:55:57.157715 [debug] [MainThread]: Command end result
[0m22:55:57.187720 [info ] [MainThread]: 
[0m22:55:57.189706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:55:57.189706 [info ] [MainThread]: 
[0m22:55:57.190716 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 86 unexpected 'AS'.
  syntax error line 29 at position 72 unexpected 'OVER'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m22:55:57.192705 [info ] [MainThread]: 
[0m22:55:57.193112 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:55:57.195024 [debug] [MainThread]: Command `dbt run` failed at 22:55:57.195024 after 5.88 seconds
[0m22:55:57.195024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867EDE0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600BDD940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018600FC2A50>]}
[0m22:55:57.196018 [debug] [MainThread]: Flushing usage events
[0m22:57:04.083536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7F197C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7F197E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7F197C50>]}


============================== 22:57:04.087541 | b7965d99-09a3-4a40-8f4e-091604fb4843 ==============================
[0m22:57:04.087541 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:57:04.088648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:57:05.181096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7FDE4920>]}
[0m22:57:05.224114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED17777F50>]}
[0m22:57:05.226117 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:57:05.548679 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:57:05.711780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:57:05.712789 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:57:05.903885 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:57:05.905440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED17702870>]}
[0m22:57:06.030381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED19638680>]}
[0m22:57:06.125948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED18464FE0>]}
[0m22:57:06.126939 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:57:06.127945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED198BB6B0>]}
[0m22:57:06.129942 [info ] [MainThread]: 
[0m22:57:06.130942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:57:06.136947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:57:06.148947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:57:06.151955 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:57:06.153965 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:57:06.154948 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:57:06.155947 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:57:06.156966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:06.156966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:07.026994 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.871 seconds
[0m22:57:07.028992 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:57:07.044179 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.886 seconds
[0m22:57:07.046179 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:57:07.158565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:57:07.161100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:57:07.169095 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:57:07.171880 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:57:07.172401 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:57:07.172401 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:57:07.173409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:07.174408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:07.952687 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.779 seconds
[0m22:57:07.954684 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:57:08.600437 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.426 seconds
[0m22:57:08.601954 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:57:08.772757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7DCE3D40>]}
[0m22:57:08.773755 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:57:08.774743 [info ] [MainThread]: 
[0m22:57:08.780482 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:57:08.781483 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:57:08.782472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:57:08.783475 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:57:08.789482 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:57:08.791480 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:57:08.818488 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:57:08.820490 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:57:08.821482 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:57:08.821482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:09.538141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m22:57:09.561675 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:57:09.678079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED1810A3F0>]}
[0m22:57:09.679272 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.89s]
[0m22:57:09.680069 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:57:09.681069 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:57:09.682079 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:57:09.683067 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:57:09.683067 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:57:09.686079 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:57:09.688073 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:57:09.709072 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:57:09.711071 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:57:09.712071 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0)) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:57:09.712071 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:57:13.955888 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.243 seconds
[0m22:57:13.957882 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:57:14.067021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7965d99-09a3-4a40-8f4e-091604fb4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED19CBEAB0>]}
[0m22:57:14.068020 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.38s]
[0m22:57:14.069018 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:57:14.071020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:14.072027 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:57:14.072027 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:57:14.073023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:57:14.073023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:57:14.074026 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:57:14.075018 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:57:14.076016 [info ] [MainThread]: 
[0m22:57:14.077017 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m22:57:14.078020 [debug] [MainThread]: Command end result
[0m22:57:14.117547 [info ] [MainThread]: 
[0m22:57:14.118545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:14.120548 [info ] [MainThread]: 
[0m22:57:14.121549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:57:14.124540 [debug] [MainThread]: Command `dbt run` succeeded at 22:57:14.124540 after 10.14 seconds
[0m22:57:14.125539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED19713B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7ED825D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7ED82450>]}
[0m22:57:14.126541 [debug] [MainThread]: Flushing usage events
[0m22:59:24.742866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6BEB5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6DD6F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6DD6FF80>]}


============================== 22:59:24.747183 | b542e657-092f-424f-91cb-13e1963e5fb5 ==============================
[0m22:59:24.747183 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:59:24.748182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:59:25.699844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7F3650A0>]}
[0m22:59:25.743847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7FB718B0>]}
[0m22:59:25.745842 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:59:26.044930 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:59:26.209728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:26.209728 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m22:59:26.381846 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:59:26.382745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7FDFF110>]}
[0m22:59:26.507763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0933F380>]}
[0m22:59:26.594900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0803B830>]}
[0m22:59:26.595899 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m22:59:26.596898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C093043E0>]}
[0m22:59:26.598904 [info ] [MainThread]: 
[0m22:59:26.600222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:59:26.603858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:59:26.613432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:59:26.617433 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:59:26.619432 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:59:26.619432 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:59:26.620433 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:59:26.620433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:26.621433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:27.536634 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.916 seconds
[0m22:59:27.538641 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:59:27.555623 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.935 seconds
[0m22:59:27.556625 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:59:27.671282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:59:27.674277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:59:27.682292 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:59:27.685289 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:59:27.686276 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:59:27.686276 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:59:27.687290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:27.688274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:28.425917 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.738 seconds
[0m22:59:28.427929 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:59:28.513866 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.826 seconds
[0m22:59:28.515865 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:59:28.636330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C095608C0>]}
[0m22:59:28.637233 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:59:28.638233 [info ] [MainThread]: 
[0m22:59:28.643185 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:59:28.644190 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:59:28.645190 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:59:28.645190 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:59:28.651206 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:59:28.652206 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:59:28.677754 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:59:28.679744 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:59:28.679744 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:59:28.680742 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:29.352581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m22:59:29.372576 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:59:29.485858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7FC82120>]}
[0m22:59:29.485858 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m22:59:29.487850 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:59:29.488260 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:59:29.489288 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:59:29.489841 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:59:29.490859 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:59:29.492856 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:59:29.494860 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:59:29.513856 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:59:29.515857 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:59:29.516856 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,
        COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) AS discount,
        ROUND(COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0)),2) AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m22:59:29.517857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:59:33.476708 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.960 seconds
[0m22:59:33.479716 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:59:33.593419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b542e657-092f-424f-91cb-13e1963e5fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C096E9220>]}
[0m22:59:33.594424 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.10s]
[0m22:59:33.595424 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:59:33.597425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:33.597425 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:59:33.598409 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:59:33.598409 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:59:33.599419 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:59:33.599419 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:59:33.599419 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:59:33.600411 [info ] [MainThread]: 
[0m22:59:33.600411 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m22:59:33.602419 [debug] [MainThread]: Command end result
[0m22:59:33.630961 [info ] [MainThread]: 
[0m22:59:33.632230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:33.633384 [info ] [MainThread]: 
[0m22:59:33.633913 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:59:33.635932 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:33.635932 after 8.99 seconds
[0m22:59:33.635932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6EB091F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6D887920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6E9926C0>]}
[0m22:59:33.636941 [debug] [MainThread]: Flushing usage events
[0m23:01:39.100293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025438670B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025435F9C200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025438BA0170>]}


============================== 23:01:39.106291 | 630302fd-2f9d-45ca-9971-726bbd7c18e5 ==============================
[0m23:01:39.106291 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:01:39.107463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:40.127781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025450A85C70>]}
[0m23:01:40.173338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025451FC5010>]}
[0m23:01:40.175300 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:01:40.477168 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:01:40.667167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:01:40.668167 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m23:01:40.861280 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:01:40.862265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025451F6B590>]}
[0m23:01:41.003102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254534D3920>]}
[0m23:01:41.092602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254522283B0>]}
[0m23:01:41.093597 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m23:01:41.093597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002545341E2A0>]}
[0m23:01:41.095596 [info ] [MainThread]: 
[0m23:01:41.096601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:41.100590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:01:41.118622 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:01:41.118622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:01:41.124610 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:01:41.126618 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:01:41.127620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:41.128620 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:01:41.131606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:42.108294 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.980 seconds
[0m23:01:42.109293 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.977 seconds
[0m23:01:42.111288 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:01:42.113309 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:01:42.232832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:01:42.235852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:01:42.242864 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:01:42.245853 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:01:42.246861 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:01:42.246861 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:01:42.247909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:42.247909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:43.097907 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.849 seconds
[0m23:01:43.099911 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:01:43.139441 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m23:01:43.141459 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:01:43.250107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254534FBAA0>]}
[0m23:01:43.251115 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:01:43.252115 [info ] [MainThread]: 
[0m23:01:43.257010 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:01:43.258010 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:01:43.259004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:01:43.260005 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:01:43.267002 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:01:43.269004 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:01:43.296015 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:01:43.298013 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:01:43.299010 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:01:43.299010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:01:44.248175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m23:01:44.268185 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:01:44.397687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025451ED2000>]}
[0m23:01:44.398687 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.14s]
[0m23:01:44.399689 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:01:44.400687 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:01:44.400687 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:01:44.401686 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:01:44.402685 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:01:44.405685 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:01:44.406685 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:01:44.425687 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:01:44.428691 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:01:44.429688 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars),2),
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) AS discount),2),
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m23:01:44.430690 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:01:45.038825 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba63a5-0000-fcc4-0001-4c5e000ca1b6
[0m23:01:45.038825 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 80 unexpected 'AS'.
syntax error line 27 at position 98 unexpected '2'.
syntax error line 28 at position 56 unexpected 'OVER'.
[0m23:01:45.039830 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:01:45.226833 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 80 unexpected 'AS'.
  syntax error line 27 at position 98 unexpected '2'.
  syntax error line 28 at position 56 unexpected 'OVER'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:01:45.226833 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630302fd-2f9d-45ca-9971-726bbd7c18e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025453990A40>]}
[0m23:01:45.228110 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.83s]
[0m23:01:45.229845 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:01:45.231829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:45.232854 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:01:45.233842 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:01:45.233842 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:01:45.234845 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:01:45.234845 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:01:45.234845 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:01:45.235850 [info ] [MainThread]: 
[0m23:01:45.236832 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m23:01:45.237830 [debug] [MainThread]: Command end result
[0m23:01:45.272832 [info ] [MainThread]: 
[0m23:01:45.273838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:45.274651 [info ] [MainThread]: 
[0m23:01:45.275672 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 80 unexpected 'AS'.
  syntax error line 27 at position 98 unexpected '2'.
  syntax error line 28 at position 56 unexpected 'OVER'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:01:45.276671 [info ] [MainThread]: 
[0m23:01:45.277679 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:01:45.279676 [debug] [MainThread]: Command `dbt run` failed at 23:01:45.279676 after 6.29 seconds
[0m23:01:45.279676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025438BE7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254534FBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254383CD5E0>]}
[0m23:01:45.280673 [debug] [MainThread]: Flushing usage events
[0m23:02:37.195863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156CD3ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156F742C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156F7436E0>]}


============================== 23:02:37.200867 | c7540856-fb7b-46d2-ac02-36a1570fd028 ==============================
[0m23:02:37.200867 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:02:37.201852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:02:38.145667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157FD9D0A0>]}
[0m23:02:38.190223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021508882F30>]}
[0m23:02:38.193219 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:02:38.515116 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:02:38.690128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:38.691128 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m23:02:38.874238 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:02:38.875237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509E5FC20>]}
[0m23:02:39.012789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509D4AA80>]}
[0m23:02:39.105169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021508B53950>]}
[0m23:02:39.106169 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m23:02:39.106169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150877DA00>]}
[0m23:02:39.108169 [info ] [MainThread]: 
[0m23:02:39.109164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:39.113682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:02:39.126704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:02:39.127705 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:02:39.129701 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:02:39.130703 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:02:39.130703 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:02:39.131699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:39.132699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:39.983674 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.852 seconds
[0m23:02:39.985676 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:02:40.007761 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.875 seconds
[0m23:02:40.009765 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:02:40.130255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:02:40.132263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:02:40.140255 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:02:40.142616 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:02:40.143665 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:02:40.144353 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:02:40.144840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:40.145601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:40.923070 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.778 seconds
[0m23:02:40.926076 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:02:40.929069 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.784 seconds
[0m23:02:40.931059 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:02:41.040759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509FF7D10>]}
[0m23:02:41.041759 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:02:41.042761 [info ] [MainThread]: 
[0m23:02:41.047915 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:02:41.048921 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:02:41.050907 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:02:41.050907 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:02:41.057909 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:02:41.058907 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:02:41.085917 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:02:41.087905 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:02:41.088918 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:02:41.088918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:41.769407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m23:02:41.791405 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:02:41.914153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509FEF530>]}
[0m23:02:41.915159 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m23:02:41.916141 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:02:41.917125 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:02:41.918150 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:02:41.919154 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:02:41.919154 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:02:41.922156 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:02:41.923160 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:02:41.943146 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:02:41.946141 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:02:41.947144 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)) AS price_dollars,2),
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) AS discount,2),
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m23:02:41.948145 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:02:42.531826 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba63a6-0000-fcd3-0001-4c5e000cc1ea
[0m23:02:42.531826 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 80 unexpected 'AS'.
syntax error line 28 at position 22 unexpected '('.
syntax error line 28 at position 31 unexpected ','.
syntax error line 28 at position 45 unexpected '('.
syntax error line 28 at position 56 unexpected 'OVER'.
syntax error line 28 at position 83 unexpected ','.
[0m23:02:42.532832 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:02:42.667792 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 80 unexpected 'AS'.
  syntax error line 28 at position 22 unexpected '('.
  syntax error line 28 at position 31 unexpected ','.
  syntax error line 28 at position 45 unexpected '('.
  syntax error line 28 at position 56 unexpected 'OVER'.
  syntax error line 28 at position 83 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:02:42.668934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7540856-fb7b-46d2-ac02-36a1570fd028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150A43B0E0>]}
[0m23:02:42.668934 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.75s]
[0m23:02:42.670790 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:02:42.672781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:42.673784 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:02:42.674783 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:02:42.674783 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:02:42.674783 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:02:42.675783 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:02:42.675783 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:02:42.675783 [info ] [MainThread]: 
[0m23:02:42.676786 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m23:02:42.678780 [debug] [MainThread]: Command end result
[0m23:02:42.709127 [info ] [MainThread]: 
[0m23:02:42.709779 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:42.710783 [info ] [MainThread]: 
[0m23:02:42.711788 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 80 unexpected 'AS'.
  syntax error line 28 at position 22 unexpected '('.
  syntax error line 28 at position 31 unexpected ','.
  syntax error line 28 at position 45 unexpected '('.
  syntax error line 28 at position 56 unexpected 'OVER'.
  syntax error line 28 at position 83 unexpected ','.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:02:42.713787 [info ] [MainThread]: 
[0m23:02:42.714787 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:02:42.715787 [debug] [MainThread]: Command `dbt run` failed at 23:02:42.715787 after 5.62 seconds
[0m23:02:42.716803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156EE2E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509C85FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157FBB93A0>]}
[0m23:02:42.717799 [debug] [MainThread]: Flushing usage events
[0m23:05:10.135582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DF1EA0A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DF3C5B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DF3C5A990>]}


============================== 23:05:10.139578 | da06926b-6b1d-4a51-a166-b27cef658506 ==============================
[0m23:05:10.139578 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:05:10.140612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:05:11.140256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8C216B10>]}
[0m23:05:11.184257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8D26F320>]}
[0m23:05:11.185242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:05:11.495521 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:05:11.659521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:05:11.660526 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m23:05:11.832676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:05:11.833665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8E974410>]}
[0m23:05:11.958671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8EA6B7A0>]}
[0m23:05:12.055666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8D778650>]}
[0m23:05:12.056668 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m23:05:12.057676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8E953D10>]}
[0m23:05:12.058668 [info ] [MainThread]: 
[0m23:05:12.059685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:12.064675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:05:12.076242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:05:12.078235 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:05:12.081239 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:05:12.081239 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:05:12.082235 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:05:12.082235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:12.083224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:13.034453 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.951 seconds
[0m23:05:13.035460 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:05:13.101876 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.019 seconds
[0m23:05:13.103876 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:05:13.222705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:05:13.224705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:05:13.232256 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:05:13.235274 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:05:13.236274 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:05:13.237274 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:05:13.237274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:13.238264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:13.889288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m23:05:13.890287 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:05:13.924081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m23:05:13.925076 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:05:14.040773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8EE16540>]}
[0m23:05:14.041773 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:05:14.042808 [info ] [MainThread]: 
[0m23:05:14.048846 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:05:14.049848 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:05:14.050848 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:05:14.051848 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:05:14.057859 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:05:14.058853 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:05:14.085429 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:05:14.087428 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:05:14.087428 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:05:14.088428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:15.087584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m23:05:15.107589 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:05:15.223710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8D442060>]}
[0m23:05:15.224717 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.17s]
[0m23:05:15.225708 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:05:15.226715 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:05:15.227710 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:05:15.228710 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:05:15.229710 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:05:15.232227 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:05:15.233249 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:05:15.252810 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:05:15.255804 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:05:15.255804 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m23:05:15.256801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:17.867499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.610 seconds
[0m23:05:17.869491 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:05:17.978920 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da06926b-6b1d-4a51-a166-b27cef658506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8F002DE0>]}
[0m23:05:17.978920 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.75s]
[0m23:05:17.980916 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:05:17.982924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:17.982924 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:05:17.983909 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:05:17.983909 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:05:17.984921 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:05:17.984921 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:05:17.984921 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:05:17.985920 [info ] [MainThread]: 
[0m23:05:17.986541 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m23:05:17.987556 [debug] [MainThread]: Command end result
[0m23:05:18.016573 [info ] [MainThread]: 
[0m23:05:18.017572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:18.018560 [info ] [MainThread]: 
[0m23:05:18.019556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:05:18.021571 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:18.021571 after 7.98 seconds
[0m23:05:18.021571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DF4537230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DF1FC02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8E991C10>]}
[0m23:05:18.022558 [debug] [MainThread]: Flushing usage events
[0m12:54:26.168040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102CE72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102CEF19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102D589640>]}


============================== 12:54:26.181663 | 4907696e-6cf8-4308-8b4e-44608f6a0e4d ==============================
[0m12:54:26.181663 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:54:26.182666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:32.869966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104654A330>]}
[0m12:54:32.915374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104662E5A0>]}
[0m12:54:32.917376 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:54:33.366815 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:54:34.976040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:54:34.977043 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m12:54:34.978246 [debug] [MainThread]: Partial parsing: updated file: transform://models\staging\stg_products.sql
[0m12:54:35.185478 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:54:35.187471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021047BAFE30>]}
[0m12:54:35.326217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021047D07290>]}
[0m12:54:35.453179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210469BBD40>]}
[0m12:54:35.454176 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m12:54:35.454176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021047E4B890>]}
[0m12:54:35.456696 [info ] [MainThread]: 
[0m12:54:35.457695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:35.462214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:54:35.476652 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:54:35.477652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:54:35.477652 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:54:35.480165 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:54:35.481175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:35.481175 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:54:35.485357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:38.823727 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.343 seconds
[0m12:54:38.825727 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:54:38.931106 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.446 seconds
[0m12:54:38.932109 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:54:39.061808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m12:54:39.062806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:54:39.071321 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m12:54:39.073330 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:54:39.074329 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m12:54:39.075330 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:54:39.075330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:39.076332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:40.008782 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.933 seconds
[0m12:54:40.011307 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:54:40.124633 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.049 seconds
[0m12:54:40.126653 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m12:54:40.247333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021046992B40>]}
[0m12:54:40.248332 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:54:40.249333 [info ] [MainThread]: 
[0m12:54:40.257742 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:54:40.259519 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:54:40.260595 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:54:40.261562 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:54:40.273108 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:54:40.274102 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:54:40.313227 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:54:40.315224 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:54:40.316228 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
    md5(cast(coalesce(cast(goods_title_link_href as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:54:40.316228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:41.233694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.917 seconds
[0m12:54:41.254778 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:54:41.377487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102CE70E30>]}
[0m12:54:41.378488 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.12s]
[0m12:54:41.380501 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:54:41.381019 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:54:41.382040 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m12:54:41.383037 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m12:54:41.384046 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:54:41.387037 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:54:41.388028 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:54:41.410650 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:54:41.413657 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:54:41.413657 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        id,
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m12:54:41.414659 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:42.387879 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba66e6-0000-fcd1-0001-4c5e000d301a
[0m12:54:42.388881 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 8
invalid identifier 'ID'
[0m12:54:42.388881 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:54:42.525467 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'ID'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m12:54:42.526476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4907696e-6cf8-4308-8b4e-44608f6a0e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021047CE6DB0>]}
[0m12:54:42.527481 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.14s]
[0m12:54:42.528688 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:54:42.531481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:42.532485 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:54:42.532485 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:54:42.533489 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m12:54:42.533489 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:54:42.534488 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:54:42.534488 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:54:42.535488 [info ] [MainThread]: 
[0m12:54:42.536478 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m12:54:42.537485 [debug] [MainThread]: Command end result
[0m12:54:42.636588 [info ] [MainThread]: 
[0m12:54:42.638587 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:42.638587 [info ] [MainThread]: 
[0m12:54:42.639589 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 23 at position 8
  invalid identifier 'ID'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m12:54:42.641585 [info ] [MainThread]: 
[0m12:54:42.642590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:54:42.643586 [debug] [MainThread]: Command `dbt run` failed at 12:54:42.643586 after 16.68 seconds
[0m12:54:42.644593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102ABFEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102CEF19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102D332630>]}
[0m12:54:42.645588 [debug] [MainThread]: Flushing usage events
[0m12:56:13.761626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1715BB5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16DC0F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170D559D0>]}


============================== 12:56:13.766627 | ccf8ae29-0580-488d-a51c-3ae169424d8c ==============================
[0m12:56:13.766627 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:13.767570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:14.754413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17F426B10>]}
[0m12:56:14.803413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1703AB620>]}
[0m12:56:14.805414 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:56:15.153989 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:56:15.323115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:15.324119 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m12:56:15.522654 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:56:15.524659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17F1FDF70>]}
[0m12:56:15.657271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10BD6EE70>]}
[0m12:56:15.750493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10AA79010>]}
[0m12:56:15.750493 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m12:56:15.751497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10BC8DA60>]}
[0m12:56:15.753496 [info ] [MainThread]: 
[0m12:56:15.754493 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:15.758504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:56:15.769502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:56:15.772492 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:56:15.775502 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:56:15.775502 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:56:15.776498 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:56:15.777502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:15.777502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:16.801470 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.024 seconds
[0m12:56:16.803475 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:56:16.812925 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.035 seconds
[0m12:56:16.814926 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:56:16.936912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m12:56:16.939931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m12:56:16.947918 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m12:56:16.949920 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:56:16.950918 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m12:56:16.951908 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m12:56:16.952922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:16.952922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:17.801091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.849 seconds
[0m12:56:17.804118 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m12:56:17.852284 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.899 seconds
[0m12:56:17.854302 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:56:17.969659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10A837050>]}
[0m12:56:17.970640 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:56:17.970640 [info ] [MainThread]: 
[0m12:56:17.976156 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:56:17.978162 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:56:17.979167 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m12:56:17.979167 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:56:17.997173 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:56:17.999165 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:56:18.026162 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:56:18.028163 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:56:18.029154 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
    md5(cast(coalesce(cast(goods_title_link_href as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS id
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:56:18.029154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:18.968447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m12:56:18.988784 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:56:19.100946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10A741F10>]}
[0m12:56:19.101939 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.12s]
[0m12:56:19.102944 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:56:19.103941 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:56:19.104946 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m12:56:19.105949 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m12:56:19.106947 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:56:19.109946 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:56:19.110946 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:56:19.131951 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:56:19.134939 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:56:19.134939 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        id,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        id,
        GOODS_TITLE_LINK_JUMP,
        category,
        rank_title,
        rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COLOR_COUNT,
        "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM clean_cols
)


SELECT 
    * 
FROM null_filled
        );
[0m12:56:19.135940 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:56:22.836231 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.700 seconds
[0m12:56:22.838225 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:56:22.950235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf8ae29-0580-488d-a51c-3ae169424d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C3110D0>]}
[0m12:56:22.950235 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.84s]
[0m12:56:22.952230 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:56:22.954236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:22.954236 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:56:22.955227 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m12:56:22.955227 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m12:56:22.955227 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m12:56:22.956235 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:56:22.956235 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:56:22.957235 [info ] [MainThread]: 
[0m12:56:22.958225 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m12:56:22.959231 [debug] [MainThread]: Command end result
[0m12:56:22.989751 [info ] [MainThread]: 
[0m12:56:22.990227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:22.991257 [info ] [MainThread]: 
[0m12:56:22.992256 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:56:22.994257 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:22.994257 after 9.38 seconds
[0m12:56:22.994257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16DC0F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10A782450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10BEF3B90>]}
[0m12:56:22.995256 [debug] [MainThread]: Flushing usage events
[0m13:39:55.180381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A1094380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A3F62750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A2F152B0>]}


============================== 13:39:55.184394 | 015c41d0-0135-466a-acf8-27fe50b744cc ==============================
[0m13:39:55.184394 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:39:55.185394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:39:56.272779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BCE76B10>]}
[0m13:39:56.392488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BC507DD0>]}
[0m13:39:56.395412 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:39:56.762311 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:39:56.950435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:39:56.951463 [debug] [MainThread]: Partial parsing: updated file: transform://models\staging\stg_products.sql
[0m13:39:56.951463 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:39:57.153598 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:39:57.154794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BD04AE70>]}
[0m13:39:57.276221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE3ACFE0>]}
[0m13:39:57.415505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE665640>]}
[0m13:39:57.416499 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:39:57.417495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BCFD27B0>]}
[0m13:39:57.418499 [info ] [MainThread]: 
[0m13:39:57.419624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:57.423652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:39:57.436653 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:39:57.437653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:39:57.437653 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:39:57.440652 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:39:57.441644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:57.442751 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:39:57.445270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:58.531820 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.090 seconds
[0m13:39:58.533949 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:39:58.576506 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.131 seconds
[0m13:39:58.578798 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:39:58.722723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:39:58.723728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:39:58.732721 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:39:58.735218 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:39:58.735218 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:39:58.736257 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:39:58.737229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:58.737229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:59.391099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.653 seconds
[0m13:39:59.393103 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:39:59.534744 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.798 seconds
[0m13:39:59.537731 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:39:59.650645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BCAE03B0>]}
[0m13:39:59.651653 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:39:59.652653 [info ] [MainThread]: 
[0m13:39:59.658663 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:39:59.659663 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:39:59.660663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:39:59.661661 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:39:59.667660 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:39:59.669662 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:39:59.695197 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:39:59.697205 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:39:59.698202 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:39:59.698202 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:00.612239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m13:40:00.634244 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:40:00.797653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE9420F0>]}
[0m13:40:00.798656 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.14s]
[0m13:40:00.799640 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:40:00.800576 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:40:00.801593 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:40:00.802602 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:40:00.802602 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:40:00.806603 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:40:00.808607 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:40:00.830163 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:40:00.834168 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:40:00.835175 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS "title",
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:40:00.835175 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:01.656216 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6714-0000-fd24-0001-4c5e000d6012
[0m13:40:01.657221 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier 'GOODS_TITLE_LINK'
[0m13:40:01.657221 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:40:01.772587 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:40:01.773587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015c41d0-0135-466a-acf8-27fe50b744cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE979BB0>]}
[0m13:40:01.774587 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.97s]
[0m13:40:01.775587 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:40:01.777573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:01.778582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:40:01.778582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:40:01.779582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:40:01.779582 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:40:01.780587 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:40:01.780587 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:40:01.781582 [info ] [MainThread]: 
[0m13:40:01.781582 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m13:40:01.783583 [debug] [MainThread]: Command end result
[0m13:40:01.812579 [info ] [MainThread]: 
[0m13:40:01.813583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:01.814583 [info ] [MainThread]: 
[0m13:40:01.815583 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:40:01.816586 [info ] [MainThread]: 
[0m13:40:01.817589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:40:01.818580 [debug] [MainThread]: Command `dbt run` failed at 13:40:01.818580 after 6.78 seconds
[0m13:40:01.819595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A1094380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE523650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BE3FEC90>]}
[0m13:40:01.819595 [debug] [MainThread]: Flushing usage events
[0m13:40:34.315781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500E77EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500FFA64B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500B0990D0>]}


============================== 13:40:34.320781 | d9c094f8-d045-45b2-b243-524467bb3d06 ==============================
[0m13:40:34.320781 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:40:34.321781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:35.319622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502A1BF4A0>]}
[0m13:40:35.365623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150297E7DD0>]}
[0m13:40:35.366612 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:40:35.676190 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:40:35.834737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:35.835739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:35.865253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502A2B2EA0>]}
[0m13:40:35.972802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502B69C9E0>]}
[0m13:40:35.972802 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:40:35.973805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502B69B8F0>]}
[0m13:40:35.976804 [info ] [MainThread]: 
[0m13:40:35.977798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:35.981804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:40:35.982802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:40:35.998804 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:40:36.001799 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:40:36.001799 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:40:36.002801 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:40:36.003801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:36.003801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:37.045177 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.041 seconds
[0m13:40:37.047177 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:40:37.787601 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.784 seconds
[0m13:40:37.789597 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:40:37.897971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:40:37.899984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:40:37.907987 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:40:37.909988 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:40:37.910988 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:40:37.911983 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:40:37.911983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:37.912988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:38.681876 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.770 seconds
[0m13:40:38.682869 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:40:38.708052 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.795 seconds
[0m13:40:38.710045 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:40:38.828955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502B8A7020>]}
[0m13:40:38.829961 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:40:38.830961 [info ] [MainThread]: 
[0m13:40:38.836655 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:40:38.837657 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:40:38.838663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:40:38.840657 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:40:38.847182 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:40:38.849171 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:40:38.875185 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:40:38.877172 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:40:38.878181 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:40:38.878181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:39.604073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m13:40:39.625066 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:40:39.746711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502A182270>]}
[0m13:40:39.747719 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m13:40:39.748702 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:40:39.749702 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:40:39.750707 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:40:39.751696 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:40:39.752705 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:40:39.766708 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:40:39.768713 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:40:39.787696 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:40:39.791708 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:40:39.792709 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS "title",
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:40:39.793703 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:40.581314 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6714-0000-fd0b-0001-4c5e000ce11e
[0m13:40:40.581314 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier 'GOODS_TITLE_LINK'
[0m13:40:40.582321 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:40:40.696354 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:40:40.696354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c094f8-d045-45b2-b243-524467bb3d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502BADA840>]}
[0m13:40:40.697354 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.94s]
[0m13:40:40.698348 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:40:40.701347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:40.701347 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:40:40.702359 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:40:40.702359 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:40:40.703353 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:40:40.703353 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:40:40.704341 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:40:40.704341 [info ] [MainThread]: 
[0m13:40:40.705342 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m13:40:40.706340 [debug] [MainThread]: Command end result
[0m13:40:40.735351 [info ] [MainThread]: 
[0m13:40:40.737354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:40.737354 [info ] [MainThread]: 
[0m13:40:40.738337 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:40:40.739350 [info ] [MainThread]: 
[0m13:40:40.740340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:40:40.742340 [debug] [MainThread]: Command `dbt run` failed at 13:40:40.742340 after 6.53 seconds
[0m13:40:40.743340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500E77EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015010DCF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015010DCF500>]}
[0m13:40:40.744345 [debug] [MainThread]: Flushing usage events
[0m13:41:41.837363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D477D34800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D477D348C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D478CC7E60>]}


============================== 13:41:41.841364 | 15c3a3a4-d13c-4d38-92c5-518ef7851c13 ==============================
[0m13:41:41.841364 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:41:41.842356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:42.781531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D477D34800>]}
[0m13:41:42.826537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47F07D0A0>]}
[0m13:41:42.828530 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:41:43.131202 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:41:43.290300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:43.291308 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:41:43.483857 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:41:43.485097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D413227B90>]}
[0m13:41:43.606126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4131C3440>]}
[0m13:41:43.695737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FF2BDA0>]}
[0m13:41:43.696736 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:41:43.697735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4131BD5B0>]}
[0m13:41:43.698737 [info ] [MainThread]: 
[0m13:41:43.700737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:41:43.704735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:41:43.715739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:41:43.717763 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:41:43.719781 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:41:43.720740 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:41:43.721743 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:41:43.721743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:43.722745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:44.654939 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.932 seconds
[0m13:41:44.656943 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:41:44.720187 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.998 seconds
[0m13:41:44.722187 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:41:44.849654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:41:44.850659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:41:44.858659 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:41:44.860644 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:41:44.861644 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:41:44.862650 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:41:44.862650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:44.863661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:45.660526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.797 seconds
[0m13:41:45.662541 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.799 seconds
[0m13:41:45.664538 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:41:45.666541 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:41:45.791564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4136572C0>]}
[0m13:41:45.792564 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:41:45.793564 [info ] [MainThread]: 
[0m13:41:45.799564 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:41:45.800557 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:41:45.800557 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:41:45.801555 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:41:45.808555 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:41:45.809556 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:41:45.835568 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:41:45.837564 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:41:45.838569 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:41:45.838569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:46.537418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m13:41:46.557423 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:41:46.675896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D47FBD1FA0>]}
[0m13:41:46.676895 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m13:41:46.677896 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:41:46.678896 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:41:46.679890 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:41:46.680882 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:41:46.681892 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:41:46.685895 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:41:46.686888 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:41:46.707895 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:41:46.710890 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:41:46.711885 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE('goods_title_link', 'Unknown') AS "title",
        COALESCE('GOODS_TITLE_LINK_JUMP', 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:41:46.711885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:41:47.533978 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6715-0000-fcd1-0001-4c5e000d3026
[0m13:41:47.533978 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 104
invalid identifier 'PRICE'
[0m13:41:47.534978 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:41:47.652880 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 104
  invalid identifier 'PRICE'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:41:47.654088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c3a3a4-d13c-4d38-92c5-518ef7851c13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4137C8650>]}
[0m13:41:47.654881 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.97s]
[0m13:41:47.655884 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:41:47.657867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:47.658880 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:41:47.658880 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:41:47.659876 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:41:47.659876 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:41:47.659876 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:41:47.660880 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:41:47.661876 [info ] [MainThread]: 
[0m13:41:47.661876 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m13:41:47.663882 [debug] [MainThread]: Command end result
[0m13:41:47.692868 [info ] [MainThread]: 
[0m13:41:47.693881 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:41:47.694878 [info ] [MainThread]: 
[0m13:41:47.695879 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 104
  invalid identifier 'PRICE'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:41:47.696877 [info ] [MainThread]: 
[0m13:41:47.697869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:41:47.699870 [debug] [MainThread]: Command `dbt run` failed at 13:41:47.699870 after 5.97 seconds
[0m13:41:47.700878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D477D348C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D413111250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D41310B9E0>]}
[0m13:41:47.701869 [debug] [MainThread]: Flushing usage events
[0m13:42:07.488581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F6BB3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F41FED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F322F0E0>]}


============================== 13:42:07.493597 | 14fd2a27-a5b7-450a-87ea-a135b14e8593 ==============================
[0m13:42:07.493597 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:42:07.494595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:42:08.448448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210FFBE1C10>]}
[0m13:42:08.494446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210FFC2B5C0>]}
[0m13:42:08.495450 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:42:08.807197 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:42:08.980999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:08.982007 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:42:09.176558 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:42:09.178403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210FF37FCB0>]}
[0m13:42:09.296972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021091287110>]}
[0m13:42:09.387014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F6D47740>]}
[0m13:42:09.388014 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:42:09.389022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021091268A10>]}
[0m13:42:09.391024 [info ] [MainThread]: 
[0m13:42:09.392012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:09.396247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:42:09.405263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:42:09.410262 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:42:09.412261 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:42:09.413258 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:42:09.414262 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:42:09.415262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:09.415262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:10.322951 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.908 seconds
[0m13:42:10.324955 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:42:10.401645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.985 seconds
[0m13:42:10.403645 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:42:10.513945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:42:10.515964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:42:10.522962 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:42:10.526053 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:42:10.526053 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:42:10.527057 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:42:10.528054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:10.528054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:11.338111 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m13:42:11.340114 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:42:11.341103 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.813 seconds
[0m13:42:11.343103 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:42:11.461418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210916172C0>]}
[0m13:42:11.462418 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:42:11.463418 [info ] [MainThread]: 
[0m13:42:11.468562 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:42:11.469566 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:42:11.470567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:42:11.470567 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:42:11.477575 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:42:11.479564 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:42:11.505568 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:42:11.507574 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:42:11.508567 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:42:11.508567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:42:12.316011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m13:42:12.337011 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:42:12.456529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210FFBE1F10>]}
[0m13:42:12.457535 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.99s]
[0m13:42:12.458535 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:42:12.459530 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:42:12.460534 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:42:12.462076 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:42:12.462076 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:42:12.466098 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:42:12.467098 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:42:12.488093 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:42:12.491088 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:42:12.492093 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE('goods_title_link', 'Unknown') AS "title",
        COALESCE('GOODS_TITLE_LINK_JUMP', 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:42:12.492093 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:13.285601 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6716-0000-fd29-0001-4c5e000d101a
[0m13:42:13.285601 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 186
invalid identifier 'TITLE'
[0m13:42:13.287598 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:42:13.401553 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 186
  invalid identifier 'TITLE'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:42:13.402553 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14fd2a27-a5b7-450a-87ea-a135b14e8593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210917AB5C0>]}
[0m13:42:13.403546 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.94s]
[0m13:42:13.404554 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:42:13.406541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:13.407554 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:42:13.407554 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:42:13.408875 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:42:13.408875 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:42:13.409549 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:42:13.409549 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:42:13.409549 [info ] [MainThread]: 
[0m13:42:13.411544 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m13:42:13.412550 [debug] [MainThread]: Command end result
[0m13:42:13.441539 [info ] [MainThread]: 
[0m13:42:13.442556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:42:13.443555 [info ] [MainThread]: 
[0m13:42:13.444542 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 186
  invalid identifier 'TITLE'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:42:13.445544 [info ] [MainThread]: 
[0m13:42:13.446545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:42:13.448545 [debug] [MainThread]: Command `dbt run` failed at 13:42:13.448545 after 6.06 seconds
[0m13:42:13.449550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021091227E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210911BDCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F69121E0>]}
[0m13:42:13.449550 [debug] [MainThread]: Flushing usage events
[0m13:42:43.605223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E61665E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E603F2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E603F1340>]}


============================== 13:42:43.609399 | e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a ==============================
[0m13:42:43.609399 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:42:43.610398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:42:44.685899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E640317F0>]}
[0m13:42:44.732574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7C2C6270>]}
[0m13:42:44.734598 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:42:45.056715 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:42:45.222640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:45.222640 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:42:45.425590 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:42:45.426589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7CFBF290>]}
[0m13:42:45.554526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7E74B200>]}
[0m13:42:45.645762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7D2B9DC0>]}
[0m13:42:45.645762 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:42:45.646751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7E4D2210>]}
[0m13:42:45.649747 [info ] [MainThread]: 
[0m13:42:45.650762 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:45.655301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:42:45.664830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:42:45.670361 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:42:45.672884 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:42:45.673900 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:42:45.673900 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:42:45.674905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:45.674905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:46.536483 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.862 seconds
[0m13:42:46.538486 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:42:46.546226 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.872 seconds
[0m13:42:46.548222 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:42:46.659331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:42:46.661327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:42:46.669363 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:42:46.672375 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:42:46.672881 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:42:46.672881 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:42:46.673893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:46.674901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:47.490298 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.815 seconds
[0m13:42:47.491302 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:42:47.548420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.874 seconds
[0m13:42:47.550423 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:42:47.665391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7E4D1430>]}
[0m13:42:47.666391 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:42:47.667389 [info ] [MainThread]: 
[0m13:42:47.673452 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:42:47.674456 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:42:47.675458 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:42:47.676452 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:42:47.683988 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:42:47.684987 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:42:47.712545 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:42:47.714570 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:42:47.715577 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:42:47.716578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:42:48.399122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m13:42:48.419213 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:42:48.536672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7CF821E0>]}
[0m13:42:48.537677 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m13:42:48.538665 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:42:48.539663 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:42:48.540673 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:42:48.540673 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:42:48.543200 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:42:48.547189 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:42:48.548195 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:42:48.569267 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:42:48.572279 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:42:48.573285 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE('goods_title_link', 'Unknown') AS title,
        COALESCE('GOODS_TITLE_LINK_JUMP', 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:42:48.574287 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:54.147486 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.573 seconds
[0m13:42:54.149480 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:42:54.275221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e041d3ec-7c02-4c9e-aabc-ebdadce7fd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7EB14860>]}
[0m13:42:54.275221 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 5.73s]
[0m13:42:54.276226 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:42:54.278754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:54.279769 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:42:54.279769 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:42:54.280757 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:42:54.280757 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:42:54.281765 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:42:54.281765 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:42:54.282287 [info ] [MainThread]: 
[0m13:42:54.283295 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m13:42:54.284300 [debug] [MainThread]: Command end result
[0m13:42:54.317418 [info ] [MainThread]: 
[0m13:42:54.318428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:54.319422 [info ] [MainThread]: 
[0m13:42:54.320435 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:42:54.322428 [debug] [MainThread]: Command `dbt run` succeeded at 13:42:54.321433 after 10.84 seconds
[0m13:42:54.322428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E61665E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7D2D5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7E6760F0>]}
[0m13:42:54.323710 [debug] [MainThread]: Flushing usage events
[0m13:46:41.196496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244ED54B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EAB6ED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EC50B0E0>]}


============================== 13:46:41.200491 | d2f9abc8-fc6b-4fb8-b158-e0ea373bb498 ==============================
[0m13:46:41.200491 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:46:41.202343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:42.336652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244ED7350A0>]}
[0m13:46:42.382221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024486707FE0>]}
[0m13:46:42.384201 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:46:42.705746 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:46:42.892270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:42.893269 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:46:43.105471 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:46:43.107484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024487C8FC20>]}
[0m13:46:43.233481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024487B77B90>]}
[0m13:46:43.328462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244869531A0>]}
[0m13:46:43.329458 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:46:43.330463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244FF670470>]}
[0m13:46:43.332463 [info ] [MainThread]: 
[0m13:46:43.333462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:43.337454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:46:43.346462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:46:43.351456 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:46:43.354468 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:46:43.355459 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:46:43.356469 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:46:43.356469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:43.357468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:44.322358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.965 seconds
[0m13:46:44.324360 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:46:44.341545 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.984 seconds
[0m13:46:44.342541 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:46:44.455676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:46:44.457680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:46:44.465685 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:46:44.468680 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:46:44.468680 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:46:44.469674 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:46:44.470672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:44.470672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:45.149898 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m13:46:45.150897 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:46:45.171448 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.701 seconds
[0m13:46:45.173473 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:46:45.283868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244866823C0>]}
[0m13:46:45.284874 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:46:45.285861 [info ] [MainThread]: 
[0m13:46:45.292860 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:46:45.293861 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:46:45.294863 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:46:45.295865 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:46:45.302859 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:46:45.304863 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:46:45.333857 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:46:45.335861 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:46:45.336862 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:46:45.336862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:46.009909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m13:46:46.031433 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:46:46.144426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024486641FA0>]}
[0m13:46:46.146433 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m13:46:46.147431 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:46:46.148432 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:46:46.149437 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:46:46.150429 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:46:46.150429 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:46:46.155439 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:46:46.156428 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:46:46.178429 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:46:46.181426 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:46:46.182428 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE('goods_title_link', 'Unknown') AS title,
        COALESCE('GOODS_TITLE_LINK_JUMP', 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE('PRICE($)', COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE('BLACKFRIDAYBELTS_CONTENT(Save $)', 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:46:46.182428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:46:48.645360 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671a-0000-fcd1-0001-4c5e000d3042
[0m13:46:48.646360 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'PRICE($)' is not recognized
[0m13:46:48.646360 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:46:48.777912 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  100038 (22018): Numeric value 'PRICE($)' is not recognized
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:46:48.778909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f9abc8-fc6b-4fb8-b158-e0ea373bb498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488235640>]}
[0m13:46:48.779911 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 2.63s]
[0m13:46:48.780914 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:46:48.783900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:48.784905 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:46:48.784905 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:46:48.785913 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:46:48.785913 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:46:48.786908 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:46:48.786908 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:46:48.787911 [info ] [MainThread]: 
[0m13:46:48.788909 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m13:46:48.790894 [debug] [MainThread]: Command end result
[0m13:46:48.821895 [info ] [MainThread]: 
[0m13:46:48.822894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:48.823894 [info ] [MainThread]: 
[0m13:46:48.824894 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  100038 (22018): Numeric value 'PRICE($)' is not recognized
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:46:48.825895 [info ] [MainThread]: 
[0m13:46:48.826892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:46:48.828897 [debug] [MainThread]: Command `dbt run` failed at 13:46:48.828897 after 7.78 seconds
[0m13:46:48.829893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EC9A6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244ED54B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244ED549940>]}
[0m13:46:48.830895 [debug] [MainThread]: Flushing usage events
[0m13:47:20.791412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197A195B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19D52A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19D52A540>]}


============================== 13:47:20.797605 | 86c1f7ef-77df-48b0-84c5-b98e751dcb8c ==============================
[0m13:47:20.797605 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:47:20.798603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:47:21.880617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B587C170>]}
[0m13:47:21.924183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B6B9B170>]}
[0m13:47:21.926257 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:22.248365 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:47:22.423003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:22.424002 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:47:22.625574 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:22.626572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19DBDBD40>]}
[0m13:47:22.766711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B81FD850>]}
[0m13:47:22.862714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B7008D70>]}
[0m13:47:22.863714 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:47:22.864717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B70AA4E0>]}
[0m13:47:22.865711 [info ] [MainThread]: 
[0m13:47:22.866710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:22.871712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:22.884709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:22.887718 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:22.890802 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:22.891813 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:22.891813 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:22.892813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:22.892813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:23.738263 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.845 seconds
[0m13:47:23.740268 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:23.758526 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.866 seconds
[0m13:47:23.760525 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:23.883372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:47:23.885376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:47:23.892396 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:47:23.895384 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:47:23.896391 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:47:23.897388 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:47:23.897388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:23.898386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:24.755814 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.858 seconds
[0m13:47:24.758816 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:47:24.782121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.885 seconds
[0m13:47:24.784121 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:47:24.915506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B82920C0>]}
[0m13:47:24.916510 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:47:24.917508 [info ] [MainThread]: 
[0m13:47:24.922811 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:47:24.923815 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:47:24.924814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:47:24.925814 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:47:24.931824 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:47:24.933824 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:47:24.958812 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:47:24.960819 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:47:24.960819 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:47:24.961819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:25.753938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m13:47:25.774938 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:47:25.883245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B6CD23F0>]}
[0m13:47:25.884250 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.96s]
[0m13:47:25.885251 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:47:25.886251 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:47:25.887251 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:47:25.888246 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:47:25.889267 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:47:25.893252 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:47:25.894266 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:47:25.915812 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:47:25.918810 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:47:25.919797 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE("goods_title_link", 'Unknown') AS title,
        COALESCE("GOODS_TITLE_LINK_JUMP", 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE('BLACKFRIDAYBELTS_CONTENT(Save $)', 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:47:25.919797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:26.541933 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671b-0000-fd16-0001-4c5e000d203e
[0m13:47:26.541933 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier '"goods_title_link"'
[0m13:47:26.542933 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:47:26.654186 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:47:26.655191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c1f7ef-77df-48b0-84c5-b98e751dcb8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B8896AE0>]}
[0m13:47:26.656192 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.77s]
[0m13:47:26.657194 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:47:26.659183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:26.660186 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:47:26.660186 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:47:26.661191 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:47:26.662187 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:47:26.662187 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:47:26.662187 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:47:26.663186 [info ] [MainThread]: 
[0m13:47:26.664188 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m13:47:26.665181 [debug] [MainThread]: Command end result
[0m13:47:26.694186 [info ] [MainThread]: 
[0m13:47:26.695179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:26.696193 [info ] [MainThread]: 
[0m13:47:26.697187 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:47:26.698179 [info ] [MainThread]: 
[0m13:47:26.699177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:47:26.701179 [debug] [MainThread]: Command `dbt run` failed at 13:47:26.701179 after 6.02 seconds
[0m13:47:26.702179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19D07B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197B990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B83EDBB0>]}
[0m13:47:26.702179 [debug] [MainThread]: Flushing usage events
[0m13:47:31.402517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D5EAC140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D53B6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D8580860>]}


============================== 13:47:31.406513 | f3d89156-703b-4dca-91be-9826304b8af9 ==============================
[0m13:47:31.406513 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:47:31.407512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:47:32.338876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D68DCB30>]}
[0m13:47:32.384884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D7D1B5C0>]}
[0m13:47:32.386885 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:32.691813 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:47:32.855566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:32.856577 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:47:33.058243 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:33.059430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F31A96D0>]}
[0m13:47:33.179459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F352B230>]}
[0m13:47:33.269080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F20B83B0>]}
[0m13:47:33.270137 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:47:33.270137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3524E60>]}
[0m13:47:33.272141 [info ] [MainThread]: 
[0m13:47:33.273137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:33.277712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:33.289740 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:33.290743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:33.291742 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:33.294739 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:33.294739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:33.295739 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:33.298733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:33.979373 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.680 seconds
[0m13:47:33.980376 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:34.097366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.803 seconds
[0m13:47:34.099359 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:34.222437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:47:34.224447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:47:34.232452 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:47:34.234452 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:47:34.235452 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:47:34.236452 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:47:34.236452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:34.237452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:35.004442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.767 seconds
[0m13:47:35.006443 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:47:35.019500 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.782 seconds
[0m13:47:35.021493 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:47:35.137062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3319E50>]}
[0m13:47:35.138067 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:47:35.139053 [info ] [MainThread]: 
[0m13:47:35.145063 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:47:35.145063 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:47:35.147059 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:47:35.148055 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:47:35.155062 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:47:35.156062 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:47:35.183621 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:47:35.185621 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:47:35.185621 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:47:35.186621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:35.856721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m13:47:35.876726 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:47:35.987685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F1D62210>]}
[0m13:47:35.988691 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m13:47:35.990873 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:47:35.991866 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:47:35.992857 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:47:35.993868 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:47:35.993868 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:47:35.997871 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:47:35.998871 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:47:36.019872 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:47:36.022867 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:47:36.023868 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE("goods_title_link", 'Unknown') AS title,
        COALESCE("GOODS_TITLE_LINK_JUMP", 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:47:36.024857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:36.672183 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671b-0000-fd0b-0001-4c5e000ce13a
[0m13:47:36.672183 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier '"goods_title_link"'
[0m13:47:36.673104 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:47:36.801356 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:47:36.802356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d89156-703b-4dca-91be-9826304b8af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F38FB5C0>]}
[0m13:47:36.803356 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.81s]
[0m13:47:36.804358 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:47:36.806345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:36.807357 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:47:36.807357 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:47:36.807357 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:47:36.808352 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:47:36.808352 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:47:36.809351 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:47:36.809351 [info ] [MainThread]: 
[0m13:47:36.810356 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m13:47:36.811342 [debug] [MainThread]: Command end result
[0m13:47:36.840356 [info ] [MainThread]: 
[0m13:47:36.842345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:36.843359 [info ] [MainThread]: 
[0m13:47:36.843359 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:47:36.844353 [info ] [MainThread]: 
[0m13:47:36.845346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:47:36.848343 [debug] [MainThread]: Command `dbt run` failed at 13:47:36.847345 after 5.54 seconds
[0m13:47:36.848343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1D5EAC140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F1EECDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F1E91FD0>]}
[0m13:47:36.849342 [debug] [MainThread]: Flushing usage events
[0m13:47:56.961582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E3D2EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E66110A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E65DDFA0>]}


============================== 13:47:56.966586 | 98e51b3b-eda5-4801-9799-2afe0b5b4d60 ==============================
[0m13:47:56.966586 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:47:56.967601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:57.889751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FF460A40>]}
[0m13:47:57.933268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E3E85340>]}
[0m13:47:57.935269 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:58.243391 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:47:58.408028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:58.409030 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:47:58.612227 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:58.613303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFD93D70>]}
[0m13:47:58.734253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFE0FA40>]}
[0m13:47:58.825069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFF49820>]}
[0m13:47:58.826068 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:47:58.827068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFF8AD80>]}
[0m13:47:58.828068 [info ] [MainThread]: 
[0m13:47:58.829282 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:58.833306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:58.834315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:47:58.847307 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:58.849306 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:47:58.850311 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:58.851312 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:47:58.851312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:58.852329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.744539 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.892 seconds
[0m13:47:59.746056 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:59.761271 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.909 seconds
[0m13:47:59.763266 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:47:59.895134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:47:59.897164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:47:59.905161 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:47:59.907188 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:47:59.908177 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:47:59.908177 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:47:59.909190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.910189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:00.659136 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.749 seconds
[0m13:48:00.661140 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:48:00.684305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.775 seconds
[0m13:48:00.685303 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:48:00.957488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024581270590>]}
[0m13:48:00.958525 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:48:00.959489 [info ] [MainThread]: 
[0m13:48:00.965081 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:48:00.965081 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:48:00.966078 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:48:00.967077 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:48:00.974084 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:48:00.976072 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:48:01.002080 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:48:01.003073 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:48:01.004081 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:48:01.005080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:01.782318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m13:48:01.802322 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:48:01.914505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FF792180>]}
[0m13:48:01.914505 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.95s]
[0m13:48:01.915756 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:48:01.916787 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:48:01.917788 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:48:01.918783 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:48:01.919783 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:48:01.924321 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:48:01.925321 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:48:01.946316 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:48:01.949316 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:48:01.949316 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:48:01.950316 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:48:02.730951 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671c-0000-fd18-0001-4c5e000d401e
[0m13:48:02.730951 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier 'GOODS_TITLE_LINK'
[0m13:48:02.731971 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:48:02.844419 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:48:02.844419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e51b3b-eda5-4801-9799-2afe0b5b4d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245813869F0>]}
[0m13:48:02.845425 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.93s]
[0m13:48:02.846406 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:48:02.849413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:02.849413 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:48:02.850419 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:48:02.850419 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:48:02.851416 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:48:02.851416 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:48:02.851416 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:48:02.852420 [info ] [MainThread]: 
[0m13:48:02.853412 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m13:48:02.854286 [debug] [MainThread]: Command end result
[0m13:48:02.883309 [info ] [MainThread]: 
[0m13:48:02.884303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:48:02.885316 [info ] [MainThread]: 
[0m13:48:02.886311 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:48:02.887307 [info ] [MainThread]: 
[0m13:48:02.888095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:48:02.890123 [debug] [MainThread]: Command `dbt run` failed at 13:48:02.889120 after 6.03 seconds
[0m13:48:02.890123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E5B1B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFDDA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245FFED9A00>]}
[0m13:48:02.891127 [debug] [MainThread]: Flushing usage events
[0m13:48:38.329011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFD9D3CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDBDEA540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDBDEBFE0>]}


============================== 13:48:38.332926 | 0426ed7d-9169-4d73-b917-4600baa90f8b ==============================
[0m13:48:38.332926 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:48:38.334927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:48:39.367069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF438D0A0>]}
[0m13:48:39.415103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF569BC20>]}
[0m13:48:39.416101 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:48:39.742202 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:48:39.923261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:39.924261 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:48:40.120900 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:48:40.121888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6CA7290>]}
[0m13:48:40.244904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDC626240>]}
[0m13:48:40.337482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6EB3350>]}
[0m13:48:40.337482 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:48:40.338478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDA3A6690>]}
[0m13:48:40.340471 [info ] [MainThread]: 
[0m13:48:40.341469 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:48:40.345480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:48:40.346989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:48:40.360006 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:48:40.363009 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:48:40.364002 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:48:40.364002 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:48:40.365002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:40.365002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:41.214288 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.849 seconds
[0m13:48:41.215296 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.851 seconds
[0m13:48:41.217298 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:48:41.218300 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:48:41.343089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:48:41.345101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:48:41.353109 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:48:41.356090 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:48:41.357089 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:48:41.358098 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:48:41.359093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:41.359093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:42.177658 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.818 seconds
[0m13:48:42.178658 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:48:42.240598 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.882 seconds
[0m13:48:42.242596 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:48:42.352352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF5762330>]}
[0m13:48:42.352352 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:48:42.353354 [info ] [MainThread]: 
[0m13:48:42.359354 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:48:42.360351 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:48:42.362354 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:48:42.362354 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:48:42.369339 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:48:42.370339 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:48:42.396341 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:48:42.398340 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:48:42.399353 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:48:42.399353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:43.196631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m13:48:43.216630 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:48:43.335082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF5721F40>]}
[0m13:48:43.336085 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m13:48:43.337069 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:48:43.338070 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:48:43.339068 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:48:43.340067 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:48:43.340067 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:48:43.345079 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:48:43.346078 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:48:43.371079 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:48:43.375077 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:48:43.376074 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE("goods_title_link", 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:48:43.377071 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:48:44.008209 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671c-0000-fcd1-0001-4c5e000d3056
[0m13:48:44.009210 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier '"goods_title_link"'
[0m13:48:44.009210 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:48:44.123301 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:48:44.123301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0426ed7d-9169-4d73-b917-4600baa90f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF72DB620>]}
[0m13:48:44.124307 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.78s]
[0m13:48:44.125298 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:48:44.128291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:44.129294 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:48:44.129294 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:48:44.129294 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:48:44.130293 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:48:44.130293 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:48:44.131293 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:48:44.131293 [info ] [MainThread]: 
[0m13:48:44.132292 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m13:48:44.133291 [debug] [MainThread]: Command end result
[0m13:48:44.162293 [info ] [MainThread]: 
[0m13:48:44.163293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:48:44.164299 [info ] [MainThread]: 
[0m13:48:44.165291 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier '"goods_title_link"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:48:44.167302 [info ] [MainThread]: 
[0m13:48:44.169296 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:48:44.171298 [debug] [MainThread]: Command `dbt run` failed at 13:48:44.171298 after 5.95 seconds
[0m13:48:44.172298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDBD05B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF6E3DB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDC7425A0>]}
[0m13:48:44.173296 [debug] [MainThread]: Flushing usage events
[0m13:49:01.351461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2C3B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2BA6F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2BA5B20>]}


============================== 13:49:01.355561 | b927968a-d422-41cc-bcc6-12fdaf42a236 ==============================
[0m13:49:01.355561 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:01.356555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:02.403212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2C3B410>]}
[0m13:49:02.448762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BA9E7E60>]}
[0m13:49:02.450748 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:49:02.768921 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:49:02.946951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:02.946951 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:49:03.164698 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:49:03.166700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD337C20>]}
[0m13:49:03.294701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD37A0C0>]}
[0m13:49:03.387270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD49D850>]}
[0m13:49:03.388276 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:49:03.388276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD28EA80>]}
[0m13:49:03.390276 [info ] [MainThread]: 
[0m13:49:03.391277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:49:03.395279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:49:03.409279 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:49:03.410269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:49:03.411274 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:49:03.413274 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:49:03.414279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:03.415277 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:49:03.418274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:04.349790 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.935 seconds
[0m13:49:04.351352 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:49:04.368573 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.950 seconds
[0m13:49:04.370568 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:49:04.504240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:49:04.506253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:49:04.513253 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:49:04.516253 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:49:04.517244 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:49:04.517244 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:49:04.518249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:04.519249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:05.291902 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.774 seconds
[0m13:49:05.293908 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:49:05.308646 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.790 seconds
[0m13:49:05.310659 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:49:05.431454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BBD4E600>]}
[0m13:49:05.432486 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:49:05.432486 [info ] [MainThread]: 
[0m13:49:05.438231 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:49:05.439233 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:49:05.440225 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:49:05.441236 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:49:05.447761 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:49:05.449749 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:49:05.475755 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:49:05.477764 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:49:05.478772 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:49:05.478772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:06.311933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m13:49:06.333261 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:49:06.448135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BBD121B0>]}
[0m13:49:06.449136 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.01s]
[0m13:49:06.450239 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:49:06.451447 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:49:06.452440 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:49:06.453440 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:49:06.454432 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:49:06.458445 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:49:06.459952 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:49:06.481377 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:49:06.484394 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:49:06.485394 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:49:06.486396 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:07.243911 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba671d-0000-fd16-0001-4c5e000d204a
[0m13:49:07.243911 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 17
invalid identifier 'GOODS_TITLE_LINK'
[0m13:49:07.244906 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:49:07.359139 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:49:07.359139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b927968a-d422-41cc-bcc6-12fdaf42a236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD7D6690>]}
[0m13:49:07.360139 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.91s]
[0m13:49:07.361328 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:49:07.364322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:07.365315 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:49:07.365315 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:49:07.365315 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:49:07.366320 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:49:07.366320 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:49:07.366320 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:49:07.367320 [info ] [MainThread]: 
[0m13:49:07.368540 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m13:49:07.368540 [debug] [MainThread]: Command end result
[0m13:49:07.400714 [info ] [MainThread]: 
[0m13:49:07.401734 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:07.402739 [info ] [MainThread]: 
[0m13:49:07.403734 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 29 at position 17
  invalid identifier 'GOODS_TITLE_LINK'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:49:07.404733 [info ] [MainThread]: 
[0m13:49:07.404733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:49:07.406726 [debug] [MainThread]: Command `dbt run` failed at 13:49:07.406726 after 6.16 seconds
[0m13:49:07.407732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A1BD9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2BD42DA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2DC06B0>]}
[0m13:49:07.407732 [debug] [MainThread]: Flushing usage events
[0m13:49:30.099682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1980CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1CBF9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1CBFA480>]}


============================== 13:49:30.106357 | c5a122fc-6b18-47b4-bbf8-7e585abc5646 ==============================
[0m13:49:30.106357 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:30.107482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:49:31.164051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1D6E3830>]}
[0m13:49:31.209051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC36276E40>]}
[0m13:49:31.211465 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:49:31.555051 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:49:31.751084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:31.752086 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:49:31.949690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:49:31.950676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3595D820>]}
[0m13:49:32.079997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC366DB500>]}
[0m13:49:32.169937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC36868080>]}
[0m13:49:32.170942 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:49:32.171934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37AF3B00>]}
[0m13:49:32.172937 [info ] [MainThread]: 
[0m13:49:32.173936 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:49:32.178479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:49:32.193030 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:49:32.194027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:49:32.195026 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:49:32.198024 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:49:32.199116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:32.199116 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:49:32.202122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:33.185485 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.983 seconds
[0m13:49:33.186485 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:49:33.192906 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.994 seconds
[0m13:49:33.194905 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:49:33.301419 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:49:33.303422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:49:33.311959 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:49:33.313947 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:49:33.315384 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:49:33.316410 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:49:33.316410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:33.317410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:34.106725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.790 seconds
[0m13:49:34.110273 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:49:34.136142 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.820 seconds
[0m13:49:34.138671 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:49:34.251397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37BB7B90>]}
[0m13:49:34.251397 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:49:34.252431 [info ] [MainThread]: 
[0m13:49:34.258659 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:49:34.259673 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:49:34.260692 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:49:34.261692 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:49:34.268218 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:49:34.269230 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:49:34.298368 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:49:34.300394 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:49:34.301397 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:49:34.302393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:34.996369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m13:49:35.016460 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:49:35.123514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC365320C0>]}
[0m13:49:35.124516 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m13:49:35.125463 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:49:35.126483 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:49:35.127491 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:49:35.128491 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:49:35.129677 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:49:35.133692 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:49:35.134771 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:49:35.157301 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:49:35.160459 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:49:35.161458 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:49:35.162455 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:37.316981 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.154 seconds
[0m13:49:37.318496 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:49:37.434249 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a122fc-6b18-47b4-bbf8-7e585abc5646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC380B7650>]}
[0m13:49:37.435249 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.31s]
[0m13:49:37.436318 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:49:37.438238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:37.439322 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:49:37.439322 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:49:37.439322 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:49:37.440320 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:49:37.440320 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:49:37.441319 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:49:37.441319 [info ] [MainThread]: 
[0m13:49:37.442325 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m13:49:37.443331 [debug] [MainThread]: Command end result
[0m13:49:37.472526 [info ] [MainThread]: 
[0m13:49:37.473530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:37.474523 [info ] [MainThread]: 
[0m13:49:37.475529 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:49:37.477530 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:37.477530 after 7.48 seconds
[0m13:49:37.478520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1980CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC37A96690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1D2ECCB0>]}
[0m13:49:37.479040 [debug] [MainThread]: Flushing usage events
[0m13:53:37.227097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CA747290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CA747B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CA747E60>]}


============================== 13:53:37.231096 | 46334477-e5b6-402d-9de9-1ee8b84090be ==============================
[0m13:53:37.231096 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:53:37.232095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:38.267884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E2A2D940>]}
[0m13:53:38.314565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234C97B4B90>]}
[0m13:53:38.316332 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:53:38.627150 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:53:38.791004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:38.792007 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:53:38.991913 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:53:38.992780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E4B79A90>]}
[0m13:53:39.116882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E4DBB020>]}
[0m13:53:39.212993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E3903830>]}
[0m13:53:39.212993 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:53:39.214006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E3949550>]}
[0m13:53:39.215995 [info ] [MainThread]: 
[0m13:53:39.216993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:39.220707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:53:39.227721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:53:39.234265 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:53:39.237287 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:53:39.238275 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:53:39.239276 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:53:39.240268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:39.241277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:40.132056 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.892 seconds
[0m13:53:40.133583 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:53:40.147811 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.906 seconds
[0m13:53:40.149811 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:53:40.281160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:53:40.282164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:53:40.290165 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:53:40.293156 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:53:40.294149 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:53:40.295160 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:53:40.296148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:40.296148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:40.969813 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.673 seconds
[0m13:53:40.971824 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:53:41.142669 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.847 seconds
[0m13:53:41.144671 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:53:41.271864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E4C420C0>]}
[0m13:53:41.272866 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:53:41.274014 [info ] [MainThread]: 
[0m13:53:41.279042 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:53:41.280033 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:53:41.281034 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:53:41.282049 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:53:41.290048 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:53:41.292047 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:53:41.330075 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:53:41.332072 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:53:41.332072 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:53:41.333071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:42.038830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m13:53:42.061855 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:53:42.174226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E35F22A0>]}
[0m13:53:42.174226 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.89s]
[0m13:53:42.175749 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:53:42.176767 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:53:42.177774 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:53:42.178773 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:53:42.179778 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:53:42.183777 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:53:42.185144 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:53:42.207154 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:53:42.210152 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:53:42.211152 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:53:42.212158 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:53:42.964666 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6721-0000-fd29-0001-4c5e000d1066
[0m13:53:42.965666 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 261 unexpected 'as'.
[0m13:53:42.965666 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:53:43.090431 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 261 unexpected 'as'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:53:43.091434 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46334477-e5b6-402d-9de9-1ee8b84090be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E51745C0>]}
[0m13:53:43.092546 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.91s]
[0m13:53:43.093435 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:53:43.095423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:43.096942 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:53:43.096942 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:53:43.096942 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:53:43.097959 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:53:43.097959 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:53:43.098950 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:53:43.098950 [info ] [MainThread]: 
[0m13:53:43.099963 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m13:53:43.100952 [debug] [MainThread]: Command end result
[0m13:53:43.130958 [info ] [MainThread]: 
[0m13:53:43.131961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:53:43.132960 [info ] [MainThread]: 
[0m13:53:43.132960 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 261 unexpected 'as'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:53:43.133969 [info ] [MainThread]: 
[0m13:53:43.135492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:53:43.137502 [debug] [MainThread]: Command `dbt run` failed at 13:53:43.137502 after 6.03 seconds
[0m13:53:43.137502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234E376DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CA332990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234CA332930>]}
[0m13:53:43.138504 [debug] [MainThread]: Flushing usage events
[0m13:54:03.894245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021304F1EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021307210170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213078FB410>]}


============================== 13:54:03.899075 | 20c50ba8-e011-46e0-a07b-ea756c523888 ==============================
[0m13:54:03.899075 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:54:03.900073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:04.972253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021307923380>]}
[0m13:54:05.016515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131FD2D6D0>]}
[0m13:54:05.018516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:54:05.339479 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:54:05.509044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:05.510044 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m13:54:05.710355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:54:05.712353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213206F5640>]}
[0m13:54:05.834728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021321E33440>]}
[0m13:54:05.928029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021320C39F40>]}
[0m13:54:05.928744 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m13:54:05.929740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213220CB950>]}
[0m13:54:05.930735 [info ] [MainThread]: 
[0m13:54:05.931744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:54:05.936266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:54:05.948814 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:54:05.949814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m13:54:05.950816 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:54:05.952818 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m13:54:05.954377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:05.954377 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m13:54:05.957335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:06.850416 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.893 seconds
[0m13:54:06.852405 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:54:06.866840 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.913 seconds
[0m13:54:06.868860 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m13:54:06.994478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m13:54:06.996498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m13:54:07.004496 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m13:54:07.007025 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m13:54:07.007025 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m13:54:07.008022 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m13:54:07.008022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:07.009036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:07.682582 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.675 seconds
[0m13:54:07.685120 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.676 seconds
[0m13:54:07.686122 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m13:54:07.688111 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m13:54:08.052630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213221A57F0>]}
[0m13:54:08.052630 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:54:08.054148 [info ] [MainThread]: 
[0m13:54:08.059216 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m13:54:08.060207 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m13:54:08.062213 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m13:54:08.062213 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m13:54:08.070768 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m13:54:08.072759 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m13:54:08.110440 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m13:54:08.112441 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m13:54:08.113440 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m13:54:08.113440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:54:08.804165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m13:54:08.825798 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m13:54:08.939601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213208EA450>]}
[0m13:54:08.940604 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.88s]
[0m13:54:08.942602 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m13:54:08.943599 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m13:54:08.943599 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m13:54:08.945122 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m13:54:08.946140 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m13:54:08.951144 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m13:54:08.952134 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m13:54:08.977725 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m13:54:08.981726 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m13:54:08.982729 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS color-count,
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m13:54:08.982729 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:54:09.673085 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6722-0000-fd24-0001-4c5e000d6056
[0m13:54:09.674592 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 41 unexpected '-'.
syntax error line 38 at position 53 unexpected '0'.
syntax error line 38 at position 59 unexpected 'blackfriday_savings'.
syntax error line 39 at position 4 unexpected 'FROM'.
syntax error line 41 at position 0 unexpected 'SELECT'.
[0m13:54:09.675598 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m13:54:09.790275 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 41 unexpected '-'.
  syntax error line 38 at position 53 unexpected '0'.
  syntax error line 38 at position 59 unexpected 'blackfriday_savings'.
  syntax error line 39 at position 4 unexpected 'FROM'.
  syntax error line 41 at position 0 unexpected 'SELECT'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:54:09.791275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20c50ba8-e011-46e0-a07b-ea756c523888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213224E8C50>]}
[0m13:54:09.792274 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.85s]
[0m13:54:09.794275 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m13:54:09.796787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:09.797789 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:54:09.797789 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m13:54:09.798791 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m13:54:09.799789 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m13:54:09.799789 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m13:54:09.800788 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m13:54:09.801790 [info ] [MainThread]: 
[0m13:54:09.802793 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m13:54:09.805313 [debug] [MainThread]: Command end result
[0m13:54:09.837520 [info ] [MainThread]: 
[0m13:54:09.838522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:09.839521 [info ] [MainThread]: 
[0m13:54:09.840819 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 41 unexpected '-'.
  syntax error line 38 at position 53 unexpected '0'.
  syntax error line 38 at position 59 unexpected 'blackfriday_savings'.
  syntax error line 39 at position 4 unexpected 'FROM'.
  syntax error line 41 at position 0 unexpected 'SELECT'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m13:54:09.842820 [info ] [MainThread]: 
[0m13:54:09.844335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:54:09.846344 [debug] [MainThread]: Command `dbt run` failed at 13:54:09.846344 after 6.06 seconds
[0m13:54:09.847344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021304F1EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021320C55F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021320D723C0>]}
[0m13:54:09.849353 [debug] [MainThread]: Flushing usage events
[0m14:04:56.202526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E744B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E7449F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E744B680>]}


============================== 14:04:56.207359 | 55cd3523-3492-4549-9124-9dccc0f9ed39 ==============================
[0m14:04:56.207359 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:04:56.208354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:57.285745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223FF165DF0>]}
[0m14:04:57.331730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223806050A0>]}
[0m14:04:57.333734 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:04:57.644727 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:04:57.817285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:57.817285 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:04:58.004857 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:58.005857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381B03EF0>]}
[0m14:04:58.124394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381B03380>]}
[0m14:04:58.216709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223808537D0>]}
[0m14:04:58.217710 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:04:58.218711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381D0AD80>]}
[0m14:04:58.219715 [info ] [MainThread]: 
[0m14:04:58.220711 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:58.224712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:04:58.237713 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:04:58.238712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:04:58.238712 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:04:58.241707 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:04:58.242713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:58.243711 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:04:58.245715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:59.371118 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.125 seconds
[0m14:04:59.372127 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:04:59.382687 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.140 seconds
[0m14:04:59.384683 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:04:59.632624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:04:59.633618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:04:59.642624 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:04:59.644624 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:04:59.645618 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:04:59.645618 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:04:59.646624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:59.646624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:00.344256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.697 seconds
[0m14:05:00.345251 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:05:00.512363 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.866 seconds
[0m14:05:00.514355 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:05:00.629298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381BC18B0>]}
[0m14:05:00.630108 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:05:00.632097 [info ] [MainThread]: 
[0m14:05:00.637416 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:05:00.638415 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:05:00.639415 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:05:00.640418 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:05:00.646417 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:05:00.647415 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:05:00.674423 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:05:00.676422 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:05:00.677421 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:05:00.678420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:01.382382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m14:05:01.403384 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:05:01.570354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022380542180>]}
[0m14:05:01.571358 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.93s]
[0m14:05:01.572343 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:05:01.573464 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:05:01.574480 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:05:01.575580 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:05:01.575580 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:05:01.580604 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:05:01.581600 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:05:01.602163 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:05:01.605163 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:05:01.606154 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH unique_record AS (
    SELECT 
        DISTINCT *
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
),
clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM unique_record
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM null_filled
        );
[0m14:05:01.607160 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:05.537049 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.930 seconds
[0m14:05:05.540050 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:05:05.658062 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cd3523-3492-4549-9124-9dccc0f9ed39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381B92D50>]}
[0m14:05:05.660065 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.08s]
[0m14:05:05.661053 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:05:05.663048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.664063 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:05:05.664063 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:05:05.665059 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:05:05.665059 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:05:05.666047 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:05:05.666047 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:05:05.666047 [info ] [MainThread]: 
[0m14:05:05.667313 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:05:05.669338 [debug] [MainThread]: Command end result
[0m14:05:05.698341 [info ] [MainThread]: 
[0m14:05:05.699342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:05.700346 [info ] [MainThread]: 
[0m14:05:05.701327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:05.703340 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:05.702338 after 9.64 seconds
[0m14:05:05.703340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381C3C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381B67890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381B75EB0>]}
[0m14:05:05.704339 [debug] [MainThread]: Flushing usage events
[0m14:11:05.834289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F23497C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F00AEAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F23B90A0>]}


============================== 14:11:05.839289 | 7997ff0f-3235-4c92-b381-451cf330b31d ==============================
[0m14:11:05.839289 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:11:05.840182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:06.912597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FF16D0A0>]}
[0m14:11:06.959598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FFBDCE60>]}
[0m14:11:06.961593 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:11:07.285396 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:11:07.456398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:07.457398 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:11:07.654636 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:07.656631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FFCDCD10>]}
[0m14:11:07.785682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998D1884D0>]}
[0m14:11:07.879543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FFEBBC50>]}
[0m14:11:07.880542 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:11:07.881552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F1BC5520>]}
[0m14:11:07.882553 [info ] [MainThread]: 
[0m14:11:07.883557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:07.888548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:11:07.901546 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:11:07.902554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:11:07.902554 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:11:07.905551 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:11:07.905551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:07.906815 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:11:07.909572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:09.107442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.198 seconds
[0m14:11:09.109448 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:11:09.120433 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.215 seconds
[0m14:11:09.122436 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:11:09.240698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:11:09.242699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:11:09.250694 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:11:09.253694 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:11:09.254694 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:11:09.254694 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:11:09.255699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:09.255699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:09.968474 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m14:11:09.970471 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:11:10.114198 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.858 seconds
[0m14:11:10.116197 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:11:10.229525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FFB9E5A0>]}
[0m14:11:10.230523 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:11:10.231514 [info ] [MainThread]: 
[0m14:11:10.237101 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:11:10.238112 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:11:10.239116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:11:10.240106 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:11:10.247107 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:11:10.248104 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:11:10.274102 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:11:10.276104 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:11:10.277102 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:11:10.277102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:11.186186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m14:11:11.206197 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:11:11.319495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299FFB620F0>]}
[0m14:11:11.320486 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.08s]
[0m14:11:11.321492 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:11:11.322492 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:11:11.323484 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:11:11.324497 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:11:11.324497 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:11:11.329487 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:11:11.330491 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:11:11.351481 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:11:11.354484 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:11:11.355484 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT(*)
FROM null_filled
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows
        );
[0m14:11:11.355484 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:11:12.078411 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6733-0000-fd16-0001-4c5e000d206e
[0m14:11:12.079421 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 13 unexpected '*'.
syntax error line 42 at position 349 unexpected 'as'.
[0m14:11:12.079421 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:11:12.222434 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  syntax error line 42 at position 349 unexpected 'as'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:11:12.222434 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7997ff0f-3235-4c92-b381-451cf330b31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998D857140>]}
[0m14:11:12.223439 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.90s]
[0m14:11:12.224434 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:11:12.226948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:12.227959 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:11:12.227959 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:11:12.228968 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:11:12.228968 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:11:12.229969 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:11:12.229969 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:11:12.230968 [info ] [MainThread]: 
[0m14:11:12.230968 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m14:11:12.232971 [debug] [MainThread]: Command end result
[0m14:11:12.261528 [info ] [MainThread]: 
[0m14:11:12.262531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:12.263532 [info ] [MainThread]: 
[0m14:11:12.264404 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  syntax error line 42 at position 349 unexpected 'as'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:11:12.265419 [info ] [MainThread]: 
[0m14:11:12.265419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:11:12.267933 [debug] [MainThread]: Command `dbt run` failed at 14:11:12.266984 after 6.58 seconds
[0m14:11:12.267933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F29952E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299F21351C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002998D133EC0>]}
[0m14:11:12.268936 [debug] [MainThread]: Flushing usage events
[0m14:11:49.793365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114CF01EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D0B27140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D0B24CB0>]}


============================== 14:11:49.797938 | 45f5b0a4-699c-47bb-988d-28f884bbef8c ==============================
[0m14:11:49.797938 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:11:49.798847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:11:50.871500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D1BD90A0>]}
[0m14:11:50.926865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D08FE0C0>]}
[0m14:11:50.928369 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:11:51.248129 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:11:51.427196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:51.428195 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:11:51.626162 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:51.627153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D0BD4B90>]}
[0m14:11:51.750985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EC1148C0>]}
[0m14:11:51.840870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EADB3920>]}
[0m14:11:51.841870 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:11:51.841870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EC26B290>]}
[0m14:11:51.843873 [info ] [MainThread]: 
[0m14:11:51.844860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:51.849407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:11:51.862365 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:11:51.863365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:11:51.863365 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:11:51.866370 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:11:51.866370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:51.867885 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:11:51.870903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:52.804394 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m14:11:52.806390 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:11:52.818472 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.952 seconds
[0m14:11:52.820498 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:11:53.078104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:11:53.080090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:11:53.087090 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:11:53.090317 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:11:53.090317 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:11:53.091305 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:11:53.092321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:53.092321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:53.886358 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.795 seconds
[0m14:11:53.888034 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:11:53.902115 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.809 seconds
[0m14:11:53.903114 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:11:54.015260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EC31FF80>]}
[0m14:11:54.016293 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:11:54.017288 [info ] [MainThread]: 
[0m14:11:54.022831 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:11:54.023853 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:11:54.024839 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:11:54.024839 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:11:54.032375 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:11:54.033373 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:11:54.059507 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:11:54.061507 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:11:54.062505 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:11:54.062505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:54.750175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m14:11:54.770266 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:11:54.882443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EABD2060>]}
[0m14:11:54.883447 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m14:11:54.885448 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:11:54.886454 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:11:54.886454 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:11:54.887971 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:11:54.887971 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:11:54.892981 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:11:54.893989 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:11:54.916051 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:11:54.919566 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:11:54.920587 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT(*)
FROM null_filled
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows
        );
[0m14:11:54.921589 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:11:55.632193 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6733-0000-fd24-0001-4c5e000d607e
[0m14:11:55.633193 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 13 unexpected '*'.
[0m14:11:55.634183 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:11:55.750864 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:11:55.751866 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f5b0a4-699c-47bb-988d-28f884bbef8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EC626DB0>]}
[0m14:11:55.751866 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.86s]
[0m14:11:55.752921 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:11:55.755948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:55.755948 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:11:55.756947 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:11:55.756947 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:11:55.756947 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:11:55.758464 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:11:55.758464 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:11:55.758464 [info ] [MainThread]: 
[0m14:11:55.759482 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m14:11:55.761472 [debug] [MainThread]: Command end result
[0m14:11:55.790066 [info ] [MainThread]: 
[0m14:11:55.791050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:55.792058 [info ] [MainThread]: 
[0m14:11:55.793051 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:11:55.794051 [info ] [MainThread]: 
[0m14:11:55.795091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:11:55.797127 [debug] [MainThread]: Command `dbt run` failed at 14:11:55.796123 after 6.11 seconds
[0m14:11:55.797127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114D16FFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EAE7D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114EC072540>]}
[0m14:11:55.798121 [debug] [MainThread]: Flushing usage events
[0m14:12:26.978472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D5A7C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D9270170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D9593B30>]}


============================== 14:12:26.981789 | 2b37efde-ef0f-4f6e-91c4-a096f215bfe0 ==============================
[0m14:12:26.981789 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:12:26.983384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:27.998367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F1635940>]}
[0m14:12:28.045863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D86A42C0>]}
[0m14:12:28.047955 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:12:28.363849 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:12:28.519180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:28.520181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:28.549350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D8E117C0>]}
[0m14:12:28.658548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F28D9310>]}
[0m14:12:28.659548 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:12:28.660546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D96A0500>]}
[0m14:12:28.664068 [info ] [MainThread]: 
[0m14:12:28.665089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:28.670618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:12:28.671612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:12:28.688621 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:12:28.691622 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:12:28.691622 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:12:28.693190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:12:28.694148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:28.695145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:29.633506 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.938 seconds
[0m14:12:29.635052 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:12:29.639043 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.945 seconds
[0m14:12:29.641038 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:12:29.757621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:12:29.759627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:12:29.766172 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:12:29.769710 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:12:29.770712 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:12:29.771713 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:12:29.771713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:29.772722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:30.423492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.652 seconds
[0m14:12:30.425647 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:12:30.549494 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.777 seconds
[0m14:12:30.550494 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:12:30.667375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F1AFF140>]}
[0m14:12:30.668380 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:12:30.668907 [info ] [MainThread]: 
[0m14:12:30.675469 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:12:30.675469 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:12:30.676471 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:12:30.677474 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:12:30.683986 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:12:30.686006 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:12:30.713584 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:12:30.715607 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:12:30.715607 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:12:30.716607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:31.395592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m14:12:31.416610 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:12:31.530785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F257A4B0>]}
[0m14:12:31.530785 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m14:12:31.531786 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:12:31.533301 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:12:31.534318 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:12:31.535326 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:12:31.536318 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:12:31.551401 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:12:31.552465 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:12:31.571664 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:12:31.574902 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:12:31.575896 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT(*)
FROM null_filled
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows
        );
[0m14:12:31.576906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:12:32.298562 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6734-0000-fd0b-0001-4c5e000ce17a
[0m14:12:32.298562 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 13 unexpected '*'.
[0m14:12:32.300562 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:12:32.417365 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:12:32.418363 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b37efde-ef0f-4f6e-91c4-a096f215bfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F2647EF0>]}
[0m14:12:32.419367 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.88s]
[0m14:12:32.421080 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:12:32.423604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:32.423604 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:12:32.424612 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:12:32.424612 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:12:32.425621 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:12:32.425621 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:12:32.425621 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:12:32.426621 [info ] [MainThread]: 
[0m14:12:32.427611 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m14:12:32.428613 [debug] [MainThread]: Command end result
[0m14:12:32.458424 [info ] [MainThread]: 
[0m14:12:32.460421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:32.461427 [info ] [MainThread]: 
[0m14:12:32.461964 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:12:32.463477 [info ] [MainThread]: 
[0m14:12:32.464501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:12:32.466501 [debug] [MainThread]: Command `dbt run` failed at 14:12:32.466501 after 5.59 seconds
[0m14:12:32.467489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D91F4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282F27005F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282D921F440>]}
[0m14:12:32.467489 [debug] [MainThread]: Flushing usage events
[0m14:12:49.291755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB79F9ED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7C9A27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7C9A3D40>]}


============================== 14:12:49.295757 | 31c90f02-00d0-4fd4-864c-d5dcd2daa7ee ==============================
[0m14:12:49.295757 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:12:49.297741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:50.286377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7F9B6B10>]}
[0m14:12:50.333383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7BB08110>]}
[0m14:12:50.335371 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:12:50.665284 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:12:50.839811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:50.840817 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:12:51.039361 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:12:51.041361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB1700C410>]}
[0m14:12:51.163883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E9FD7C0>]}
[0m14:12:51.255132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7FD18500>]}
[0m14:12:51.255132 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:12:51.256138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7FFD3410>]}
[0m14:12:51.258135 [info ] [MainThread]: 
[0m14:12:51.259130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:51.263189 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:12:51.269739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:12:51.276739 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:12:51.279749 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:12:51.280739 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:12:51.280739 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:12:51.281746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:51.282740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:52.151203 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.869 seconds
[0m14:12:52.153204 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:12:52.181525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.899 seconds
[0m14:12:52.183540 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:12:52.300033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:12:52.302029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:12:52.310033 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:12:52.313018 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:12:52.313478 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:12:52.313478 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:12:52.314510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:52.315431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:53.068056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.753 seconds
[0m14:12:53.070051 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:12:53.075049 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.760 seconds
[0m14:12:53.076048 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:12:53.193752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB17248590>]}
[0m14:12:53.194743 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:12:53.195760 [info ] [MainThread]: 
[0m14:12:53.201881 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:12:53.202879 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:12:53.203873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:12:53.203873 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:12:53.210880 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:12:53.211873 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:12:53.238894 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:12:53.241888 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:12:53.241888 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:12:53.242885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:54.030194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m14:12:54.052192 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:12:54.171210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7F9E1F70>]}
[0m14:12:54.172214 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m14:12:54.173211 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:12:54.174212 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:12:54.175220 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:12:54.176220 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:12:54.177221 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:12:54.181220 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:12:54.182225 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:12:54.204209 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:12:54.207219 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:12:54.208220 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT(*)
FROM null_filled
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id
FROM unique_rows
        );
[0m14:12:54.209223 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:12:54.791629 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6734-0000-fd29-0001-4c5e000d10a6
[0m14:12:54.792634 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 13 unexpected '*'.
[0m14:12:54.792634 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:12:54.907110 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:12:54.908108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c90f02-00d0-4fd4-864c-d5dcd2daa7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB17616330>]}
[0m14:12:54.909112 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.73s]
[0m14:12:54.910013 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:12:54.912025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:54.913046 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:12:54.913046 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:12:54.914023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:12:54.914023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:12:54.915022 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:12:54.915022 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:12:54.916024 [info ] [MainThread]: 
[0m14:12:54.916024 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m14:12:54.918021 [debug] [MainThread]: Command end result
[0m14:12:54.947024 [info ] [MainThread]: 
[0m14:12:54.948035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:54.949027 [info ] [MainThread]: 
[0m14:12:54.950036 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 13 unexpected '*'.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:12:54.951034 [info ] [MainThread]: 
[0m14:12:54.952034 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:12:54.953039 [debug] [MainThread]: Command `dbt run` failed at 14:12:54.953039 after 5.76 seconds
[0m14:12:54.954041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7E935970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7CAE6F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7C9DEC90>]}
[0m14:12:54.955035 [debug] [MainThread]: Flushing usage events
[0m14:13:18.063026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A6E4C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A965D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A965DB20>]}


============================== 14:13:18.067431 | 4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0 ==============================
[0m14:13:18.067431 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:13:18.068572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:13:19.023491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C190C920>]}
[0m14:13:19.067712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A8ED4B90>]}
[0m14:13:19.069780 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:13:19.383735 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:13:19.548458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:19.549467 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:13:19.740249 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:13:19.742774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C43336E0>]}
[0m14:13:19.863631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C43E5880>]}
[0m14:13:19.956522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C43C8E30>]}
[0m14:13:19.956522 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:13:19.957526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C4268E30>]}
[0m14:13:19.959523 [info ] [MainThread]: 
[0m14:13:19.960522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:13:19.964040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:13:19.976081 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:13:19.977082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:13:19.978081 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:13:19.980099 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:13:19.981083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:19.981083 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:13:19.984249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:20.851941 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.872 seconds
[0m14:13:20.853898 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:13:20.925687 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.941 seconds
[0m14:13:20.926686 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:13:21.042643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:13:21.044666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:13:21.052317 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:13:21.054212 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:13:21.055922 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:13:21.055922 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:13:21.056872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:21.057879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:21.750582 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.693 seconds
[0m14:13:21.752255 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:13:21.900515 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.843 seconds
[0m14:13:21.902122 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:13:22.074338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C437A630>]}
[0m14:13:22.075343 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:13:22.076343 [info ] [MainThread]: 
[0m14:13:22.080632 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:13:22.082138 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:13:22.083150 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:13:22.084158 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:13:22.090152 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:13:22.092156 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:13:22.118224 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:13:22.121225 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:13:22.121225 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:13:22.122221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:22.974506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m14:13:22.994593 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:13:23.145196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C2D62210>]}
[0m14:13:23.146195 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.06s]
[0m14:13:23.148203 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:13:23.149197 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:13:23.150196 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:13:23.151202 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:13:23.151202 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:13:23.155726 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:13:23.156726 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:13:23.178346 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:13:23.181353 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:13:23.182352 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows
        );
[0m14:13:23.182352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:26.235128 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.052 seconds
[0m14:13:26.237128 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:13:26.356041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a9a2e60-5ac8-4fb4-8877-3c423a5b42c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C48A51F0>]}
[0m14:13:26.357036 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.21s]
[0m14:13:26.358040 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:13:26.360493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:26.362005 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:13:26.362005 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:13:26.362005 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:13:26.363015 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:13:26.363015 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:13:26.364012 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:13:26.364012 [info ] [MainThread]: 
[0m14:13:26.365013 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m14:13:26.366027 [debug] [MainThread]: Command end result
[0m14:13:26.396053 [info ] [MainThread]: 
[0m14:13:26.397649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:26.398194 [info ] [MainThread]: 
[0m14:13:26.399241 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:13:26.401415 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:26.400891 after 8.44 seconds
[0m14:13:26.401934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A996D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C42C1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6A6356A80>]}
[0m14:13:26.402971 [debug] [MainThread]: Flushing usage events
[0m14:15:41.005513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FB23FEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FB46950A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FB4694680>]}


============================== 14:15:41.010766 | 5af45d1d-cf3f-4855-9bed-a6d727474dd8 ==============================
[0m14:15:41.010766 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:41.011765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:42.037530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FB4F93830>]}
[0m14:15:42.087530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCCC9DDF0>]}
[0m14:15:42.089531 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:15:42.413578 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:15:42.584618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:42.585618 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:15:42.782900 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:15:42.783901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF407C20>]}
[0m14:15:42.906480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF2F1400>]}
[0m14:15:43.003093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCE0F34A0>]}
[0m14:15:43.004090 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:15:43.004090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF566000>]}
[0m14:15:43.006101 [info ] [MainThread]: 
[0m14:15:43.007101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:43.011298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:15:43.018315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:15:43.025314 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:15:43.028323 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:15:43.029312 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:15:43.029884 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:15:43.030332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:43.030332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:43.997010 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.966 seconds
[0m14:15:43.997010 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.967 seconds
[0m14:15:43.999009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:15:44.000009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:15:44.123441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:15:44.125453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:15:44.133450 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:15:44.136450 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:15:44.136450 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:15:44.137474 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:15:44.138460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:44.138460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:44.846690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.708 seconds
[0m14:15:44.848691 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:15:44.964578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.826 seconds
[0m14:15:44.966572 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:15:45.085186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCE0F2EA0>]}
[0m14:15:45.085186 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:15:45.086178 [info ] [MainThread]: 
[0m14:15:45.091472 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:15:45.092475 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:15:45.093464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:15:45.094471 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:15:45.100474 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:15:45.102474 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:15:45.128477 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:15:45.130474 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:15:45.130474 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:15:45.131470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:45.840194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m14:15:45.862188 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:15:45.975827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCDDE2120>]}
[0m14:15:45.975827 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.88s]
[0m14:15:45.977835 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:15:45.978827 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:15:45.979822 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:15:45.980819 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:15:45.980819 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:15:45.985835 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:15:45.986819 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:15:46.007835 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:15:46.011829 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:15:46.012818 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)\

SELECT DISTINCT * FROM trzy
        );
[0m14:15:46.012818 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:46.751900 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6737-0000-fd24-0001-4c5e000d6096
[0m14:15:46.751900 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 17 unexpected '\
'.
[0m14:15:46.751900 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:15:46.869227 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 17 unexpected '\
  '.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:15:46.870226 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af45d1d-cf3f-4855-9bed-a6d727474dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF967DD0>]}
[0m14:15:46.871211 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.89s]
[0m14:15:46.872222 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:15:46.874219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:46.875222 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:15:46.875222 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:15:46.876227 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:15:46.876227 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:15:46.877223 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:15:46.877223 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:15:46.878223 [info ] [MainThread]: 
[0m14:15:46.879223 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m14:15:46.880229 [debug] [MainThread]: Command end result
[0m14:15:46.909221 [info ] [MainThread]: 
[0m14:15:46.911212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:46.912229 [info ] [MainThread]: 
[0m14:15:46.913224 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 17 unexpected '\
  '.
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:15:46.914222 [info ] [MainThread]: 
[0m14:15:46.915223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:15:46.918218 [debug] [MainThread]: Command `dbt run` failed at 14:15:46.917224 after 6.06 seconds
[0m14:15:46.918218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FB46F2AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF5894C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FCF3CEAB0>]}
[0m14:15:46.919226 [debug] [MainThread]: Flushing usage events
[0m14:15:57.964848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A436A32F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A433D10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A433D0170>]}


============================== 14:15:57.968518 | 78b01fbe-4ccd-42b6-b691-fdc5e9a113bf ==============================
[0m14:15:57.968518 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:57.970098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:58.915501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5BD12120>]}
[0m14:15:58.958055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5C79E870>]}
[0m14:15:58.959043 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:15:59.272620 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:15:59.443388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:59.444392 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:15:59.637393 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:15:59.638787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5C8C8D40>]}
[0m14:15:59.757267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5DDA71D0>]}
[0m14:15:59.845710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5CA7BE30>]}
[0m14:15:59.845710 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:15:59.846698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5DCF2630>]}
[0m14:15:59.848705 [info ] [MainThread]: 
[0m14:15:59.849705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:59.853695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:15:59.859710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:15:59.867707 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:15:59.869710 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:15:59.870767 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:15:59.871648 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:15:59.872168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:59.872896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:00.718563 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.846 seconds
[0m14:16:00.720564 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:16:00.834356 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.962 seconds
[0m14:16:00.836361 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:16:00.953880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:16:00.955884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:16:00.962884 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:16:00.965884 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:16:00.965884 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:16:00.966870 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:16:00.967869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:00.967869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:01.710755 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.743 seconds
[0m14:16:01.712755 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:16:01.822400 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.855 seconds
[0m14:16:01.825923 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:16:01.953329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5E110590>]}
[0m14:16:01.954330 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:16:01.955331 [info ] [MainThread]: 
[0m14:16:01.961325 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:16:01.962317 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:16:01.963324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:16:01.963324 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:16:01.970313 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:16:01.971315 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:16:01.997330 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:16:01.999320 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:16:01.999320 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:16:02.000329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:02.985799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.985 seconds
[0m14:16:03.005801 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:16:03.130557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5E1FCA40>]}
[0m14:16:03.131557 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.17s]
[0m14:16:03.132544 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:16:03.133548 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:16:03.134553 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:16:03.135556 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:16:03.136556 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:16:03.140558 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:16:03.142545 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:16:03.162569 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:16:03.165964 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:16:03.166948 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:16:03.166948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:05.369826 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.203 seconds
[0m14:16:05.372827 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:16:05.505647 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78b01fbe-4ccd-42b6-b691-fdc5e9a113bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5E2FBEC0>]}
[0m14:16:05.505647 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.37s]
[0m14:16:05.507575 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:16:05.509599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:05.509599 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:16:05.510597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:16:05.510597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:16:05.511598 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:16:05.511598 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:16:05.512594 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:16:05.512594 [info ] [MainThread]: 
[0m14:16:05.514086 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m14:16:05.515105 [debug] [MainThread]: Command end result
[0m14:16:05.543105 [info ] [MainThread]: 
[0m14:16:05.544112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:05.545108 [info ] [MainThread]: 
[0m14:16:05.546108 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:16:05.548105 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:05.547103 after 7.68 seconds
[0m14:16:05.548105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A433AB080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5DDDFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A4367B6E0>]}
[0m14:16:05.549115 [debug] [MainThread]: Flushing usage events
[0m14:25:45.110293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D3933E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D0F2EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D308D160>]}


============================== 14:25:45.115313 | a6433bd1-6900-4c5e-b287-0af040e3993b ==============================
[0m14:25:45.115313 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:25:45.116301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:46.221339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EBB15DF0>]}
[0m14:25:46.268058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EBFE86E0>]}
[0m14:25:46.269567 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:25:46.585184 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:25:46.753643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:46.753643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:46.784738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ECA26060>]}
[0m14:25:46.882894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ECC99EE0>]}
[0m14:25:46.883402 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:25:46.884410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ECCAF470>]}
[0m14:25:46.886417 [info ] [MainThread]: 
[0m14:25:46.887412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:46.892960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:25:46.900981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:25:46.909494 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:25:46.911509 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:25:46.912521 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:25:46.913517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:25:46.914518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:46.914518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:47.987366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.073 seconds
[0m14:25:47.988361 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:25:48.012000 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.097 seconds
[0m14:25:48.013000 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:25:48.239087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:25:48.241091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:25:48.249081 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:25:48.251086 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:25:48.252217 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:25:48.253092 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:25:48.253092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:48.254092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:49.122797 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.870 seconds
[0m14:25:49.125795 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:25:49.163444 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.909 seconds
[0m14:25:49.164442 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:25:49.285857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC99E600>]}
[0m14:25:49.286878 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:25:49.288873 [info ] [MainThread]: 
[0m14:25:49.293882 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:25:49.294885 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:25:49.295876 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:25:49.296872 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:25:49.303871 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:25:49.305866 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:25:49.331887 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:25:49.333880 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:25:49.333880 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:25:49.334881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:50.043330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m14:25:50.064330 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:25:50.181019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC9621B0>]}
[0m14:25:50.182023 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.88s]
[0m14:25:50.184021 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:25:50.185020 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:25:50.186014 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:25:50.187529 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:25:50.187529 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:25:50.208085 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:25:50.210072 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:25:50.234082 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:25:50.238085 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:25:50.239085 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        COALESCE(goods_title_link, 'Unknown') AS title,
        COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available') AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:25:50.239085 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:53.848245 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.609 seconds
[0m14:25:53.851245 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:25:53.970098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6433bd1-6900-4c5e-b287-0af040e3993b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ECA24080>]}
[0m14:25:53.971100 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.78s]
[0m14:25:53.973109 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:25:53.974108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:53.975631 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:25:53.976645 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:25:53.976645 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:25:53.977663 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:25:53.977663 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:25:53.978654 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:25:53.979655 [info ] [MainThread]: 
[0m14:25:53.980654 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m14:25:53.981654 [debug] [MainThread]: Command end result
[0m14:25:54.014071 [info ] [MainThread]: 
[0m14:25:54.015580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:54.016590 [info ] [MainThread]: 
[0m14:25:54.018590 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:25:54.020596 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:54.020596 after 9.06 seconds
[0m14:25:54.021595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D38152E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EB510230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D36627B0>]}
[0m14:25:54.022589 [debug] [MainThread]: Flushing usage events
[0m14:28:49.194857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A021DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A021CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919FC0C260>]}


============================== 14:28:49.198858 | 0a9c3210-4a13-4aab-9c76-a2845adbe555 ==============================
[0m14:28:49.198858 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:28:49.199879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:50.150577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291A04D3410>]}
[0m14:28:50.196115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B8B50C20>]}
[0m14:28:50.198117 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:28:50.527906 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:28:50.688895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:50.689895 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:28:50.885459 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:28:50.886445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919F534BC0>]}
[0m14:28:51.005021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BABCB230>]}
[0m14:28:51.097109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B97581A0>]}
[0m14:28:51.098115 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:28:51.099098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BA94E0F0>]}
[0m14:28:51.101098 [info ] [MainThread]: 
[0m14:28:51.102099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:51.106096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:28:51.107096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:28:51.120100 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:28:51.123111 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:28:51.123111 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:28:51.124108 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:28:51.124108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:51.125115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:52.229645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.105 seconds
[0m14:28:52.230644 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:28:52.247327 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.122 seconds
[0m14:28:52.248322 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:28:52.366312 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:28:52.367312 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:28:52.375867 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:28:52.378867 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:28:52.378867 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:28:52.379857 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:28:52.380854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:52.381513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:53.186084 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.805 seconds
[0m14:28:53.188088 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:28:53.211830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.831 seconds
[0m14:28:53.213832 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:28:53.328298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BAA817F0>]}
[0m14:28:53.329315 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:28:53.330306 [info ] [MainThread]: 
[0m14:28:53.335429 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:28:53.336433 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:28:53.337432 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:28:53.338437 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:28:53.344443 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:28:53.346433 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:28:53.373448 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:28:53.374969 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:28:53.375967 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:28:53.375967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:54.085933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m14:28:54.106933 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:28:54.228570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B9402000>]}
[0m14:28:54.229575 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.89s]
[0m14:28:54.231575 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:28:54.232561 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:28:54.233575 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:28:54.234570 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:28:54.234570 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:28:54.238593 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:28:54.240579 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:28:54.261127 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:28:54.265125 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:28:54.265125 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:28:54.266125 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:28:57.224738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.959 seconds
[0m14:28:57.226755 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:28:57.345238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9c3210-4a13-4aab-9c76-a2845adbe555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BAF551C0>]}
[0m14:28:57.346238 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.11s]
[0m14:28:57.347238 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:28:57.349230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:57.349230 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:28:57.350231 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:28:57.350231 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:28:57.351231 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:28:57.351231 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:28:57.352232 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:28:57.352232 [info ] [MainThread]: 
[0m14:28:57.353230 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m14:28:57.354241 [debug] [MainThread]: Command end result
[0m14:28:57.382808 [info ] [MainThread]: 
[0m14:28:57.384805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:57.385807 [info ] [MainThread]: 
[0m14:28:57.386795 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:28:57.387808 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:57.387808 after 8.30 seconds
[0m14:28:57.388803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002919F76B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BA9E6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291BA912390>]}
[0m14:28:57.388803 [debug] [MainThread]: Flushing usage events
[0m14:40:40.931563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC289E9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2934D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2934CA40>]}


============================== 14:40:40.935580 | 011d8494-f0f0-4076-bcb3-2bb30089c919 ==============================
[0m14:40:40.935580 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:40:40.936565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:40:42.026007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC41925C70>]}
[0m14:40:42.069002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4121F5F0>]}
[0m14:40:42.071007 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:40:42.392026 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:40:42.561026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:42.561026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:42.592566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC41B8C560>]}
[0m14:40:42.684606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC428C9910>]}
[0m14:40:42.685609 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:40:42.686610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43A81F40>]}
[0m14:40:42.688605 [info ] [MainThread]: 
[0m14:40:42.689604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:42.693610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:40:42.699606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:40:42.707608 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:40:42.710604 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:40:42.710604 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:40:42.711605 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:40:42.712606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:42.712606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:43.824393 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.112 seconds
[0m14:40:43.826391 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:40:43.848589 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.136 seconds
[0m14:40:43.850588 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:40:43.977737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:40:43.979736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:40:43.987741 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:40:43.990889 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:40:43.991467 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:40:43.992283 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:40:43.992283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:43.993308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:44.615174 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.623 seconds
[0m14:40:44.617164 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:40:44.760773 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.768 seconds
[0m14:40:44.762777 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:40:44.878908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC425CE960>]}
[0m14:40:44.879934 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:40:44.880933 [info ] [MainThread]: 
[0m14:40:44.886095 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:40:44.887095 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:40:44.888100 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:40:44.889098 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:40:44.895096 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:40:44.897098 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:40:44.928092 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:40:44.930092 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:40:44.931093 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:40:44.932091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:45.603473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m14:40:45.622991 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:40:45.743480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC42592480>]}
[0m14:40:45.744482 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m14:40:45.745682 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:40:45.746785 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:40:45.747808 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:40:45.748794 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:40:45.749799 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:40:45.763812 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:40:45.764811 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:40:45.784809 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:40:45.787796 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:40:45.788802 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:40:45.789807 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:48.801817 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.012 seconds
[0m14:40:48.803817 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:40:48.923824 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011d8494-f0f0-4076-bcb3-2bb30089c919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43C87CE0>]}
[0m14:40:48.924824 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.18s]
[0m14:40:48.925815 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:40:48.927816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:48.928815 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:40:48.928815 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:40:48.929816 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:40:48.929816 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:40:48.930815 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:40:48.930815 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:40:48.931817 [info ] [MainThread]: 
[0m14:40:48.931817 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m14:40:48.933816 [debug] [MainThread]: Command end result
[0m14:40:48.967339 [info ] [MainThread]: 
[0m14:40:48.969338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:48.969338 [info ] [MainThread]: 
[0m14:40:48.970340 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:40:48.972335 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:48.972335 after 8.15 seconds
[0m14:40:48.972335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC412D4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC295622A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29562D80>]}
[0m14:40:48.973338 [debug] [MainThread]: Flushing usage events
[0m14:43:20.329401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685EBCD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686252E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686268B740>]}


============================== 14:43:20.333661 | 7c21a65c-a430-4683-9050-79b932d9f692 ==============================
[0m14:43:20.333661 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:43:20.335136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:43:21.305136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687AE18B30>]}
[0m14:43:21.367135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687A63FE60>]}
[0m14:43:21.369134 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:43:21.684754 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:43:21.844876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:21.845866 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:43:22.083520 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:43:22.086531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687CCAC260>]}
[0m14:43:22.219530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687CD2A990>]}
[0m14:43:22.319194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B9D8320>]}
[0m14:43:22.320200 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:43:22.320200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B7D2060>]}
[0m14:43:22.322196 [info ] [MainThread]: 
[0m14:43:22.323191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:22.328192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:43:22.329200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:43:22.342206 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:43:22.345195 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:43:22.345195 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:43:22.346197 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:43:22.346197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:22.347196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:23.685142 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.338 seconds
[0m14:43:23.688139 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:43:23.756295 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.409 seconds
[0m14:43:23.757299 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:43:23.873824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:43:23.874819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:43:23.882824 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:43:23.884845 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:43:23.885845 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:43:23.886846 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:43:23.886846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:23.887846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:24.572572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m14:43:24.573575 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:43:24.789610 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.902 seconds
[0m14:43:24.790616 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:43:24.913171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B6E2360>]}
[0m14:43:24.914165 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:43:24.915174 [info ] [MainThread]: 
[0m14:43:24.920478 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:43:24.921501 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:43:24.922501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:43:24.923509 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:43:24.929506 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:43:24.931501 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:43:24.957506 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:43:24.959500 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:43:24.960502 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:43:24.960502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:25.876596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m14:43:25.897604 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:43:26.022930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B6A1E20>]}
[0m14:43:26.022930 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.10s]
[0m14:43:26.024935 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:43:26.025937 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:43:26.026929 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:43:26.027927 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:43:26.028944 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:43:26.032939 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:43:26.034948 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:43:26.055494 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:43:26.059499 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:43:26.059499 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:43:26.060503 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:43:28.455216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.395 seconds
[0m14:43:28.458206 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:43:28.576218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c21a65c-a430-4683-9050-79b932d9f692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687D252000>]}
[0m14:43:28.576218 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.55s]
[0m14:43:28.578212 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:43:28.580209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:28.580209 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:43:28.581212 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:43:28.581212 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:43:28.582212 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:43:28.582212 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:43:28.583213 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:43:28.583213 [info ] [MainThread]: 
[0m14:43:28.584220 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m14:43:28.586221 [debug] [MainThread]: Command end result
[0m14:43:28.614226 [info ] [MainThread]: 
[0m14:43:28.615223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:28.616215 [info ] [MainThread]: 
[0m14:43:28.617210 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:43:28.619214 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:28.619214 after 8.39 seconds
[0m14:43:28.620215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687B794590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026861AAF3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026861AAEF90>]}
[0m14:43:28.620215 [debug] [MainThread]: Flushing usage events
[0m14:47:54.464797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FCEB4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FCEB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FCEB3E0>]}


============================== 14:47:54.469914 | 3201a26c-a722-4862-99d5-eebc3e6fce00 ==============================
[0m14:47:54.469914 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:47:54.470933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:47:55.514539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4EE26C90>]}
[0m14:47:55.560701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FEA0860>]}
[0m14:47:55.562233 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:47:55.898024 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:47:56.061491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:56.061491 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:47:56.262547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:47:56.264057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA6A36C410>]}
[0m14:47:56.411649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA6A52B1D0>]}
[0m14:47:56.539904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA69098E90>]}
[0m14:47:56.540908 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:47:56.541900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA68F08500>]}
[0m14:47:56.547456 [info ] [MainThread]: 
[0m14:47:56.548450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:47:56.553444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:47:56.554897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:47:56.573472 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:47:56.577505 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:47:56.578507 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:47:56.579502 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:47:56.580507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:56.580507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:57.666400 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.085 seconds
[0m14:47:57.666400 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.087 seconds
[0m14:47:57.668399 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:47:57.670404 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:47:57.793706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:47:57.795673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:47:57.802660 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:47:57.806178 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:47:57.807169 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:47:57.807169 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:47:57.808183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:57.809171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:58.444329 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.636 seconds
[0m14:47:58.446354 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:47:58.602472 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.794 seconds
[0m14:47:58.603977 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:47:58.720809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA67F30470>]}
[0m14:47:58.720809 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:47:58.722815 [info ] [MainThread]: 
[0m14:47:58.728334 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:47:58.729332 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:47:58.730332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:47:58.731337 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:47:58.738869 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:47:58.740867 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:47:58.772672 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:47:58.775803 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:47:58.776808 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:47:58.776808 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:59.610041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m14:47:59.633770 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:47:59.744461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA68D62060>]}
[0m14:47:59.745462 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.01s]
[0m14:47:59.746457 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:47:59.748453 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:47:59.749453 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:47:59.750458 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:47:59.751453 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:47:59.756980 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:47:59.758979 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:47:59.780586 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:47:59.784081 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:47:59.785092 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:47:59.785092 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:48:01.808961 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.024 seconds
[0m14:48:01.811966 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:48:01.938857 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3201a26c-a722-4862-99d5-eebc3e6fce00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA6A874530>]}
[0m14:48:01.940859 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.19s]
[0m14:48:01.942855 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:48:01.945254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:01.946253 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:48:01.946253 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:48:01.947254 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:48:01.948259 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:48:01.948259 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:48:01.949252 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:48:01.950249 [info ] [MainThread]: 
[0m14:48:01.951252 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m14:48:01.952255 [debug] [MainThread]: Command end result
[0m14:48:01.985896 [info ] [MainThread]: 
[0m14:48:01.987408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:01.988421 [info ] [MainThread]: 
[0m14:48:01.989426 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:48:01.991431 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:01.991431 after 7.69 seconds
[0m14:48:01.992421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FD63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA6A3D0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4FA42540>]}
[0m14:48:01.993933 [debug] [MainThread]: Flushing usage events
[0m14:55:40.710073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E79FE960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E6A2F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA547AA0>]}


============================== 14:55:40.715072 | 8bd8b7d2-fea4-4c76-9a28-63f42d7c6282 ==============================
[0m14:55:40.715072 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:55:40.717072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:41.960336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A382C3D0A0>]}
[0m14:55:42.012330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3834DF560>]}
[0m14:55:42.014339 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:55:42.409518 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:55:42.609722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:42.610724 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:55:42.854706 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:55:42.855704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA2ADA60>]}
[0m14:55:43.014712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A384AAF1D0>]}
[0m14:55:43.123185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A38379B830>]}
[0m14:55:43.124185 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:55:43.125181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A384AAC230>]}
[0m14:55:43.128186 [info ] [MainThread]: 
[0m14:55:43.130187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:43.136174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:55:43.138190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:55:43.157190 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:55:43.159712 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:55:43.160710 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:55:43.161719 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:55:43.162712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:43.163713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:44.169539 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.007 seconds
[0m14:55:44.171541 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:55:44.176546 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.013 seconds
[0m14:55:44.177558 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:55:44.296086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:55:44.297087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:55:44.305115 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:55:44.308117 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:55:44.308117 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:55:44.309118 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:55:44.310117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:44.311112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:45.202958 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m14:55:45.204960 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:55:45.209981 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.900 seconds
[0m14:55:45.211979 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:55:45.340534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3FFDB4560>]}
[0m14:55:45.341538 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:55:45.342539 [info ] [MainThread]: 
[0m14:55:45.348528 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:55:45.349534 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:55:45.350540 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:55:45.351538 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:55:45.358530 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:55:45.360538 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:55:45.386527 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:55:45.388530 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:55:45.389542 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:55:45.390537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:46.157318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m14:55:46.187854 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:55:46.308414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A383442120>]}
[0m14:55:46.309426 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.96s]
[0m14:55:46.310421 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:55:46.312421 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:55:46.312421 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:55:46.313429 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:55:46.314422 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:55:46.320418 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:55:46.322420 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:55:46.345416 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:55:46.349409 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:55:46.350413 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color-count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:55:46.351411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:47.061650 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba675f-0000-fd29-0001-4c5e000d116e
[0m14:55:47.061650 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR'
[0m14:55:47.062652 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:55:47.180651 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:55:47.181651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd8b7d2-fea4-4c76-9a28-63f42d7c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A38501F4D0>]}
[0m14:55:47.182651 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.87s]
[0m14:55:47.184652 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:55:47.186638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:47.188638 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:55:47.188638 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:55:47.189646 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:55:47.190638 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:55:47.191639 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:55:47.191639 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:55:47.192637 [info ] [MainThread]: 
[0m14:55:47.193653 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m14:55:47.194653 [debug] [MainThread]: Command end result
[0m14:55:47.230102 [info ] [MainThread]: 
[0m14:55:47.232107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:47.233107 [info ] [MainThread]: 
[0m14:55:47.234107 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:55:47.235107 [info ] [MainThread]: 
[0m14:55:47.236111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:55:47.239111 [debug] [MainThread]: Command `dbt run` failed at 14:55:47.238116 after 6.68 seconds
[0m14:55:47.240095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A384C0F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A38378BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E79FE960>]}
[0m14:55:47.240095 [debug] [MainThread]: Flushing usage events
[0m14:59:25.561654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A32C59EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A32C38EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A32DEA7A70>]}


============================== 14:59:25.566267 | 21213c60-f97c-4aae-ba62-f9bddd7b2002 ==============================
[0m14:59:25.566267 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:59:25.568279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:26.530327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A347BA50A0>]}
[0m14:59:26.574891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A32EF219A0>]}
[0m14:59:26.576894 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:59:26.895554 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:59:27.067087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:27.068087 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:59:27.269819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:59:27.271323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3493C7FE0>]}
[0m14:59:27.396900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A349331B80>]}
[0m14:59:27.488396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3480D9670>]}
[0m14:59:27.489394 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:59:27.490397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3491E1FD0>]}
[0m14:59:27.491399 [info ] [MainThread]: 
[0m14:59:27.492404 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:27.496407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:59:27.505407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:59:27.510395 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:59:27.512407 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:59:27.513396 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:59:27.513396 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:59:27.514399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:27.514399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:28.704601 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.190 seconds
[0m14:59:28.705601 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.192 seconds
[0m14:59:28.707600 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:59:28.709606 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:59:28.823935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:59:28.825952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:59:28.833934 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:59:28.837071 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:59:28.837591 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:59:28.838476 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:59:28.838992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:28.838992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:29.521918 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.683 seconds
[0m14:59:29.523901 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:59:29.537021 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.698 seconds
[0m14:59:29.539022 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:59:29.669478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3493F14F0>]}
[0m14:59:29.670483 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:59:29.671483 [info ] [MainThread]: 
[0m14:59:29.677349 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:59:29.678365 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:59:29.679376 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:59:29.679376 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:59:29.686372 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:59:29.687369 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:59:29.714362 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:59:29.716366 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:59:29.717369 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:59:29.718374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:30.470549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m14:59:30.492549 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:59:30.617741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A347DA22D0>]}
[0m14:59:30.617741 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.94s]
[0m14:59:30.619747 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:59:30.620746 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:59:30.621741 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:59:30.622747 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:59:30.622747 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:59:30.627746 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:59:30.628746 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:59:30.649784 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:59:30.654800 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:59:30.655800 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color_count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:59:30.655800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:31.317334 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6763-0000-fd0b-0001-4c5e000ce242
[0m14:59:31.318339 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR_COUNT'
[0m14:59:31.318339 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:59:31.433239 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:59:31.433239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21213c60-f97c-4aae-ba62-f9bddd7b2002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3498FBB90>]}
[0m14:59:31.434455 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.81s]
[0m14:59:31.435458 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:59:31.438487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:31.439487 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:59:31.439487 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:59:31.439487 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:59:31.440489 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:59:31.440489 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:59:31.440489 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:59:31.441486 [info ] [MainThread]: 
[0m14:59:31.442482 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m14:59:31.443478 [debug] [MainThread]: Command end result
[0m14:59:31.473486 [info ] [MainThread]: 
[0m14:59:31.474489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:59:31.475486 [info ] [MainThread]: 
[0m14:59:31.476478 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:59:31.478477 [info ] [MainThread]: 
[0m14:59:31.479480 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:59:31.481476 [debug] [MainThread]: Command `dbt run` failed at 14:59:31.481476 after 6.04 seconds
[0m14:59:31.481476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A349542000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3493AC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A32E5908F0>]}
[0m14:59:31.482473 [debug] [MainThread]: Flushing usage events
[0m14:59:53.488550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E29EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E29F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E29F2C0>]}


============================== 14:59:53.492226 | 0a96bae4-1ecd-4000-bab1-0995e2dba8bb ==============================
[0m14:59:53.492226 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:59:53.493226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:59:54.435469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C26D002F0>]}
[0m14:59:54.480455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C274F5EE0>]}
[0m14:59:54.482694 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:59:54.797575 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:59:54.963565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:54.964565 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m14:59:55.153149 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:59:55.155147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2975C410>]}
[0m14:59:55.276757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2969DAC0>]}
[0m14:59:55.368013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C28488620>]}
[0m14:59:55.369006 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m14:59:55.369006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2991B830>]}
[0m14:59:55.371009 [info ] [MainThread]: 
[0m14:59:55.372014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:55.377003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:59:55.390019 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:59:55.390019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m14:59:55.391160 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:59:55.393021 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m14:59:55.394014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:55.395008 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m14:59:55.398014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:56.276048 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.882 seconds
[0m14:59:56.278050 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:59:56.315787 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.918 seconds
[0m14:59:56.316791 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m14:59:56.470645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m14:59:56.471643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m14:59:56.480639 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m14:59:56.482642 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m14:59:56.483641 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m14:59:56.483641 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m14:59:56.484643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:56.485642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:57.245709 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.761 seconds
[0m14:59:57.247709 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m14:59:57.395352 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.910 seconds
[0m14:59:57.397351 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m14:59:57.514553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2818E810>]}
[0m14:59:57.515558 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:59:57.516558 [info ] [MainThread]: 
[0m14:59:57.521866 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m14:59:57.524867 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m14:59:57.525871 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m14:59:57.525871 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m14:59:57.531873 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m14:59:57.533867 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m14:59:57.559879 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m14:59:57.561877 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m14:59:57.562884 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m14:59:57.563883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:58.343633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m14:59:58.365136 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m14:59:58.484835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C281523C0>]}
[0m14:59:58.485821 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.96s]
[0m14:59:58.486836 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m14:59:58.487832 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m14:59:58.488835 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m14:59:58.489824 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m14:59:58.489824 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m14:59:58.496830 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m14:59:58.497835 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m14:59:58.518835 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m14:59:58.521835 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m14:59:58.522830 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color_count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m14:59:58.522830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:59:59.221346 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6764-0000-fd29-0001-4c5e000d1182
[0m14:59:59.222347 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR_COUNT'
[0m14:59:59.223486 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m14:59:59.350216 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:59:59.351216 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a96bae4-1ecd-4000-bab1-0995e2dba8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C2848A270>]}
[0m14:59:59.351216 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.86s]
[0m14:59:59.352216 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m14:59:59.355197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:59.355197 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:59:59.356219 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m14:59:59.356219 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m14:59:59.357213 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m14:59:59.357213 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m14:59:59.358203 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m14:59:59.358203 [info ] [MainThread]: 
[0m14:59:59.359202 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m14:59:59.360208 [debug] [MainThread]: Command end result
[0m14:59:59.389731 [info ] [MainThread]: 
[0m14:59:59.390738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:59:59.391739 [info ] [MainThread]: 
[0m14:59:59.392737 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m14:59:59.393738 [info ] [MainThread]: 
[0m14:59:59.394740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:59:59.396750 [debug] [MainThread]: Command `dbt run` failed at 14:59:59.395741 after 6.01 seconds
[0m14:59:59.396750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0F1B3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C282DCAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0F0491F0>]}
[0m14:59:59.397741 [debug] [MainThread]: Flushing usage events
[0m15:00:36.534993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002068CB3B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020689EFC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020688F89340>]}


============================== 15:00:36.538872 | cf8be08a-6fc4-4846-9ebc-7b257f82accb ==============================
[0m15:00:36.538872 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:00:36.540869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:37.546380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002068CCA7DA0>]}
[0m15:00:37.590390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002068CB3B5C0>]}
[0m15:00:37.592530 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:00:37.901694 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:00:38.062985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:38.063984 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:00:38.259575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:00:38.260576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A7120590>]}
[0m15:00:38.385183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A723D580>]}
[0m15:00:38.478612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A5E98590>]}
[0m15:00:38.479616 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:00:38.480621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A5F18950>]}
[0m15:00:38.482613 [info ] [MainThread]: 
[0m15:00:38.483617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:38.487611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:00:38.498613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:00:38.500617 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:00:38.503972 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:00:38.503972 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:00:38.504982 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:00:38.504982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:38.505973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:39.556258 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.051 seconds
[0m15:00:39.558263 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:00:39.558263 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.053 seconds
[0m15:00:39.561263 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:00:39.842912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:00:39.843906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:00:39.851917 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:00:39.854918 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:00:39.855919 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:00:39.855919 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:00:39.856919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:39.856919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:40.526656 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.670 seconds
[0m15:00:40.528656 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:00:40.727884 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.870 seconds
[0m15:00:40.729887 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:00:40.854615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A7192420>]}
[0m15:00:40.855620 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:00:40.856620 [info ] [MainThread]: 
[0m15:00:40.862605 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:00:40.863605 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:00:40.864613 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:00:40.864613 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:00:40.871626 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:00:40.872624 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:00:40.898642 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:00:40.900636 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:00:40.900636 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:00:40.901629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:41.587919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m15:00:41.609444 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:00:41.745762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A5B42150>]}
[0m15:00:41.746767 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.88s]
[0m15:00:41.747767 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:00:41.748770 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:00:41.749767 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:00:41.750966 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:00:41.751981 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:00:41.756994 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:00:41.757995 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:00:41.778994 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:00:41.782980 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:00:41.783991 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color-count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:00:41.784979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:42.865665 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6764-0000-fcd1-0001-4c5e000d315e
[0m15:00:42.866667 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR'
[0m15:00:42.866667 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:00:42.986267 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:00:42.987265 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8be08a-6fc4-4846-9ebc-7b257f82accb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A76A52E0>]}
[0m15:00:42.988266 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.24s]
[0m15:00:42.989265 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:00:42.992277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:42.992277 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:00:42.993273 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:00:42.993273 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:00:42.994265 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:00:42.995274 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:00:42.995274 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:00:42.996271 [info ] [MainThread]: 
[0m15:00:42.997263 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m15:00:42.998268 [debug] [MainThread]: Command end result
[0m15:00:43.034265 [info ] [MainThread]: 
[0m15:00:43.036268 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:00:43.037271 [info ] [MainThread]: 
[0m15:00:43.038269 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:00:43.039263 [info ] [MainThread]: 
[0m15:00:43.040271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:00:43.042272 [debug] [MainThread]: Command `dbt run` failed at 15:00:43.042272 after 6.62 seconds
[0m15:00:43.043270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A70FDCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002068C360DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A730C8C0>]}
[0m15:00:43.043270 [debug] [MainThread]: Flushing usage events
[0m15:01:00.190471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4865EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4A089C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4ACD4380>]}


============================== 15:01:00.194476 | d1e3147a-afbf-41cd-a4e6-0e9fe11ac36d ==============================
[0m15:01:00.194476 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:00.195476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:01.092491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB63E35940>]}
[0m15:01:01.136479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB63E5D460>]}
[0m15:01:01.137485 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:01:01.447401 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:01:01.603398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:01.604413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:01.633952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6407F110>]}
[0m15:01:01.725069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB65550CE0>]}
[0m15:01:01.726063 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:01:01.727063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB65530620>]}
[0m15:01:01.729071 [info ] [MainThread]: 
[0m15:01:01.730064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:01.734058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:01.735059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:01.749062 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:01.752059 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:01.753062 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:01.753062 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:01.754069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:01.755074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:03.067577 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.313 seconds
[0m15:01:03.069582 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:03.077266 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.323 seconds
[0m15:01:03.079256 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:03.208670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:01:03.210677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:01:03.218678 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:01:03.220677 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:01:03.221675 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:01:03.221675 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:01:03.222676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:03.223675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:04.155506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.932 seconds
[0m15:01:04.157507 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:01:04.417195 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.194 seconds
[0m15:01:04.418196 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:01:04.586720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB65481C40>]}
[0m15:01:04.587726 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:01:04.587726 [info ] [MainThread]: 
[0m15:01:04.593721 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:01:04.594713 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:01:04.595714 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:01:04.595714 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:01:04.602727 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:01:04.604720 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:01:04.630254 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:01:04.632241 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:01:04.633244 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:01:04.634238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:05.780375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.146 seconds
[0m15:01:05.800378 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:01:05.928208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6402E3C0>]}
[0m15:01:05.929213 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.33s]
[0m15:01:05.931198 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:01:05.932213 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:01:05.933198 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:01:05.934213 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:01:05.934213 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:01:05.951207 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:01:05.952198 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:01:05.971207 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:01:05.975207 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:01:05.976207 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color-count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color-count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:01:05.976207 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:06.934136 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6765-0000-fcd3-0001-4c5e000cc382
[0m15:01:06.934136 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR'
[0m15:01:06.935229 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:01:07.051170 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:07.052170 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3147a-afbf-41cd-a4e6-0e9fe11ac36d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB65850530>]}
[0m15:01:07.053170 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.12s]
[0m15:01:07.054161 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:01:07.056158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:07.057165 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:07.057165 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:07.058166 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:01:07.058166 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:01:07.058166 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:01:07.059167 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:01:07.059167 [info ] [MainThread]: 
[0m15:01:07.060155 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m15:01:07.061158 [debug] [MainThread]: Command end result
[0m15:01:07.091728 [info ] [MainThread]: 
[0m15:01:07.092733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:07.092733 [info ] [MainThread]: 
[0m15:01:07.093719 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:07.094732 [info ] [MainThread]: 
[0m15:01:07.095729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:01:07.096716 [debug] [MainThread]: Command `dbt run` failed at 15:01:07.096716 after 7.01 seconds
[0m15:01:07.097728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4865EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4A952930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4B1F05F0>]}
[0m15:01:07.098727 [debug] [MainThread]: Flushing usage events
[0m15:01:18.019924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8D4BECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8FC90170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8FE9B6B0>]}


============================== 15:01:18.023929 | 435498b6-70ae-4b8b-b84d-1cb85a43866d ==============================
[0m15:01:18.023929 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:18.024820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:01:18.953452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA7D6DD30>]}
[0m15:01:18.999454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA8F64DA0>]}
[0m15:01:19.001246 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:01:19.312026 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:01:19.461844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:19.462853 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:01:19.671889 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:01:19.672403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA7A40EF0>]}
[0m15:01:19.795175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAA66B110>]}
[0m15:01:19.884821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAA50C500>]}
[0m15:01:19.885822 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:01:19.885822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA8F66F60>]}
[0m15:01:19.887822 [info ] [MainThread]: 
[0m15:01:19.888832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:19.893111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:19.905126 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:19.906126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:19.907137 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:19.909136 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:19.910126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:19.910126 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:19.913129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:20.971431 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.061 seconds
[0m15:01:20.973435 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:21.181344 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.267 seconds
[0m15:01:21.183348 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:21.335259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:01:21.336256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:01:21.344260 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:01:21.346260 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:01:21.347362 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:01:21.348259 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:01:21.348259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:21.349255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:22.198914 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.850 seconds
[0m15:01:22.201910 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:01:22.222321 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.873 seconds
[0m15:01:22.224325 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:01:22.344849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA8EDE8A0>]}
[0m15:01:22.345847 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:01:22.346853 [info ] [MainThread]: 
[0m15:01:22.352398 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:01:22.353401 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:01:22.354397 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:01:22.355404 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:01:22.362407 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:01:22.363400 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:01:22.389411 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:01:22.391398 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:01:22.391398 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:01:22.392407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:23.345341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m15:01:23.367345 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:01:23.533922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAAA07B30>]}
[0m15:01:23.534917 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.18s]
[0m15:01:23.536021 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:01:23.536917 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:01:23.537921 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:01:23.538917 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:01:23.538917 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:01:23.543922 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:01:23.545909 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:01:23.565923 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:01:23.569911 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:01:23.570911 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color_count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:01:23.570911 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:24.487042 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6765-0000-fd29-0001-4c5e000d119e
[0m15:01:24.488042 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR_COUNT'
[0m15:01:24.488042 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:01:24.611507 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:24.612507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435498b6-70ae-4b8b-b84d-1cb85a43866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAAA07BF0>]}
[0m15:01:24.613507 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.07s]
[0m15:01:24.614507 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:01:24.616513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:24.617529 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:24.618525 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:24.618525 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:01:24.618525 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:01:24.619528 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:01:24.619528 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:01:24.620524 [info ] [MainThread]: 
[0m15:01:24.620524 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m15:01:24.622520 [debug] [MainThread]: Command end result
[0m15:01:24.651842 [info ] [MainThread]: 
[0m15:01:24.652840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:24.653850 [info ] [MainThread]: 
[0m15:01:24.655054 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:24.656067 [info ] [MainThread]: 
[0m15:01:24.657078 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:01:24.658069 [debug] [MainThread]: Command `dbt run` failed at 15:01:24.658069 after 6.74 seconds
[0m15:01:24.659077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8D4BECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C90021100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAA555AF0>]}
[0m15:01:24.659077 [debug] [MainThread]: Flushing usage events
[0m15:01:39.789623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5CB0B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C55AE750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5CB3AD0>]}


============================== 15:01:39.794327 | 70f88852-088b-43e9-be83-652f01797f9a ==============================
[0m15:01:39.794327 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:39.795536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:40.744659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DF4F1C10>]}
[0m15:01:40.796651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DE1D5F10>]}
[0m15:01:40.799659 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:01:41.120228 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:01:41.291298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:41.292298 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:01:41.493437 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:01:41.494440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0AC2BA0>]}
[0m15:01:41.617427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0A03B90>]}
[0m15:01:41.708371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DF803470>]}
[0m15:01:41.709369 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:01:41.709369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0A418E0>]}
[0m15:01:41.711383 [info ] [MainThread]: 
[0m15:01:41.712380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:41.717111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:41.722430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:01:41.731464 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:41.733466 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:01:41.734471 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:41.734471 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:01:41.735465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:41.735465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:42.667873 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.932 seconds
[0m15:01:42.669869 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:42.864060 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.128 seconds
[0m15:01:42.865053 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:01:42.978866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:01:42.979867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:01:42.987873 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:01:42.989871 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:01:42.990872 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:01:42.991859 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:01:42.991859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:42.992858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:43.764202 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.772 seconds
[0m15:01:43.766204 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:01:43.957498 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.965 seconds
[0m15:01:43.959495 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:01:44.083802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0A1FEC0>]}
[0m15:01:44.083802 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:01:44.084801 [info ] [MainThread]: 
[0m15:01:44.090476 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:01:44.091474 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:01:44.092475 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:01:44.092475 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:01:44.099485 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:01:44.100486 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:01:44.126490 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:01:44.128492 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:01:44.129486 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:01:44.129486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:44.851093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m15:01:44.872084 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:01:45.010300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DF4F20C0>]}
[0m15:01:45.011309 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.92s]
[0m15:01:45.012378 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:01:45.014313 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:01:45.015315 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:01:45.016311 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:01:45.016311 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:01:45.021314 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:01:45.022314 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:01:45.043298 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:01:45.046309 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:01:45.047315 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color_count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:01:45.047315 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:45.914111 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6765-0000-fce6-0001-4c5e000d700a
[0m15:01:45.914111 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR_COUNT'
[0m15:01:45.915111 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:01:46.073467 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:46.074468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f88852-088b-43e9-be83-652f01797f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E1086240>]}
[0m15:01:46.075468 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.06s]
[0m15:01:46.076470 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:01:46.078455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:46.079467 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:46.079467 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:01:46.080468 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:01:46.080468 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:01:46.081454 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:01:46.081454 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:01:46.082468 [info ] [MainThread]: 
[0m15:01:46.082889 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m15:01:46.083904 [debug] [MainThread]: Command end result
[0m15:01:46.113920 [info ] [MainThread]: 
[0m15:01:46.114909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:46.115903 [info ] [MainThread]: 
[0m15:01:46.116913 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:01:46.117911 [info ] [MainThread]: 
[0m15:01:46.118914 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:01:46.121906 [debug] [MainThread]: Command `dbt run` failed at 15:01:46.120907 after 6.43 seconds
[0m15:01:46.121906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238C5D829F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0C922A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DE50D5E0>]}
[0m15:01:46.122903 [debug] [MainThread]: Flushing usage events
[0m15:02:30.830865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DC90B1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DC98EE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DC6C05430>]}


============================== 15:02:30.835377 | c14d58bf-d211-42b7-90e4-04e1afeaa06e ==============================
[0m15:02:30.835377 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:02:30.836686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:02:31.752107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE1554920>]}
[0m15:02:31.797107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE280B3E0>]}
[0m15:02:31.798801 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:32.102827 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:02:32.260189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:32.261194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:32.291203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DCAE95A30>]}
[0m15:02:32.380195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DC9A414F0>]}
[0m15:02:32.381192 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:02:32.382191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE2A0FDD0>]}
[0m15:02:32.383193 [info ] [MainThread]: 
[0m15:02:32.385567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:32.389470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:02:32.399730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:02:32.404502 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:02:32.407488 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:02:32.407488 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:02:32.408750 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:02:32.409499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:32.409499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:33.301309 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.892 seconds
[0m15:02:33.303315 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:02:33.305858 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.896 seconds
[0m15:02:33.306853 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:02:33.426135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:02:33.427147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:02:33.436146 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:02:33.438234 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:02:33.439239 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:02:33.440239 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:02:33.440239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:33.441239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:34.086001 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.645 seconds
[0m15:02:34.088000 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:02:34.264466 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.823 seconds
[0m15:02:34.266520 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:02:34.386249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE292FE90>]}
[0m15:02:34.387249 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:02:34.388249 [info ] [MainThread]: 
[0m15:02:34.393825 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:02:34.394838 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:02:34.395825 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:02:34.396828 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:02:34.402824 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:02:34.403827 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:02:34.430824 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:02:34.432823 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:02:34.433827 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:02:34.434826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:35.296221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m15:02:35.321972 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:02:35.443284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE2891F10>]}
[0m15:02:35.444291 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.05s]
[0m15:02:35.445284 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:02:35.446282 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:02:35.447268 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:02:35.448278 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:02:35.448278 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:02:35.464828 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:02:35.465918 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:02:35.485840 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:02:35.488825 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:02:35.489838 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0),
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(color_count as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:02:35.490832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:02:36.449062 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6766-0000-fd24-0001-4c5e000d612e
[0m15:02:36.449062 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 581
invalid identifier 'COLOR_COUNT'
[0m15:02:36.450048 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:02:36.585982 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:02:36.587071 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c14d58bf-d211-42b7-90e4-04e1afeaa06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE41F08C0>]}
[0m15:02:36.587071 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 1.14s]
[0m15:02:36.588672 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:02:36.590684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:36.591689 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:02:36.591689 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:02:36.592692 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:02:36.592692 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:02:36.593690 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:02:36.593690 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:02:36.593690 [info ] [MainThread]: 
[0m15:02:36.594680 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m15:02:36.596681 [debug] [MainThread]: Command end result
[0m15:02:36.627697 [info ] [MainThread]: 
[0m15:02:36.628681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:36.629691 [info ] [MainThread]: 
[0m15:02:36.629691 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 42 at position 581
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m15:02:36.630682 [info ] [MainThread]: 
[0m15:02:36.631680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:02:36.633401 [debug] [MainThread]: Command `dbt run` failed at 15:02:36.633401 after 5.90 seconds
[0m15:02:36.634402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DC9903050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE292E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DE2BA38C0>]}
[0m15:02:36.634402 [debug] [MainThread]: Flushing usage events
[0m15:03:01.870509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202813B4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020283D721E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020283D73C20>]}


============================== 15:03:01.875509 | b21e306a-2d82-4368-8f35-b2b4d73b83e3 ==============================
[0m15:03:01.875509 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:03:01.876908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:03.009696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029CD4F9E0>]}
[0m15:03:03.066700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029AAB6C90>]}
[0m15:03:03.069700 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:03:03.409807 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:03:03.600161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:03.601167 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:03:03.829739 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:03:03.830742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E54B800>]}
[0m15:03:03.981742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E6AE8A0>]}
[0m15:03:04.082743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E7E16A0>]}
[0m15:03:04.083743 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:03:04.084743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E7EEC00>]}
[0m15:03:04.086745 [info ] [MainThread]: 
[0m15:03:04.087743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:04.092744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:03:04.105742 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:03:04.106741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:03:04.107742 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:03:04.110741 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:03:04.110741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:04.111741 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:03:04.114743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:05.971950 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.861 seconds
[0m15:03:05.972960 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:03:06.188206 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.074 seconds
[0m15:03:06.190221 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:03:06.512422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:03:06.514427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:03:06.522411 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:03:06.525411 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:03:06.526412 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:03:06.526412 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:03:06.527420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:06.527420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:07.264976 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.738 seconds
[0m15:03:07.266979 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:03:07.412820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.885 seconds
[0m15:03:07.414828 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:03:07.534027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E6909E0>]}
[0m15:03:07.535030 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:03:07.536038 [info ] [MainThread]: 
[0m15:03:07.542027 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:03:07.543112 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:03:07.544046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:03:07.544046 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:03:07.551032 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:03:07.553047 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:03:07.581046 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:03:07.583880 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:03:07.584877 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:03:07.586866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:08.408704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m15:03:08.435703 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:03:08.666225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029D0422A0>]}
[0m15:03:08.667220 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.12s]
[0m15:03:08.668228 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:03:08.670228 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:03:08.671225 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:03:08.672214 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:03:08.673213 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:03:08.678222 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:03:08.679222 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:03:08.702741 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:03:08.706737 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:03:08.707744 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
),
trzy AS (SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
    * 
FROM unique_rows)

SELECT DISTINCT * FROM trzy
        );
[0m15:03:08.708740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:13.511714 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.803 seconds
[0m15:03:13.513719 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:03:13.638602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b21e306a-2d82-4368-8f35-b2b4d73b83e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029EC876E0>]}
[0m15:03:13.639602 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.97s]
[0m15:03:13.640602 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:03:13.642593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:13.643597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:03:13.643597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:03:13.644597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:03:13.644597 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:03:13.645601 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:03:13.645601 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:03:13.646597 [info ] [MainThread]: 
[0m15:03:13.647602 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 9.56 seconds (9.56s).
[0m15:03:13.648611 [debug] [MainThread]: Command end result
[0m15:03:13.677711 [info ] [MainThread]: 
[0m15:03:13.678596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:13.679593 [info ] [MainThread]: 
[0m15:03:13.680603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:03:13.682603 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:13.682603 after 11.92 seconds
[0m15:03:13.683602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020281C96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029D172990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020283D92A20>]}
[0m15:03:13.683602 [debug] [MainThread]: Flushing usage events
[0m15:20:50.367151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C07F6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C088B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BDB9A900>]}


============================== 15:20:50.371140 | bed938a7-d0c6-4240-9001-af968d0c5121 ==============================
[0m15:20:50.371140 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:20:50.372401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:20:51.362008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D95CC9E0>]}
[0m15:20:51.409007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D98B24B0>]}
[0m15:20:51.410886 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:20:51.738529 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:20:51.911861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:51.912860 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:20:52.103969 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:20:52.105969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180DAEBC380>]}
[0m15:20:52.224967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D99A7740>]}
[0m15:20:52.318145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D9BE86B0>]}
[0m15:20:52.319146 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:20:52.320145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D99E11F0>]}
[0m15:20:52.321145 [info ] [MainThread]: 
[0m15:20:52.322141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:52.326155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:20:52.340157 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:20:52.340157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:20:52.341144 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:20:52.343145 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:20:52.343145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:52.344158 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:20:52.347155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:53.632731 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.285 seconds
[0m15:20:53.634737 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:20:53.663461 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.320 seconds
[0m15:20:53.665470 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:20:53.841877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:20:53.843879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:20:53.850892 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:20:53.853888 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:20:53.854883 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:20:53.854883 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:20:53.855893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:53.855893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:54.524835 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.669 seconds
[0m15:20:54.526857 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:20:54.651536 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.796 seconds
[0m15:20:54.653539 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:20:54.773131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D98F23F0>]}
[0m15:20:54.774130 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:20:54.775123 [info ] [MainThread]: 
[0m15:20:54.780330 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:20:54.781324 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:20:54.782332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:20:54.783338 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:20:54.789351 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:20:54.790339 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:20:54.817327 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:20:54.819324 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:20:54.820332 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:20:54.820332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:55.534531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m15:20:55.555534 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:20:55.892145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D98B1F40>]}
[0m15:20:55.893152 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.11s]
[0m15:20:55.894134 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:20:55.895140 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:20:55.896128 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:20:55.897126 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:20:55.898128 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:20:55.902128 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:20:55.904127 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:20:55.925138 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:20:55.928124 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:20:55.929137 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     *
FROM null_filled
)

SELECT * FROM null_filled
        );
[0m15:20:55.930130 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:20:57.541931 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m15:20:57.544937 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:20:57.663695 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed938a7-d0c6-4240-9001-af968d0c5121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180DB425220>]}
[0m15:20:57.663695 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.77s]
[0m15:20:57.665687 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:20:57.666686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:57.667695 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:20:57.667695 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:20:57.668696 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:20:57.668696 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:20:57.668696 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:20:57.669685 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:20:57.669685 [info ] [MainThread]: 
[0m15:20:57.670696 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m15:20:57.672690 [debug] [MainThread]: Command end result
[0m15:20:57.701219 [info ] [MainThread]: 
[0m15:20:57.702227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:57.703228 [info ] [MainThread]: 
[0m15:20:57.704226 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:20:57.706224 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:57.706224 after 7.48 seconds
[0m15:20:57.706224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C0791100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D99E1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C0A10320>]}
[0m15:20:57.707224 [debug] [MainThread]: Flushing usage events
[0m15:21:36.430591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D931AAECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9337B64B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92E4590D0>]}


============================== 15:21:36.435101 | f5ec0d0f-c4d5-478b-a4be-fee8065cb146 ==============================
[0m15:21:36.435101 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:21:36.437110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:37.421104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94CC8FF20>]}
[0m15:21:37.464467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94D0E0170>]}
[0m15:21:37.466001 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:21:37.766555 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:21:37.938556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:37.939562 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:21:38.130509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:21:38.131510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94EAA3B90>]}
[0m15:21:38.253378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94E9F2480>]}
[0m15:21:38.351049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94EC8D670>]}
[0m15:21:38.352048 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:21:38.353051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94EAB2390>]}
[0m15:21:38.355566 [info ] [MainThread]: 
[0m15:21:38.356569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:38.360567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:21:38.373094 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:21:38.374601 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:21:38.374601 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:21:38.377610 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:21:38.378614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:38.379610 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:21:38.381606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:39.213142 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.835 seconds
[0m15:21:39.214706 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:21:39.315609 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m15:21:39.316610 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:21:39.433071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:21:39.435086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:21:39.442632 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:21:39.445156 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:21:39.446179 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:21:39.446179 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:21:39.447165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:39.447165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:40.207385 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.760 seconds
[0m15:21:40.209376 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:21:40.270233 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.824 seconds
[0m15:21:40.272226 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:21:40.385959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94ED84EF0>]}
[0m15:21:40.386969 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:21:40.387971 [info ] [MainThread]: 
[0m15:21:40.393964 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:21:40.393964 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:21:40.394966 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:21:40.396183 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:21:40.402179 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:21:40.404692 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:21:40.431754 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:21:40.433750 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:21:40.434752 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:21:40.434752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:41.161971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m15:21:41.183063 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:21:41.312531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94D4E2210>]}
[0m15:21:41.313536 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.92s]
[0m15:21:41.315047 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:21:41.316060 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:21:41.317073 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:21:41.319079 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:21:41.320071 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:21:41.325614 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:21:41.326621 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:21:41.349697 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:21:41.353696 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:21:41.353696 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     *
FROM null_filled
)

SELECT * FROM unique_rows
        );
[0m15:21:41.354705 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:21:43.409350 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.055 seconds
[0m15:21:43.411343 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:21:43.532107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ec0d0f-c4d5-478b-a4be-fee8065cb146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94F075C40>]}
[0m15:21:43.532107 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.21s]
[0m15:21:43.534523 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:21:43.536042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:43.537044 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:21:43.537044 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:21:43.538042 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:21:43.538042 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:21:43.538042 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:21:43.539042 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:21:43.539042 [info ] [MainThread]: 
[0m15:21:43.540042 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m15:21:43.542044 [debug] [MainThread]: Command end result
[0m15:21:43.571141 [info ] [MainThread]: 
[0m15:21:43.572138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:43.573135 [info ] [MainThread]: 
[0m15:21:43.574134 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:21:43.575659 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:43.575659 after 7.25 seconds
[0m15:21:43.576671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9345F7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94EB89850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94EAB3D10>]}
[0m15:21:43.577671 [debug] [MainThread]: Flushing usage events
[0m15:25:28.760185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E77C9EC200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E77F4264B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E77EF40980>]}


============================== 15:25:28.768189 | c4451a2e-5a3a-4a40-bce7-c4a53679ed87 ==============================
[0m15:25:28.768189 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:25:28.769186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:25:29.795039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E717D02870>]}
[0m15:25:29.842038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71874EDE0>]}
[0m15:25:29.843027 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:25:30.150590 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:25:30.330189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:30.330189 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m15:25:30.534251 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:25:30.535249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7187ADFA0>]}
[0m15:25:30.659259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719C907D0>]}
[0m15:25:30.748255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E718A1EB40>]}
[0m15:25:30.749250 [info ] [MainThread]: Found 2 models, 1 test, 575 macros
[0m15:25:30.750255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719C227B0>]}
[0m15:25:30.752259 [info ] [MainThread]: 
[0m15:25:30.753258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:30.757270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:25:30.771263 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:25:30.771263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m15:25:30.772280 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:25:30.774279 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m15:25:30.775284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:30.775284 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m15:25:30.778273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:31.760869 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.983 seconds
[0m15:25:31.762873 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:25:31.772423 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.997 seconds
[0m15:25:31.773417 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m15:25:31.886990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m15:25:31.888990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m15:25:31.896976 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m15:25:31.899813 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m15:25:31.900384 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m15:25:31.901069 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m15:25:31.901555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:31.901555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:32.559748 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.658 seconds
[0m15:25:32.560747 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m15:25:32.704570 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.803 seconds
[0m15:25:32.706581 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m15:25:32.818258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719CCDAC0>]}
[0m15:25:32.819292 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:25:32.819292 [info ] [MainThread]: 
[0m15:25:32.825543 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m15:25:32.826561 [info ] [Thread-1 (]: 1 of 2 START sql view model products_schema.stg_products ....................... [RUN]
[0m15:25:32.827569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m15:25:32.828567 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m15:25:32.834567 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m15:25:32.835572 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m15:25:32.863566 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m15:25:32.865560 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m15:25:32.866564 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m15:25:32.867559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:33.559464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m15:25:33.580460 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m15:25:33.691731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7187122A0>]}
[0m15:25:33.692731 [info ] [Thread-1 (]: 1 of 2 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m15:25:33.693722 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m15:25:33.694732 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m15:25:33.695727 [info ] [Thread-3 (]: 2 of 2 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m15:25:33.696722 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m15:25:33.697727 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m15:25:33.701833 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m15:25:33.703824 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m15:25:33.723828 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m15:25:33.727827 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m15:25:33.727827 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),
null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),
unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
    FROM unique_rows
        );
[0m15:25:33.728832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:25:35.776046 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.047 seconds
[0m15:25:35.778053 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m15:25:35.888231 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4451a2e-5a3a-4a40-bce7-c4a53679ed87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71A2F6600>]}
[0m15:25:35.888231 [info ] [Thread-3 (]: 2 of 2 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.19s]
[0m15:25:35.890227 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m15:25:35.892236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:35.892236 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:25:35.893232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m15:25:35.893232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m15:25:35.894236 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m15:25:35.894236 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m15:25:35.895237 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m15:25:35.895237 [info ] [MainThread]: 
[0m15:25:35.896236 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m15:25:35.899227 [debug] [MainThread]: Command end result
[0m15:25:35.932229 [info ] [MainThread]: 
[0m15:25:35.933236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:35.934230 [info ] [MainThread]: 
[0m15:25:35.935237 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:25:35.937241 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:35.936226 after 7.32 seconds
[0m15:25:35.937241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E77F5311F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7175DDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719BE06B0>]}
[0m15:25:35.938226 [debug] [MainThread]: Flushing usage events
[0m21:56:37.700513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5D08B2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5D7464B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5D08BF20>]}


============================== 21:56:37.709050 | 2e7e9a30-e22a-4ace-bfb0-9391d9015e4d ==============================
[0m21:56:37.709050 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:56:37.711039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:37.717050 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m21:56:37.719201 [debug] [MainThread]: Command `dbt run` failed at 21:56:37.719201 after 0.20 seconds
[0m21:56:37.720198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5E0D3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5D0BA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5CD67380>]}
[0m21:56:37.720198 [debug] [MainThread]: Flushing usage events
[0m21:57:22.945369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5CA84B500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5CA84B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5CA849A00>]}


============================== 21:57:22.950421 | 9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934 ==============================
[0m21:57:22.950421 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:57:22.950421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:57:30.611908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E38A2C90>]}
[0m21:57:30.672702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5CA84B440>]}
[0m21:57:30.674703 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:57:31.218360 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:57:31.316472 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:57:31.317479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E3926B10>]}
[0m21:57:33.999166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:57:34.000174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E4CDA4B0>]}
[0m21:57:34.360007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5CA8F1A60>]}
[0m21:57:34.566422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E4EA8500>]}
[0m21:57:34.567421 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m21:57:34.567421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C94D7AD0>]}
[0m21:57:34.572943 [info ] [MainThread]: 
[0m21:57:34.573946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:34.579980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:57:34.581508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:57:34.597032 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:57:34.598606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:57:34.602546 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:57:34.603547 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:57:34.607554 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:57:34.608552 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:57:34.609751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:34.610754 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:57:34.611749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:34.618750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:36.689723 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.072 seconds
[0m21:57:36.691250 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:57:36.782842 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.173 seconds
[0m21:57:36.784840 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:57:36.908524 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.297 seconds
[0m21:57:36.911529 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:57:37.075669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now create_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m21:57:37.079914 [debug] [ThreadPool]: Creating schema "database: "E_COMMERCE_PRODUCT"
schema: "products_schema_analytics"
"
[0m21:57:37.085921 [debug] [ThreadPool]: Using snowflake connection "create_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m21:57:37.086913 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "create_E_COMMERCE_PRODUCT_products_schema_analytics"} */
create schema if not exists E_COMMERCE_PRODUCT.products_schema_analytics
[0m21:57:37.086913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:37.881073 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.794 seconds
[0m21:57:37.882073 [debug] [ThreadPool]: On create_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m21:57:37.999421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:57:38.001442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m21:57:38.009073 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:57:38.009970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:57:38.012980 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m21:57:38.013971 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:57:38.015980 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:57:38.016979 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m21:57:38.017984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:38.017984 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:57:38.018984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:38.020517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:38.817639 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.800 seconds
[0m21:57:38.820168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:57:38.860089 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.839 seconds
[0m21:57:38.861089 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:57:39.017234 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.998 seconds
[0m21:57:39.018750 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m21:57:39.138642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E3B8E630>]}
[0m21:57:39.139877 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:57:39.139877 [info ] [MainThread]: 
[0m21:57:39.152120 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:57:39.153116 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:57:39.153116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:57:39.154123 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:57:39.160667 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:57:39.162671 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:57:39.192293 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:57:39.194915 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:57:39.194915 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:57:39.195902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:57:39.933078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m21:57:39.956118 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:57:40.066958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E3861F10>]}
[0m21:57:40.066958 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m21:57:40.068962 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:57:40.070063 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:57:40.071061 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:57:40.072066 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:57:40.072066 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:57:40.077066 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:57:40.079056 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:57:40.102736 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:57:40.107738 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:57:40.107738 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m21:57:40.108735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:44.433630 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.324 seconds
[0m21:57:44.435635 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:57:44.551047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E530D550>]}
[0m21:57:44.552036 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.48s]
[0m21:57:44.553052 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:57:44.554059 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m21:57:44.555047 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m21:57:44.556038 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m21:57:44.557040 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m21:57:44.561564 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m21:57:44.563565 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m21:57:44.566562 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m21:57:44.569073 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m21:57:44.570082 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        *
    FROM cols_to_keep
)

SELECT 
    *
FROM id_generated;
[0m21:57:44.571092 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m21:57:45.323777 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba6905-0000-fce6-0001-4c5e000d70f6
[0m21:57:45.324774 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 4 unexpected 'SELECT'.
syntax error line 7 at position 30 unexpected 'avg_price_dollars'.
syntax error line 8 at position 25 unexpected 'avg_discount'.
syntax error line 9 at position 36 unexpected 'avg_sold_proposition'.
syntax error line 10 at position 4 unexpected 'FROM'.
syntax error line 13 at position 0 unexpected ')'.
[0m21:57:45.324774 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m21:57:45.436877 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 7 at position 30 unexpected 'avg_price_dollars'.
  syntax error line 8 at position 25 unexpected 'avg_discount'.
  syntax error line 9 at position 36 unexpected 'avg_sold_proposition'.
  syntax error line 10 at position 4 unexpected 'FROM'.
  syntax error line 13 at position 0 unexpected ')'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:57:45.436877 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2b0544-7cc6-44d8-bc69-d3e5cd0e3934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C6D8F9B0>]}
[0m21:57:45.437894 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.88s]
[0m21:57:45.438894 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m21:57:45.441417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:45.441417 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:57:45.442423 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:57:45.442423 [debug] [MainThread]: Connection 'create_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m21:57:45.443417 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:57:45.444416 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m21:57:45.444416 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:57:45.445427 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:57:45.445427 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:57:45.446418 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m21:57:45.447433 [info ] [MainThread]: 
[0m21:57:45.447433 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m21:57:45.449957 [debug] [MainThread]: Command end result
[0m21:57:45.481207 [info ] [MainThread]: 
[0m21:57:45.482206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:57:45.483208 [info ] [MainThread]: 
[0m21:57:45.484207 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 7 at position 30 unexpected 'avg_price_dollars'.
  syntax error line 8 at position 25 unexpected 'avg_discount'.
  syntax error line 9 at position 36 unexpected 'avg_sold_proposition'.
  syntax error line 10 at position 4 unexpected 'FROM'.
  syntax error line 13 at position 0 unexpected ')'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:57:45.485208 [info ] [MainThread]: 
[0m21:57:45.486715 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:57:45.487724 [debug] [MainThread]: Command `dbt run` failed at 21:57:45.487724 after 22.66 seconds
[0m21:57:45.487724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E3C0DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C6E9EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E3A0CAA0>]}
[0m21:57:45.489232 [debug] [MainThread]: Flushing usage events
[0m21:58:12.609899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A941B31D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A941B39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8EFC90D0>]}


============================== 21:58:12.614826 | 20d2fa31-a171-4ead-81d1-5d5e08aa8d26 ==============================
[0m21:58:12.614826 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:58:12.615448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:13.576154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A93CE4E60>]}
[0m21:58:13.635191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AACDA7C80>]}
[0m21:58:13.636189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:58:13.978680 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:58:14.148828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:14.149837 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m21:58:14.350238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAF640380>]}
[0m21:58:14.440118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAF6F55B0>]}
[0m21:58:14.440891 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m21:58:14.441910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAF53FE00>]}
[0m21:58:14.442910 [info ] [MainThread]: 
[0m21:58:14.444914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:14.448910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:14.449914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:14.461535 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:14.462537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:14.465543 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:14.466551 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:14.468536 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:14.470064 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:14.471090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:14.472091 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:14.473090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:14.475086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:15.989252 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.516 seconds
[0m21:58:15.990790 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:15.997928 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.523 seconds
[0m21:58:15.999928 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:16.019994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.549 seconds
[0m21:58:16.021019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:16.142084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m21:58:16.143093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:58:16.151637 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m21:58:16.151637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:58:16.154637 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:58:16.155627 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m21:58:16.158168 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:58:16.159161 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:58:16.159161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:16.160169 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:58:16.161280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:16.163279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:16.960971 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.801 seconds
[0m21:58:16.961975 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m21:58:17.000403 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.839 seconds
[0m21:58:17.001416 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:58:17.418018 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.255 seconds
[0m21:58:17.419017 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:58:17.528300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAFA7F020>]}
[0m21:58:17.529331 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:58:17.530336 [info ] [MainThread]: 
[0m21:58:17.535623 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:58:17.536647 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:58:17.537637 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:58:17.538643 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:58:17.545166 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:58:17.546170 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:58:17.574840 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:58:17.576846 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:58:17.576846 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:58:17.577845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:58:18.386133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.808 seconds
[0m21:58:18.408728 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:58:18.517195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAFAF9310>]}
[0m21:58:18.518202 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.98s]
[0m21:58:18.520189 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:58:18.520698 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:58:18.521717 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:58:18.522715 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:58:18.523716 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:58:18.528720 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:58:18.531424 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:58:18.551112 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:58:18.554109 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:58:18.555626 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m21:58:18.556643 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:21.917356 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.361 seconds
[0m21:58:21.919354 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:58:22.033304 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAFB6E3C0>]}
[0m21:58:22.033304 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.51s]
[0m21:58:22.035306 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:58:22.036311 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m21:58:22.037304 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m21:58:22.038310 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m21:58:22.038310 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m21:58:22.043844 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m21:58:22.044852 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m21:58:22.047852 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m21:58:22.050392 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m21:58:22.050463 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        *
    FROM cols_to_keep
)

SELECT 
    *
FROM id_generated;
[0m21:58:22.051409 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m21:58:22.740808 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba6906-0000-fce6-0001-4c5e000d70fa
[0m21:58:22.741823 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 17 unexpected ';'.
[0m21:58:22.742820 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m21:58:22.864012 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 17 unexpected ';'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:58:22.865012 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d2fa31-a171-4ead-81d1-5d5e08aa8d26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAFAE3950>]}
[0m21:58:22.866008 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.83s]
[0m21:58:22.867011 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m21:58:22.869010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:22.869010 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:22.869010 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:22.869010 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:22.870921 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m21:58:22.870921 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:58:22.871934 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:58:22.871934 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:58:22.871934 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:58:22.872953 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m21:58:22.872953 [info ] [MainThread]: 
[0m21:58:22.873957 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m21:58:22.875951 [debug] [MainThread]: Command end result
[0m21:58:22.907252 [info ] [MainThread]: 
[0m21:58:22.908242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:58:22.908242 [info ] [MainThread]: 
[0m21:58:22.909245 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 17 unexpected ';'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:58:22.910261 [info ] [MainThread]: 
[0m21:58:22.911328 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:58:22.913328 [debug] [MainThread]: Command `dbt run` failed at 21:58:22.913328 after 10.41 seconds
[0m21:58:22.913328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A951C7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAF7522D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAE181F70>]}
[0m21:58:22.914334 [debug] [MainThread]: Flushing usage events
[0m21:58:33.037571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E4DB75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E22CF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E5DE77A0>]}


============================== 21:58:33.042138 | 8eeecfa7-3d76-491d-9077-39e38603beca ==============================
[0m21:58:33.042138 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:58:33.043134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:58:33.973019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FED2E240>]}
[0m21:58:34.017707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FECCEB40>]}
[0m21:58:34.018702 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:58:34.329077 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:58:34.495278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:34.495278 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m21:58:34.688103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF2D9670>]}
[0m21:58:34.774974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FEFA0320>]}
[0m21:58:34.776487 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m21:58:34.777497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF1B73E0>]}
[0m21:58:34.779500 [info ] [MainThread]: 
[0m21:58:34.780496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:34.784581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:34.797663 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:34.797663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:34.798662 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:34.799664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m21:58:34.803190 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:34.804193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:34.807193 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m21:58:34.807193 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:34.810698 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m21:58:34.811705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:34.811705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:36.829831 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.019 seconds
[0m21:58:36.831347 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:36.839018 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.035 seconds
[0m21:58:36.841016 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:36.849515 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.037 seconds
[0m21:58:36.851084 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m21:58:36.966804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m21:58:36.969840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m21:58:36.976353 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m21:58:36.979895 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m21:58:36.980883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m21:58:36.981391 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m21:58:36.982400 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m21:58:36.984401 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m21:58:36.985402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:36.986402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:36.986402 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m21:58:36.989410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:37.796262 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.806 seconds
[0m21:58:37.798262 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m21:58:37.803797 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.818 seconds
[0m21:58:37.805794 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m21:58:37.938955 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.954 seconds
[0m21:58:37.940973 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m21:58:38.052917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF284440>]}
[0m21:58:38.053919 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:58:38.054916 [info ] [MainThread]: 
[0m21:58:38.059907 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m21:58:38.061414 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m21:58:38.062421 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m21:58:38.063424 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m21:58:38.069425 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m21:58:38.070934 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m21:58:38.098552 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m21:58:38.101063 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m21:58:38.102080 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m21:58:38.102080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:58:38.791248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m21:58:38.811337 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m21:58:38.928467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FEC92240>]}
[0m21:58:38.929468 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m21:58:38.931042 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m21:58:38.932010 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m21:58:38.933003 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m21:58:38.933998 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m21:58:38.934998 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m21:58:38.939007 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m21:58:38.941002 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m21:58:38.961620 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m21:58:38.966626 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m21:58:38.967628 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m21:58:38.967628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:40.575141 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.607 seconds
[0m21:58:40.577145 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m21:58:40.695964 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF754890>]}
[0m21:58:40.695964 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.76s]
[0m21:58:40.697970 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m21:58:40.698962 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m21:58:40.699971 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m21:58:40.700965 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m21:58:40.701482 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m21:58:40.706504 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m21:58:40.707495 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m21:58:40.711008 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m21:58:40.713020 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m21:58:40.713020 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        *
    FROM cols_to_keep
)

SELECT 
    *
FROM id_generated
        );
[0m21:58:40.714024 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m21:58:41.312012 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba6906-0000-fd0b-0001-4c5e000ce32a
[0m21:58:41.312012 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 13
invalid identifier 'PRICE'
[0m21:58:41.313016 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m21:58:41.429257 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PRICE'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:58:41.429257 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeecfa7-3d76-491d-9077-39e38603beca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF71F620>]}
[0m21:58:41.430836 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.73s]
[0m21:58:41.431788 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m21:58:41.434795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:41.435788 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:41.435788 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:41.435788 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m21:58:41.436789 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m21:58:41.436789 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m21:58:41.437795 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m21:58:41.437795 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m21:58:41.437795 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m21:58:41.438795 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m21:58:41.438795 [info ] [MainThread]: 
[0m21:58:41.439795 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m21:58:41.441299 [debug] [MainThread]: Command end result
[0m21:58:41.476400 [info ] [MainThread]: 
[0m21:58:41.477394 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:58:41.478411 [info ] [MainThread]: 
[0m21:58:41.479399 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PRICE'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m21:58:41.479399 [info ] [MainThread]: 
[0m21:58:41.480907 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:58:41.483466 [debug] [MainThread]: Command `dbt run` failed at 21:58:41.482450 after 8.55 seconds
[0m21:58:41.483466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E22CF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FF2DA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E54A5070>]}
[0m21:58:41.484468 [debug] [MainThread]: Flushing usage events
[0m22:00:09.324502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D4C295B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D2D5ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D5796930>]}


============================== 22:00:09.329507 | 39e16147-7904-4788-b6ea-069917861344 ==============================
[0m22:00:09.329507 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:00:09.330508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:00:10.308872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EE70E780>]}
[0m22:00:10.353995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EE7DD2E0>]}
[0m22:00:10.355904 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:00:10.677689 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:00:10.851964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:10.851964 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:00:11.059715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EFD403B0>]}
[0m22:00:11.163469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EFDC4320>]}
[0m22:00:11.164670 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:00:11.165675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EEAB8350>]}
[0m22:00:11.167676 [info ] [MainThread]: 
[0m22:00:11.168683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:00:11.172671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:00:11.185722 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:00:11.186723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:00:11.187716 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:00:11.187716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:00:11.191731 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:00:11.191731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:11.195118 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:00:11.196103 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:00:11.198129 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:00:11.200111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:11.201109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:12.397295 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.197 seconds
[0m22:00:12.399294 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:00:12.405296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.204 seconds
[0m22:00:12.406290 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:00:12.626694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.435 seconds
[0m22:00:12.627699 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:00:12.741260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:00:12.742268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:00:12.751905 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:00:12.751905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:00:12.754906 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:00:12.755906 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:00:12.758906 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:00:12.759900 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:00:12.759900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:12.760901 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:00:12.761902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:12.763892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:13.536236 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.776 seconds
[0m22:00:13.537229 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:00:13.599194 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.838 seconds
[0m22:00:13.601195 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:00:13.755499 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.992 seconds
[0m22:00:13.757500 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:00:13.876640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EFDC41D0>]}
[0m22:00:13.877522 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:00:13.878506 [info ] [MainThread]: 
[0m22:00:13.884264 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:00:13.885264 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:00:13.886272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:00:13.887269 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:00:13.894263 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:00:13.895267 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:00:13.922281 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:00:13.924265 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:00:13.925272 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:00:13.926263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:00:14.660688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m22:00:14.681691 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:00:14.801163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F0143CB0>]}
[0m22:00:14.802172 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m22:00:14.803155 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:00:14.804159 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:00:14.805163 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:00:14.806163 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:00:14.807154 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:00:14.811167 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:00:14.813160 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:00:14.833176 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:00:14.837162 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:00:14.837162 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:00:14.838161 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:00:18.247887 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.410 seconds
[0m22:00:18.249885 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:00:18.358808 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F019E390>]}
[0m22:00:18.359808 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.55s]
[0m22:00:18.360884 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:00:18.361814 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:00:18.362804 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:00:18.364103 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:00:18.365118 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:00:18.370148 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:00:18.371140 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:00:18.374160 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:00:18.376149 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:00:18.377159 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        *
    FROM cols_to_keep
)

SELECT 
    *
FROM id_generated
        );
[0m22:00:18.377159 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:00:19.178780 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba6908-0000-fd0b-0001-4c5e000ce32e
[0m22:00:19.178780 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 31
invalid identifier 'C'
[0m22:00:19.179777 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:00:19.300790 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:00:19.301791 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e16147-7904-4788-b6ea-069917861344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EFE64290>]}
[0m22:00:19.301791 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.94s]
[0m22:00:19.303784 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:00:19.305774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:19.306785 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:00:19.306785 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:00:19.307787 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:00:19.307787 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:00:19.307787 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:00:19.308774 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:00:19.308774 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:00:19.309776 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:00:19.309776 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:00:19.310777 [info ] [MainThread]: 
[0m22:00:19.311785 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.14 seconds (8.14s).
[0m22:00:19.313784 [debug] [MainThread]: Command end result
[0m22:00:19.346792 [info ] [MainThread]: 
[0m22:00:19.347780 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:00:19.349166 [info ] [MainThread]: 
[0m22:00:19.350156 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:00:19.351159 [info ] [MainThread]: 
[0m22:00:19.352157 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:00:19.355155 [debug] [MainThread]: Command `dbt run` failed at 22:00:19.354159 after 10.18 seconds
[0m22:00:19.355155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EFB680E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D5053890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223D5051DF0>]}
[0m22:00:19.356154 [debug] [MainThread]: Flushing usage events
[0m22:02:02.892145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF8D20170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF561F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF8FF27B0>]}


============================== 22:02:02.896151 | ee48fed1-49da-4583-9186-2c969f6f48a2 ==============================
[0m22:02:02.896151 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:02:02.898147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:02:03.840274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B921FAB70>]}
[0m22:02:03.885805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF80DFAD0>]}
[0m22:02:03.887131 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:02:04.191988 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:02:04.350549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:04.350549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:04.381113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF8C136B0>]}
[0m22:02:04.475237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B93618CB0>]}
[0m22:02:04.476242 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:02:04.476242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B92411760>]}
[0m22:02:04.478242 [info ] [MainThread]: 
[0m22:02:04.479238 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:04.483384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:02:04.497610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:02:04.498601 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:02:04.501596 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:02:04.502010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:02:04.502579 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:02:04.503614 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:02:04.506598 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:02:04.506598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:04.507607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:04.508598 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:02:04.512608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:05.718671 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.206 seconds
[0m22:02:05.719684 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:02:05.722690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.216 seconds
[0m22:02:05.723688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.217 seconds
[0m22:02:05.725693 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:02:05.727689 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:02:06.046530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:02:06.047535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:02:06.056532 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:02:06.058529 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:02:06.059529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:02:06.059529 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:02:06.060531 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:02:06.062531 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:02:06.063525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:06.064515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:06.064515 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:02:06.068535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:06.828242 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.765 seconds
[0m22:02:06.830262 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:02:06.940395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.872 seconds
[0m22:02:06.941389 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:02:06.952048 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m22:02:06.954055 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:02:07.077139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF6BC0800>]}
[0m22:02:07.078129 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:02:07.079130 [info ] [MainThread]: 
[0m22:02:07.085028 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:02:07.086014 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:02:07.087024 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:02:07.088023 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:02:07.094033 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:02:07.095024 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:02:07.122030 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:02:07.124023 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:02:07.125017 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:02:07.125017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:02:08.162988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.037 seconds
[0m22:02:08.182535 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:02:08.300210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B92101F10>]}
[0m22:02:08.301215 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.21s]
[0m22:02:08.302201 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:02:08.304202 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:02:08.304202 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:02:08.305205 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:02:08.306204 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:02:08.321206 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:02:08.322214 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:02:08.342202 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:02:08.346199 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:02:08.347203 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:02:08.347203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:02:12.415255 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.068 seconds
[0m22:02:12.417250 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:02:12.540816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9389AAB0>]}
[0m22:02:12.541823 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.24s]
[0m22:02:12.542820 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:02:12.543723 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:02:12.544743 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:02:12.545750 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:02:12.546753 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:02:12.550753 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:02:12.551754 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:02:12.554778 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:02:12.557771 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:02:12.558782 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        *
    FROM cols_to_keep
)

SELECT 
    *
FROM id_generated
        );
[0m22:02:12.558782 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:02:13.180841 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba690a-0000-fd24-0001-4c5e000d6236
[0m22:02:13.181846 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 31
invalid identifier 'C'
[0m22:02:13.181846 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:02:13.306909 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:02:13.307911 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee48fed1-49da-4583-9186-2c969f6f48a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B936AC3B0>]}
[0m22:02:13.308910 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.76s]
[0m22:02:13.309908 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:02:13.311649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:13.312652 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:02:13.313652 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:02:13.313652 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:02:13.313652 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:02:13.314657 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:02:13.314657 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:02:13.315657 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:02:13.315657 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:02:13.315657 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:02:13.316657 [info ] [MainThread]: 
[0m22:02:13.317345 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.84 seconds (8.84s).
[0m22:02:13.319374 [debug] [MainThread]: Command end result
[0m22:02:13.351375 [info ] [MainThread]: 
[0m22:02:13.352365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:02:13.353363 [info ] [MainThread]: 
[0m22:02:13.354369 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:02:13.355365 [info ] [MainThread]: 
[0m22:02:13.356360 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:02:13.358374 [debug] [MainThread]: Command `dbt run` failed at 22:02:13.357361 after 10.61 seconds
[0m22:02:13.358374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B92412840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B92142EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF8FCB380>]}
[0m22:02:13.359362 [debug] [MainThread]: Flushing usage events
[0m22:03:12.592014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71F5B6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E721B50170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E721AD7B60>]}


============================== 22:03:12.596598 | d38e9907-e3fa-4e82-b4a1-add7fdd385b5 ==============================
[0m22:03:12.596598 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:03:12.597366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:13.627773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E739F2FA70>]}
[0m22:03:13.675420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73A5F7950>]}
[0m22:03:13.676423 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:03:13.996701 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:03:14.153274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:14.154276 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:03:14.356352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71FE303B0>]}
[0m22:03:14.450076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73C8D5490>]}
[0m22:03:14.451074 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:03:14.452080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73B64A510>]}
[0m22:03:14.454070 [info ] [MainThread]: 
[0m22:03:14.455058 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:14.459061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:03:14.460436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:03:14.472965 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:03:14.473965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:03:14.476967 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:03:14.477970 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:03:14.481102 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:03:14.481102 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:03:14.482099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:14.483099 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:03:14.486099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:14.484097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:15.552463 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.071 seconds
[0m22:03:15.554451 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:03:15.555452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.072 seconds
[0m22:03:15.558979 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:03:15.653301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.167 seconds
[0m22:03:15.655300 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:03:15.778158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:03:15.778158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:03:15.781478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:03:15.789001 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:03:15.792024 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:03:15.794025 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:03:15.795019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:03:15.795019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:03:15.796026 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:03:15.797013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:15.797013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:15.798022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:16.670675 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.873 seconds
[0m22:03:16.672706 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:03:16.859006 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.061 seconds
[0m22:03:16.860022 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:03:16.945916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.149 seconds
[0m22:03:16.947913 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:03:17.229149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73C88BCE0>]}
[0m22:03:17.229149 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:03:17.230178 [info ] [MainThread]: 
[0m22:03:17.236168 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:03:17.237157 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:03:17.237814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:03:17.237814 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:03:17.244907 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:03:17.246914 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:03:17.274492 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:03:17.276493 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:03:17.277496 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:03:17.278495 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:18.264175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m22:03:18.285278 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:03:18.401259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73B271DC0>]}
[0m22:03:18.402260 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.16s]
[0m22:03:18.404262 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:03:18.405247 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:03:18.406254 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:03:18.407255 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:03:18.407255 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:03:18.412805 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:03:18.413801 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:03:18.434897 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:03:18.437882 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:03:18.437882 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:03:18.437882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:20.742523 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.304 seconds
[0m22:03:20.745528 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:03:20.864702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73AF98200>]}
[0m22:03:20.865702 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.46s]
[0m22:03:20.866705 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:03:20.867703 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:03:20.867703 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:03:20.868708 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:03:20.869708 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:03:20.874703 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:03:20.875708 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:03:20.878707 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:03:20.881703 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:03:20.881703 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_selling_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:03:20.882706 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:03:21.625349 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba690b-0000-fd0b-0001-4c5e000ce33e
[0m22:03:21.625349 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 31
invalid identifier 'C'
[0m22:03:21.626344 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:03:21.742484 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:03:21.743484 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e9907-e3fa-4e82-b4a1-add7fdd385b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73C978410>]}
[0m22:03:21.744485 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.87s]
[0m22:03:21.745024 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:03:21.748049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:21.749058 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:03:21.749058 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:03:21.750039 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:03:21.750039 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:03:21.751048 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:03:21.751566 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:03:21.751566 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:03:21.752576 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:03:21.752576 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:03:21.753583 [info ] [MainThread]: 
[0m22:03:21.754572 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m22:03:21.755585 [debug] [MainThread]: Command end result
[0m22:03:21.787138 [info ] [MainThread]: 
[0m22:03:21.788140 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:03:21.789138 [info ] [MainThread]: 
[0m22:03:21.790135 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:03:21.792137 [info ] [MainThread]: 
[0m22:03:21.793139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:03:21.795131 [debug] [MainThread]: Command `dbt run` failed at 22:03:21.795131 after 9.32 seconds
[0m22:03:21.796127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71F5B6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E73A28D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71E68A3F0>]}
[0m22:03:21.796127 [debug] [MainThread]: Flushing usage events
[0m22:04:14.062613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D18D81D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D198E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D18D81A0>]}


============================== 22:04:14.067180 | 0df098cc-c010-4ec8-aca6-8d70857979a1 ==============================
[0m22:04:14.067180 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:04:14.068179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:04:15.072799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D0C460F0>]}
[0m22:04:15.117433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EAB4CFE0>]}
[0m22:04:15.119432 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:04:15.429914 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:04:15.593525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:15.594525 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:04:15.785948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EC0E9880>]}
[0m22:04:15.878176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EC0EAA50>]}
[0m22:04:15.879175 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:04:15.879175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EB0C41A0>]}
[0m22:04:15.881186 [info ] [MainThread]: 
[0m22:04:15.882185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:15.887455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:04:15.893981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:04:15.903551 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:04:15.905543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:04:15.909549 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:04:15.910543 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:04:15.913048 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:04:15.913048 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:04:15.914062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:15.915060 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:04:15.915060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:15.918066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:17.021079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.103 seconds
[0m22:04:17.021079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.108 seconds
[0m22:04:17.023596 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:04:17.025604 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:04:17.120521 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.205 seconds
[0m22:04:17.121523 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:04:17.236722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:04:17.238708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:04:17.247232 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:04:17.248313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:04:17.250241 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:04:17.251246 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:04:17.253771 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:04:17.254775 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:04:17.255762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:17.255762 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:04:17.256761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:17.258767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:18.161121 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.902 seconds
[0m22:04:18.162805 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:04:18.199562 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.943 seconds
[0m22:04:18.199562 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.945 seconds
[0m22:04:18.201567 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:04:18.203101 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:04:18.327554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EB0053D0>]}
[0m22:04:18.328554 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:04:18.329558 [info ] [MainThread]: 
[0m22:04:18.335633 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:04:18.336625 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:04:18.337631 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:04:18.338630 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:04:18.345163 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:04:18.346160 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:04:18.372776 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:04:18.374784 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:04:18.375787 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:04:18.376791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:04:19.047540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m22:04:19.067293 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:04:19.174092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EAAD2240>]}
[0m22:04:19.175091 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m22:04:19.177084 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:04:19.178091 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:04:19.179083 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:04:19.180093 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:04:19.180093 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:04:19.185632 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:04:19.186625 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:04:19.208232 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:04:19.211240 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:04:19.211240 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:04:19.212832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:04:21.146341 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.934 seconds
[0m22:04:21.148346 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:04:21.258361 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EAC61550>]}
[0m22:04:21.259366 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.08s]
[0m22:04:21.260352 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:04:21.261364 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:04:21.262885 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:04:21.263243 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:04:21.264268 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:04:21.268806 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:04:21.269791 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:04:21.272801 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:04:21.275269 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:04:21.275269 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(c as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(e as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(g as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(r as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(y as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_selling_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:04:21.276271 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:04:22.036802 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba690c-0000-fd29-0001-4c5e000d12ae
[0m22:04:22.037806 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 31
invalid identifier 'C'
[0m22:04:22.037806 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:04:22.163374 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:04:22.164396 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df098cc-c010-4ec8-aca6-8d70857979a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EC4E7560>]}
[0m22:04:22.165384 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.90s]
[0m22:04:22.166397 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:04:22.168826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:22.168826 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:04:22.168826 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:04:22.169827 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:04:22.169827 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:04:22.170827 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:04:22.171823 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:04:22.171823 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:04:22.172834 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:04:22.172834 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:04:22.173871 [info ] [MainThread]: 
[0m22:04:22.174871 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m22:04:22.175864 [debug] [MainThread]: Command end result
[0m22:04:22.206043 [info ] [MainThread]: 
[0m22:04:22.207033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:22.208045 [info ] [MainThread]: 
[0m22:04:22.209035 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'C'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:04:22.210047 [info ] [MainThread]: 
[0m22:04:22.211050 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:04:22.212567 [debug] [MainThread]: Command `dbt run` failed at 22:04:22.212567 after 8.26 seconds
[0m22:04:22.213574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D198E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EAEA6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EB0C4170>]}
[0m22:04:22.213574 [debug] [MainThread]: Flushing usage events
[0m22:05:40.453133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1CD7530E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1CACFEC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1CA871100>]}


============================== 22:05:40.457471 | ffe83869-a81e-4d87-9598-5f4bd84a48f1 ==============================
[0m22:05:40.457471 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:05:40.458482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.509491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E6778DD0>]}
[0m22:05:41.560510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1CC85E330>]}
[0m22:05:41.562511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:05:41.915470 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:05:42.087599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:42.088606 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:05:42.284720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E7CF5A60>]}
[0m22:05:42.381157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E69F3D70>]}
[0m22:05:42.382157 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:05:42.383156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E7CF5FD0>]}
[0m22:05:42.385158 [info ] [MainThread]: 
[0m22:05:42.386168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:42.390174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:05:42.391221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:05:42.406165 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:05:42.408161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:05:42.409715 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:05:42.411020 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:05:42.414554 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:05:42.415556 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:05:42.416563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:42.416563 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:05:42.417555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:42.420561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.468487 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.051 seconds
[0m22:05:43.470003 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:05:43.475022 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.059 seconds
[0m22:05:43.477031 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:05:43.679634 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.259 seconds
[0m22:05:43.681638 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:05:43.795900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:05:43.797902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:05:43.806906 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:05:43.809903 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:05:43.809903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:05:43.811904 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:05:43.811904 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:05:43.814896 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:05:43.815886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.816908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.817901 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:05:43.821892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:44.724078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.908 seconds
[0m22:05:44.727088 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:05:44.730088 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.908 seconds
[0m22:05:44.731088 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:05:44.745276 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.929 seconds
[0m22:05:44.747270 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:05:44.861601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E69F0A40>]}
[0m22:05:44.862601 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:05:44.862601 [info ] [MainThread]: 
[0m22:05:44.868676 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:05:44.869693 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:05:44.869693 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:05:44.871208 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:05:44.877778 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:05:44.878772 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:05:44.904770 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:05:44.906771 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:05:44.907767 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:05:44.907767 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:45.625014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m22:05:45.647008 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:05:45.995502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E66CA510>]}
[0m22:05:45.995502 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.12s]
[0m22:05:45.997490 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:05:45.998503 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:05:45.999490 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:05:46.000498 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:05:46.001498 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:05:46.006495 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:05:46.007490 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:05:46.029497 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:05:46.033487 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:05:46.034506 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:05:46.035499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:05:48.914433 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.879 seconds
[0m22:05:48.916439 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:05:49.044754 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E81AF7D0>]}
[0m22:05:49.045751 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.04s]
[0m22:05:49.046751 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:05:49.047752 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:05:49.048750 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:05:49.049740 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:05:49.050741 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:05:49.053749 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:05:49.055755 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:05:49.057750 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:05:49.059748 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:05:49.060758 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_selling_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:05:49.061741 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:05:49.815594 [debug] [Thread-5 (]: Snowflake adapter: Snowflake query id: 01ba690d-0000-fd29-0001-4c5e000d12ba
[0m22:05:49.816589 [debug] [Thread-5 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 8
invalid identifier 'AVG_SELLING_PROPOSITION'
[0m22:05:49.817594 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:05:49.931434 [debug] [Thread-5 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'AVG_SELLING_PROPOSITION'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:05:49.932434 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffe83869-a81e-4d87-9598-5f4bd84a48f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E8169C70>]}
[0m22:05:49.932434 [error] [Thread-5 (]: 3 of 3 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.88s]
[0m22:05:49.933431 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:05:49.936431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:49.936431 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:05:49.937430 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:05:49.937430 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:05:49.937430 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:05:49.938430 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:05:49.938430 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:05:49.938430 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:05:49.939435 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:05:49.939435 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:05:49.940435 [info ] [MainThread]: 
[0m22:05:49.941435 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m22:05:49.942432 [debug] [MainThread]: Command end result
[0m22:05:49.973459 [info ] [MainThread]: 
[0m22:05:49.974455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:49.974455 [info ] [MainThread]: 
[0m22:05:49.975444 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'AVG_SELLING_PROPOSITION'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m22:05:49.976455 [info ] [MainThread]: 
[0m22:05:49.977455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:05:49.978969 [debug] [MainThread]: Command `dbt run` failed at 22:05:49.978969 after 9.64 seconds
[0m22:05:49.979979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E5CC29C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E7CF7A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1CD47A510>]}
[0m22:05:49.980977 [debug] [MainThread]: Flushing usage events
[0m22:06:05.707627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2E04860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E01554C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E027F200>]}


============================== 22:06:05.712125 | f3bde5ed-21f0-4fbf-817c-1306d9bca340 ==============================
[0m22:06:05.712125 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:06:05.713118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.667089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E52A8F50>]}
[0m22:06:06.714887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2DAC4A0>]}
[0m22:06:06.716876 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:06:07.021203 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:06:07.185339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:07.186360 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:06:07.379474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FE25A780>]}
[0m22:06:07.468265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FE2D58B0>]}
[0m22:06:07.469262 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:06:07.470264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FCD06180>]}
[0m22:06:07.471268 [info ] [MainThread]: 
[0m22:06:07.473268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:07.477272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:06:07.478272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:06:07.491294 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:06:07.491294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:06:07.494288 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:06:07.495289 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:06:07.498290 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:06:07.499295 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:06:07.499295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:07.500812 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:06:07.500812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:07.503823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.564904 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.061 seconds
[0m22:06:08.565904 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:06:08.590784 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.090 seconds
[0m22:06:08.592783 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:06:08.627446 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.128 seconds
[0m22:06:08.628446 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:06:08.737753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:06:08.739773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:06:08.747773 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:06:08.748778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:06:08.751769 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:06:08.752764 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:06:08.755826 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:06:08.756817 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:06:08.756817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.757826 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:06:08.757826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.759826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:09.719990 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:06:09.720994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.964 seconds
[0m22:06:09.721990 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:06:09.723995 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:06:09.909225 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.151 seconds
[0m22:06:09.910244 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:06:10.023333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FCCAE720>]}
[0m22:06:10.024345 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:06:10.025337 [info ] [MainThread]: 
[0m22:06:10.030975 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:06:10.030975 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:06:10.031970 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:06:10.032959 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:06:10.039975 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:06:10.041970 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:06:10.069975 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:06:10.071975 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:06:10.071975 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:06:10.072975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:10.775687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m22:06:10.796718 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:06:10.907888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FCC722D0>]}
[0m22:06:10.907888 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m22:06:10.909878 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:06:10.910885 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:06:10.911873 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:06:10.912884 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:06:10.912884 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:06:10.918888 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:06:10.919888 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:06:10.941883 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:06:10.944885 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:06:10.945874 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:06:10.946875 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:13.802581 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.856 seconds
[0m22:06:13.804585 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:06:13.915045 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FE6CC3E0>]}
[0m22:06:13.916045 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.00s]
[0m22:06:13.917047 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:06:13.918051 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:06:13.919051 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:06:13.920047 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:06:13.921050 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:06:13.924052 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:06:13.926056 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:06:13.928047 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:06:13.930044 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:06:13.931055 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        AVG(price_dollars) AS avg_price_dollars,
        AVG(discount) AS avg_discount,
        AVG(selling_proposition) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:06:13.931055 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:06:16.053857 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.123 seconds
[0m22:06:16.055859 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:06:16.169422 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bde5ed-21f0-4fbf-817c-1306d9bca340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FE6CDE80>]}
[0m22:06:16.169422 [info ] [Thread-5 (]: 3 of 3 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.25s]
[0m22:06:16.171223 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:06:16.173234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.174233 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:06:16.174233 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:06:16.174233 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:06:16.175232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:06:16.175232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:06:16.176232 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:06:16.176232 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:06:16.176232 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:06:16.177243 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:06:16.177243 [info ] [MainThread]: 
[0m22:06:16.178246 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m22:06:16.180246 [debug] [MainThread]: Command end result
[0m22:06:16.210243 [info ] [MainThread]: 
[0m22:06:16.210243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.211244 [info ] [MainThread]: 
[0m22:06:16.212240 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:06:16.214335 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.214335 after 10.61 seconds
[0m22:06:16.215352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E1886630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285FCD6FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E39C52E0>]}
[0m22:06:16.215352 [debug] [MainThread]: Flushing usage events
[0m22:11:14.222457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953551520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953B8DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953B8C8C0>]}


============================== 22:11:14.229456 | 5124a25d-ec94-44ac-ab2d-482c76f88a6b ==============================
[0m22:11:14.229456 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:11:14.230445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:11:15.279433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96C9BD0A0>]}
[0m22:11:15.324017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95183C9B0>]}
[0m22:11:15.326023 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:11:15.626809 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:11:15.804016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:15.805016 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m22:11:16.013364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96CE80CB0>]}
[0m22:11:16.109800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96D028B90>]}
[0m22:11:16.110801 [info ] [MainThread]: Found 3 models, 1 test, 575 macros
[0m22:11:16.111800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96CE723F0>]}
[0m22:11:16.113799 [info ] [MainThread]: 
[0m22:11:16.114799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:16.118798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:11:16.126801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:11:16.132808 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:11:16.134805 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:11:16.135803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:11:16.136808 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:11:16.136808 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:11:16.140804 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:11:16.141802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:16.142797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:16.143210 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:11:16.147223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:17.369229 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.226 seconds
[0m22:11:17.370232 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:11:17.385235 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.243 seconds
[0m22:11:17.387233 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:11:17.479071 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.331 seconds
[0m22:11:17.480080 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:11:17.597890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:11:17.599901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:11:17.607893 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:11:17.608889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:11:17.610889 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:11:17.611886 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:11:17.614884 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:11:17.615888 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:11:17.615888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:17.616886 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:11:17.617885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:17.618887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:18.557499 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.941 seconds
[0m22:11:18.559490 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:11:18.566758 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.949 seconds
[0m22:11:18.567758 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:11:18.611396 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.992 seconds
[0m22:11:18.612391 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:11:18.751747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96E31F2F0>]}
[0m22:11:18.752745 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:11:18.753746 [info ] [MainThread]: 
[0m22:11:18.759481 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:11:18.760484 [info ] [Thread-1 (]: 1 of 3 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:11:18.761478 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:11:18.761478 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:11:18.768475 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:11:18.770471 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:11:18.798028 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:11:18.800242 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:11:18.800242 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:11:18.801251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:19.518706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m22:11:19.545215 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:11:19.678607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96CCF2090>]}
[0m22:11:19.678607 [info ] [Thread-1 (]: 1 of 3 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.92s]
[0m22:11:19.680600 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:11:19.681613 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:11:19.682600 [info ] [Thread-3 (]: 2 of 3 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:11:19.683609 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:11:19.683609 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:11:19.688598 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:11:19.691135 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:11:19.713683 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:11:19.716672 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:11:19.717700 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:11:19.718668 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:21.827142 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.108 seconds
[0m22:11:21.829133 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:11:21.948952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96E6B2F90>]}
[0m22:11:21.950953 [info ] [Thread-3 (]: 2 of 3 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.27s]
[0m22:11:21.951938 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:11:21.952947 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:11:21.953938 [info ] [Thread-5 (]: 3 of 3 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:11:21.954944 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:11:21.954944 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:11:21.959942 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:11:21.960940 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:11:21.963941 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:11:21.965941 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:11:21.966947 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:11:21.966947 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:11:23.360234 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.393 seconds
[0m22:11:23.362240 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:11:23.484288 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124a25d-ec94-44ac-ab2d-482c76f88a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96E3F8E00>]}
[0m22:11:23.485294 [info ] [Thread-5 (]: 3 of 3 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.53s]
[0m22:11:23.486289 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:11:23.488301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:23.489310 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:11:23.489310 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:11:23.490311 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:11:23.490311 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:11:23.491301 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:11:23.491301 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:11:23.492310 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:11:23.492310 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:11:23.493299 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:11:23.493299 [info ] [MainThread]: 
[0m22:11:23.494302 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m22:11:23.496303 [debug] [MainThread]: Command end result
[0m22:11:23.529357 [info ] [MainThread]: 
[0m22:11:23.530356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:23.531358 [info ] [MainThread]: 
[0m22:11:23.532367 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:11:23.533367 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:23.533367 after 9.46 seconds
[0m22:11:23.534358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953BC52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9519469F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9501E74A0>]}
[0m22:11:23.534358 [debug] [MainThread]: Flushing usage events
[0m22:18:55.391025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE131F6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE10ECDD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE12A5DC70>]}


============================== 22:18:55.396033 | 66f9da10-b928-4715-aecb-f4912c53f10d ==============================
[0m22:18:55.396033 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:18:55.397278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:56.377800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f9da10-b928-4715-aecb-f4912c53f10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2C3A6EA0>]}
[0m22:18:56.421798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f9da10-b928-4715-aecb-f4912c53f10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE124E4110>]}
[0m22:18:56.423789 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:18:56.727436 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:18:56.897947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:18:56.897947 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\dim_products.sql
[0m22:18:57.037053 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.dim_products' (models\analytics\dim_products.sql) depends on a node named 'int_product' which was not found
[0m22:18:57.039048 [debug] [MainThread]: Command `dbt run` failed at 22:18:57.038052 after 1.75 seconds
[0m22:18:57.039048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE1096EC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2D8D5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B3ED790>]}
[0m22:18:57.040048 [debug] [MainThread]: Flushing usage events
[0m22:19:18.460962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947CE78F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947CE7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947CE7C50>]}


============================== 22:19:18.464974 | 0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406 ==============================
[0m22:19:18.464974 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:19:18.465960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:19.422945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9609AD0A0>]}
[0m22:19:19.467514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947CE7F20>]}
[0m22:19:19.469510 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:19:19.780867 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:19:19.943572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:19:19.944559 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\dim_products.sql
[0m22:19:20.134023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9621E8740>]}
[0m22:19:20.225556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D962191550>]}
[0m22:19:20.226554 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m22:19:20.227543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D960BF0500>]}
[0m22:19:20.229556 [info ] [MainThread]: 
[0m22:19:20.230644 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:20.234668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:19:20.241674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:19:20.248675 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:19:20.249675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m22:19:20.251671 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:19:20.252669 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:19:20.255661 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m22:19:20.256673 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:19:20.256673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:20.257676 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m22:19:20.257676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:20.260670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:21.802053 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.544 seconds
[0m22:19:21.804052 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:19:21.811944 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.551 seconds
[0m22:19:21.813951 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:19:21.830011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.573 seconds
[0m22:19:21.831973 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m22:19:21.960388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m22:19:21.961937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m22:19:21.968936 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m22:19:21.969940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m22:19:21.973196 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m22:19:21.974202 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m22:19:21.977201 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m22:19:21.978201 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m22:19:21.979201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:21.980191 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m22:19:21.980191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:21.981666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:22.800612 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.818 seconds
[0m22:19:22.802623 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m22:19:22.919961 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.939 seconds
[0m22:19:22.921621 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m22:19:22.951020 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.971 seconds
[0m22:19:22.952009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m22:19:23.065212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D960BBE8A0>]}
[0m22:19:23.066216 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m22:19:23.067229 [info ] [MainThread]: 
[0m22:19:23.073419 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m22:19:23.073419 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m22:19:23.074426 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m22:19:23.075411 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m22:19:23.081952 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m22:19:23.082949 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m22:19:23.113425 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m22:19:23.115427 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m22:19:23.115427 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m22:19:23.116429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:23.969215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m22:19:23.988974 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m22:19:24.111525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9625CB5C0>]}
[0m22:19:24.112537 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.04s]
[0m22:19:24.113868 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m22:19:24.114881 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m22:19:24.115876 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m22:19:24.116886 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m22:19:24.117886 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m22:19:24.131595 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m22:19:24.133588 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m22:19:24.153663 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m22:19:24.156652 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m22:19:24.157650 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m22:19:24.158661 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:27.106652 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.947 seconds
[0m22:19:27.108196 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m22:19:27.234206 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9626468D0>]}
[0m22:19:27.234206 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.12s]
[0m22:19:27.235206 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m22:19:27.236212 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m22:19:27.237201 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m22:19:27.238207 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m22:19:27.239215 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m22:19:27.242750 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m22:19:27.244742 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m22:19:27.247750 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m22:19:27.248754 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m22:19:27.250272 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m22:19:27.251286 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:19:28.651513 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m22:19:28.653517 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m22:19:28.777761 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9626219A0>]}
[0m22:19:28.778764 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.54s]
[0m22:19:28.780274 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m22:19:28.781281 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m22:19:28.782284 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m22:19:28.783293 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m22:19:28.783293 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m22:19:28.787288 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m22:19:28.788291 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m22:19:28.791797 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m22:19:28.794806 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m22:19:28.794806 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    sk_id,
    title,
    ct.category_id,
    GOODS_TITLE_LINK_JUMP,
    color_count
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS int_table
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
int_table.category = ct.category
        );
[0m22:19:28.795825 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m22:19:29.380338 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba691b-0000-fcd1-0001-4c5e000d329e
[0m22:19:29.381350 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 0 unexpected 'int_table'.
[0m22:19:29.381350 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m22:19:29.506473 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected 'int_table'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m22:19:29.506473 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab8c9b6-9d17-4af3-b5c9-a5dfcc9df406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D960D00EC0>]}
[0m22:19:29.507475 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.72s]
[0m22:19:29.508471 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m22:19:29.511540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:29.511540 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:19:29.512543 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:19:29.512543 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m22:19:29.513544 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m22:19:29.513544 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m22:19:29.514543 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m22:19:29.514543 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m22:19:29.515545 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m22:19:29.515545 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m22:19:29.516544 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m22:19:29.516544 [info ] [MainThread]: 
[0m22:19:29.517545 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m22:19:29.519550 [debug] [MainThread]: Command end result
[0m22:19:29.549342 [info ] [MainThread]: 
[0m22:19:29.551712 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:29.552707 [info ] [MainThread]: 
[0m22:19:29.553017 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected 'int_table'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m22:19:29.554035 [info ] [MainThread]: 
[0m22:19:29.555048 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:19:29.557040 [debug] [MainThread]: Command `dbt run` failed at 22:19:29.557040 after 11.20 seconds
[0m22:19:29.558040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95F864CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D960B7A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9621916D0>]}
[0m22:19:29.558040 [debug] [MainThread]: Flushing usage events
[0m23:04:33.510476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6824EE030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C682160170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6826E4B00>]}


============================== 23:04:33.519471 | da5da551-024e-472a-a179-ed4c7ff2d8d1 ==============================
[0m23:04:33.519471 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:04:33.521474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:34.640545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69ACF2000>]}
[0m23:04:34.687072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69B8CF020>]}
[0m23:04:34.690088 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:04:35.006621 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:04:35.194782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:35.194782 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:04:35.384056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69BA10CB0>]}
[0m23:04:35.476160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CEA1550>]}
[0m23:04:35.477161 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:04:35.477161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CCDD340>]}
[0m23:04:35.479158 [info ] [MainThread]: 
[0m23:04:35.480146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:04:35.484390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:04:35.495960 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:04:35.496965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:04:35.496965 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:04:35.497964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:04:35.499964 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:04:35.500964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:35.503966 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:04:35.504967 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:04:35.507964 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:04:35.509484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:35.510498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:36.849451 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.339 seconds
[0m23:04:36.850451 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:04:37.012874 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.503 seconds
[0m23:04:37.014877 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:04:37.109942 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.609 seconds
[0m23:04:37.110936 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:04:37.221164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:04:37.223176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:04:37.231181 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:04:37.234732 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:04:37.234732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:04:37.235726 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:04:37.235726 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:04:37.238722 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:04:37.239954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:37.239954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:37.240984 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:04:37.243983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:38.077543 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.833 seconds
[0m23:04:38.078537 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:04:38.166191 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.926 seconds
[0m23:04:38.168192 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:04:38.196184 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.956 seconds
[0m23:04:38.198185 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:04:38.545188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69B8CE960>]}
[0m23:04:38.546189 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:04:38.547188 [info ] [MainThread]: 
[0m23:04:38.553310 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:04:38.553310 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:04:38.554332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:04:38.555321 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:04:38.562327 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:04:38.563332 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:04:38.593337 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:04:38.595328 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:04:38.596334 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:04:38.597337 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:39.450321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m23:04:39.471327 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:04:39.580980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69B88E420>]}
[0m23:04:39.580980 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.03s]
[0m23:04:39.582986 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:04:39.583986 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:04:39.584983 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:04:39.585977 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:04:39.585977 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:04:39.602001 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:04:39.603000 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:04:39.624523 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:04:39.628516 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:04:39.629522 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:04:39.629522 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:04:43.858231 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.228 seconds
[0m23:04:43.860228 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:04:43.975024 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D3291F0>]}
[0m23:04:43.976030 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.39s]
[0m23:04:43.977029 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:04:43.978030 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:04:43.979024 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:04:43.980024 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:04:43.980024 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:04:43.984029 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:04:43.985049 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:04:43.988024 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:04:43.990029 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:04:43.990029 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:04:43.991014 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:04:46.206600 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.216 seconds
[0m23:04:46.209627 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:04:46.322296 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D32A030>]}
[0m23:04:46.322296 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.34s]
[0m23:04:46.323806 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:04:46.324828 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:04:46.325820 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:04:46.326825 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:04:46.326825 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:04:46.329830 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:04:46.330856 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:04:46.333854 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:04:46.335854 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:04:46.335854 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    sk_id,
    title,
    ct.category_id,
    GOODS_TITLE_LINK_JUMP,
    color_count
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
inttable.category = ct.category
        );
[0m23:04:46.336853 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:04:47.038781 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6948-0000-fd34-0001-4c5e000da06e
[0m23:04:47.039784 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 0 unexpected 'inttable'.
[0m23:04:47.040783 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:04:47.150313 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:04:47.151311 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5da551-024e-472a-a179-ed4c7ff2d8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D2771A0>]}
[0m23:04:47.152312 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.82s]
[0m23:04:47.153305 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:04:47.156314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:47.156314 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:04:47.157316 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:04:47.157316 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:04:47.158314 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:04:47.158314 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:04:47.158314 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:04:47.159316 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:04:47.159316 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:04:47.160314 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:04:47.160314 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:04:47.161314 [info ] [MainThread]: 
[0m23:04:47.161314 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m23:04:47.163630 [debug] [MainThread]: Command end result
[0m23:04:47.194621 [info ] [MainThread]: 
[0m23:04:47.195622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:04:47.197625 [info ] [MainThread]: 
[0m23:04:47.198622 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:04:47.199622 [info ] [MainThread]: 
[0m23:04:47.200622 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:04:47.203624 [debug] [MainThread]: Command `dbt run` failed at 23:04:47.202626 after 13.84 seconds
[0m23:04:47.203624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CD692B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6FEC59DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69BBA32C0>]}
[0m23:04:47.204634 [debug] [MainThread]: Flushing usage events
[0m23:07:53.343843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF615E0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF6112EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF62C47C20>]}


============================== 23:07:53.347483 | 7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d ==============================
[0m23:07:53.347483 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:07:53.349003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:54.419590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF62BEF5C0>]}
[0m23:07:54.467626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF63C921E0>]}
[0m23:07:54.470109 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:07:54.798393 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:07:54.967606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:54.968616 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:07:55.149448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E1888F0>]}
[0m23:07:55.242143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7CEF5A30>]}
[0m23:07:55.242143 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:07:55.243143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E18A4E0>]}
[0m23:07:55.245137 [info ] [MainThread]: 
[0m23:07:55.246139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:55.251142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:07:55.261142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:07:55.266126 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:07:55.267132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:07:55.269125 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:07:55.269125 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:07:55.272129 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:07:55.273126 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:07:55.273126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:55.274130 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:07:55.274130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:55.277128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:56.654112 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.381 seconds
[0m23:07:56.655109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.378 seconds
[0m23:07:56.657105 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:07:56.659111 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:07:56.680468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.406 seconds
[0m23:07:56.682469 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:07:56.800202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:07:56.802205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:07:56.809738 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:07:56.810738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:07:56.812740 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:07:56.813745 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:07:56.817306 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:07:56.818296 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:07:56.818296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:56.819300 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:07:56.819300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:56.821300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:57.641230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.820 seconds
[0m23:07:57.643226 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:07:57.698142 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.880 seconds
[0m23:07:57.700144 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:07:57.746636 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.927 seconds
[0m23:07:57.748655 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:07:57.866516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF617005C0>]}
[0m23:07:57.867514 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:07:57.868519 [info ] [MainThread]: 
[0m23:07:57.873923 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:07:57.874924 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:07:57.875937 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:07:57.876928 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:07:57.882941 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:07:57.883933 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:07:57.911503 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:07:57.913503 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:07:57.914504 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:07:57.915503 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:58.596272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m23:07:58.616810 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:07:58.728430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7CB22030>]}
[0m23:07:58.729431 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m23:07:58.730993 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:07:58.732014 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:07:58.733010 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:07:58.734014 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:07:58.735010 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:07:58.749036 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:07:58.750022 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:07:58.771575 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:07:58.774569 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:07:58.775574 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:07:58.775574 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:08:02.466964 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.691 seconds
[0m23:08:02.468963 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:08:02.580771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E5D67B0>]}
[0m23:08:02.581771 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.85s]
[0m23:08:02.582776 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:08:02.583781 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:08:02.584774 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:08:02.586776 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:08:02.586776 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:08:02.590778 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:08:02.591778 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:08:02.595037 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:08:02.597035 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:08:02.598048 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:08:02.599043 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:08:05.431435 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.833 seconds
[0m23:08:05.434417 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:08:05.542978 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E5A4590>]}
[0m23:08:05.543973 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.96s]
[0m23:08:05.544978 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:08:05.545973 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:08:05.546978 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:08:05.547974 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:08:05.547974 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:08:05.550978 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:08:05.551978 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:08:05.554982 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:08:05.556979 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:08:05.556979 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable.color_count
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:08:05.557973 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:08:06.157629 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba694c-0000-fd24-0001-4c5e000d629a
[0m23:08:06.157629 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'INTTABLE.COLOR_COUNT'
[0m23:08:06.158620 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:08:06.278153 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:08:06.279151 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f87c4ba-71ba-45f0-a9c4-ad96cc9b710d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E679CA0>]}
[0m23:08:06.280152 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.73s]
[0m23:08:06.280897 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:08:06.283922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:06.283922 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:08:06.284931 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:08:06.284931 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:08:06.285929 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:08:06.285929 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:08:06.286923 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:08:06.286923 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:08:06.286923 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:08:06.287916 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:08:06.287916 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:08:06.288912 [info ] [MainThread]: 
[0m23:08:06.289912 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 11.04 seconds (11.04s).
[0m23:08:06.290920 [debug] [MainThread]: Command end result
[0m23:08:06.322123 [info ] [MainThread]: 
[0m23:08:06.322981 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:08:06.323975 [info ] [MainThread]: 
[0m23:08:06.323975 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:08:06.324977 [info ] [MainThread]: 
[0m23:08:06.325976 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:08:06.327976 [debug] [MainThread]: Command `dbt run` failed at 23:08:06.327976 after 13.14 seconds
[0m23:08:06.328982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF63A755E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7CB22030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7E139580>]}
[0m23:08:06.329980 [debug] [MainThread]: Flushing usage events
[0m23:09:37.621152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A2FC42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A5AA64B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A2257020>]}


============================== 23:09:37.626152 | 529dddb8-4251-406c-897e-638881688643 ==============================
[0m23:09:37.626152 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:09:37.627174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:09:38.714596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BED0AB70>]}
[0m23:09:38.762164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A5DAD010>]}
[0m23:09:38.764164 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:09:39.069961 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:09:39.233931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:09:39.234934 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:09:39.416386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C0143440>]}
[0m23:09:39.506745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C02212B0>]}
[0m23:09:39.507746 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:09:39.508743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BED46030>]}
[0m23:09:39.510736 [info ] [MainThread]: 
[0m23:09:39.511747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:39.515738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:09:39.516734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:09:39.529765 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:09:39.529765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:09:39.532767 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:09:39.533768 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:09:39.535772 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:09:39.536771 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:09:39.537774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:39.537774 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:09:39.538773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:39.541774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:40.615201 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.078 seconds
[0m23:09:40.616206 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.075 seconds
[0m23:09:40.617206 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:09:40.619206 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:09:40.624201 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.086 seconds
[0m23:09:40.626203 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:09:40.753005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:09:40.754015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:09:40.762021 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:09:40.765019 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:09:40.766020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:09:40.767019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:09:40.767019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:09:40.770014 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:09:40.771028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:40.771028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:40.772021 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:09:40.776021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:41.683715 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.908 seconds
[0m23:09:41.684719 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:09:41.707131 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.936 seconds
[0m23:09:41.709140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.938 seconds
[0m23:09:41.710129 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:09:41.712370 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:09:41.823604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C0155F10>]}
[0m23:09:41.823604 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:09:41.824615 [info ] [MainThread]: 
[0m23:09:41.830448 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:09:41.831439 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:09:41.832439 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:09:41.832439 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:09:41.839439 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:09:41.840439 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:09:41.867977 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:09:41.869967 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:09:41.870966 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:09:41.870966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:09:42.550778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m23:09:42.571348 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:09:42.685996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C06DBE00>]}
[0m23:09:42.685996 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m23:09:42.687989 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:09:42.688987 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:09:42.689994 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:09:42.690994 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:09:42.691993 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:09:42.704999 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:09:42.706989 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:09:42.727998 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:09:42.730989 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:09:42.731998 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:09:42.731998 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:44.869750 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.138 seconds
[0m23:09:44.871745 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:09:44.982937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C05F2750>]}
[0m23:09:44.983950 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.29s]
[0m23:09:44.984940 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:09:44.985934 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:09:44.986933 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:09:44.987938 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:09:44.987938 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:09:44.991937 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:09:44.993073 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:09:44.996935 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:09:44.998937 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:09:44.998937 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:09:44.999944 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:09:46.313220 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m23:09:46.315224 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:09:46.431261 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C06A5D90>]}
[0m23:09:46.432266 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.44s]
[0m23:09:46.434265 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:09:46.434265 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:09:46.435263 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:09:46.436267 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:09:46.437291 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:09:46.440284 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:09:46.441276 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:09:46.445283 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:09:46.447284 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:09:46.447284 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_variety"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:09:46.448286 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:09:47.056878 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba694d-0000-fd29-0001-4c5e000d1306
[0m23:09:47.056878 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'INTTABLE."color_variety"'
[0m23:09:47.057882 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:09:47.189214 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE."color_variety"'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:09:47.190212 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529dddb8-4251-406c-897e-638881688643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C073B710>]}
[0m23:09:47.191198 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.75s]
[0m23:09:47.192212 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:09:47.195210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:47.195210 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:09:47.195210 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:09:47.196208 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:09:47.196208 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:09:47.197208 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:09:47.197208 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:09:47.198206 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:09:47.198206 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:09:47.198206 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:09:47.199223 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:09:47.199223 [info ] [MainThread]: 
[0m23:09:47.200227 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m23:09:47.202224 [debug] [MainThread]: Command end result
[0m23:09:47.233750 [info ] [MainThread]: 
[0m23:09:47.234748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:47.235746 [info ] [MainThread]: 
[0m23:09:47.236748 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE."color_variety"'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:09:47.237758 [info ] [MainThread]: 
[0m23:09:47.238825 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:09:47.240858 [debug] [MainThread]: Command `dbt run` failed at 23:09:47.239844 after 9.74 seconds
[0m23:09:47.240858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A535D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A5B025A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A2127530>]}
[0m23:09:47.241847 [debug] [MainThread]: Flushing usage events
[0m23:10:10.276391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E2632510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DCDE90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DF45EBD0>]}


============================== 23:10:10.280618 | e547b897-2790-402a-b6c5-40db0012032b ==============================
[0m23:10:10.280618 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:10:10.282616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:11.234212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FB3450A0>]}
[0m23:10:11.278776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FAFB5CD0>]}
[0m23:10:11.280812 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:10:11.586484 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:10:11.748067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:11.748067 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:10:11.932297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FBED50D0>]}
[0m23:10:12.021170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FD429340>]}
[0m23:10:12.022180 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:10:12.023182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FC16B470>]}
[0m23:10:12.025175 [info ] [MainThread]: 
[0m23:10:12.026175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:12.030167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:10:12.031180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:10:12.043181 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:10:12.044175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:10:12.046180 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:10:12.047175 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:10:12.050175 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:10:12.050175 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:10:12.051183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:12.051183 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:10:12.052174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:12.054177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:13.005259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.955 seconds
[0m23:10:13.007262 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:10:13.020010 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.968 seconds
[0m23:10:13.022005 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:10:13.081920 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.027 seconds
[0m23:10:13.082930 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:10:13.198107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:10:13.199127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:10:13.209141 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:10:13.209141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:10:13.212141 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:10:13.213138 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:10:13.217131 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:10:13.218144 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:10:13.218144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:13.219137 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:10:13.220137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:13.221136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:14.069208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.848 seconds
[0m23:10:14.071196 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:10:14.127843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.909 seconds
[0m23:10:14.129836 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:10:14.157939 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.938 seconds
[0m23:10:14.159927 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:10:14.269568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FBD87FB0>]}
[0m23:10:14.270583 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:10:14.270583 [info ] [MainThread]: 
[0m23:10:14.276565 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:10:14.277575 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:10:14.278569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:10:14.278569 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:10:14.286115 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:10:14.288106 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:10:14.314824 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:10:14.316794 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:10:14.317814 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:10:14.317814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:14.996977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m23:10:15.016976 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:10:15.138755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FBE12390>]}
[0m23:10:15.139760 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m23:10:15.141757 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:10:15.142755 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:10:15.143760 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:10:15.144763 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:10:15.145753 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:10:15.159762 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:10:15.160762 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:10:15.181370 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:10:15.185393 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:10:15.186398 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:10:15.186398 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:17.080974 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.895 seconds
[0m23:10:17.083307 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:10:17.192889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FD8D6870>]}
[0m23:10:17.193889 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.05s]
[0m23:10:17.195890 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:10:17.196889 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:10:17.196889 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:10:17.198896 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:10:17.198896 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:10:17.203894 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:10:17.205883 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:10:17.207891 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:10:17.209910 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:10:17.210904 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:10:17.210904 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:10:18.569638 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m23:10:18.571638 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:10:18.679850 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FD8DFEC0>]}
[0m23:10:18.681358 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.48s]
[0m23:10:18.682366 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:10:18.683370 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:10:18.684366 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:10:18.685367 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:10:18.685367 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:10:18.689368 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:10:18.690366 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:10:18.692369 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:10:18.694369 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:10:18.695367 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable.color_variety
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:10:18.695367 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:10:19.287049 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba694e-0000-fd30-0001-4c5e000db01e
[0m23:10:19.288053 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'INTTABLE.COLOR_VARIETY'
[0m23:10:19.288053 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:10:19.411972 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_VARIETY'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:10:19.411972 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e547b897-2790-402a-b6c5-40db0012032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FD972030>]}
[0m23:10:19.412961 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.73s]
[0m23:10:19.413973 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:10:19.416963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:19.416963 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:10:19.417966 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:10:19.417966 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:10:19.418963 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:10:19.418963 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:10:19.419969 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:10:19.419969 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:10:19.420970 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:10:19.420970 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:10:19.420970 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:10:19.421959 [info ] [MainThread]: 
[0m23:10:19.422715 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m23:10:19.424743 [debug] [MainThread]: Command end result
[0m23:10:19.454745 [info ] [MainThread]: 
[0m23:10:19.455742 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:19.456750 [info ] [MainThread]: 
[0m23:10:19.457749 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_VARIETY'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:10:19.458731 [info ] [MainThread]: 
[0m23:10:19.459731 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:10:19.461736 [debug] [MainThread]: Command `dbt run` failed at 23:10:19.460730 after 9.29 seconds
[0m23:10:19.461736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E2CDDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FBFA2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9FBFBA330>]}
[0m23:10:19.462731 [debug] [MainThread]: Flushing usage events
[0m23:11:48.068758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90875EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90B1123C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A28B620>]}


============================== 23:11:48.073488 | e18cbf84-7d31-4c85-b566-5ec609c3b449 ==============================
[0m23:11:48.073488 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:11:48.074500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:49.075197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F924106B10>]}
[0m23:11:49.122741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9241DCA70>]}
[0m23:11:49.123741 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:11:49.441190 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:11:49.620236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:49.621243 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:11:49.804929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9257A45F0>]}
[0m23:11:49.901227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90B13A120>]}
[0m23:11:49.901227 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:11:49.902230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92555D220>]}
[0m23:11:49.904230 [info ] [MainThread]: 
[0m23:11:49.905229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:11:49.909442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:11:49.922459 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:11:49.923456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:11:49.923456 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:11:49.924467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:11:49.926252 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:11:49.927250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:49.930259 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:11:49.931263 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:11:49.936284 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:11:49.938276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:49.939274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:51.282652 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.355 seconds
[0m23:11:51.283643 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:11:51.305365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.366 seconds
[0m23:11:51.306360 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:11:51.312366 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.374 seconds
[0m23:11:51.313367 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:11:51.429183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:11:51.431187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:11:51.438188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:11:51.440188 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:11:51.443188 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:11:51.446200 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:11:51.447190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:11:51.448174 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:11:51.449183 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:11:51.449183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:51.450183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:51.451192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:52.378061 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.927 seconds
[0m23:11:52.380062 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:11:52.488167 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.039 seconds
[0m23:11:52.490166 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:11:52.655981 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.206 seconds
[0m23:11:52.657998 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:11:52.771167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925654F20>]}
[0m23:11:52.772163 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:11:52.772996 [info ] [MainThread]: 
[0m23:11:52.778376 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:11:52.779386 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:11:52.780390 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:11:52.780390 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:11:52.786409 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:11:52.788972 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:11:52.814971 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:11:52.816971 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:11:52.817966 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:11:52.817966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:53.611733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m23:11:53.631743 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:11:53.754033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F924142000>]}
[0m23:11:53.754033 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m23:11:53.756023 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:11:53.757485 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:11:53.758501 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:11:53.759502 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:11:53.759502 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:11:53.773500 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:11:53.775510 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:11:53.796021 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:11:53.799019 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:11:53.800020 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_count",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:11:53.801023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:11:56.022451 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m23:11:56.025457 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:11:56.137054 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925CE6720>]}
[0m23:11:56.138058 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.38s]
[0m23:11:56.140059 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:11:56.141066 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:11:56.142057 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:11:56.143068 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:11:56.144069 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:11:56.148070 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:11:56.149072 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:11:56.153070 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:11:56.155072 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:11:56.156068 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:11:56.157060 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:11:58.845518 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.689 seconds
[0m23:11:58.848519 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:11:58.962848 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925CF04A0>]}
[0m23:11:58.963858 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.82s]
[0m23:11:58.964839 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:11:58.965833 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:11:58.966843 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:11:58.967845 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:11:58.967845 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:11:58.970849 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:11:58.972847 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:11:58.975860 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:11:58.977845 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:11:58.977845 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable.color_count
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:11:58.978848 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:11:59.598618 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6950-0000-fd34-0001-4c5e000da082
[0m23:11:59.598618 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'INTTABLE.COLOR_COUNT'
[0m23:11:59.599623 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:11:59.710709 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:11:59.710709 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e18cbf84-7d31-4c85-b566-5ec609c3b449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925D1A1B0>]}
[0m23:11:59.711697 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.74s]
[0m23:11:59.712711 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:11:59.715694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:59.715694 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:11:59.716713 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:11:59.716713 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:11:59.717706 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:11:59.717706 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:11:59.717706 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:11:59.718707 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:11:59.718707 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:11:59.719695 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:11:59.719695 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:11:59.720697 [info ] [MainThread]: 
[0m23:11:59.721114 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m23:11:59.723140 [debug] [MainThread]: Command end result
[0m23:11:59.754146 [info ] [MainThread]: 
[0m23:11:59.755143 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:59.756135 [info ] [MainThread]: 
[0m23:11:59.757131 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:11:59.758130 [info ] [MainThread]: 
[0m23:11:59.759129 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:11:59.761136 [debug] [MainThread]: Command `dbt run` failed at 23:11:59.761136 after 11.84 seconds
[0m23:11:59.761136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90ADD43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F924141340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9074975F0>]}
[0m23:11:59.762133 [debug] [MainThread]: Flushing usage events
[0m23:12:23.625518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C788EFC140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B8FF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C788196F90>]}


============================== 23:12:23.629535 | f9078715-15a6-4bca-9806-11c10ef9979c ==============================
[0m23:12:23.629535 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:12:23.631181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:24.565619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A4B7F560>]}
[0m23:12:24.610620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3831010>]}
[0m23:12:24.612621 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:12:24.923555 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:12:25.098491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:12:25.099491 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:12:25.099491 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m23:12:25.298173 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:12:25.299159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78ACC8B30>]}
[0m23:12:25.452813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A4C63230>]}
[0m23:12:25.540760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A62845F0>]}
[0m23:12:25.541759 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:12:25.542762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5F34A40>]}
[0m23:12:25.544762 [info ] [MainThread]: 
[0m23:12:25.545757 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:12:25.550019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:12:25.559575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:12:25.563572 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:12:25.565562 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:12:25.566561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:12:25.567572 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:12:25.568573 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:12:25.570566 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:12:25.571572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:25.571572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:25.572573 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:12:25.577562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:26.584753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.007 seconds
[0m23:12:26.586772 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:12:26.587742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.016 seconds
[0m23:12:26.590753 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:12:26.619666 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.048 seconds
[0m23:12:26.621660 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:12:26.730271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:12:26.732281 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:12:26.740286 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:12:26.741279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:12:26.743282 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:12:26.744355 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:12:26.747294 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:12:26.747925 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:12:26.748956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:26.748956 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:12:26.749945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:26.751559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:27.554737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.806 seconds
[0m23:12:27.555739 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:12:27.642721 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.891 seconds
[0m23:12:27.644725 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:12:27.656378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.907 seconds
[0m23:12:27.658377 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:12:27.772218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A61932F0>]}
[0m23:12:27.772218 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:12:27.773241 [info ] [MainThread]: 
[0m23:12:27.778710 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:12:27.779712 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:12:27.780702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:12:27.781716 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:12:27.787721 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:12:27.789709 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:12:27.816746 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:12:27.818731 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:12:27.818731 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:12:27.819734 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:28.488722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m23:12:28.509727 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:12:28.616880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B3D4F50>]}
[0m23:12:28.617881 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m23:12:28.618874 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:12:28.619865 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:12:28.620867 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:12:28.622074 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:12:28.623091 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:12:28.627621 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:12:28.628647 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:12:28.648696 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:12:28.652692 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:12:28.652692 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_count" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:12:28.653690 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:12:29.290178 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba6950-0000-fd24-0001-4c5e000d62b6
[0m23:12:29.291173 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 581
invalid identifier '"color_count"'
[0m23:12:29.291173 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:12:29.407049 [debug] [Thread-3 (]: Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 45 at position 581
  invalid identifier '"color_count"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:12:29.407049 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9078715-15a6-4bca-9806-11c10ef9979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A63A4680>]}
[0m23:12:29.408033 [error] [Thread-3 (]: 2 of 4 ERROR creating sql table model products_schema_intermediate.int_products  [[31mERROR[0m in 0.78s]
[0m23:12:29.409033 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:12:29.411031 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:12:29.412041 [info ] [Thread-5 (]: 3 of 4 SKIP relation products_schema_analytics.dim_category .................... [[33mSKIP[0m]
[0m23:12:29.413030 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:12:29.414031 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:12:29.414031 [info ] [Thread-7 (]: 4 of 4 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m23:12:29.415090 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:12:29.417119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:29.417119 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:12:29.418118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:12:29.418118 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:12:29.419111 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:12:29.419111 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:12:29.419111 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:12:29.419111 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:12:29.420629 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:12:29.420629 [info ] [MainThread]: 
[0m23:12:29.421655 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m23:12:29.423653 [debug] [MainThread]: Command end result
[0m23:12:29.523307 [info ] [MainThread]: 
[0m23:12:29.523873 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:29.524698 [info ] [MainThread]: 
[0m23:12:29.525722 [error] [MainThread]:   Database Error in model int_products (models\intermediate\int_products.sql)
  000904 (42000): SQL compilation error: error line 45 at position 581
  invalid identifier '"color_count"'
  compiled code at target\run\transform\models\intermediate\int_products.sql
[0m23:12:29.526711 [info ] [MainThread]: 
[0m23:12:29.526711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:12:29.528716 [debug] [MainThread]: Command `dbt run` failed at 23:12:29.528716 after 6.01 seconds
[0m23:12:29.529233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A4E78200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A62F3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78B873E30>]}
[0m23:12:29.529233 [debug] [MainThread]: Flushing usage events
[0m23:13:40.661019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AE7741A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AF132480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AF133B00>]}


============================== 23:13:40.666060 | a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c ==============================
[0m23:13:40.666060 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:13:40.667045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:13:41.751039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C6CA6570>]}
[0m23:13:41.806768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C8087FE0>]}
[0m23:13:41.808779 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:13:42.131449 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:13:42.315093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:13:42.315093 [debug] [MainThread]: Partial parsing: updated file: transform://models\intermediate\int_products.sql
[0m23:13:42.511828 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:13:42.513823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C95D1070>]}
[0m23:13:42.633704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C9777860>]}
[0m23:13:42.725757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C82F98B0>]}
[0m23:13:42.726762 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:13:42.726762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C9614B90>]}
[0m23:13:42.729195 [info ] [MainThread]: 
[0m23:13:42.730193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:13:42.734193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:13:42.747790 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:13:42.747790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:13:42.748794 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:13:42.748794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:13:42.751790 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:13:42.751790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:42.754785 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:13:42.755798 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:13:42.758025 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:13:42.760035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:42.760035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:43.770765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.011 seconds
[0m23:13:43.771761 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.020 seconds
[0m23:13:43.773764 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:13:43.774771 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:13:43.782368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.023 seconds
[0m23:13:43.784382 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:13:43.895813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:13:43.897320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:13:43.908882 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:13:43.909890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:13:43.909890 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:13:43.910889 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:13:43.912800 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:13:43.913803 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:13:43.914803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:43.914803 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:13:43.915772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:43.917297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:44.706234 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.789 seconds
[0m23:13:44.708769 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:13:44.822487 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.907 seconds
[0m23:13:44.825013 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:13:44.838527 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.924 seconds
[0m23:13:44.839533 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:13:44.955484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168ACCC1A60>]}
[0m23:13:44.956994 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:13:44.958014 [info ] [MainThread]: 
[0m23:13:44.964030 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:13:44.964546 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:13:44.965559 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:13:44.965559 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:13:44.973094 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:13:44.974092 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:13:45.000672 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:13:45.002675 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:13:45.003674 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:13:45.004674 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:45.673938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m23:13:45.694942 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:13:45.812767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AE841340>]}
[0m23:13:45.813768 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m23:13:45.814757 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:13:45.815770 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:13:45.816754 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:13:45.818768 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:13:45.818768 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:13:45.823766 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:13:45.825276 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:13:45.845286 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:13:45.849292 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:13:45.850294 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:13:45.851293 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:13:47.954512 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.104 seconds
[0m23:13:47.956516 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:13:48.064567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C9B2B020>]}
[0m23:13:48.065571 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.25s]
[0m23:13:48.066564 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:13:48.067557 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:13:48.068573 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:13:48.069572 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:13:48.069572 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:13:48.073570 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:13:48.074569 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:13:48.077574 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:13:48.079571 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:13:48.079571 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:13:48.080573 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:13:50.226587 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.146 seconds
[0m23:13:50.228579 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:13:50.345317 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AB4F3650>]}
[0m23:13:50.346317 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.28s]
[0m23:13:50.347323 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:13:50.348319 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:13:50.349312 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:13:50.350318 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:13:50.350318 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:13:50.353318 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:13:50.355313 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:13:50.357319 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:13:50.359322 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:13:50.360323 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable.color_counts
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:13:50.360323 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:13:51.473875 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6951-0000-fd16-0001-4c5e000d90aa
[0m23:13:51.474874 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'INTTABLE.COLOR_COUNTS'
[0m23:13:51.474874 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:13:52.148809 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNTS'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:13:52.149809 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d34f05-9c1d-4e38-b3cc-c12d60a34c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C9B3E480>]}
[0m23:13:52.149809 [error] [Thread-7 (]: 4 of 4 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 1.80s]
[0m23:13:52.151807 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:13:52.153796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:52.154805 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:13:52.154805 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:13:52.155794 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:13:52.155794 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:13:52.156808 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:13:52.156808 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:13:52.156808 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:13:52.157812 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:13:52.157812 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:13:52.157812 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:13:52.158809 [info ] [MainThread]: 
[0m23:13:52.159809 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m23:13:52.160796 [debug] [MainThread]: Command end result
[0m23:13:52.259915 [info ] [MainThread]: 
[0m23:13:52.260924 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:13:52.261924 [info ] [MainThread]: 
[0m23:13:52.262922 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'INTTABLE.COLOR_COUNTS'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:13:52.262922 [info ] [MainThread]: 
[0m23:13:52.263915 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:13:52.265925 [debug] [MainThread]: Command `dbt run` failed at 23:13:52.264918 after 11.72 seconds
[0m23:13:52.265925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AE7741A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168AE869DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168C9725010>]}
[0m23:13:52.266918 [debug] [MainThread]: Flushing usage events
[0m23:18:39.404471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C67CEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C57FF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C57FEC00>]}


============================== 23:18:39.409055 | 172f3742-6ee9-4020-b642-b30df3b524ad ==============================
[0m23:18:39.409055 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:18:39.410053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:40.346227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E0EF6B10>]}
[0m23:18:40.388773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E22AE270>]}
[0m23:18:40.390759 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:18:40.693252 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:18:40.860930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:40.860930 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:18:41.041056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E38748C0>]}
[0m23:18:41.127261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3821430>]}
[0m23:18:41.128267 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:18:41.129260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E2788470>]}
[0m23:18:41.131265 [info ] [MainThread]: 
[0m23:18:41.132262 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:41.136288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:18:41.149283 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:18:41.150276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:18:41.150276 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:18:41.151285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:18:41.153284 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:18:41.154283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:41.156289 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:18:41.157283 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:18:41.161540 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:18:41.162541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:41.162541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:42.325190 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.171 seconds
[0m23:18:42.327190 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:18:42.342035 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.180 seconds
[0m23:18:42.344038 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:18:42.352656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.190 seconds
[0m23:18:42.354650 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:18:42.461198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:18:42.463201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:18:42.473200 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:18:42.473200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:18:42.476196 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:18:42.477195 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:18:42.481199 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:18:42.482196 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:18:42.483205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:42.483205 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:18:42.484197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:42.486197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:43.289511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.806 seconds
[0m23:18:43.291521 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:18:43.441365 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.955 seconds
[0m23:18:43.442374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.960 seconds
[0m23:18:43.444375 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:18:43.446396 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:18:43.565694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3ACB230>]}
[0m23:18:43.566699 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:18:43.567707 [info ] [MainThread]: 
[0m23:18:43.573157 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:18:43.574167 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:18:43.575167 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:18:43.576164 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:18:43.582672 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:18:43.584687 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:18:43.612698 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:18:43.614697 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:18:43.614697 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:18:43.615701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:18:44.301088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m23:18:44.322082 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:18:44.434955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E2212060>]}
[0m23:18:44.435962 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m23:18:44.436945 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:18:44.438356 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:18:44.439378 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:18:44.440377 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:18:44.441380 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:18:44.455406 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:18:44.456409 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:18:44.477949 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:18:44.481946 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:18:44.481946 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:18:44.482960 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:18:47.418223 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.935 seconds
[0m23:18:47.420241 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:18:47.533793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3C76A50>]}
[0m23:18:47.533793 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.09s]
[0m23:18:47.535789 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:18:47.536789 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:18:47.537790 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:18:47.538790 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:18:47.539790 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:18:47.544298 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:18:47.546310 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:18:47.550306 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:18:47.553313 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:18:47.553313 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:18:47.554311 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:18:48.817676 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.264 seconds
[0m23:18:48.819678 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:18:48.932345 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3C77290>]}
[0m23:18:48.933349 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.39s]
[0m23:18:48.934350 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:18:48.935345 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:18:48.936350 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:18:48.937336 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:18:48.938345 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:18:48.941350 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:18:48.942345 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:18:48.945350 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:18:48.947350 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:18:48.948350 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
   "color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:18:48.949343 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:18:50.482068 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.533 seconds
[0m23:18:50.483066 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:18:50.603433 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172f3742-6ee9-4020-b642-b30df3b524ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3D23BF0>]}
[0m23:18:50.603433 [info ] [Thread-7 (]: 4 of 4 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.67s]
[0m23:18:50.604634 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:18:50.606654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:50.607664 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:18:50.607664 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:18:50.608661 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:18:50.608661 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:18:50.609665 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:18:50.609665 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:18:50.609665 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:18:50.610657 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:18:50.610657 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:18:50.611652 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:18:50.611652 [info ] [MainThread]: 
[0m23:18:50.612654 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m23:18:50.614652 [debug] [MainThread]: Command end result
[0m23:18:50.643215 [info ] [MainThread]: 
[0m23:18:50.644204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:50.645206 [info ] [MainThread]: 
[0m23:18:50.646207 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:18:50.648213 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:50.648213 after 11.39 seconds
[0m23:18:50.650208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8FF1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E3876B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C847C980>]}
[0m23:18:50.650208 [debug] [MainThread]: Flushing usage events
[0m23:19:19.100081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BFB5B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BF8B0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BC1B6F90>]}


============================== 23:19:19.104097 | ac38ce71-4f7d-4222-8205-6a857e70a733 ==============================
[0m23:19:19.104097 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:19:19.106087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:19:20.036934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BF380F50>]}
[0m23:19:20.081931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175D8C54980>]}
[0m23:19:20.082934 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:19:20.402105 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:19:20.566380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:20.567380 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:19:20.746339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA244530>]}
[0m23:19:20.832502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA1F11F0>]}
[0m23:19:20.833502 [info ] [MainThread]: Found 4 models, 1 test, 575 macros
[0m23:19:20.834502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA247830>]}
[0m23:19:20.836506 [info ] [MainThread]: 
[0m23:19:20.836990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:19:20.841019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:19:20.853018 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:19:20.854006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:19:20.855011 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:19:20.855011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:19:20.858017 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:19:20.859016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:20.861003 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:19:20.862011 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:19:20.866015 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:19:20.868011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:20.869006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:21.897012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.029 seconds
[0m23:19:21.899019 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:19:21.900012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.042 seconds
[0m23:19:21.903207 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:19:21.912382 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.045 seconds
[0m23:19:21.914386 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:19:22.029357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:19:22.030350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:19:22.038346 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:19:22.039347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:19:22.041355 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:19:22.042346 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:19:22.045360 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:19:22.046360 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:19:22.047345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:22.047345 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:19:22.048360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:22.050346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:22.843315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.797 seconds
[0m23:19:22.845333 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:19:22.846325 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.799 seconds
[0m23:19:22.849497 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:19:22.869259 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.819 seconds
[0m23:19:22.871253 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:19:22.979508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175D8C1E810>]}
[0m23:19:22.980509 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:19:22.981503 [info ] [MainThread]: 
[0m23:19:22.986499 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:19:22.987506 [info ] [Thread-1 (]: 1 of 4 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:19:22.988493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:19:22.989526 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:19:22.995518 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:19:22.997511 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:19:23.026568 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:19:23.028570 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:19:23.029571 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:19:23.029571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:19:23.844329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m23:19:23.865331 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:19:23.987979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175D8BDA480>]}
[0m23:19:23.988989 [info ] [Thread-1 (]: 1 of 4 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.00s]
[0m23:19:23.989969 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:19:23.991993 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:19:23.991993 [info ] [Thread-3 (]: 2 of 4 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:19:23.993012 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:19:23.994009 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:19:24.008540 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:19:24.009539 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:19:24.029544 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:19:24.033539 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:19:24.033539 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:19:24.034540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:19:27.003847 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.969 seconds
[0m23:19:27.005876 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:19:27.114751 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA34C8F0>]}
[0m23:19:27.115751 [info ] [Thread-3 (]: 2 of 4 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.12s]
[0m23:19:27.116756 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:19:27.117757 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:19:27.118752 [info ] [Thread-5 (]: 3 of 4 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:19:27.119754 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:19:27.120742 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:19:27.123754 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:19:27.125758 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:19:27.127752 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:19:27.129753 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:19:27.130754 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:19:27.131752 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:19:28.272964 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m23:19:28.274955 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:19:28.385315 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA664440>]}
[0m23:19:28.386327 [info ] [Thread-5 (]: 3 of 4 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.27s]
[0m23:19:28.387325 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:19:28.388325 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:19:28.389325 [info ] [Thread-7 (]: 4 of 4 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:19:28.390324 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:19:28.391325 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:19:28.394326 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:19:28.395336 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:19:28.402343 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:19:28.404343 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:19:28.405336 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:19:28.405336 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:19:29.952273 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m23:19:29.954267 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:19:30.066718 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac38ce71-4f7d-4222-8205-6a857e70a733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175DA6B8740>]}
[0m23:19:30.066718 [info ] [Thread-7 (]: 4 of 4 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.68s]
[0m23:19:30.068725 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:19:30.070711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:30.071720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:19:30.071720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:19:30.071720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:19:30.072717 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:19:30.072717 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:19:30.073718 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:19:30.073718 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:19:30.074711 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:19:30.074711 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:19:30.075710 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:19:30.076713 [info ] [MainThread]: 
[0m23:19:30.077714 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.24 seconds (9.24s).
[0m23:19:30.079717 [debug] [MainThread]: Command end result
[0m23:19:30.110716 [info ] [MainThread]: 
[0m23:19:30.111724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:30.112240 [info ] [MainThread]: 
[0m23:19:30.113185 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:19:30.114201 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:30.114201 after 11.11 seconds
[0m23:19:30.115209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BF0DF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175D785F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175D84711C0>]}
[0m23:19:30.116213 [debug] [MainThread]: Flushing usage events
[0m23:26:58.517840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB98BB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB96810D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB9557440>]}


============================== 23:26:58.522633 | 468a25d6-41dc-4ade-8748-7c649a212b7e ==============================
[0m23:26:58.522633 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:26:58.523135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:26:59.453013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED212E570>]}
[0m23:26:59.497384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EBAF68EC0>]}
[0m23:26:59.499375 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:26:59.805181 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:26:59.973923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:26:59.973923 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\fact_products_performance.sql
[0m23:27:00.195649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED16578C0>]}
[0m23:27:00.284930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED3F4D5E0>]}
[0m23:27:00.285928 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:27:00.286929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED3D344A0>]}
[0m23:27:00.288928 [info ] [MainThread]: 
[0m23:27:00.289927 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:00.293676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:27:00.305710 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:27:00.306700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:27:00.307697 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:27:00.307697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:27:00.310706 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:27:00.310706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:00.313707 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:27:00.314698 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:27:00.319700 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:27:00.319700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:00.320701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:01.658512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.348 seconds
[0m23:27:01.660517 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:27:01.663512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.343 seconds
[0m23:27:01.664512 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:27:01.672531 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.351 seconds
[0m23:27:01.673515 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:27:01.784142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:27:01.786139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:27:01.793147 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:27:01.794144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:27:01.797136 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:27:01.798143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:27:01.802142 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:27:01.803141 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:27:01.803141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:01.804140 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:27:01.804140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:01.806142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:02.592380 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.786 seconds
[0m23:27:02.594389 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:27:02.607157 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.803 seconds
[0m23:27:02.609161 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:27:02.759732 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.957 seconds
[0m23:27:02.761734 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:27:02.874115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB74AC860>]}
[0m23:27:02.875119 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:27:02.876111 [info ] [MainThread]: 
[0m23:27:02.882106 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:27:02.883106 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:27:02.884107 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:27:02.884107 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:27:02.891109 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:27:02.892121 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:27:02.918125 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:27:02.920120 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:27:02.920120 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:27:02.921120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:27:03.599499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m23:27:03.619522 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:27:03.728366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED2932000>]}
[0m23:27:03.729370 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m23:27:03.731378 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:27:03.732367 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:27:03.733377 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:27:03.734376 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:27:03.735376 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:27:03.750403 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:27:03.751403 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:27:03.772941 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:27:03.775946 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:27:03.776945 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:27:03.777947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:27:06.778424 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.001 seconds
[0m23:27:06.780435 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:27:06.905259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED4394A40>]}
[0m23:27:06.906270 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.17s]
[0m23:27:06.907261 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:27:06.908269 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:27:06.909258 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:27:06.910268 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:27:06.911261 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:27:06.915268 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:27:06.916265 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:27:06.919268 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:27:06.921266 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:27:06.922268 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:27:06.922268 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:27:08.025845 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m23:27:08.028835 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:27:08.148372 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED4395490>]}
[0m23:27:08.149375 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.24s]
[0m23:27:08.151371 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:27:08.152366 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:27:08.152366 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:27:08.153366 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:27:08.154364 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:27:08.155370 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:27:08.156375 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:27:08.156375 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:27:08.157369 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:27:08.160365 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:27:08.163910 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:27:08.165903 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:27:08.166900 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:27:08.169898 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:27:08.172902 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:27:08.174904 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:27:08.175904 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:27:08.176904 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:27:08.176904 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:27:08.177904 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod_id,
    title,
    ct.category_id,
    rank_title,
    rank_sub,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings,
    "color_count"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
        );
[0m23:27:08.179905 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:27:08.844896 [debug] [Thread-8 (]: Snowflake adapter: Snowflake query id: 01ba695f-0000-fd34-0001-4c5e000da0a6
[0m23:27:08.845904 [debug] [Thread-8 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 4
invalid identifier 'PROD_ID'
[0m23:27:08.845904 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:27:08.959651 [debug] [Thread-8 (]: Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 4 at position 4
  invalid identifier 'PROD_ID'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:27:08.960651 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED4455520>]}
[0m23:27:08.961644 [error] [Thread-8 (]: 5 of 5 ERROR creating sql table model products_schema_analytics.fact_products_performance  [[31mERROR[0m in 0.81s]
[0m23:27:08.963168 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:27:10.156340 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.979 seconds
[0m23:27:10.159334 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:27:10.268242 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468a25d6-41dc-4ade-8748-7c649a212b7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED44681A0>]}
[0m23:27:10.268242 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 2.11s]
[0m23:27:10.270234 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:27:10.272232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:10.273236 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:27:10.273236 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:27:10.274243 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:27:10.274243 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:27:10.275242 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:27:10.275242 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:27:10.276245 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:27:10.276245 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:27:10.276245 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:27:10.277232 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:27:10.277232 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:27:10.278241 [info ] [MainThread]: 
[0m23:27:10.279233 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m23:27:10.281235 [debug] [MainThread]: Command end result
[0m23:27:10.312232 [info ] [MainThread]: 
[0m23:27:10.314237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:27:10.315233 [info ] [MainThread]: 
[0m23:27:10.316233 [error] [MainThread]:   Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 4 at position 4
  invalid identifier 'PROD_ID'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:27:10.317242 [info ] [MainThread]: 
[0m23:27:10.318233 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:27:10.319234 [debug] [MainThread]: Command `dbt run` failed at 23:27:10.319234 after 11.95 seconds
[0m23:27:10.320234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED4200140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB8BB94C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EB5A41C40>]}
[0m23:27:10.321235 [debug] [MainThread]: Flushing usage events
[0m23:29:07.732942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202267C4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020227342F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202273404A0>]}


============================== 23:29:07.740020 | ecd97cbb-e4e1-42b0-8551-64d516d850f7 ==============================
[0m23:29:07.740020 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:29:07.742025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:08.905240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023F2E8950>]}
[0m23:29:08.952475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023FD20F20>]}
[0m23:29:08.954284 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:29:09.283183 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:29:09.465060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:09.466061 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:29:09.654081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020241C74A40>]}
[0m23:29:09.745162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020241C25970>]}
[0m23:29:09.745162 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:29:09.746165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020241C38C50>]}
[0m23:29:09.747555 [info ] [MainThread]: 
[0m23:29:09.748549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:09.753549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:09.764097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:09.766093 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:09.768627 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:09.768627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:09.769619 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:09.770630 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:09.773621 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:09.773621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:09.774618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:09.774618 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:09.781147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:11.108352 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.334 seconds
[0m23:29:11.110356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.329 seconds
[0m23:29:11.111357 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:11.113354 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:11.122878 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.349 seconds
[0m23:29:11.123877 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:11.237898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:29:11.239903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:29:11.248413 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:29:11.251416 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:29:11.251416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:29:11.252415 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:29:11.253408 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:29:11.255937 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:29:11.256959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:11.257960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:11.258949 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:29:11.262955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:12.038549 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.781 seconds
[0m23:29:12.040554 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:29:12.064425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.801 seconds
[0m23:29:12.066126 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:29:12.220060 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.962 seconds
[0m23:29:12.222062 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:29:12.335296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020240642510>]}
[0m23:29:12.335296 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:29:12.336301 [info ] [MainThread]: 
[0m23:29:12.342170 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:29:12.343191 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:29:12.343987 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:29:12.345025 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:29:12.351549 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:29:12.353556 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:29:12.378898 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:29:12.380884 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:29:12.381899 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:29:12.382882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:13.070193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m23:29:13.090286 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:29:13.204300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020240602210>]}
[0m23:29:13.205299 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m23:29:13.206330 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:29:13.208346 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:29:13.209349 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:29:13.210353 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:29:13.211342 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:29:13.226414 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:29:13.227427 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:29:13.259777 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:29:13.264774 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:29:13.266297 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:29:13.267313 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:29:15.248172 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.980 seconds
[0m23:29:15.250181 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:29:15.364673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020242167D10>]}
[0m23:29:15.366182 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.16s]
[0m23:29:15.367190 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:29:15.368189 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:29:15.369190 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:29:15.371190 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:29:15.371190 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:29:15.375188 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:29:15.376189 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:29:15.379225 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:29:15.381226 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:29:15.381226 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:29:15.382224 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:29:16.795395 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m23:29:16.796920 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:29:16.923440 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202420A50D0>]}
[0m23:29:16.924458 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.55s]
[0m23:29:16.926073 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:29:16.927086 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:29:16.927086 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:29:16.928097 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:29:16.930092 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:29:16.929093 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:29:16.930092 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:29:16.931087 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:29:16.934599 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:29:16.934599 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:29:16.939155 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:29:16.940150 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:29:16.943146 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:29:16.944153 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:29:16.945150 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:29:16.947686 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:29:16.948682 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:29:16.949688 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:29:16.951691 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:29:16.952692 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    title,
    ct.category_id,
    rank_title,
    rank_sub,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings,
    "color_count"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
        );
[0m23:29:16.953700 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:29:17.817294 [debug] [Thread-8 (]: Snowflake adapter: Snowflake query id: 01ba6961-0000-fd16-0001-4c5e000d90c6
[0m23:29:17.818304 [debug] [Thread-8 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier '"color_count"'
[0m23:29:17.819304 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:29:17.930492 [debug] [Thread-8 (]: Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier '"color_count"'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:29:17.931488 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002024219EC60>]}
[0m23:29:17.932488 [error] [Thread-8 (]: 5 of 5 ERROR creating sql table model products_schema_analytics.fact_products_performance  [[31mERROR[0m in 1.00s]
[0m23:29:17.933493 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:29:18.707466 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m23:29:18.709465 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:29:18.819668 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd97cbb-e4e1-42b0-8551-64d516d850f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202421A0860>]}
[0m23:29:18.819668 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.89s]
[0m23:29:18.821663 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:29:18.823666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:18.823666 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:18.824667 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:18.824667 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:18.824667 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:29:18.824667 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:29:18.826180 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:29:18.827190 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:29:18.827190 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:29:18.828191 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:29:18.828191 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:29:18.829194 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:29:18.829194 [info ] [MainThread]: 
[0m23:29:18.830717 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m23:29:18.832743 [debug] [MainThread]: Command end result
[0m23:29:18.868860 [info ] [MainThread]: 
[0m23:29:18.869863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:29:18.870863 [info ] [MainThread]: 
[0m23:29:18.870863 [error] [MainThread]:   Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier '"color_count"'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:29:18.871862 [info ] [MainThread]: 
[0m23:29:18.872860 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:29:18.874863 [debug] [MainThread]: Command `dbt run` failed at 23:29:18.873862 after 11.33 seconds
[0m23:29:18.874863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202277572F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020241B2C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020240602210>]}
[0m23:29:18.874863 [debug] [MainThread]: Flushing usage events
[0m23:29:34.431872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44D771700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44DE1E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A59F260>]}


============================== 23:29:34.436954 | fd762c21-edaa-483a-8313-372dbecca41f ==============================
[0m23:29:34.436954 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:29:34.437477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:35.384600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E466F9F1A0>]}
[0m23:29:35.430227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E465C10A70>]}
[0m23:29:35.431235 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:29:35.777759 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:29:35.943954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:35.944976 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:29:36.133699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4685D0BC0>]}
[0m23:29:36.227785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46857D760>]}
[0m23:29:36.228779 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:29:36.229779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E468590DD0>]}
[0m23:29:36.230777 [info ] [MainThread]: 
[0m23:29:36.232078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:36.237108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:36.249999 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:36.249999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:36.250986 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:36.251996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:29:36.254994 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:36.254994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:36.257510 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:29:36.258531 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:36.262534 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:29:36.263529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:36.264520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:37.461399 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.198 seconds
[0m23:29:37.463399 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.198 seconds
[0m23:29:37.464395 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:37.465396 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:37.494265 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.238 seconds
[0m23:29:37.495268 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:29:37.606783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:29:37.607834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:29:37.615834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:29:37.616828 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:29:37.619209 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:29:37.623204 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:29:37.624204 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:29:37.625200 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:29:37.625200 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:29:37.626213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:37.626213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:37.627210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:38.562219 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.935 seconds
[0m23:29:38.563221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.936 seconds
[0m23:29:38.565222 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:29:38.567213 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.941 seconds
[0m23:29:38.568730 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:29:38.571729 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:29:38.688252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E466F9E690>]}
[0m23:29:38.689246 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:29:38.689246 [info ] [MainThread]: 
[0m23:29:38.694243 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:29:38.695243 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:29:38.697248 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:29:38.697759 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:29:38.705787 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:29:38.707305 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:29:38.742295 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:29:38.744296 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:29:38.745299 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:29:38.745299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:39.432706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m23:29:39.454370 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:29:39.564048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E466F621E0>]}
[0m23:29:39.565048 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m23:29:39.566048 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:29:39.567052 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:29:39.567557 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:29:39.569565 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:29:39.569565 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:29:39.587082 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:29:39.588466 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:29:39.610510 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:29:39.614510 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:29:39.614510 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:29:39.615514 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:29:41.506009 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.891 seconds
[0m23:29:41.508550 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:29:41.619578 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E468A2EC90>]}
[0m23:29:41.619578 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.05s]
[0m23:29:41.621576 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:29:41.622570 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:29:41.623569 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:29:41.624580 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:29:41.624580 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:29:41.629128 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:29:41.630128 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:29:41.633133 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:29:41.634634 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:29:41.635650 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:29:41.635650 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:29:42.967741 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.331 seconds
[0m23:29:42.969750 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:29:43.084299 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46896CC80>]}
[0m23:29:43.084299 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.46s]
[0m23:29:43.086300 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:29:43.087299 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:29:43.087299 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:29:43.087299 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:29:43.089745 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:29:43.088740 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:29:43.090734 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:29:43.091737 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:29:43.094739 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:29:43.094739 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:29:43.098290 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:29:43.099293 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:29:43.102277 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:29:43.103286 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:29:43.106283 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:29:43.107275 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:29:43.107781 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:29:43.108793 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:29:43.109791 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:29:43.111789 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    title,
    ct.category_id,
    rank_title,
    rank_sub,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings,
    color_count
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
        );
[0m23:29:43.112792 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:29:43.797613 [debug] [Thread-8 (]: Snowflake adapter: Snowflake query id: 01ba6961-0000-fd24-0001-4c5e000d62c6
[0m23:29:43.798624 [debug] [Thread-8 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'COLOR_COUNT'
[0m23:29:43.798624 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:29:43.918318 [debug] [Thread-8 (]: Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:29:43.919317 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E468A19D00>]}
[0m23:29:43.919317 [error] [Thread-8 (]: 5 of 5 ERROR creating sql table model products_schema_analytics.fact_products_performance  [[31mERROR[0m in 0.83s]
[0m23:29:43.921315 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:29:45.871424 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.762 seconds
[0m23:29:45.873421 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:29:45.989868 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd762c21-edaa-483a-8313-372dbecca41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E468B00890>]}
[0m23:29:45.990878 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 2.90s]
[0m23:29:45.991874 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:29:45.993869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:45.993869 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:45.994870 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:45.994870 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:29:45.994870 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:29:45.995871 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:29:45.995871 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:29:45.995871 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:29:45.995871 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:29:45.997378 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:29:45.997378 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:29:45.998387 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:29:45.998387 [info ] [MainThread]: 
[0m23:29:45.999386 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.77 seconds (9.77s).
[0m23:29:46.001387 [debug] [MainThread]: Command end result
[0m23:29:46.033175 [info ] [MainThread]: 
[0m23:29:46.034174 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:29:46.035184 [info ] [MainThread]: 
[0m23:29:46.036176 [error] [MainThread]:   Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'COLOR_COUNT'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:29:46.037685 [info ] [MainThread]: 
[0m23:29:46.038699 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:29:46.040704 [debug] [MainThread]: Command `dbt run` failed at 23:29:46.040704 after 11.71 seconds
[0m23:29:46.040704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44DF73770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E468827EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44E0D1190>]}
[0m23:29:46.041710 [debug] [MainThread]: Flushing usage events
[0m23:30:09.236384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B742954140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B745099730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B74509AF60>]}


============================== 23:30:09.243909 | afe1a84c-3757-4155-9225-df1086d5564f ==============================
[0m23:30:09.243909 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:30:09.245909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:10.567924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7451A8DA0>]}
[0m23:30:10.619700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75EA9EAE0>]}
[0m23:30:10.621688 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:30:10.954487 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:30:11.143858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:11.143858 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:30:11.352437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B760070B00>]}
[0m23:30:11.456148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76001DB50>]}
[0m23:30:11.457144 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:30:11.458138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75EB91400>]}
[0m23:30:11.458656 [info ] [MainThread]: 
[0m23:30:11.460164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:11.465187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:30:11.479825 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:30:11.481855 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:30:11.481855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:11.482847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:30:11.484844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:30:11.491413 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:30:11.502968 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:30:11.503969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:11.497986 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:30:11.509102 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:30:11.510094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:12.541037 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.059 seconds
[0m23:30:12.543036 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:30:12.578082 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.074 seconds
[0m23:30:12.579417 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.069 seconds
[0m23:30:12.581401 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:30:12.582419 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:30:12.705033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:30:12.707042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:30:12.713599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:30:12.716599 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:30:12.722183 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:30:12.726164 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:30:12.726164 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:30:12.727172 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:30:12.728166 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:30:12.728680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:12.729698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:12.730697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:13.560330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.831 seconds
[0m23:30:13.561335 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:30:13.661312 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.931 seconds
[0m23:30:13.663841 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:30:13.784898 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.056 seconds
[0m23:30:13.786897 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:30:13.898453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75E71C9E0>]}
[0m23:30:13.899193 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:30:13.900192 [info ] [MainThread]: 
[0m23:30:13.907192 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:30:13.908198 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:30:13.908724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:30:13.909748 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:30:13.916733 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:30:13.918241 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:30:13.952161 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:30:13.954147 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:30:13.955163 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:30:13.956168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:30:14.636475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m23:30:14.661071 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:30:14.773091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75E9FA660>]}
[0m23:30:14.774099 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m23:30:14.775108 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:30:14.776106 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:30:14.777101 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:30:14.778106 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:30:14.779203 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:30:14.796739 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:30:14.798365 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:30:14.822189 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:30:14.827172 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:30:14.828177 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:30:14.828690 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:30:16.937470 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.109 seconds
[0m23:30:16.940518 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:30:17.046614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76046E360>]}
[0m23:30:17.046614 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.27s]
[0m23:30:17.048123 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:30:17.049145 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:30:17.050140 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:30:17.051148 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:30:17.052140 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:30:17.057135 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:30:17.058664 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:30:17.061683 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:30:17.063687 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:30:17.063687 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:30:17.064689 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:30:18.386674 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m23:30:18.391213 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:30:18.511219 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76042AA50>]}
[0m23:30:18.511219 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.46s]
[0m23:30:18.513213 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:30:18.513721 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:30:18.514739 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:30:18.515739 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:30:18.516744 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:30:18.515739 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:30:18.518253 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:30:18.519261 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:30:18.524275 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:30:18.525292 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:30:18.529798 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:30:18.530798 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:30:18.533803 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:30:18.534798 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:30:18.538329 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:30:18.539346 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:30:18.541349 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:30:18.542347 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:30:18.543339 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:30:18.545350 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    title,
    ct.category_id,
    rank_title,
    rank_sub,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings,
    color_counts
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
        );
[0m23:30:18.546337 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:30:19.292292 [debug] [Thread-8 (]: Snowflake adapter: Snowflake query id: 01ba6962-0000-fd34-0001-4c5e000da0ba
[0m23:30:19.293295 [debug] [Thread-8 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'COLOR_COUNTS'
[0m23:30:19.294277 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:30:19.415789 [debug] [Thread-8 (]: Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'COLOR_COUNTS'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:30:19.416787 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741EEFA40>]}
[0m23:30:19.416787 [error] [Thread-8 (]: 5 of 5 ERROR creating sql table model products_schema_analytics.fact_products_performance  [[31mERROR[0m in 0.90s]
[0m23:30:19.419303 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:30:20.408743 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.867 seconds
[0m23:30:20.410766 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:30:20.524191 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe1a84c-3757-4155-9225-df1086d5564f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76046E360>]}
[0m23:30:20.524191 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 2.01s]
[0m23:30:20.526191 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:30:20.528185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:20.528704 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:30:20.528704 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:30:20.528704 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:30:20.529726 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:30:20.529726 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:30:20.530720 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:30:20.530720 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:30:20.531725 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:30:20.531725 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:30:20.532720 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:30:20.532720 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:30:20.533725 [info ] [MainThread]: 
[0m23:30:20.534711 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m23:30:20.536717 [debug] [MainThread]: Command end result
[0m23:30:20.571981 [info ] [MainThread]: 
[0m23:30:20.572998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:20.573989 [info ] [MainThread]: 
[0m23:30:20.574975 [error] [MainThread]:   Database Error in model fact_products_performance (models\analytics\fact_products_performance.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'COLOR_COUNTS'
  compiled code at target\run\transform\models\analytics\fact_products_performance.sql
[0m23:30:20.576980 [info ] [MainThread]: 
[0m23:30:20.576980 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:30:20.579511 [debug] [MainThread]: Command `dbt run` failed at 23:30:20.579511 after 11.49 seconds
[0m23:30:20.580505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7456E3B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75FE24B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B745B5F980>]}
[0m23:30:20.581504 [debug] [MainThread]: Flushing usage events
[0m23:31:00.297462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267AF15C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267AE5AF200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B20C79E0>]}


============================== 23:31:00.302298 | 4b8af352-0842-4732-99d5-c7566c31a23f ==============================
[0m23:31:00.302298 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:31:00.304302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:01.458989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB0797F0>]}
[0m23:31:01.515236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C9C10FE0>]}
[0m23:31:01.516242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:31:01.852904 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:31:02.046011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:31:02.046011 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:31:02.260948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CAFE2480>]}
[0m23:31:02.361743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC6059D0>]}
[0m23:31:02.361743 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:31:02.362755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC3E23C0>]}
[0m23:31:02.364750 [info ] [MainThread]: 
[0m23:31:02.365760 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:31:02.371266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:31:02.384919 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:31:02.384919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:31:02.385929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:31:02.386920 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:31:02.391480 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:31:02.394477 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:31:02.394477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:02.395464 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:31:02.396466 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:31:02.399978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:02.401990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:03.474927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.074 seconds
[0m23:31:03.475916 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.081 seconds
[0m23:31:03.477915 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:31:03.479925 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:31:03.484577 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.083 seconds
[0m23:31:03.486114 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:31:03.612900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:31:03.613903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:31:03.623470 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:31:03.624455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:31:03.627462 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:31:03.628466 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:31:03.631602 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:31:03.632600 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:31:03.633591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:03.633591 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:31:03.634591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:03.636598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:04.451098 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.814 seconds
[0m23:31:04.453093 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:31:04.586657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.952 seconds
[0m23:31:04.588672 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:31:04.595168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.961 seconds
[0m23:31:04.596166 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:31:04.705117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC526600>]}
[0m23:31:04.706122 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:31:04.707121 [info ] [MainThread]: 
[0m23:31:04.713022 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:31:04.714031 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:31:04.716027 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:31:04.716027 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:31:04.723566 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:31:04.725557 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:31:04.754163 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:31:04.757165 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:31:04.758169 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:31:04.758169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:05.480644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m23:31:05.502264 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:31:05.612978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CAFE2360>]}
[0m23:31:05.613989 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.90s]
[0m23:31:05.614978 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:31:05.615987 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:31:05.616975 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:31:05.617975 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:31:05.618983 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:31:05.634059 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:31:05.636048 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:31:05.658089 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:31:05.662628 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:31:05.663625 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:31:05.664631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:31:08.090808 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.426 seconds
[0m23:31:08.093808 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:31:08.201304 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CCAC3500>]}
[0m23:31:08.202309 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.58s]
[0m23:31:08.203458 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:31:08.204299 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m23:31:08.206305 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m23:31:08.207304 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m23:31:08.207304 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m23:31:08.211843 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m23:31:08.212841 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m23:31:08.215830 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m23:31:08.218845 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m23:31:08.219831 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:31:08.219831 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:31:09.500795 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m23:31:09.502803 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m23:31:09.632875 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC6E52B0>]}
[0m23:31:09.633881 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.43s]
[0m23:31:09.635878 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m23:31:09.636880 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:31:09.636880 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:31:09.637866 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:31:09.638867 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:31:09.639885 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:31:09.642112 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:31:09.642112 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:31:09.643100 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:31:09.646102 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:31:09.650620 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:31:09.651642 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:31:09.655636 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:31:09.656639 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:31:09.661152 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:31:09.662150 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:31:09.662150 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id,
    inttable.title,
    ct.category_id,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m23:31:09.663151 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:31:09.664155 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:31:09.666151 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    title,
    ct.category_id,
    rank_title,
    rank_sub,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings,
    "color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
        );
[0m23:31:09.667153 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:31:11.708009 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.040 seconds
[0m23:31:11.710009 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:31:11.724940 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m23:31:11.726937 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:31:11.823055 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267AE49FCE0>]}
[0m23:31:11.824053 [info ] [Thread-8 (]: 5 of 5 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 2.18s]
[0m23:31:11.825046 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:31:11.838342 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8af352-0842-4732-99d5-c7566c31a23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CCA0A1B0>]}
[0m23:31:11.839865 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 2.20s]
[0m23:31:11.840888 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:31:11.842889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:11.842889 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:31:11.843896 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:31:11.843896 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:31:11.844889 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:31:11.844889 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:31:11.845883 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:31:11.845883 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:31:11.846882 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:31:11.846882 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m23:31:11.846882 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:31:11.847882 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:31:11.848883 [info ] [MainThread]: 
[0m23:31:11.848883 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m23:31:11.851420 [debug] [MainThread]: Command end result
[0m23:31:11.884997 [info ] [MainThread]: 
[0m23:31:11.885996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:11.886989 [info ] [MainThread]: 
[0m23:31:11.888506 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:31:11.891071 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:11.891071 after 11.71 seconds
[0m23:31:11.892097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC61CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB3B7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB0A5790>]}
[0m23:31:11.892097 [debug] [MainThread]: Flushing usage events
[0m23:51:47.065665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002485046B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484DA8EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002485033F620>]}


============================== 23:51:47.070663 | 259530c4-4315-401f-8152-b8d1041a2128 ==============================
[0m23:51:47.070663 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:51:47.071662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:51:48.139976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '259530c4-4315-401f-8152-b8d1041a2128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486889D0A0>]}
[0m23:51:48.190531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '259530c4-4315-401f-8152-b8d1041a2128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248693E9D00>]}
[0m23:51:48.191518 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:51:48.493967 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:51:48.673591 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m23:51:48.674598 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\agg_category_performance.sql
[0m23:51:48.674598 [debug] [MainThread]: Partial parsing: deleted file: transform://models\analytics\dim_category.sql
[0m23:51:48.675589 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:51:48.675589 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:51:48.837376 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.dim_products' (models\analytics\dim_products.sql) depends on a node named 'dim_category' which was not found
[0m23:51:48.839362 [debug] [MainThread]: Command `dbt run` failed at 23:51:48.839362 after 1.92 seconds
[0m23:51:48.840383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248505D75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024868847CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486950D880>]}
[0m23:51:48.840383 [debug] [MainThread]: Flushing usage events
[0m23:53:06.279291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5827BE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A584EE0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5852F7770>]}


============================== 23:53:06.284779 | 49da2fc8-86c0-4f64-9366-7fcd71691363 ==============================
[0m23:53:06.284779 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:53:06.285847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:07.386908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49da2fc8-86c0-4f64-9366-7fcd71691363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A59D8101A0>]}
[0m23:53:07.434140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49da2fc8-86c0-4f64-9366-7fcd71691363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A59E2CCA70>]}
[0m23:53:07.435598 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:53:07.756018 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:53:07.921604 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m23:53:07.922128 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\agg_category_performance.sql
[0m23:53:07.923150 [debug] [MainThread]: Partial parsing: deleted file: transform://models\analytics\dim_category.sql
[0m23:53:07.923150 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:53:07.924150 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:53:08.087715 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.dim_products' (models\analytics\dim_products.sql) depends on a node named 'dim_category' which was not found
[0m23:53:08.090330 [debug] [MainThread]: Command `dbt run` failed at 23:53:08.089308 after 1.93 seconds
[0m23:53:08.090330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5852F75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A59E28EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A59F75DDC0>]}
[0m23:53:08.091331 [debug] [MainThread]: Flushing usage events
[0m23:53:49.455275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A059EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A27A3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A27A2FC0>]}


============================== 23:53:49.460281 | b8d0a9a2-d1aa-4962-ac8a-e5a0a0f337de ==============================
[0m23:53:49.460281 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:53:49.466359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:53:50.502135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8d0a9a2-d1aa-4962-ac8a-e5a0a0f337de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB6E50A0>]}
[0m23:53:50.551242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8d0a9a2-d1aa-4962-ac8a-e5a0a0f337de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BBF35580>]}
[0m23:53:50.553243 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:53:50.867967 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:53:51.031518 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m23:53:51.032518 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\agg_category_performance.sql
[0m23:53:51.032518 [debug] [MainThread]: Partial parsing: deleted file: transform://models\analytics\dim_category.sql
[0m23:53:51.033518 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:53:51.033518 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:53:51.190586 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.fact_products_performance' (models\analytics\fact_products_performance.sql) depends on a node named 'dim_category' which was not found
[0m23:53:51.192586 [debug] [MainThread]: Command `dbt run` failed at 23:53:51.192586 after 1.84 seconds
[0m23:53:51.193587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A2E814F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BD589C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BB6E5070>]}
[0m23:53:51.193587 [debug] [MainThread]: Flushing usage events
[0m23:54:27.982057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB2C6B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB25BCFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FAFEB6E70>]}


============================== 23:54:27.987484 | 30615107-20da-4b51-b1f2-f404a4d21844 ==============================
[0m23:54:27.987484 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:27.988505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:28.968214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCB5D81D0>]}
[0m23:54:29.016313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCB490E90>]}
[0m23:54:29.018313 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:29.339319 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:54:29.496972 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m23:54:29.497972 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\agg_category_performance.sql
[0m23:54:29.497972 [debug] [MainThread]: Partial parsing: deleted file: transform://models\analytics\dim_category.sql
[0m23:54:29.499093 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:54:29.499963 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\fact_products_performance.sql
[0m23:54:29.706187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCDED9F40>]}
[0m23:54:29.799262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCDF63290>]}
[0m23:54:29.800273 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:54:29.801268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCDF1D040>]}
[0m23:54:29.803267 [info ] [MainThread]: 
[0m23:54:29.804255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:29.809260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:54:29.810264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:54:29.822256 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:54:29.823263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:54:29.826257 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:54:29.827270 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:54:29.829283 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:54:29.830271 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:54:29.830271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:29.831271 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:54:29.832262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:29.835280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:31.261275 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.431 seconds
[0m23:54:31.263279 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:54:31.267281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.435 seconds
[0m23:54:31.268283 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:54:31.273301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.438 seconds
[0m23:54:31.275302 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:54:31.403249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:54:31.406242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:54:31.413258 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:54:31.416252 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:54:31.417243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:54:31.418254 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:54:31.419247 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:54:31.421246 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:54:31.422253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:31.422253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:31.423253 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:54:31.426261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:32.351240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.930 seconds
[0m23:54:32.353248 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:54:32.369673 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.948 seconds
[0m23:54:32.371681 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:54:32.389609 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.963 seconds
[0m23:54:32.390608 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:54:32.502006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCC9B5550>]}
[0m23:54:32.502969 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:54:32.502969 [info ] [MainThread]: 
[0m23:54:32.509677 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:54:32.510681 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:54:32.510681 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:54:32.511686 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:54:32.518677 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:54:32.519683 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:54:32.547254 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:54:32.549242 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:54:32.549242 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:54:32.550243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:33.231995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m23:54:33.253019 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:54:33.362088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCC8F2360>]}
[0m23:54:33.363093 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.85s]
[0m23:54:33.364093 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:54:33.366093 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:54:33.366093 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:54:33.367091 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:54:33.368093 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:54:33.373117 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:54:33.374142 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:54:33.395651 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:54:33.399638 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:54:33.400650 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:54:33.401660 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:54:37.343490 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.942 seconds
[0m23:54:37.345490 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:54:37.457953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCE35B4A0>]}
[0m23:54:37.458955 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.09s]
[0m23:54:37.460099 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:54:37.461128 [debug] [Thread-5 (]: Began running node model.transform.agg_category_performance
[0m23:54:37.462127 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m23:54:37.463127 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m23:54:37.464133 [debug] [Thread-5 (]: Began compiling node model.transform.agg_category_performance
[0m23:54:37.467128 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m23:54:37.469131 [debug] [Thread-5 (]: Began executing node model.transform.agg_category_performance
[0m23:54:37.472131 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m23:54:37.474131 [debug] [Thread-5 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m23:54:37.475133 [debug] [Thread-5 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:54:37.475133 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:54:39.825686 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.351 seconds
[0m23:54:39.827676 [debug] [Thread-5 (]: On model.transform.agg_category_performance: Close
[0m23:54:39.942788 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCE3CBF80>]}
[0m23:54:39.943787 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 2.48s]
[0m23:54:39.945779 [debug] [Thread-5 (]: Finished running node model.transform.agg_category_performance
[0m23:54:39.946777 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:54:39.946777 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:54:39.947775 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:54:39.948777 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:54:39.949775 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:54:39.950775 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:54:39.951774 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:54:39.951774 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:54:39.954772 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:54:39.958771 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:54:39.959778 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:54:39.960776 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:54:39.963771 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:54:39.966181 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:54:39.969196 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:54:39.969196 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    inttable.rank_title,
    inttable.rank_sub,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
    ON inttable.category = ct.category
        );
[0m23:54:39.971180 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:54:39.971180 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:54:39.972178 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m23:54:39.974179 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:54:40.827335 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba697a-0000-fd29-0001-4c5e000d135a
[0m23:54:40.827335 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 12 unexpected '.'.
syntax error line 15 at position 7 unexpected 'inttable'.
[0m23:54:40.828535 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:54:40.938610 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected '.'.
  syntax error line 15 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:54:40.939619 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCDFFA840>]}
[0m23:54:40.940615 [error] [Thread-7 (]: 4 of 5 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.99s]
[0m23:54:40.941625 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:54:42.691995 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.719 seconds
[0m23:54:42.694998 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:54:42.806215 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30615107-20da-4b51-b1f2-f404a4d21844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FCE3CBFE0>]}
[0m23:54:42.807215 [info ] [Thread-8 (]: 5 of 5 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 2.86s]
[0m23:54:42.808212 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:54:42.810214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:42.811220 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:54:42.811220 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:54:42.812221 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:54:42.812221 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:54:42.812221 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:54:42.813221 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:54:42.813221 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:54:42.814220 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:54:42.814220 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m23:54:42.814220 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:54:42.815225 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:54:42.815225 [info ] [MainThread]: 
[0m23:54:42.816211 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 13.01 seconds (13.01s).
[0m23:54:42.818213 [debug] [MainThread]: Command end result
[0m23:54:42.849210 [info ] [MainThread]: 
[0m23:54:42.850218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:54:42.851215 [info ] [MainThread]: 
[0m23:54:42.852211 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected '.'.
  syntax error line 15 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:54:42.853219 [info ] [MainThread]: 
[0m23:54:42.854213 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:54:42.855209 [debug] [MainThread]: Command `dbt run` failed at 23:54:42.855209 after 14.98 seconds
[0m23:54:42.856211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB39C7C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB3593D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB3591D30>]}
[0m23:54:42.857224 [debug] [MainThread]: Flushing usage events
[0m23:56:12.551145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9714EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B99383F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B993823F0>]}


============================== 23:56:12.558134 | 62adc092-7aa5-43b3-86e1-770108c1efde ==============================
[0m23:56:12.558134 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:56:12.559133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:56:13.599002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB14B7BF0>]}
[0m23:56:13.642558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B99B2B5C0>]}
[0m23:56:13.644545 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:56:13.968810 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:56:14.137904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:14.137904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:14.168907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB2BADD00>]}
[0m23:56:14.267861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB40551C0>]}
[0m23:56:14.268847 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:56:14.269854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B993BB230>]}
[0m23:56:14.272850 [info ] [MainThread]: 
[0m23:56:14.273857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:56:14.278506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:56:14.287520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:56:14.295069 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:56:14.296058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:56:14.298064 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:56:14.299054 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:56:14.302062 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:56:14.303053 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:56:14.304059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:14.305056 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:56:14.308054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:14.305056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:15.365757 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.058 seconds
[0m23:56:15.367751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.062 seconds
[0m23:56:15.368753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.065 seconds
[0m23:56:15.369764 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:56:15.371764 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:56:15.373754 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:56:15.503813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:56:15.505812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:56:15.513816 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:56:15.515817 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:56:15.516817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:56:15.517817 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:56:15.517817 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:56:15.520812 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:56:15.521816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:15.521816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:15.522814 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:56:15.525819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:16.342349 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.816 seconds
[0m23:56:16.344351 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:56:16.493670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.973 seconds
[0m23:56:16.495689 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:56:16.499690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.977 seconds
[0m23:56:16.501689 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:56:16.612711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB2B7A180>]}
[0m23:56:16.613728 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:56:16.614729 [info ] [MainThread]: 
[0m23:56:16.619485 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:56:16.620483 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:56:16.621658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:56:16.622682 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:56:16.628671 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:56:16.630676 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:56:16.657687 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:56:16.659682 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:56:16.660678 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:56:16.661673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:56:17.557710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m23:56:17.577729 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:56:17.692248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB2B31EE0>]}
[0m23:56:17.693270 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.07s]
[0m23:56:17.694262 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:56:17.695266 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:56:17.696265 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:56:17.697272 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:56:17.698270 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:56:17.713258 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:56:17.714270 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:56:17.734271 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:56:17.738259 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:56:17.739274 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:56:17.740289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:56:20.786814 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.046 seconds
[0m23:56:20.788817 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:56:20.900420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB43FA630>]}
[0m23:56:20.901420 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.20s]
[0m23:56:20.903418 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:56:20.904421 [debug] [Thread-5 (]: Began running node model.transform.agg_category_performance
[0m23:56:20.905421 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m23:56:20.906420 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m23:56:20.906420 [debug] [Thread-5 (]: Began compiling node model.transform.agg_category_performance
[0m23:56:20.910412 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m23:56:20.911416 [debug] [Thread-5 (]: Began executing node model.transform.agg_category_performance
[0m23:56:20.914426 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m23:56:20.916410 [debug] [Thread-5 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m23:56:20.917427 [debug] [Thread-5 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:56:20.917427 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:56:23.305432 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.388 seconds
[0m23:56:23.307431 [debug] [Thread-5 (]: On model.transform.agg_category_performance: Close
[0m23:56:23.417932 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB4477DA0>]}
[0m23:56:23.418938 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 2.51s]
[0m23:56:23.419932 [debug] [Thread-5 (]: Finished running node model.transform.agg_category_performance
[0m23:56:23.420937 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:56:23.421927 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:56:23.421927 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:56:23.423934 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:56:23.422933 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:56:23.424933 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:56:23.424933 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:56:23.427932 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:56:23.428932 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:56:23.432931 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:56:23.432931 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:56:23.437935 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:56:23.437935 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:56:23.440928 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:56:23.442941 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:56:23.443928 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    inttable.rank_title,
    inttable.rank_sub,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
    ON inttable.category = ct.category
        );
[0m23:56:23.443928 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:56:23.444928 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:56:23.446933 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m23:56:23.448135 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:56:24.104575 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba697c-0000-fd34-0001-4c5e000da0d2
[0m23:56:24.105587 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 12 unexpected '.'.
syntax error line 15 at position 7 unexpected 'inttable'.
[0m23:56:24.105587 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:56:24.225378 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected '.'.
  syntax error line 15 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:56:24.226378 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B99B4FFE0>]}
[0m23:56:24.227373 [error] [Thread-7 (]: 4 of 5 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.80s]
[0m23:56:24.228377 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:56:25.240585 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.793 seconds
[0m23:56:25.242578 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:56:25.355857 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62adc092-7aa5-43b3-86e1-770108c1efde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB2ADF8F0>]}
[0m23:56:25.356857 [info ] [Thread-8 (]: 5 of 5 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.93s]
[0m23:56:25.357852 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:56:25.360366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:25.360366 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:56:25.361383 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:56:25.361383 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:56:25.361383 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:56:25.362383 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:56:25.362383 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:56:25.362383 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:56:25.363383 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:56:25.363383 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m23:56:25.364374 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:56:25.364374 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:56:25.365383 [info ] [MainThread]: 
[0m23:56:25.365734 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 11.09 seconds (11.09s).
[0m23:56:25.367757 [debug] [MainThread]: Command end result
[0m23:56:25.398267 [info ] [MainThread]: 
[0m23:56:25.399266 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:56:25.399266 [info ] [MainThread]: 
[0m23:56:25.400783 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected '.'.
  syntax error line 15 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:56:25.401790 [info ] [MainThread]: 
[0m23:56:25.402805 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:56:25.404802 [debug] [MainThread]: Command `dbt run` failed at 23:56:25.404802 after 13.01 seconds
[0m23:56:25.405806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B99133AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B99CB29F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB2BD6510>]}
[0m23:56:25.406806 [debug] [MainThread]: Flushing usage events
[0m23:57:47.139673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACC81EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB856F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACEFF2AE0>]}


============================== 23:57:47.144216 | bbe5ed62-9db3-45b2-a80b-f38b1cdc8827 ==============================
[0m23:57:47.144216 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:57:47.145214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:48.100163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE6E6C500>]}
[0m23:57:48.145385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE7A6AD20>]}
[0m23:57:48.147378 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:57:48.472498 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:57:48.633795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:48.633795 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:57:48.825356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9930A10>]}
[0m23:57:48.920877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE98E5730>]}
[0m23:57:48.922384 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:57:48.923400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE8450B90>]}
[0m23:57:48.924915 [info ] [MainThread]: 
[0m23:57:48.925913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:48.929911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:57:48.940438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:57:48.944956 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:57:48.947961 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:57:48.947961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:57:48.948959 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:57:48.949961 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:57:48.952460 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:57:48.953475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:48.953475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:48.954477 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:57:48.960471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:49.986385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.025 seconds
[0m23:57:49.987391 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.034 seconds
[0m23:57:49.988385 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:57:49.991380 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:57:50.011231 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.058 seconds
[0m23:57:50.012746 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:57:50.150341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:57:50.152868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:57:50.160882 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:57:50.160882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:57:50.164409 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:57:50.165578 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:57:50.169594 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:57:50.170599 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:57:50.170599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:50.172113 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:57:50.173127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:50.175127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:51.003400 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.830 seconds
[0m23:57:51.004421 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:57:51.151117 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.979 seconds
[0m23:57:51.152622 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:57:51.156636 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.982 seconds
[0m23:57:51.158651 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:57:51.267515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE97D4A70>]}
[0m23:57:51.268515 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:57:51.269515 [info ] [MainThread]: 
[0m23:57:51.275054 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:57:51.276068 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:57:51.277070 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:57:51.277070 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:57:51.284144 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:57:51.285153 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:57:51.312201 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:57:51.313717 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:57:51.314725 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:57:51.314725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:51.990461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m23:57:52.010536 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:57:52.118576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE82BE630>]}
[0m23:57:52.119581 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m23:57:52.120662 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:57:52.122184 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:57:52.123193 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:57:52.124207 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:57:52.125207 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:57:52.139940 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:57:52.140936 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:57:52.162563 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:57:52.166583 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:57:52.167591 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:57:52.167591 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:57:54.330464 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.162 seconds
[0m23:57:54.332462 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:57:54.440886 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9CD16D0>]}
[0m23:57:54.440886 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.32s]
[0m23:57:54.443405 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:57:54.444413 [debug] [Thread-5 (]: Began running node model.transform.agg_category_performance
[0m23:57:54.445413 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m23:57:54.446414 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m23:57:54.447413 [debug] [Thread-5 (]: Began compiling node model.transform.agg_category_performance
[0m23:57:54.451411 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m23:57:54.452412 [debug] [Thread-5 (]: Began executing node model.transform.agg_category_performance
[0m23:57:54.456744 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m23:57:54.458743 [debug] [Thread-5 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m23:57:54.458743 [debug] [Thread-5 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:57:54.459743 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:57:56.006440 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m23:57:56.008439 [debug] [Thread-5 (]: On model.transform.agg_category_performance: Close
[0m23:57:56.119517 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9C871D0>]}
[0m23:57:56.120517 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.67s]
[0m23:57:56.121509 [debug] [Thread-5 (]: Finished running node model.transform.agg_category_performance
[0m23:57:56.122512 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:57:56.122512 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:57:56.123667 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:57:56.125671 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:57:56.124669 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:57:56.125671 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:57:56.127179 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:57:56.130196 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:57:56.131193 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:57:56.131193 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:57:56.134714 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:57:56.137718 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:57:56.139722 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:57:56.143250 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:57:56.144272 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:57:56.145273 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    inttable.rank_title,
    inttable.rank_sub,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
    ON inttable.category = ct.category
        );
[0m23:57:56.146268 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:57:56.147263 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:57:56.149262 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m23:57:56.150271 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:57:56.962914 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba697d-0000-fd30-0001-4c5e000db066
[0m23:57:56.962914 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'RANK_TITLE'
[0m23:57:56.963937 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:57:57.080512 [debug] [Thread-7 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'RANK_TITLE'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:57:57.080512 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9DB4E90>]}
[0m23:57:57.081516 [error] [Thread-7 (]: 4 of 5 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.95s]
[0m23:57:57.083038 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:57:57.994876 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.844 seconds
[0m23:57:57.996880 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:57:58.102664 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe5ed62-9db3-45b2-a80b-f38b1cdc8827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB73FAA0>]}
[0m23:57:58.102664 [info ] [Thread-8 (]: 5 of 5 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.98s]
[0m23:57:58.104794 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:57:58.106791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:58.107784 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:57:58.107784 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:57:58.107784 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:57:58.108795 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:57:58.109794 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:57:58.109794 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:57:58.109794 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:57:58.110799 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:57:58.110799 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m23:57:58.110799 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:57:58.111799 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:57:58.111799 [info ] [MainThread]: 
[0m23:57:58.112802 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m23:57:58.114921 [debug] [MainThread]: Command end result
[0m23:57:58.146084 [info ] [MainThread]: 
[0m23:57:58.147066 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:57:58.148084 [info ] [MainThread]: 
[0m23:57:58.149065 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'RANK_TITLE'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m23:57:58.150067 [info ] [MainThread]: 
[0m23:57:58.151074 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:57:58.152594 [debug] [MainThread]: Command `dbt run` failed at 23:57:58.152594 after 11.16 seconds
[0m23:57:58.152594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE97BFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAE9B60050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACF3679B0>]}
[0m23:57:58.153613 [debug] [MainThread]: Flushing usage events
[0m23:58:22.092313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269563B29C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269563B3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269563B3E60>]}


============================== 23:58:22.096853 | 9a06963e-11b1-443f-88f4-570a0a83de93 ==============================
[0m23:58:22.096853 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:58:22.097852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:58:23.013504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269561816A0>]}
[0m23:58:23.059037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696E1F8AD0>]}
[0m23:58:23.060039 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:58:23.389198 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:58:23.556970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:58:23.556970 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m23:58:23.739127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696E89D370>]}
[0m23:58:23.827679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970A7DA00>]}
[0m23:58:23.828675 [info ] [MainThread]: Found 5 models, 1 test, 575 macros
[0m23:58:23.829658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696F6058E0>]}
[0m23:58:23.831674 [info ] [MainThread]: 
[0m23:58:23.832674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:23.836617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:58:23.849141 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:58:23.850143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:58:23.850143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:58:23.851154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:23.852153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m23:58:23.854506 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:58:23.860488 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m23:58:23.861490 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:58:23.862490 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m23:58:23.863491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:23.863491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:24.876532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.013 seconds
[0m23:58:24.877538 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:58:24.919845 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.056 seconds
[0m23:58:24.920855 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.070 seconds
[0m23:58:24.922850 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:58:24.923850 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m23:58:25.040160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m23:58:25.042172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m23:58:25.050166 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m23:58:25.053675 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m23:58:25.053976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m23:58:25.054619 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m23:58:25.055649 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m23:58:25.059645 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m23:58:25.060650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:25.061402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:25.062437 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m23:58:25.065421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:25.927373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.862 seconds
[0m23:58:25.929372 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m23:58:25.977123 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.916 seconds
[0m23:58:25.979119 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m23:58:26.016432 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.956 seconds
[0m23:58:26.018431 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m23:58:26.134062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696F606C30>]}
[0m23:58:26.135061 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m23:58:26.136062 [info ] [MainThread]: 
[0m23:58:26.142069 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m23:58:26.143072 [info ] [Thread-1 (]: 1 of 5 START sql view model products_schema.stg_products ....................... [RUN]
[0m23:58:26.144074 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m23:58:26.145067 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m23:58:26.152071 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m23:58:26.153064 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m23:58:26.181619 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m23:58:26.183618 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m23:58:26.183618 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m23:58:26.184616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:26.852500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m23:58:26.874046 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m23:58:26.987922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696F45A4E0>]}
[0m23:58:26.988934 [info ] [Thread-1 (]: 1 of 5 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m23:58:26.989919 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m23:58:26.991344 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m23:58:26.992343 [info ] [Thread-3 (]: 2 of 5 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m23:58:26.993334 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m23:58:26.994338 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m23:58:27.009332 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m23:58:27.010341 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m23:58:27.031334 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m23:58:27.036330 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m23:58:27.036330 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m23:58:27.037331 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:58:28.807951 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m23:58:28.809947 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m23:58:28.927250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970E6C830>]}
[0m23:58:28.928253 [info ] [Thread-3 (]: 2 of 5 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.93s]
[0m23:58:28.929105 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m23:58:28.930133 [debug] [Thread-5 (]: Began running node model.transform.agg_category_performance
[0m23:58:28.931133 [info ] [Thread-5 (]: 3 of 5 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m23:58:28.932121 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m23:58:28.933122 [debug] [Thread-5 (]: Began compiling node model.transform.agg_category_performance
[0m23:58:28.936139 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m23:58:28.938124 [debug] [Thread-5 (]: Began executing node model.transform.agg_category_performance
[0m23:58:28.941133 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m23:58:28.943151 [debug] [Thread-5 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m23:58:28.944158 [debug] [Thread-5 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        category,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m23:58:28.944158 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m23:58:30.049672 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m23:58:30.051666 [debug] [Thread-5 (]: On model.transform.agg_category_performance: Close
[0m23:58:30.167875 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269528CF740>]}
[0m23:58:30.167875 [info ] [Thread-5 (]: 3 of 5 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.23s]
[0m23:58:30.169870 [debug] [Thread-5 (]: Finished running node model.transform.agg_category_performance
[0m23:58:30.170870 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m23:58:30.171867 [debug] [Thread-8 (]: Began running node model.transform.fact_products_performance
[0m23:58:30.171867 [info ] [Thread-7 (]: 4 of 5 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m23:58:30.173876 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m23:58:30.172877 [info ] [Thread-8 (]: 5 of 5 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m23:58:30.174867 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m23:58:30.174867 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m23:58:30.177863 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m23:58:30.179177 [debug] [Thread-8 (]: Began compiling node model.transform.fact_products_performance
[0m23:58:30.182704 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m23:58:30.183691 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m23:58:30.186694 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m23:58:30.187692 [debug] [Thread-8 (]: Began executing node model.transform.fact_products_performance
[0m23:58:30.190706 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m23:58:30.191705 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m23:58:30.193693 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
    ON inttable.category = ct.category
        );
[0m23:58:30.193693 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m23:58:30.194692 [debug] [Thread-8 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m23:58:30.196691 [debug] [Thread-8 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m23:58:30.197696 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m23:58:31.785801 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m23:58:31.787806 [debug] [Thread-8 (]: On model.transform.fact_products_performance: Close
[0m23:58:31.900107 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970F4E3C0>]}
[0m23:58:31.900107 [info ] [Thread-8 (]: 5 of 5 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.72s]
[0m23:58:31.902121 [debug] [Thread-8 (]: Finished running node model.transform.fact_products_performance
[0m23:58:33.192926 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.998 seconds
[0m23:58:33.194926 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m23:58:33.303484 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a06963e-11b1-443f-88f4-570a0a83de93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269528CFF50>]}
[0m23:58:33.304495 [info ] [Thread-7 (]: 4 of 5 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 3.13s]
[0m23:58:33.305493 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m23:58:33.307495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:33.308499 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:58:33.308499 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:58:33.309485 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m23:58:33.309485 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m23:58:33.310484 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m23:58:33.310484 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m23:58:33.310484 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m23:58:33.311485 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m23:58:33.311485 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m23:58:33.312495 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m23:58:33.313485 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m23:58:33.313485 [info ] [MainThread]: 
[0m23:58:33.314485 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m23:58:33.316495 [debug] [MainThread]: Command end result
[0m23:58:33.347488 [info ] [MainThread]: 
[0m23:58:33.348495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:33.349506 [info ] [MainThread]: 
[0m23:58:33.350507 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:58:33.351504 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:33.351504 after 11.36 seconds
[0m23:58:33.352517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970935700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970A9CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696F203740>]}
[0m23:58:33.353514 [debug] [MainThread]: Flushing usage events
[0m00:09:47.741713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D267C5EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D26A63B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D26A63B470>]}


============================== 00:09:47.745705 | 53b23367-4f0c-40bc-9d98-1f2ec81c3d6b ==============================
[0m00:09:47.745705 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:09:47.747707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:48.690706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b23367-4f0c-40bc-9d98-1f2ec81c3d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D202417050>]}
[0m00:09:48.738218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b23367-4f0c-40bc-9d98-1f2ec81c3d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D203419940>]}
[0m00:09:48.740222 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:09:49.059453 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:09:49.252595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:09:49.253601 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\dim_category.sql
[0m00:09:49.253601 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:09:49.413698 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transform.agg_category_performance' (models\analytics\agg_category_performance.sql) depends on a node named 'dim_catgory' which was not found
[0m00:09:49.415428 [debug] [MainThread]: Command `dbt run` failed at 00:09:49.415428 after 1.79 seconds
[0m00:09:49.415428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D267C5EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D269769D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D268321610>]}
[0m00:09:49.416421 [debug] [MainThread]: Flushing usage events
[0m00:10:15.980278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F3BF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F3BF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F3BE360>]}


============================== 00:10:15.985231 | 16e773cf-8275-4b29-94e9-7eb62b432d2f ==============================
[0m00:10:15.985231 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:10:15.986225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:16.999304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B878FEC920>]}
[0m00:10:17.044310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87879E270>]}
[0m00:10:17.046312 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:10:17.350122 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:10:17.508228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:10:17.508228 [debug] [MainThread]: Partial parsing: added file: transform://models\analytics\dim_category.sql
[0m00:10:17.509233 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:10:17.705723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87A581EE0>]}
[0m00:10:17.798087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8792E9F10>]}
[0m00:10:17.799088 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:10:17.799088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87A582DE0>]}
[0m00:10:17.801089 [info ] [MainThread]: 
[0m00:10:17.802323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:10:17.806997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:17.820537 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:17.821534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:17.821534 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:17.822545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:17.824409 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:17.825407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:17.828420 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:17.829548 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:17.833451 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:17.834437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:17.834437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:18.963334 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.128 seconds
[0m00:10:18.964335 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:18.968132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.143 seconds
[0m00:10:18.970161 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:18.973145 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.139 seconds
[0m00:10:18.975146 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:19.147947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:10:19.149470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:10:19.156491 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:10:19.157498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:10:19.160321 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:10:19.160953 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:10:19.163981 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:10:19.164986 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:10:19.164986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:19.166202 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:10:19.166202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:19.169216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:20.058699 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.890 seconds
[0m00:10:20.060698 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:10:20.064701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.898 seconds
[0m00:10:20.065704 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:10:20.159042 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.993 seconds
[0m00:10:20.160037 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:10:20.281253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87A5E9070>]}
[0m00:10:20.282252 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:10:20.283259 [info ] [MainThread]: 
[0m00:10:20.288193 [debug] [Thread-1 (]: Began running node model.transform.dim_category
[0m00:10:20.289220 [debug] [Thread-2 (]: Began running node model.transform.stg_products
[0m00:10:20.289220 [info ] [Thread-1 (]: 1 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:10:20.290220 [info ] [Thread-2 (]: 2 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:10:20.292227 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:10:20.293217 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:10:20.293217 [debug] [Thread-1 (]: Began compiling node model.transform.dim_category
[0m00:10:20.294219 [debug] [Thread-2 (]: Began compiling node model.transform.stg_products
[0m00:10:20.302741 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:10:20.304749 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:10:20.306742 [debug] [Thread-1 (]: Began executing node model.transform.dim_category
[0m00:10:20.306742 [debug] [Thread-2 (]: Began executing node model.transform.stg_products
[0m00:10:20.334746 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:10:20.357309 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:10:20.358310 [debug] [Thread-1 (]: Using snowflake connection "model.transform.dim_category"
[0m00:10:20.359306 [debug] [Thread-1 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM (( reference('int_products')))
        );
[0m00:10:20.361305 [debug] [Thread-2 (]: Using snowflake connection "model.transform.stg_products"
[0m00:10:20.361305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:20.362309 [debug] [Thread-2 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:10:20.364304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:10:21.200426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba698a-0000-fd29-0001-4c5e000d138a
[0m00:10:21.201427 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'REFERENCE('int_products')'
[0m00:10:21.202425 [debug] [Thread-1 (]: On model.transform.dim_category: Close
[0m00:10:21.263488 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m00:10:21.284519 [debug] [Thread-2 (]: On model.transform.stg_products: Close
[0m00:10:21.319709 [debug] [Thread-1 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'REFERENCE('int_products')'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m00:10:21.321710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F844E00>]}
[0m00:10:21.321710 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 1.03s]
[0m00:10:21.322932 [debug] [Thread-1 (]: Finished running node model.transform.dim_category
[0m00:10:21.398645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87AA7D220>]}
[0m00:10:21.399645 [info ] [Thread-2 (]: 2 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.11s]
[0m00:10:21.400638 [debug] [Thread-2 (]: Finished running node model.transform.stg_products
[0m00:10:21.401640 [debug] [Thread-4 (]: Began running node model.transform.int_products
[0m00:10:21.402646 [info ] [Thread-4 (]: 3 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:10:21.403636 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:10:21.404641 [debug] [Thread-4 (]: Began compiling node model.transform.int_products
[0m00:10:21.409650 [debug] [Thread-4 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:10:21.411641 [debug] [Thread-4 (]: Began executing node model.transform.int_products
[0m00:10:21.414650 [debug] [Thread-4 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:10:21.417649 [debug] [Thread-4 (]: Using snowflake connection "model.transform.int_products"
[0m00:10:21.418646 [debug] [Thread-4 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:10:21.418646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:10:24.684678 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.266 seconds
[0m00:10:24.686682 [debug] [Thread-4 (]: On model.transform.int_products: Close
[0m00:10:24.800713 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e773cf-8275-4b29-94e9-7eb62b432d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8792C3890>]}
[0m00:10:24.801719 [info ] [Thread-4 (]: 3 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.40s]
[0m00:10:24.802855 [debug] [Thread-4 (]: Finished running node model.transform.int_products
[0m00:10:24.803871 [debug] [Thread-6 (]: Began running node model.transform.agg_category_performance
[0m00:10:24.804874 [info ] [Thread-6 (]: 4 of 6 SKIP relation products_schema_analytics.agg_category_performance ........ [[33mSKIP[0m]
[0m00:10:24.805875 [debug] [Thread-6 (]: Finished running node model.transform.agg_category_performance
[0m00:10:24.806888 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m00:10:24.806888 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m00:10:24.807819 [info ] [Thread-8 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:10:24.808851 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m00:10:24.807819 [info ] [Thread-9 (]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:10:24.809849 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m00:10:24.811845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:24.812844 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:24.813840 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:24.813840 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:24.814848 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:10:24.814848 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:10:24.815840 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:10:24.815840 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:10:24.816846 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:10:24.816846 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:10:24.817837 [info ] [MainThread]: 
[0m00:10:24.818836 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m00:10:24.819852 [debug] [MainThread]: Command end result
[0m00:10:24.852396 [info ] [MainThread]: 
[0m00:10:24.854400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:24.855391 [info ] [MainThread]: 
[0m00:10:24.855391 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'REFERENCE('int_products')'
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m00:10:24.856908 [info ] [MainThread]: 
[0m00:10:24.857925 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m00:10:24.858922 [debug] [MainThread]: Command `dbt run` failed at 00:10:24.858922 after 8.98 seconds
[0m00:10:24.859923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F86C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8787CDA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B85F3BF440>]}
[0m00:10:24.859923 [debug] [MainThread]: Flushing usage events
[0m00:10:44.284945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B302540CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B302543E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3025A5AC0>]}


============================== 00:10:44.288961 | 83dc3836-f767-4e18-ac3e-5bdac4cd6db0 ==============================
[0m00:10:44.288961 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:10:44.289961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:45.243974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31B687DA0>]}
[0m00:10:45.289096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31AAA5F10>]}
[0m00:10:45.291211 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:10:45.601249 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:10:45.770869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:10:45.770869 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m00:10:45.964545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31B5CA480>]}
[0m00:10:46.055289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31BA59730>]}
[0m00:10:46.055289 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:10:46.056293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31B8352E0>]}
[0m00:10:46.058297 [info ] [MainThread]: 
[0m00:10:46.059298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:10:46.063309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:46.075315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:46.075315 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:46.078838 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:46.078838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:10:46.079843 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:46.080847 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:46.083841 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:10:46.084846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:46.085847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:46.085847 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:10:46.090854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:47.405040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.314 seconds
[0m00:10:47.406053 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:47.422016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.337 seconds
[0m00:10:47.423028 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:47.451929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.366 seconds
[0m00:10:47.452925 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:10:47.571637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:10:47.573638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:10:47.580147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:10:47.582144 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:10:47.585154 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:10:47.588701 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:10:47.589137 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:10:47.589839 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:10:47.590622 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:10:47.590622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:47.591647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:47.591647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:48.409630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.818 seconds
[0m00:10:48.412636 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:10:48.550906 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.959 seconds
[0m00:10:48.552924 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:10:48.588425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.997 seconds
[0m00:10:48.590430 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:10:48.701736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B30025CA70>]}
[0m00:10:48.702747 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:10:48.703734 [info ] [MainThread]: 
[0m00:10:48.709543 [debug] [Thread-1 (]: Began running node model.transform.dim_category
[0m00:10:48.709543 [debug] [Thread-2 (]: Began running node model.transform.stg_products
[0m00:10:48.710544 [info ] [Thread-1 (]: 1 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:10:48.711544 [info ] [Thread-2 (]: 2 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:10:48.712548 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:10:48.714544 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:10:48.714544 [debug] [Thread-1 (]: Began compiling node model.transform.dim_category
[0m00:10:48.715545 [debug] [Thread-2 (]: Began compiling node model.transform.stg_products
[0m00:10:48.723535 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:10:48.725533 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:10:48.727533 [debug] [Thread-1 (]: Began executing node model.transform.dim_category
[0m00:10:48.748550 [debug] [Thread-2 (]: Began executing node model.transform.stg_products
[0m00:10:48.754548 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:10:48.774635 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:10:48.776637 [debug] [Thread-1 (]: Using snowflake connection "model.transform.dim_category"
[0m00:10:48.777636 [debug] [Thread-1 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM (( ref('int_products')))
        );
[0m00:10:48.778646 [debug] [Thread-2 (]: Using snowflake connection "model.transform.stg_products"
[0m00:10:48.779164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:10:48.780180 [debug] [Thread-2 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:10:48.782172 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:10:49.537792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba698a-0000-fd34-0001-4c5e000da112
[0m00:10:49.538792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 8 unexpected 'ref'.
syntax error line 6 at position 28 unexpected ')'.
[0m00:10:49.538792 [debug] [Thread-1 (]: On model.transform.dim_category: Close
[0m00:10:49.656728 [debug] [Thread-1 (]: Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 8 unexpected 'ref'.
  syntax error line 6 at position 28 unexpected ')'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m00:10:49.657723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31D0F76B0>]}
[0m00:10:49.658831 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model products_schema_analytics.dim_category ... [[31mERROR[0m in 0.94s]
[0m00:10:49.659726 [debug] [Thread-1 (]: Finished running node model.transform.dim_category
[0m00:10:49.730039 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m00:10:49.754050 [debug] [Thread-2 (]: On model.transform.stg_products: Close
[0m00:10:49.893919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31D0F6510>]}
[0m00:10:49.894922 [info ] [Thread-2 (]: 2 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.18s]
[0m00:10:49.896911 [debug] [Thread-2 (]: Finished running node model.transform.stg_products
[0m00:10:49.898434 [debug] [Thread-4 (]: Began running node model.transform.int_products
[0m00:10:49.899446 [info ] [Thread-4 (]: 3 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:10:49.900432 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:10:49.901443 [debug] [Thread-4 (]: Began compiling node model.transform.int_products
[0m00:10:49.906445 [debug] [Thread-4 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:10:49.907452 [debug] [Thread-4 (]: Began executing node model.transform.int_products
[0m00:10:49.911442 [debug] [Thread-4 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:10:49.915444 [debug] [Thread-4 (]: Using snowflake connection "model.transform.int_products"
[0m00:10:49.915444 [debug] [Thread-4 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:10:49.916444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:10:51.914642 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.998 seconds
[0m00:10:51.916646 [debug] [Thread-4 (]: On model.transform.int_products: Close
[0m00:10:52.032671 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dc3836-f767-4e18-ac3e-5bdac4cd6db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31D09C3E0>]}
[0m00:10:52.033672 [info ] [Thread-4 (]: 3 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.13s]
[0m00:10:52.035492 [debug] [Thread-4 (]: Finished running node model.transform.int_products
[0m00:10:52.036489 [debug] [Thread-6 (]: Began running node model.transform.agg_category_performance
[0m00:10:52.037490 [info ] [Thread-6 (]: 4 of 6 SKIP relation products_schema_analytics.agg_category_performance ........ [[33mSKIP[0m]
[0m00:10:52.038499 [debug] [Thread-6 (]: Finished running node model.transform.agg_category_performance
[0m00:10:52.039499 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m00:10:52.039499 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m00:10:52.040500 [info ] [Thread-8 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:10:52.041509 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m00:10:52.041509 [info ] [Thread-9 (]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:10:52.042501 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m00:10:52.044502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:52.045495 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:52.045495 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:52.046497 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:10:52.046497 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:10:52.047494 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:10:52.047494 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:10:52.048500 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:10:52.048500 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:10:52.049491 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:10:52.049491 [info ] [MainThread]: 
[0m00:10:52.050490 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m00:10:52.052502 [debug] [MainThread]: Command end result
[0m00:10:52.083073 [info ] [MainThread]: 
[0m00:10:52.084050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:52.085043 [info ] [MainThread]: 
[0m00:10:52.086050 [error] [MainThread]:   Database Error in model dim_category (models\analytics\dim_category.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 8 unexpected 'ref'.
  syntax error line 6 at position 28 unexpected ')'.
  compiled code at target\run\transform\models\analytics\dim_category.sql
[0m00:10:52.087046 [info ] [MainThread]: 
[0m00:10:52.088050 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m00:10:52.090054 [debug] [MainThread]: Command `dbt run` failed at 00:10:52.090054 after 7.91 seconds
[0m00:10:52.090054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ECDC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37EB55400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B31D08F260>]}
[0m00:10:52.091048 [debug] [MainThread]: Flushing usage events
[0m00:11:08.140222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC3B4EDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC5B17E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC5B14770>]}


============================== 00:11:08.145206 | 39add21d-8720-44c0-9cc3-2e565f039439 ==============================
[0m00:11:08.145206 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:11:08.146206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:11:09.128144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDE246B10>]}
[0m00:11:09.173140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDE10E360>]}
[0m00:11:09.175130 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:09.488755 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:11:09.661896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:09.662896 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m00:11:09.856463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE0B2C890>]}
[0m00:11:09.951425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF8B96D0>]}
[0m00:11:09.952424 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:11:09.953423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDE9059A0>]}
[0m00:11:09.955424 [info ] [MainThread]: 
[0m00:11:09.956351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:09.960373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:11:09.973373 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:11:09.973373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:11:09.974371 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:11:09.975369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:11:09.977370 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:11:09.978373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:09.981365 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:11:09.982369 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:11:09.985369 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:11:09.986375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:09.987399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:11.004989 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.019 seconds
[0m00:11:11.006991 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:11:11.006991 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.020 seconds
[0m00:11:11.009993 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:11:11.018938 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.041 seconds
[0m00:11:11.020939 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:11:11.132155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:11:11.133154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:11:11.141419 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:11:11.142547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:11:11.145422 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:11:11.146421 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:11:11.149415 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:11:11.150463 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:11:11.150463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:11.151420 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:11:11.152411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:11.153417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:11.931955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.778 seconds
[0m00:11:11.933959 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:11:11.934949 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.783 seconds
[0m00:11:11.937957 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:11:11.955994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.805 seconds
[0m00:11:11.957988 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:11:12.069365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF59E6F0>]}
[0m00:11:12.070370 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:11:12.071367 [info ] [MainThread]: 
[0m00:11:12.076588 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:11:12.077600 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:11:12.078602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:11:12.078602 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:11:12.085604 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:11:12.086602 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:11:12.112160 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:11:12.114158 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:11:12.115162 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:11:12.116148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:12.854113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m00:11:12.874114 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:11:12.986159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE0FAED50>]}
[0m00:11:12.987168 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m00:11:12.988011 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:11:12.989486 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:11:12.990517 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:11:12.991501 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:11:12.992511 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:11:12.997513 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:11:12.999518 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:11:13.021060 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:11:13.025060 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:11:13.026100 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:11:13.026100 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:11:14.919814 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.893 seconds
[0m00:11:14.921816 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:11:15.045349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC4120260>]}
[0m00:11:15.046354 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.05s]
[0m00:11:15.048340 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:11:15.049350 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:11:15.050342 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:11:15.051343 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:11:15.052344 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:11:15.058341 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:11:15.059344 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:11:15.062340 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:11:15.064339 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:11:15.065344 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
        );
[0m00:11:15.066337 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:11:18.655755 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 3.590 seconds
[0m00:11:18.658754 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:11:18.769584 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC2A70200>]}
[0m00:11:18.770584 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 3.72s]
[0m00:11:18.771635 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:11:18.772669 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:11:18.773662 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:11:18.774656 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:11:18.774656 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:11:18.778662 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:11:18.779666 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:11:18.782665 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:11:18.784657 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:11:18.785666 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category.id
        category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:11:18.785666 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:11:19.517427 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba698b-0000-fd29-0001-4c5e000d1396
[0m00:11:19.518434 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'CT.CATEGORY.ID'
[0m00:11:19.519427 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:11:19.641491 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CT.CATEGORY.ID'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:11:19.642491 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39add21d-8720-44c0-9cc3-2e565f039439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE0FF6210>]}
[0m00:11:19.643481 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.87s]
[0m00:11:19.644489 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:11:19.646023 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:11:19.647023 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:11:19.648016 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:11:19.649031 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:11:19.649031 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:11:19.651021 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:11:19.652013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:19.653023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:11:19.653023 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:11:19.654014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:11:19.654014 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:11:19.655013 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:11:19.655013 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:11:19.655013 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:11:19.656015 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:11:19.656015 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:11:19.657014 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:11:19.657014 [info ] [MainThread]: 
[0m00:11:19.658013 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m00:11:19.660019 [debug] [MainThread]: Command end result
[0m00:11:19.693015 [info ] [MainThread]: 
[0m00:11:19.694014 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:11:19.695013 [info ] [MainThread]: 
[0m00:11:19.696015 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CT.CATEGORY.ID'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:11:19.697012 [info ] [MainThread]: 
[0m00:11:19.698016 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:11:19.701027 [debug] [MainThread]: Command `dbt run` failed at 00:11:19.700030 after 11.67 seconds
[0m00:11:19.701027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC5DC7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDE99D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DC5B17E30>]}
[0m00:11:19.702027 [debug] [MainThread]: Flushing usage events
[0m00:12:15.789634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD9CE3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD62C6E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD9CE3080>]}


============================== 00:12:15.794663 | aee56eae-8c74-4608-959f-c85123e549be ==============================
[0m00:12:15.794663 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:12:15.795661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:16.742058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF2C00F80>]}
[0m00:12:16.786614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF2D0EB40>]}
[0m00:12:16.788610 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:12:17.102143 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:12:17.278575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:17.279582 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:12:17.473887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF42A31D0>]}
[0m00:12:17.563026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF3009B50>]}
[0m00:12:17.564025 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:12:17.564025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF42F7410>]}
[0m00:12:17.566026 [info ] [MainThread]: 
[0m00:12:17.567376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:17.572552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:12:17.585130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:12:17.584116 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:12:17.587125 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:12:17.588124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:12:17.589128 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:12:17.589128 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:12:17.593123 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:12:17.593123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:17.594124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:17.594124 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:12:17.599131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:18.589957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.997 seconds
[0m00:12:18.591956 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:12:18.596850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.003 seconds
[0m00:12:18.597849 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.999 seconds
[0m00:12:18.599845 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:12:18.601851 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:12:18.720729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:12:18.722739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:12:18.730790 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:12:18.731738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:12:18.734733 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:12:18.735733 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:12:18.738734 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:12:18.739733 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:12:18.740724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:18.740724 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:12:18.741739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:18.743738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:19.673729 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.932 seconds
[0m00:12:19.674723 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.934 seconds
[0m00:12:19.676727 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:12:19.678730 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:12:19.715591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.972 seconds
[0m00:12:19.717595 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:12:19.828413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF41DF500>]}
[0m00:12:19.829417 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:12:19.830413 [info ] [MainThread]: 
[0m00:12:19.835176 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:12:19.836187 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:12:19.837178 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:12:19.838189 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:12:19.845182 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:12:19.846184 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:12:19.872193 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:12:19.874204 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:12:19.874204 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:12:19.875196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:12:20.684198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m00:12:20.705189 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:12:20.818385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF2CD2210>]}
[0m00:12:20.819382 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.98s]
[0m00:12:20.820381 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:12:20.821384 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:12:20.822375 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:12:20.823373 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:12:20.824373 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:12:20.829382 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:12:20.830592 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:12:20.851378 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:12:20.855382 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:12:20.856373 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:12:20.856373 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:12:23.581591 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.724 seconds
[0m00:12:23.583596 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:12:23.694358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF4758170>]}
[0m00:12:23.695371 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.87s]
[0m00:12:23.696358 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:12:23.697358 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:12:23.698357 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:12:23.699361 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:12:23.700357 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:12:23.703361 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:12:23.704361 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:12:23.707356 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:12:23.709361 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:12:23.709361 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
        );
[0m00:12:23.710362 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:12:25.433316 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.724 seconds
[0m00:12:25.436322 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:12:25.560672 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD61B36E0>]}
[0m00:12:25.561674 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.86s]
[0m00:12:25.563675 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:12:25.564356 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:12:25.565375 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:12:25.566384 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:12:25.566384 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:12:25.570411 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:12:25.572407 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:12:25.574413 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:12:25.577396 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:12:25.577396 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category.id
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:12:25.578405 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:12:26.156441 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba698c-0000-fd16-0001-4c5e000d9142
[0m00:12:26.157440 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 13 unexpected '('.
syntax error line 7 at position 14 unexpected 'AVG'.
syntax error line 7 at position 32 unexpected ','.
syntax error line 13 at position 7 unexpected 'inttable'.
[0m00:12:26.158441 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:12:26.296486 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 13 unexpected '('.
  syntax error line 7 at position 14 unexpected 'AVG'.
  syntax error line 7 at position 32 unexpected ','.
  syntax error line 13 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:12:26.297486 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee56eae-8c74-4608-959f-c85123e549be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF4715FD0>]}
[0m00:12:26.297486 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.73s]
[0m00:12:26.298486 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:12:26.300485 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:12:26.301488 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:12:26.301488 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:12:26.302488 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:12:26.303492 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:12:26.304493 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:12:26.306492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:26.307491 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:12:26.308491 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:12:26.309488 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:12:26.309488 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:12:26.310488 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:12:26.311498 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:12:26.311498 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:12:26.312489 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:12:26.313491 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:12:26.313491 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:12:26.314490 [info ] [MainThread]: 
[0m00:12:26.315499 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m00:12:26.317509 [debug] [MainThread]: Command end result
[0m00:12:26.352033 [info ] [MainThread]: 
[0m00:12:26.354037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:12:26.355053 [info ] [MainThread]: 
[0m00:12:26.356054 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 13 unexpected '('.
  syntax error line 7 at position 14 unexpected 'AVG'.
  syntax error line 7 at position 32 unexpected ','.
  syntax error line 13 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:12:26.357048 [info ] [MainThread]: 
[0m00:12:26.358055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:12:26.360049 [debug] [MainThread]: Command `dbt run` failed at 00:12:26.360049 after 10.69 seconds
[0m00:12:26.361053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD9C42720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CF4298D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5EF3770>]}
[0m00:12:26.362053 [debug] [MainThread]: Flushing usage events
[0m00:15:11.147511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA989A3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA989A3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA989A36E0>]}


============================== 00:15:11.152522 | 78671c86-503a-4c0b-9dbc-03b09eba42fd ==============================
[0m00:15:11.152522 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:15:11.153522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:15:12.234325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB156C830>]}
[0m00:15:12.280419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB1820620>]}
[0m00:15:12.282419 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:15:12.608060 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:15:12.789999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:15:12.790996 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_category.sql
[0m00:15:12.995671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB2F56810>]}
[0m00:15:13.087308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB1C687D0>]}
[0m00:15:13.088293 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:15:13.089296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB0AE5970>]}
[0m00:15:13.091303 [info ] [MainThread]: 
[0m00:15:13.092303 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:15:13.096291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:15:13.110294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:15:13.111294 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:15:13.113292 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:15:13.114290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:15:13.115296 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:15:13.115296 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:15:13.118297 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:15:13.119295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:13.120293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:13.120293 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:15:13.126296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:14.154880 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.029 seconds
[0m00:15:14.157902 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:15:14.237430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.118 seconds
[0m00:15:14.237430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.118 seconds
[0m00:15:14.239431 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:15:14.241433 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:15:14.355540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:15:14.357565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:15:14.365570 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:15:14.368560 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:15:14.369616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:15:14.370273 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:15:14.370994 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:15:14.373539 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:15:14.374546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:14.375530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:14.375908 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:15:14.378923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:15.204781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.830 seconds
[0m00:15:15.205788 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.826 seconds
[0m00:15:15.207780 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:15:15.209786 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:15:15.298848 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.923 seconds
[0m00:15:15.299853 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:15:15.410495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB1C42450>]}
[0m00:15:15.411494 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:15:15.412129 [info ] [MainThread]: 
[0m00:15:15.417896 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:15:15.418896 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:15:15.419898 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:15:15.419898 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:15:15.426895 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:15:15.428899 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:15:15.456938 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:15:15.459176 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:15:15.459176 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:15:15.460171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:15:16.143548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m00:15:16.163573 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:15:16.276065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB19320F0>]}
[0m00:15:16.277065 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m00:15:16.278066 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:15:16.280072 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:15:16.280072 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:15:16.282066 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:15:16.282066 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:15:16.287639 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:15:16.289632 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:15:16.309639 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:15:16.313639 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:15:16.313639 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:15:16.314639 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:15:18.244349 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.930 seconds
[0m00:15:18.246351 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:15:18.362603 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB32D3DA0>]}
[0m00:15:18.363604 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.08s]
[0m00:15:18.365599 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:15:18.365599 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:15:18.366598 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:15:18.368597 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:15:18.368597 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:15:18.372595 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:15:18.373597 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:15:18.376602 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:15:18.378134 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:15:18.379148 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:15:18.379148 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:15:19.839113 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.459 seconds
[0m00:15:19.841134 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:15:19.947560 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB30CC950>]}
[0m00:15:19.948565 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.58s]
[0m00:15:19.950569 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:15:19.950569 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:15:19.951565 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:15:19.953573 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:15:19.953573 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:15:19.959247 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:15:19.960946 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:15:19.964826 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:15:19.967559 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:15:19.968100 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category.id
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:15:19.968634 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:15:20.734235 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba698f-0000-fd34-0001-4c5e000da12a
[0m00:15:20.734765 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 13 unexpected '('.
syntax error line 7 at position 14 unexpected 'AVG'.
syntax error line 7 at position 32 unexpected ','.
syntax error line 13 at position 7 unexpected 'inttable'.
[0m00:15:20.735809 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:15:20.927045 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 13 unexpected '('.
  syntax error line 7 at position 14 unexpected 'AVG'.
  syntax error line 7 at position 32 unexpected ','.
  syntax error line 13 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:15:20.927045 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78671c86-503a-4c0b-9dbc-03b09eba42fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB33A51F0>]}
[0m00:15:20.928045 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.97s]
[0m00:15:20.930045 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:15:20.931040 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:15:20.932036 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:15:20.932036 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:15:20.934036 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:15:20.933037 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:15:20.935031 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:15:20.937041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:20.937041 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:15:20.938032 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:15:20.938032 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:15:20.939034 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:15:20.939034 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:15:20.940034 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:15:20.941035 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:15:20.941035 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:15:20.942033 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:15:20.942033 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:15:20.943032 [info ] [MainThread]: 
[0m00:15:20.943622 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m00:15:20.945202 [debug] [MainThread]: Command end result
[0m00:15:21.000350 [info ] [MainThread]: 
[0m00:15:21.002774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:15:21.005238 [info ] [MainThread]: 
[0m00:15:21.008633 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 13 unexpected '('.
  syntax error line 7 at position 14 unexpected 'AVG'.
  syntax error line 7 at position 32 unexpected ','.
  syntax error line 13 at position 7 unexpected 'inttable'.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:15:21.010871 [info ] [MainThread]: 
[0m00:15:21.012974 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:15:21.016365 [debug] [MainThread]: Command `dbt run` failed at 00:15:21.015935 after 9.98 seconds
[0m00:15:21.017666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA9859E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB2E46B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA98682750>]}
[0m00:15:21.018725 [debug] [MainThread]: Flushing usage events
[0m00:16:31.212378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B607E0FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60A290B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60A2926C0>]}


============================== 00:16:31.216493 | c5839559-5b3f-4c9d-8ce1-128d2a85b939 ==============================
[0m00:16:31.216493 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:16:31.218388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:16:32.381694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B623750D40>]}
[0m00:16:32.426471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B623A56D50>]}
[0m00:16:32.429004 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:16:32.758894 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:16:32.936580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:32.936580 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:16:33.134647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B625052480>]}
[0m00:16:33.245292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B623DBA120>]}
[0m00:16:33.246290 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:16:33.246290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6250A77D0>]}
[0m00:16:33.248814 [info ] [MainThread]: 
[0m00:16:33.249819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:16:33.254813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:16:33.270872 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:16:33.270872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:16:33.272436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:16:33.273388 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:16:33.277906 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:16:33.281921 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:16:33.282916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:33.283915 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:16:33.284918 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:16:33.289110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:33.292123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:34.302850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.014 seconds
[0m00:16:34.303848 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.013 seconds
[0m00:16:34.305846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.023 seconds
[0m00:16:34.306847 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:16:34.309145 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:16:34.311141 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:16:34.432849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:16:34.433854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:16:34.440354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:16:34.443365 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:16:34.446369 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:16:34.450104 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:16:34.451088 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:16:34.451088 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:16:34.452105 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:16:34.453091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:34.453091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:34.454091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:35.234223 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.780 seconds
[0m00:16:35.235227 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:16:35.425173 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.972 seconds
[0m00:16:35.427170 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:16:35.493998 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.041 seconds
[0m00:16:35.495997 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:16:35.611652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6253F1460>]}
[0m00:16:35.612650 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:16:35.613657 [info ] [MainThread]: 
[0m00:16:35.618576 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:16:35.620594 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:16:35.621599 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:16:35.621599 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:16:35.628131 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:16:35.630159 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:16:35.655755 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:16:35.658326 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:16:35.659299 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:16:35.660294 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:36.402522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m00:16:36.424142 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:16:36.534908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B623A82120>]}
[0m00:16:36.534908 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.91s]
[0m00:16:36.536911 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:16:36.537908 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:16:36.539035 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:16:36.540035 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:16:36.540035 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:16:36.545033 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:16:36.547038 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:16:36.568613 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:16:36.571618 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:16:36.572618 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:16:36.572618 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:16:38.694328 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.122 seconds
[0m00:16:38.697340 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:16:38.810164 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6251F2840>]}
[0m00:16:38.811161 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.27s]
[0m00:16:38.812155 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:16:38.813159 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:16:38.814150 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:16:38.815162 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:16:38.816163 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:16:38.819166 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:16:38.821155 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:16:38.824164 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:16:38.826153 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:16:38.826153 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:16:38.827169 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:16:41.113887 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.287 seconds
[0m00:16:41.116869 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:16:41.228103 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B606FAF5C0>]}
[0m00:16:41.228103 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.41s]
[0m00:16:41.230102 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:16:41.231099 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:16:41.231099 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:16:41.233092 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:16:41.233092 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:16:41.237100 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:16:41.239091 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:16:41.241088 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:16:41.244099 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:16:41.245094 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category_id,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:16:41.245094 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:16:41.847416 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6990-0000-fd24-0001-4c5e000d6336
[0m00:16:41.847416 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CATEGORY'
[0m00:16:41.848416 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:16:41.962735 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CATEGORY'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:16:41.963734 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5839559-5b3f-4c9d-8ce1-128d2a85b939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6254C25D0>]}
[0m00:16:41.964755 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.73s]
[0m00:16:41.965755 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:16:41.967750 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:16:41.967750 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:16:41.968740 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:16:41.969743 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:16:41.969743 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:16:41.970751 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:16:41.972749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:41.973750 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:16:41.974740 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:16:41.974740 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:16:41.975742 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:16:41.975742 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:16:41.976744 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:16:41.976744 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:16:41.977742 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:16:41.977742 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:16:41.977742 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:16:41.979249 [info ] [MainThread]: 
[0m00:16:41.980255 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m00:16:41.981256 [debug] [MainThread]: Command end result
[0m00:16:42.013284 [info ] [MainThread]: 
[0m00:16:42.014267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:42.015269 [info ] [MainThread]: 
[0m00:16:42.016262 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CATEGORY'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:16:42.017263 [info ] [MainThread]: 
[0m00:16:42.018264 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:16:42.020258 [debug] [MainThread]: Command `dbt run` failed at 00:16:42.020258 after 10.96 seconds
[0m00:16:42.020258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60AA425A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62539E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6250F1E20>]}
[0m00:16:42.021254 [debug] [MainThread]: Flushing usage events
[0m00:16:58.640027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42F699A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42C8B9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42EEC2DB0>]}


============================== 00:16:58.646030 | a6a62e45-bfcc-48a6-ae64-1e5581ad3284 ==============================
[0m00:16:58.646030 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:16:58.647030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:16:59.666863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4479E5280>]}
[0m00:16:59.711450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448740D40>]}
[0m00:16:59.713450 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:17:00.032371 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:17:00.199149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:00.200149 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:17:00.393048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A449D269F0>]}
[0m00:17:00.483025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448A58710>]}
[0m00:17:00.484052 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:17:00.485036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448880B30>]}
[0m00:17:00.487046 [info ] [MainThread]: 
[0m00:17:00.487729 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:00.491758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:17:00.504290 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:17:00.505288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:17:00.506279 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:17:00.506279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:17:00.509284 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:17:00.510280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.513285 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:17:00.513285 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:17:00.517300 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:17:00.518298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.518298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:01.664077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.146 seconds
[0m00:17:01.665084 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:17:01.681073 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.171 seconds
[0m00:17:01.682066 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:17:01.689079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.170 seconds
[0m00:17:01.690075 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:17:01.889888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:17:01.891883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:17:01.900389 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:17:01.904391 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:17:01.904391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:17:01.905390 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:17:01.906394 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:17:01.908391 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:17:01.909398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:01.910402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:01.911399 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:17:01.915397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:02.770487 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.856 seconds
[0m00:17:02.772480 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:17:02.838012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.929 seconds
[0m00:17:02.840001 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.929 seconds
[0m00:17:02.841396 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:17:02.843404 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:17:02.961474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448742600>]}
[0m00:17:02.961474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:17:02.962486 [info ] [MainThread]: 
[0m00:17:02.968602 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:17:02.969602 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:17:02.970601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:17:02.971606 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:17:02.977596 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:17:02.979600 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:17:03.005168 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:17:03.007160 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:17:03.007160 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:17:03.008162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:03.678391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m00:17:03.698422 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:17:03.814046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4486FE060>]}
[0m00:17:03.814046 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.84s]
[0m00:17:03.816033 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:17:03.817039 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:17:03.818024 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:17:03.819034 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:17:03.819034 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:17:03.824033 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:17:03.825030 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:17:03.847033 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:17:03.851034 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:17:03.851034 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:17:03.852034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:05.699202 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.847 seconds
[0m00:17:05.701202 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:17:05.814228 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A208500>]}
[0m00:17:05.815231 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.00s]
[0m00:17:05.816220 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:17:05.817230 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:17:05.818224 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:17:05.819229 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:17:05.820224 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:17:05.823225 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:17:05.824224 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:17:05.827223 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:17:05.829220 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:17:05.829220 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:17:05.830222 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:17:07.136592 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m00:17:07.138593 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:17:07.247378 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42BBDF6B0>]}
[0m00:17:07.248390 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.43s]
[0m00:17:07.250371 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:17:07.251380 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:17:07.252370 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:17:07.253379 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:17:07.253379 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:17:07.257380 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:17:07.259378 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:17:07.261383 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:17:07.264381 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:17:07.264381 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category_id AS category_id,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY ct.category_id
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:17:07.265382 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:17:07.869008 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6991-0000-fd24-0001-4c5e000d633e
[0m00:17:07.869008 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 31
invalid identifier 'CATEGORY'
[0m00:17:07.870103 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:17:07.981964 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 21 at position 31
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:17:07.981964 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a62e45-bfcc-48a6-ae64-1e5581ad3284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A1B28D0>]}
[0m00:17:07.982974 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.73s]
[0m00:17:07.983951 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:17:07.985949 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:17:07.986958 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:17:07.987400 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:17:07.988429 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:17:07.987400 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:17:07.989420 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:17:07.991454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:07.992446 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:17:07.993468 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:17:07.994459 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:17:07.994459 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:17:07.995452 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:17:07.995452 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:17:07.996452 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:17:07.996452 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:17:07.997457 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:17:07.998457 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:17:07.999454 [info ] [MainThread]: 
[0m00:17:08.000451 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m00:17:08.002449 [debug] [MainThread]: Command end result
[0m00:17:08.033986 [info ] [MainThread]: 
[0m00:17:08.034984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:08.035976 [info ] [MainThread]: 
[0m00:17:08.036971 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 21 at position 31
  invalid identifier 'CATEGORY'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:17:08.037976 [info ] [MainThread]: 
[0m00:17:08.038985 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:17:08.039986 [debug] [MainThread]: Command `dbt run` failed at 00:17:08.039986 after 9.54 seconds
[0m00:17:08.040987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A447D8C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A021AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448A5B530>]}
[0m00:17:08.041985 [debug] [MainThread]: Flushing usage events
[0m00:18:28.714938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B49EED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B5024E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B3A1EBA0>]}


============================== 00:18:28.719957 | 771bfb79-74d8-41a9-a14d-a43da7d787a7 ==============================
[0m00:18:28.719957 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:18:28.720948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:29.694995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D03A7770>]}
[0m00:18:29.741493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CF80DCD0>]}
[0m00:18:29.743496 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:18:30.061710 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:18:30.242741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:18:30.243741 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:18:30.441349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D18E0680>]}
[0m00:18:30.536784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D071A0C0>]}
[0m00:18:30.537785 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:18:30.538793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D0560500>]}
[0m00:18:30.540785 [info ] [MainThread]: 
[0m00:18:30.541782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:18:30.545788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:18:30.558791 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:18:30.559861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:18:30.559861 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:18:30.561055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:18:30.563084 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:18:30.564080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:30.567084 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:18:30.568084 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:18:30.571081 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:18:30.572081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:30.573073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:31.607983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.035 seconds
[0m00:18:31.609980 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:18:31.612990 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.040 seconds
[0m00:18:31.614507 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:18:31.631117 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.067 seconds
[0m00:18:31.633116 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:18:31.748207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:18:31.749210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:18:31.755214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:18:31.759212 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:18:31.762208 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:18:31.765209 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:18:31.766201 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:18:31.767215 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:18:31.767215 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:18:31.768215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:31.768215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:31.769211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:32.531588 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.763 seconds
[0m00:18:32.531588 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.763 seconds
[0m00:18:32.535592 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:18:32.538590 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:18:32.658859 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.890 seconds
[0m00:18:32.660849 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:18:32.771526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D1A07170>]}
[0m00:18:32.772516 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:18:32.773630 [info ] [MainThread]: 
[0m00:18:32.779278 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:18:32.780270 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:18:32.781272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:18:32.782272 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:18:32.788280 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:18:32.789274 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:18:32.814555 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:18:32.817081 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:18:32.817081 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:18:32.818075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:33.668653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m00:18:33.689207 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:18:33.798227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D03CA5D0>]}
[0m00:18:33.799227 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.02s]
[0m00:18:33.801220 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:18:33.802227 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:18:33.803220 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:18:33.804230 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:18:33.804230 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:18:33.809232 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:18:33.810217 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:18:33.832318 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:18:33.835292 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:18:33.836287 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:18:33.837287 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:18:35.787707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.950 seconds
[0m00:18:35.789703 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:18:35.901543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D1E98950>]}
[0m00:18:35.902554 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.10s]
[0m00:18:35.903236 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:18:35.904275 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:18:35.905270 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:18:35.906297 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:18:35.907286 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:18:35.911291 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:18:35.913284 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:18:35.915291 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:18:35.917279 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:18:35.917279 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:18:35.918287 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:18:37.264242 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.346 seconds
[0m00:18:37.266246 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:18:37.391350 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D1E59190>]}
[0m00:18:37.392350 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.49s]
[0m00:18:37.393438 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:18:37.394473 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:18:37.395466 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:18:37.396464 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:18:37.397466 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:18:37.401470 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:18:37.402458 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:18:37.405465 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:18:37.407483 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:18:37.408481 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category_id AS category_id,
        inttable.category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY ct.category_id
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:18:37.408481 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:18:38.196403 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6992-0000-fd29-0001-4c5e000d13b2
[0m00:18:38.197409 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 8
'INTTABLE.CATEGORY' in select clause is neither an aggregate nor in the group by clause.
[0m00:18:38.197409 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:18:38.307677 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'INTTABLE.CATEGORY' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:18:38.308672 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771bfb79-74d8-41a9-a14d-a43da7d787a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D1E59490>]}
[0m00:18:38.309693 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.91s]
[0m00:18:38.310689 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:18:38.312691 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:18:38.313682 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:18:38.314681 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:18:38.315680 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:18:38.314681 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:18:38.316682 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:18:38.318683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:38.319678 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:18:38.319678 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:18:38.319678 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:18:38.320677 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:18:38.320677 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:18:38.321679 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:18:38.321679 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:18:38.321679 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:18:38.322678 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:18:38.322678 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:18:38.323677 [info ] [MainThread]: 
[0m00:18:38.324192 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m00:18:38.326197 [debug] [MainThread]: Command end result
[0m00:18:38.356732 [info ] [MainThread]: 
[0m00:18:38.357724 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:18:38.358728 [info ] [MainThread]: 
[0m00:18:38.359713 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'INTTABLE.CATEGORY' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:18:38.360727 [info ] [MainThread]: 
[0m00:18:38.361713 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:18:38.363717 [debug] [MainThread]: Command `dbt run` failed at 00:18:38.363717 after 9.79 seconds
[0m00:18:38.364722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D198C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B3A1F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D07367E0>]}
[0m00:18:38.364722 [debug] [MainThread]: Flushing usage events
[0m00:19:37.809648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022269D1EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022267AA0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226A0C8FB0>]}


============================== 00:19:37.814659 | ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2 ==============================
[0m00:19:37.814659 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:19:37.815653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:38.822335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226A953800>]}
[0m00:19:38.866881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226799FBF0>]}
[0m00:19:38.868681 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:19:39.180051 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:19:39.359358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:39.360359 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:19:39.552057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227FDB3440>]}
[0m00:19:39.644349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227FAE9820>]}
[0m00:19:39.644349 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:19:39.645351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227FE52D20>]}
[0m00:19:39.647654 [info ] [MainThread]: 
[0m00:19:39.648657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:39.653249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:19:39.665279 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:19:39.666283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:19:39.667278 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:19:39.668279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:19:39.670281 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:19:39.671277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:39.674286 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:19:39.675282 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:19:39.678281 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:19:39.679285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:39.680285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:40.741072 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.062 seconds
[0m00:19:40.742074 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:19:40.744077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.064 seconds
[0m00:19:40.746076 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:19:40.749079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.078 seconds
[0m00:19:40.751079 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:19:40.877992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:19:40.879998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:19:40.888004 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:19:40.889003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:19:40.893003 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:19:40.894003 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:19:40.897518 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:19:40.898534 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:19:40.899529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:40.900531 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:19:40.900531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:40.902528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:41.699541 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.799 seconds
[0m00:19:41.701542 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:19:41.814040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.912 seconds
[0m00:19:41.817063 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:19:41.851372 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.952 seconds
[0m00:19:41.852381 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:19:41.966268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227E4BB3B0>]}
[0m00:19:41.967277 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:19:41.968264 [info ] [MainThread]: 
[0m00:19:41.973949 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:19:41.974958 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:19:41.975959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:19:41.975959 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:19:41.982959 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:19:41.983981 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:19:42.011508 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:19:42.013497 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:19:42.014512 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:19:42.015498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:42.690552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m00:19:42.711636 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:19:42.839275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227F7B20F0>]}
[0m00:19:42.840276 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m00:19:42.841260 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:19:42.842262 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:19:42.843267 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:19:42.844267 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:19:42.845266 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:19:42.850271 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:19:42.851273 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:19:42.872547 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:19:42.876267 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:19:42.876267 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:19:42.877272 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:19:45.013163 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.136 seconds
[0m00:19:45.015168 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:19:45.123819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220528C260>]}
[0m00:19:45.124819 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.28s]
[0m00:19:45.125836 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:19:45.126869 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:19:45.127865 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:19:45.129865 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:19:45.129865 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:19:45.133858 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:19:45.134864 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:19:45.137870 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:19:45.139870 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:19:45.141383 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:19:45.141383 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:19:46.439168 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.298 seconds
[0m00:19:46.442166 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:19:46.554728 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022266CDF6E0>]}
[0m00:19:46.555732 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.43s]
[0m00:19:46.556721 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:19:46.557719 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:19:46.558723 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:19:46.560725 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:19:46.561722 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:19:46.565722 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:19:46.566722 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:19:46.569725 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:19:46.571723 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:19:46.572721 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        ct.category_id AS category_id,
        inttable.category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:19:46.572721 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:19:47.324839 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba6993-0000-fcd1-0001-4c5e000d3356
[0m00:19:47.324839 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 6 at position 8
'CT.CATEGORY_ID' in select clause is neither an aggregate nor in the group by clause.
[0m00:19:47.326030 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:19:47.444782 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001104 (42601): SQL compilation error: error line 6 at position 8
  'CT.CATEGORY_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:19:47.444782 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0ef6f3-e42c-4749-a6c3-58c72b3a92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222053631A0>]}
[0m00:19:47.445976 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.89s]
[0m00:19:47.446770 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:19:47.448779 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:19:47.449777 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:19:47.449777 [info ] [Thread-9 (]: 5 of 6 SKIP relation products_schema_analytics.dim_products .................... [[33mSKIP[0m]
[0m00:19:47.450776 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:19:47.451767 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:19:47.452782 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:19:47.454780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:47.454780 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:19:47.455797 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:19:47.455797 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:19:47.456784 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:19:47.457783 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:19:47.457783 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:19:47.458779 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:19:47.458779 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:19:47.459780 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:19:47.459780 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:19:47.460768 [info ] [MainThread]: 
[0m00:19:47.461768 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m00:19:47.463769 [debug] [MainThread]: Command end result
[0m00:19:47.493786 [info ] [MainThread]: 
[0m00:19:47.494788 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:19:47.495786 [info ] [MainThread]: 
[0m00:19:47.496797 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  001104 (42601): SQL compilation error: error line 6 at position 8
  'CT.CATEGORY_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:19:47.497797 [info ] [MainThread]: 
[0m00:19:47.499788 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m00:19:47.501789 [debug] [MainThread]: Command `dbt run` failed at 00:19:47.501789 after 9.79 seconds
[0m00:19:47.501789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226A7C3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226A5B5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002227FE53500>]}
[0m00:19:47.501789 [debug] [MainThread]: Flushing usage events
[0m00:20:28.943107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002610096B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026100760170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617DBD7380>]}


============================== 00:20:28.948622 | 5dd2d041-a0bb-43c6-92a8-ec593beeb436 ==============================
[0m00:20:28.948622 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:20:28.949632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:29.939688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026100B23DA0>]}
[0m00:20:29.985211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617E41CD40>]}
[0m00:20:29.986218 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:20:30.298474 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:20:30.489724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:20:30.489724 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:20:30.693387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AFA6B40>]}
[0m00:20:30.790396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026119C92CF0>]}
[0m00:20:30.790396 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:20:30.791398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026119B0D220>]}
[0m00:20:30.793406 [info ] [MainThread]: 
[0m00:20:30.794397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:20:30.798396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:20:30.799407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:20:30.812399 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:20:30.812399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:20:30.815400 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:20:30.816398 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:20:30.820417 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:20:30.820417 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:20:30.821408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:30.822404 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:20:30.822404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:30.825398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:31.855293 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.030 seconds
[0m00:20:31.856302 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.035 seconds
[0m00:20:31.858305 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:20:31.859305 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.037 seconds
[0m00:20:31.861309 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:20:31.864310 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:20:31.983089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:20:31.984102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:20:31.992100 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:20:31.993099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:20:31.997094 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:20:31.997094 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:20:32.000094 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:20:32.001094 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:20:32.002087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:32.002087 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:20:32.003100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:32.005099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:32.760871 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.756 seconds
[0m00:20:32.764881 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:20:32.882498 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.879 seconds
[0m00:20:32.884488 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:20:32.937892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.936 seconds
[0m00:20:32.939894 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:20:33.066703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261199BE8D0>]}
[0m00:20:33.067700 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:20:33.068703 [info ] [MainThread]: 
[0m00:20:33.074164 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:20:33.074164 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:20:33.075165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:20:33.076167 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:20:33.082155 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:20:33.084154 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:20:33.110172 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:20:33.112170 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:20:33.112170 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:20:33.113172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:33.915051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m00:20:33.935049 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:20:34.044977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611996A540>]}
[0m00:20:34.044977 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.97s]
[0m00:20:34.046839 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:20:34.047858 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:20:34.048853 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:20:34.048853 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:20:34.050372 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:20:34.055394 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:20:34.056388 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:20:34.077386 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:20:34.081383 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:20:34.081383 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:20:34.082389 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:20:36.041557 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.959 seconds
[0m00:20:36.044564 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:20:36.160065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611B44C140>]}
[0m00:20:36.161066 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.11s]
[0m00:20:36.162056 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:20:36.163070 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:20:36.164061 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:20:36.165065 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:20:36.165065 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:20:36.169589 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:20:36.170585 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:20:36.172584 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:20:36.174577 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:20:36.174577 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:20:36.175591 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:20:37.329029 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.153 seconds
[0m00:20:37.331023 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:20:37.443537 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617CDDF860>]}
[0m00:20:37.444537 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.28s]
[0m00:20:37.445537 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:20:37.446543 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:20:37.447528 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:20:37.448544 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:20:37.448544 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:20:37.452542 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:20:37.454543 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:20:37.457085 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:20:37.459090 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:20:37.459090 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:20:37.460080 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:20:38.996598 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.536 seconds
[0m00:20:38.998602 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:20:39.116971 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617CDDFC50>]}
[0m00:20:39.117976 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.67s]
[0m00:20:39.118977 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:20:39.119975 [debug] [Thread-9 (]: Began running node model.transform.dim_products
[0m00:20:39.120973 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:20:39.121969 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m00:20:39.123965 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m00:20:39.122964 [info ] [Thread-10 ]: 6 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m00:20:39.123965 [debug] [Thread-9 (]: Began compiling node model.transform.dim_products
[0m00:20:39.124965 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m00:20:39.127973 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.dim_products"
[0m00:20:39.128976 [debug] [Thread-10 ]: Began compiling node model.transform.fact_products_performance
[0m00:20:39.132976 [debug] [Thread-10 ]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m00:20:39.133968 [debug] [Thread-9 (]: Began executing node model.transform.dim_products
[0m00:20:39.137973 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.dim_products"
[0m00:20:39.137973 [debug] [Thread-10 ]: Began executing node model.transform.fact_products_performance
[0m00:20:39.140963 [debug] [Thread-10 ]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m00:20:39.141964 [debug] [Thread-9 (]: Using snowflake connection "model.transform.dim_products"
[0m00:20:39.144976 [debug] [Thread-9 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
    ON inttable.category = ct.category
        );
[0m00:20:39.145983 [debug] [Thread-10 ]: Using snowflake connection "model.transform.fact_products_performance"
[0m00:20:39.146981 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m00:20:39.146981 [debug] [Thread-10 ]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m00:20:39.148972 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m00:20:39.847651 [debug] [Thread-9 (]: Snowflake adapter: Snowflake query id: 01ba6994-0000-fd16-0001-4c5e000d916a
[0m00:20:39.847651 [debug] [Thread-9 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 27
invalid identifier 'CT.CATEGORY'
[0m00:20:39.848661 [debug] [Thread-9 (]: On model.transform.dim_products: Close
[0m00:20:39.975407 [debug] [Thread-9 (]: Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 13 at position 27
  invalid identifier 'CT.CATEGORY'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m00:20:39.976411 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611B5228A0>]}
[0m00:20:39.977537 [error] [Thread-9 (]: 5 of 6 ERROR creating sql table model products_schema_analytics.dim_products ... [[31mERROR[0m in 0.85s]
[0m00:20:39.978412 [debug] [Thread-9 (]: Finished running node model.transform.dim_products
[0m00:20:40.944785 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.796 seconds
[0m00:20:40.946789 [debug] [Thread-10 ]: On model.transform.fact_products_performance: Close
[0m00:20:41.072159 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd2d041-a0bb-43c6-92a8-ec593beeb436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611B521C10>]}
[0m00:20:41.073165 [info ] [Thread-10 ]: 6 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.95s]
[0m00:20:41.074158 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:20:41.076152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:41.077157 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:20:41.077157 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:20:41.078151 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:20:41.078151 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:20:41.079149 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:20:41.079149 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:20:41.080152 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:20:41.080152 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:20:41.081151 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:20:41.081151 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:20:41.082150 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m00:20:41.082150 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m00:20:41.083150 [info ] [MainThread]: 
[0m00:20:41.084347 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m00:20:41.086370 [debug] [MainThread]: Command end result
[0m00:20:41.117364 [info ] [MainThread]: 
[0m00:20:41.118366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:20:41.119368 [info ] [MainThread]: 
[0m00:20:41.120373 [error] [MainThread]:   Database Error in model dim_products (models\analytics\dim_products.sql)
  000904 (42000): SQL compilation error: error line 13 at position 27
  invalid identifier 'CT.CATEGORY'
  compiled code at target\run\transform\models\analytics\dim_products.sql
[0m00:20:41.121363 [info ] [MainThread]: 
[0m00:20:41.122363 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:20:41.123368 [debug] [MainThread]: Command `dbt run` failed at 00:20:41.123368 after 12.29 seconds
[0m00:20:41.124365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611985EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611B2C3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002617FE4CE00>]}
[0m00:20:41.124365 [debug] [MainThread]: Flushing usage events
[0m00:23:20.409721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CDF44920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CE400170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CDCD1250>]}


============================== 00:23:20.414726 | 3be85147-13d7-4f80-a25a-60ec43be3908 ==============================
[0m00:23:20.414726 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:23:20.415721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:21.403081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E78217F0>]}
[0m00:23:21.447672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CD83A240>]}
[0m00:23:21.449672 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:23:21.758862 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:23:21.930752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:21.930752 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m00:23:22.111883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E6D92780>]}
[0m00:23:22.202435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E8DA5CD0>]}
[0m00:23:22.203434 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:23:22.204434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E792D610>]}
[0m00:23:22.206443 [info ] [MainThread]: 
[0m00:23:22.207447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:23:22.212447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:23:22.223441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:23:22.224438 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:23:22.227434 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:23:22.227434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:23:22.228439 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:23:22.229438 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:23:22.231430 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:23:22.232436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:22.233434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:22.233434 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:23:22.240440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:23.204374 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.964 seconds
[0m00:23:23.205380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.973 seconds
[0m00:23:23.207382 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:23:23.209387 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:23:23.220442 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.989 seconds
[0m00:23:23.222443 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:23:23.334122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:23:23.335119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:23:23.336120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:23:23.344130 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:23:23.347151 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:23:23.351143 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:23:23.351143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:23:23.352147 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:23:23.353143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:23:23.353143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:23.354147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:23.355148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:24.187504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.833 seconds
[0m00:23:24.188515 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:23:24.278039 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.924 seconds
[0m00:23:24.280035 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:23:24.304581 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.950 seconds
[0m00:23:24.306583 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:23:24.420671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E8C95370>]}
[0m00:23:24.421678 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:23:24.422671 [info ] [MainThread]: 
[0m00:23:24.427659 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:23:24.428662 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:23:24.430662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:23:24.430662 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:23:24.437664 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:23:24.439668 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:23:24.469009 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:23:24.470997 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:23:24.472001 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:23:24.473001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:25.289274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m00:23:25.309825 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:23:25.429270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E7782030>]}
[0m00:23:25.430270 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 1.00s]
[0m00:23:25.431713 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:23:25.432736 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:23:25.433731 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:23:25.434724 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:23:25.435721 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:23:25.449752 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:23:25.450738 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:23:25.473292 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:23:25.476278 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:23:25.477280 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:23:25.478285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:23:28.466098 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.987 seconds
[0m00:23:28.467618 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:23:28.591936 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E9223E30>]}
[0m00:23:28.592950 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.16s]
[0m00:23:28.593934 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:23:28.594940 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:23:28.595941 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:23:28.596806 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:23:28.597822 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:23:28.600839 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:23:28.602821 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:23:28.604834 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:23:28.606821 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:23:28.606821 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:23:28.607836 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:23:29.936474 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.328 seconds
[0m00:23:29.938474 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:23:30.056071 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CABF35F0>]}
[0m00:23:30.057069 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.46s]
[0m00:23:30.058074 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:23:30.059073 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:23:30.060081 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m00:23:30.060081 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:23:30.061081 [info ] [Thread-8 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m00:23:30.062080 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:23:30.063073 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m00:23:30.064073 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:23:30.065071 [debug] [Thread-8 (]: Began compiling node model.transform.dim_products
[0m00:23:30.068601 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:23:30.072618 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.dim_products"
[0m00:23:30.074609 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:23:30.077611 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:23:30.078608 [debug] [Thread-8 (]: Began executing node model.transform.dim_products
[0m00:23:30.081617 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.dim_products"
[0m00:23:30.083608 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:23:30.084620 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:23:30.084620 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:23:30.086618 [debug] [Thread-8 (]: Using snowflake connection "model.transform.dim_products"
[0m00:23:30.088612 [debug] [Thread-8 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts"
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m00:23:30.089612 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:23:31.723821 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.634 seconds
[0m00:23:31.725830 [debug] [Thread-8 (]: On model.transform.dim_products: Close
[0m00:23:31.757487 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m00:23:31.759486 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:23:31.837872 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CABF38F0>]}
[0m00:23:31.838875 [info ] [Thread-8 (]: 5 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.77s]
[0m00:23:31.840872 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m00:23:31.901479 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E91548F0>]}
[0m00:23:31.902478 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.84s]
[0m00:23:31.904466 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:23:31.905470 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:23:31.907467 [info ] [Thread-10 ]: 6 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m00:23:31.908469 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m00:23:31.908469 [debug] [Thread-10 ]: Began compiling node model.transform.fact_products_performance
[0m00:23:31.912485 [debug] [Thread-10 ]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m00:23:31.913711 [debug] [Thread-10 ]: Began executing node model.transform.fact_products_performance
[0m00:23:31.916485 [debug] [Thread-10 ]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m00:23:31.918477 [debug] [Thread-10 ]: Using snowflake connection "model.transform.fact_products_performance"
[0m00:23:31.919491 [debug] [Thread-10 ]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m00:23:31.919491 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m00:23:33.255895 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.336 seconds
[0m00:23:33.257895 [debug] [Thread-10 ]: On model.transform.fact_products_performance: Close
[0m00:23:33.370654 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be85147-13d7-4f80-a25a-60ec43be3908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E9272BD0>]}
[0m00:23:33.370654 [info ] [Thread-10 ]: 6 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.46s]
[0m00:23:33.372161 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:23:33.374169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:33.375171 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:23:33.375171 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:23:33.375171 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:23:33.376176 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:23:33.376176 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:23:33.377178 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:23:33.377178 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:23:33.378183 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:23:33.378183 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:23:33.378183 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:23:33.379183 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m00:23:33.379183 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m00:23:33.380183 [info ] [MainThread]: 
[0m00:23:33.380183 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 11.17 seconds (11.17s).
[0m00:23:33.382709 [debug] [MainThread]: Command end result
[0m00:23:33.413727 [info ] [MainThread]: 
[0m00:23:33.414728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:33.414728 [info ] [MainThread]: 
[0m00:23:33.415723 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:23:33.417277 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:33.417277 after 13.15 seconds
[0m00:23:33.418292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E8CC6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CDF44920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0E8FAC470>]}
[0m00:23:33.418292 [debug] [MainThread]: Flushing usage events
[0m00:27:14.294156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ED590CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ED6AE4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ED590FB0>]}


============================== 00:27:14.299158 | d0240ce8-d0a2-443d-b337-f9d479278ea4 ==============================
[0m00:27:14.299158 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:14.299767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:15.249421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FFA55F40>]}
[0m00:27:15.293421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FFA55F10>]}
[0m00:27:15.295410 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:15.609835 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:15.791113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:27:15.791113 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\dim_products.sql
[0m00:27:15.792113 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:27:15.987358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020087C868D0>]}
[0m00:27:16.078133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020087DA1E80>]}
[0m00:27:16.079130 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:27:16.080139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FFA97FB0>]}
[0m00:27:16.082143 [info ] [MainThread]: 
[0m00:27:16.083138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:16.087143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:16.100144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:16.099138 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:16.103167 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:16.104167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:16.104167 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:16.105168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:16.107167 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:16.108169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:16.108169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:16.109168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:16.115164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:17.211603 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.103 seconds
[0m00:27:17.215599 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:17.326016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.211 seconds
[0m00:27:17.327020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.218 seconds
[0m00:27:17.329016 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:17.332017 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:17.448543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:27:17.449551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:27:17.459575 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:27:17.461573 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:27:17.462559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:27:17.462559 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:27:17.463570 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:27:17.466097 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:27:17.467128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:17.468119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:17.468119 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:27:17.472121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:18.260036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.793 seconds
[0m00:27:18.262033 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:27:18.284518 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m00:27:18.286550 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:27:18.395296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.923 seconds
[0m00:27:18.397298 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:27:18.512254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008677E690>]}
[0m00:27:18.513199 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:27:18.514204 [info ] [MainThread]: 
[0m00:27:18.518899 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:27:18.519916 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:27:18.520917 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:27:18.520917 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:27:18.527916 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:27:18.528922 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:27:18.555917 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:27:18.557915 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:27:18.557915 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:27:18.558918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:27:19.254096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m00:27:19.275091 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:27:19.384791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008673E2A0>]}
[0m00:27:19.385796 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.86s]
[0m00:27:19.386800 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:27:19.388313 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:27:19.389332 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:27:19.390328 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:27:19.390328 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:27:19.395325 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:27:19.396329 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:27:19.418353 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:27:19.422642 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:27:19.423649 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:27:19.423649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:27:23.221949 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.798 seconds
[0m00:27:23.223956 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:27:23.338078 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020088295670>]}
[0m00:27:23.339078 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.95s]
[0m00:27:23.340083 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:27:23.341083 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:27:23.342072 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:27:23.343069 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:27:23.344081 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:27:23.347086 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:27:23.348084 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:27:23.351082 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:27:23.353080 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:27:23.353080 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:27:23.354086 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:27:25.838008 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.484 seconds
[0m00:27:25.840020 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:27:25.959886 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200882972C0>]}
[0m00:27:25.960893 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.62s]
[0m00:27:25.961887 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:27:25.962889 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:27:25.962889 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m00:27:25.963891 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:27:25.965893 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:27:25.964879 [info ] [Thread-8 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m00:27:25.965893 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:27:25.966890 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m00:27:25.970891 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:27:25.971896 [debug] [Thread-8 (]: Began compiling node model.transform.dim_products
[0m00:27:25.972889 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:27:25.975895 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.dim_products"
[0m00:27:25.978895 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:27:25.980890 [debug] [Thread-8 (]: Began executing node model.transform.dim_products
[0m00:27:25.983419 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.dim_products"
[0m00:27:25.984412 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:27:25.985412 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,s
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:27:25.986417 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:27:25.987411 [debug] [Thread-8 (]: Using snowflake connection "model.transform.dim_products"
[0m00:27:25.989418 [debug] [Thread-8 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m00:27:25.990420 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:27:26.698656 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba699b-0000-fcd1-0001-4c5e000d339a
[0m00:27:26.698656 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 26
invalid identifier 'S'
[0m00:27:26.699667 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:27:26.814671 [debug] [Thread-7 (]: Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 22 at position 26
  invalid identifier 'S'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:27:26.814671 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E9BCFA40>]}
[0m00:27:26.815679 [error] [Thread-7 (]: 4 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.85s]
[0m00:27:26.817679 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:27:26.818688 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:27:26.819679 [info ] [Thread-10 ]: 6 of 6 SKIP relation products_schema_analytics.fact_products_performance ....... [[33mSKIP[0m]
[0m00:27:26.820680 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:27:27.663385 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m00:27:27.665384 [debug] [Thread-8 (]: On model.transform.dim_products: Close
[0m00:27:27.781174 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0240ce8-d0a2-443d-b337-f9d479278ea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020088236E40>]}
[0m00:27:27.782173 [info ] [Thread-8 (]: 5 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.81s]
[0m00:27:27.784173 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m00:27:27.786174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:27.787176 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:27:27.787176 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:27:27.787176 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:27:27.788175 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:27:27.788175 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:27:27.789174 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:27:27.789174 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:27:27.789174 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:27:27.790174 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:27:27.790174 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:27:27.791165 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m00:27:27.791165 [info ] [MainThread]: 
[0m00:27:27.792163 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 11.71 seconds (11.71s).
[0m00:27:27.794163 [debug] [MainThread]: Command end result
[0m00:27:27.826170 [info ] [MainThread]: 
[0m00:27:27.827169 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:27:27.828171 [info ] [MainThread]: 
[0m00:27:27.829176 [error] [MainThread]:   Database Error in model agg_category_performance (models\analytics\agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 22 at position 26
  invalid identifier 'S'
  compiled code at target\run\transform\models\analytics\agg_category_performance.sql
[0m00:27:27.830174 [info ] [MainThread]: 
[0m00:27:27.831684 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m00:27:27.833691 [debug] [MainThread]: Command `dbt run` failed at 00:27:27.833691 after 13.64 seconds
[0m00:27:27.833691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ED7F7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FF25E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020086B90CE0>]}
[0m00:27:27.834691 [debug] [MainThread]: Flushing usage events
[0m00:27:45.936474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028783290170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287836C0FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287836C1940>]}


============================== 00:27:45.940833 | 30084629-b0cb-4168-9872-4372589f760c ==============================
[0m00:27:45.940833 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:45.941843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:46.916758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287836F0F80>]}
[0m00:27:46.962321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879B255F10>]}
[0m00:27:46.964090 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:47.280117 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:47.442812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:27:47.442812 [debug] [MainThread]: Partial parsing: updated file: transform://models\analytics\agg_category_performance.sql
[0m00:27:47.641132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879DB92A20>]}
[0m00:27:47.735041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C8AA660>]}
[0m00:27:47.736042 [info ] [MainThread]: Found 6 models, 1 test, 575 macros
[0m00:27:47.737054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C347FB0>]}
[0m00:27:47.738050 [info ] [MainThread]: 
[0m00:27:47.739047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:47.743892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:47.751916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:47.756441 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:47.757443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m00:27:47.760442 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:47.761444 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:47.765443 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m00:27:47.766441 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:47.766441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:47.767444 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m00:27:47.768442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:47.771445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:48.759526 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.989 seconds
[0m00:27:48.761527 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:48.763534 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.996 seconds
[0m00:27:48.765524 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:48.809434 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.042 seconds
[0m00:27:48.811429 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m00:27:48.926320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m00:27:48.927320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m00:27:48.936319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m00:27:48.937315 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m00:27:48.940332 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m00:27:48.943426 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m00:27:48.944392 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show objects in E_COMMERCE_PRODUCT.products_schema limit 10000
[0m00:27:48.945058 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show objects in E_COMMERCE_PRODUCT.products_schema_analytics limit 10000
[0m00:27:48.946086 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show objects in E_COMMERCE_PRODUCT.products_schema_intermediate limit 10000
[0m00:27:48.946086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:48.947085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:48.947085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:49.775598 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.829 seconds
[0m00:27:49.777592 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m00:27:49.896701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.950 seconds
[0m00:27:49.897701 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m00:27:49.909844 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.962 seconds
[0m00:27:49.910847 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m00:27:50.031163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879DAF5BB0>]}
[0m00:27:50.032154 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m00:27:50.032154 [info ] [MainThread]: 
[0m00:27:50.038465 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m00:27:50.039470 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m00:27:50.040469 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.transform.stg_products'
[0m00:27:50.040469 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m00:27:50.047481 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m00:27:50.048471 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m00:27:50.075003 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m00:27:50.076988 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m00:27:50.076988 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m00:27:50.077999 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:27:50.777857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m00:27:50.797861 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m00:27:50.908813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C56A660>]}
[0m00:27:50.908813 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.87s]
[0m00:27:50.910816 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m00:27:50.911800 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m00:27:50.912802 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m00:27:50.913801 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.transform.int_products'
[0m00:27:50.914811 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m00:27:50.919814 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m00:27:50.921806 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m00:27:50.942831 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m00:27:50.946825 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m00:27:50.947825 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m00:27:50.948823 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:27:52.769307 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.820 seconds
[0m00:27:52.771306 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m00:27:52.882569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C94B860>]}
[0m00:27:52.883573 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.97s]
[0m00:27:52.884568 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m00:27:52.885574 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m00:27:52.886580 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m00:27:52.887580 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m00:27:52.888578 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m00:27:52.891578 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m00:27:52.893572 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m00:27:52.895582 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m00:27:52.897574 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m00:27:52.898574 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m00:27:52.898574 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:27:55.437370 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.538 seconds
[0m00:27:55.439372 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m00:27:55.565016 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287FFA5F5C0>]}
[0m00:27:55.566034 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.68s]
[0m00:27:55.567014 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m00:27:55.568016 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m00:27:55.568016 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m00:27:55.569020 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m00:27:55.571015 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m00:27:55.570019 [info ] [Thread-8 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m00:27:55.571015 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m00:27:55.572015 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m00:27:55.576011 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m00:27:55.577012 [debug] [Thread-8 (]: Began compiling node model.transform.dim_products
[0m00:27:55.581010 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.dim_products"
[0m00:27:55.582017 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m00:27:55.585016 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m00:27:55.586011 [debug] [Thread-8 (]: Began executing node model.transform.dim_products
[0m00:27:55.589017 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.dim_products"
[0m00:27:55.591011 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m00:27:55.592012 [debug] [Thread-8 (]: Using snowflake connection "model.transform.dim_products"
[0m00:27:55.593016 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m00:27:55.594021 [debug] [Thread-8 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m00:27:55.594021 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:27:55.595014 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:27:58.533528 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.939 seconds
[0m00:27:58.535544 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m00:27:58.642486 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879DFC0260>]}
[0m00:27:58.643486 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 3.07s]
[0m00:27:58.644478 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m00:27:58.644478 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m00:27:58.645480 [info ] [Thread-10 ]: 6 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m00:27:58.646478 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m00:27:58.647489 [debug] [Thread-10 ]: Began compiling node model.transform.fact_products_performance
[0m00:27:58.650518 [debug] [Thread-10 ]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m00:27:58.651521 [debug] [Thread-10 ]: Began executing node model.transform.fact_products_performance
[0m00:27:58.655512 [debug] [Thread-10 ]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m00:27:58.656610 [debug] [Thread-10 ]: Using snowflake connection "model.transform.fact_products_performance"
[0m00:27:58.657499 [debug] [Thread-10 ]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m00:27:58.658499 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m00:27:58.670026 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 3.075 seconds
[0m00:27:58.672028 [debug] [Thread-8 (]: On model.transform.dim_products: Close
[0m00:27:58.785308 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879E0E3E90>]}
[0m00:27:58.786306 [info ] [Thread-8 (]: 5 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 3.21s]
[0m00:27:58.787307 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m00:28:00.019566 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.361 seconds
[0m00:28:00.022573 [debug] [Thread-10 ]: On model.transform.fact_products_performance: Close
[0m00:28:00.136192 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30084629-b0cb-4168-9872-4372589f760c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879E0C1B50>]}
[0m00:28:00.136192 [info ] [Thread-10 ]: 6 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.49s]
[0m00:28:00.138187 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m00:28:00.140187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:00.141180 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:28:00.141180 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:28:00.141180 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT' was properly closed.
[0m00:28:00.142187 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m00:28:00.142187 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m00:28:00.143187 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m00:28:00.143187 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m00:28:00.144186 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m00:28:00.144186 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m00:28:00.144186 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m00:28:00.145186 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m00:28:00.145186 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m00:28:00.146177 [info ] [MainThread]: 
[0m00:28:00.147177 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 12.41 seconds (12.41s).
[0m00:28:00.149201 [debug] [MainThread]: Command end result
[0m00:28:00.178741 [info ] [MainThread]: 
[0m00:28:00.180744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:00.180744 [info ] [MainThread]: 
[0m00:28:00.181749 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:28:00.183741 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:00.183741 after 14.35 seconds
[0m00:28:00.183741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C56A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879DA6C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879C948680>]}
[0m00:28:00.184741 [debug] [MainThread]: Flushing usage events
[0m02:36:20.216191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f65642c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f513b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f58f0a10>]}


============================== 02:36:20.218253 | a8dd30d6-022b-49b5-b2b1-cb5754451f99 ==============================
[0m02:36:20.218253 [info ] [MainThread]: Running with dbt=1.5.0
[0m02:36:20.219057 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default'}
[0m02:36:20.994069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f532d160>]}
[0m02:36:21.011041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cf787020>]}
[0m02:36:21.040221 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m02:36:21.071714 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:36:21.072676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cdf8ffe0>]}
[0m02:36:22.676616 [debug] [MainThread]: 1603: static parser failed on analytics/agg_category_performance.sql
[0m02:36:22.708201 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/agg_category_performance.sql
[0m02:36:22.710108 [debug] [MainThread]: 1603: static parser failed on analytics/dim_category.sql
[0m02:36:22.715450 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_category.sql
[0m02:36:22.719650 [debug] [MainThread]: 1699: static parser successfully parsed analytics/dim_products.sql
[0m02:36:22.723683 [debug] [MainThread]: 1699: static parser successfully parsed analytics/fact_products_performance.sql
[0m02:36:22.728144 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m02:36:22.736293 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m02:36:22.738232 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_products.sql
[0m02:36:22.822351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd77ba70>]}
[0m02:36:22.839884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd51f980>]}
[0m02:36:22.840644 [info ] [MainThread]: Found 6 models, 1 test, 0 snapshots, 0 analyses, 437 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:36:22.841470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f4eaab10>]}
[0m02:36:22.843264 [info ] [MainThread]: 
[0m02:36:22.844553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:36:22.846644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m02:36:22.852988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m02:36:22.854121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m02:36:22.877663 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m02:36:22.878404 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m02:36:22.880059 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m02:36:22.880472 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m02:36:22.881213 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m02:36:22.881865 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m02:36:22.882414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:22.883041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:22.883658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:23.926037 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:36:23.927845 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m02:36:23.948763 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:36:23.950607 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m02:36:23.990567 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:36:23.992413 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m02:36:24.098761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m02:36:24.099933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m02:36:24.101181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m02:36:24.108439 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m02:36:24.111947 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m02:36:24.114373 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m02:36:24.115459 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m02:36:24.116537 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m02:36:24.117309 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m02:36:24.118009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:24.118645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:24.119229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:24.463682 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:36:24.465531 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m02:36:24.578672 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:36:24.580423 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m02:36:24.660742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:36:24.662454 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m02:36:24.770515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f513b2c0>]}
[0m02:36:24.771576 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m02:36:24.772364 [info ] [MainThread]: 
[0m02:36:24.785233 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m02:36:24.786189 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m02:36:24.787576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.stg_products)
[0m02:36:24.788423 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m02:36:24.790397 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m02:36:24.797771 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 02:36:24.789019 => 02:36:24.797452
[0m02:36:24.798453 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m02:36:24.826211 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m02:36:24.835821 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m02:36:24.836517 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m02:36:24.837219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:25.287582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:36:25.310119 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 02:36:24.799014 => 02:36:25.309885
[0m02:36:25.310975 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m02:36:25.427703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd5a7110>]}
[0m02:36:25.428629 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.64s]
[0m02:36:25.429654 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m02:36:25.431357 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m02:36:25.432186 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m02:36:25.433204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m02:36:25.433934 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m02:36:25.440822 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m02:36:25.450189 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 02:36:25.434408 => 02:36:25.449756
[0m02:36:25.450959 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m02:36:25.474021 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m02:36:25.483021 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m02:36:25.483814 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m02:36:25.484377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:36:28.788927 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:36:28.792101 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 02:36:25.451618 => 02:36:28.791918
[0m02:36:28.792918 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m02:36:28.921265 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a625e3c0>]}
[0m02:36:28.922198 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.49s]
[0m02:36:28.923611 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m02:36:28.925189 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m02:36:28.926023 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m02:36:28.927616 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m02:36:28.928510 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m02:36:28.934259 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m02:36:28.942035 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 02:36:28.929030 => 02:36:28.941724
[0m02:36:28.942630 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m02:36:28.945641 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m02:36:28.953615 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m02:36:28.954330 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m02:36:28.954974 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m02:36:30.528624 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:30.532037 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 02:36:28.943000 => 02:36:30.531851
[0m02:36:30.532773 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m02:36:30.636380 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a4136db0>]}
[0m02:36:30.637415 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.71s]
[0m02:36:30.638585 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m02:36:30.640370 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m02:36:30.640861 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m02:36:30.641432 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m02:36:30.642363 [info ] [Thread-8 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m02:36:30.643792 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m02:36:30.645074 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m02:36:30.645875 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m02:36:30.646764 [debug] [Thread-8 (]: Began compiling node model.transform.dim_products
[0m02:36:30.652446 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m02:36:30.655230 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.dim_products"
[0m02:36:30.660928 [debug] [Thread-7 (]: Timing info for model.transform.agg_category_performance (compile): 02:36:30.647637 => 02:36:30.660614
[0m02:36:30.661793 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m02:36:30.662736 [debug] [Thread-8 (]: Timing info for model.transform.dim_products (compile): 02:36:30.652862 => 02:36:30.662440
[0m02:36:30.665700 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m02:36:30.666820 [debug] [Thread-8 (]: Began executing node model.transform.dim_products
[0m02:36:30.671437 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.dim_products"
[0m02:36:30.676655 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m02:36:30.677768 [debug] [Thread-8 (]: Using snowflake connection "model.transform.dim_products"
[0m02:36:30.678415 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m02:36:30.679200 [debug] [Thread-8 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m02:36:30.679939 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m02:36:30.680669 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m02:36:31.588249 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:36:31.591532 [debug] [Thread-7 (]: Timing info for model.transform.agg_category_performance (execute): 02:36:30.663079 => 02:36:31.591266
[0m02:36:31.592387 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m02:36:31.706997 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a62c8e60>]}
[0m02:36:31.708097 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.06s]
[0m02:36:31.709631 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m02:36:31.711062 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m02:36:31.712031 [info ] [Thread-10 ]: 6 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m02:36:31.713478 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m02:36:31.714322 [debug] [Thread-10 ]: Began compiling node model.transform.fact_products_performance
[0m02:36:31.717967 [debug] [Thread-10 ]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m02:36:31.728130 [debug] [Thread-10 ]: Timing info for model.transform.fact_products_performance (compile): 02:36:31.714971 => 02:36:31.727796
[0m02:36:31.728974 [debug] [Thread-10 ]: Began executing node model.transform.fact_products_performance
[0m02:36:31.732261 [debug] [Thread-10 ]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m02:36:31.735514 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:36:31.740145 [debug] [Thread-8 (]: Timing info for model.transform.dim_products (execute): 02:36:30.668398 => 02:36:31.739916
[0m02:36:31.741053 [debug] [Thread-8 (]: On model.transform.dim_products: Close
[0m02:36:31.746875 [debug] [Thread-10 ]: Using snowflake connection "model.transform.fact_products_performance"
[0m02:36:31.747814 [debug] [Thread-10 ]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m02:36:31.748545 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m02:36:31.858406 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a62c89e0>]}
[0m02:36:31.859262 [info ] [Thread-8 (]: 5 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.21s]
[0m02:36:31.860422 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m02:36:33.374050 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:33.376918 [debug] [Thread-10 ]: Timing info for model.transform.fact_products_performance (execute): 02:36:31.729600 => 02:36:33.376715
[0m02:36:33.377745 [debug] [Thread-10 ]: On model.transform.fact_products_performance: Close
[0m02:36:33.481688 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8dd30d6-022b-49b5-b2b1-cb5754451f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a627fce0>]}
[0m02:36:33.482688 [info ] [Thread-10 ]: 6 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.77s]
[0m02:36:33.484023 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m02:36:33.487427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:33.488088 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m02:36:33.488653 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m02:36:33.489167 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m02:36:33.489665 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m02:36:33.490142 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m02:36:33.490530 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m02:36:33.490889 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m02:36:33.491430 [info ] [MainThread]: 
[0m02:36:33.492074 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m02:36:33.494058 [debug] [MainThread]: Command end result
[0m02:36:33.510584 [info ] [MainThread]: 
[0m02:36:33.511646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:33.512829 [info ] [MainThread]: 
[0m02:36:33.514030 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:36:33.515350 [debug] [MainThread]: Command `dbt run` succeeded at 02:36:33.515136 after 13.32 seconds
[0m02:36:33.516131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f9507020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f51f8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f58f0a10>]}
[0m02:36:33.516850 [debug] [MainThread]: Flushing usage events
[0m03:11:48.029218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fbf3fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fc2a1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fbf3fc20>]}


============================== 03:11:48.031332 | 96601d37-8ffd-40f7-8682-73a182e39710 ==============================
[0m03:11:48.031332 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:11:48.032184 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m03:11:48.709807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fc327410>]}
[0m03:11:48.726703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d48b65a0>]}
[0m03:11:48.757823 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m03:11:49.640129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:11:49.641044 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/generic_test.yml
[0m03:11:49.662881 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m03:11:49.688083 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m03:11:49.812486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fbf3f260>]}
[0m03:11:49.829575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d4808380>]}
[0m03:11:49.830500 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 437 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:11:49.831403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dcb74950>]}
[0m03:11:49.833401 [info ] [MainThread]: 
[0m03:11:49.834748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:11:49.837156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m03:11:49.838169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m03:11:49.844719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m03:11:49.857392 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m03:11:49.859331 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m03:11:49.861475 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m03:11:49.862277 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m03:11:49.862934 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m03:11:49.863584 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m03:11:49.864107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:49.864691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:49.865248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:50.443211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:11:50.445325 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m03:11:50.452819 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m03:11:50.454714 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m03:11:50.723719 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:11:50.725366 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m03:11:50.923677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96601d37-8ffd-40f7-8682-73a182e39710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d46ac4d0>]}
[0m03:11:50.924776 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:11:50.925439 [info ] [MainThread]: 
[0m03:11:50.932141 [debug] [Thread-1 (]: Began running node test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525
[0m03:11:50.932728 [debug] [Thread-2 (]: Began running node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:11:50.933248 [debug] [Thread-3 (]: Began running node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2
[0m03:11:50.934127 [debug] [Thread-4 (]: Began running node test.transform.not_null_int_products_Price_dollars.5790bc28fa
[0m03:11:50.933686 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_type_check_int_products_Price_dollars__float ....... [RUN]
[0m03:11:50.935044 [debug] [Thread-5 (]: Began running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:11:50.935689 [debug] [Thread-6 (]: Began running node test.transform.not_null_int_products_selling_proposition.d4ad05ad6a
[0m03:11:50.936432 [info ] [Thread-2 (]: 2 of 6 START test dbt_utils_type_check_int_products_discount__float ............ [RUN]
[0m03:11:50.937315 [info ] [Thread-3 (]: 3 of 6 START test dbt_utils_type_check_int_products_selling_proposition__number  [RUN]
[0m03:11:50.938308 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_products_Price_dollars .......................... [RUN]
[0m03:11:50.939700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525)
[0m03:11:50.940501 [info ] [Thread-5 (]: 5 of 6 START test not_null_int_products_discount ............................... [RUN]
[0m03:11:50.941366 [info ] [Thread-6 (]: 6 of 6 START test not_null_int_products_selling_proposition .................... [RUN]
[0m03:11:50.942441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9)
[0m03:11:50.943557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2)
[0m03:11:50.944652 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_Price_dollars.5790bc28fa'
[0m03:11:50.945346 [debug] [Thread-1 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525
[0m03:11:50.946387 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_discount.0b2d52e328'
[0m03:11:50.947550 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_selling_proposition.d4ad05ad6a'
[0m03:11:50.948200 [debug] [Thread-2 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:11:50.948816 [debug] [Thread-3 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2
[0m03:11:50.949513 [debug] [Thread-4 (]: Began compiling node test.transform.not_null_int_products_Price_dollars.5790bc28fa
[0m03:11:50.954992 [debug] [Thread-1 (]: Timing info for test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525 (compile): 03:11:50.950171 => 03:11:50.954723
[0m03:11:50.955663 [debug] [Thread-5 (]: Began compiling node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:11:50.956650 [debug] [Thread-6 (]: Began compiling node test.transform.not_null_int_products_selling_proposition.d4ad05ad6a
[0m03:11:50.961443 [debug] [Thread-2 (]: Timing info for test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9 (compile): 03:11:50.957273 => 03:11:50.961187
[0m03:11:50.966641 [debug] [Thread-3 (]: Timing info for test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2 (compile): 03:11:50.962297 => 03:11:50.966344
[0m03:11:50.977200 [debug] [Thread-4 (]: Writing injected SQL for node "test.transform.not_null_int_products_Price_dollars.5790bc28fa"
[0m03:11:50.982835 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:11:50.985511 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_type_check_int_products_Price_dollars__float (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:50.989684 [debug] [Thread-6 (]: Writing injected SQL for node "test.transform.not_null_int_products_selling_proposition.d4ad05ad6a"
[0m03:11:50.991780 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_type_check_int_products_discount__float (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:50.993627 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_type_check_int_products_selling_proposition__number (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:50.994983 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_type_check_int_products_Price_dollars__float ............ [[31mERROR[0m in 0.06s]
[0m03:11:50.996426 [error] [Thread-2 (]: 2 of 6 ERROR dbt_utils_type_check_int_products_discount__float ................. [[31mERROR[0m in 0.05s]
[0m03:11:50.998030 [error] [Thread-3 (]: 3 of 6 ERROR dbt_utils_type_check_int_products_selling_proposition__number ..... [[31mERROR[0m in 0.05s]
[0m03:11:51.000057 [debug] [Thread-1 (]: Finished running node test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525
[0m03:11:51.001387 [debug] [Thread-2 (]: Finished running node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:11:51.002498 [debug] [Thread-3 (]: Finished running node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2
[0m03:11:51.005453 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.d4ad05ad6a (compile): 03:11:50.985926 => 03:11:51.004966
[0m03:11:51.006426 [debug] [Thread-6 (]: Began executing node test.transform.not_null_int_products_selling_proposition.d4ad05ad6a
[0m03:11:51.014827 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_Price_dollars.5790bc28fa (compile): 03:11:50.967671 => 03:11:51.013821
[0m03:11:51.016044 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (compile): 03:11:50.978945 => 03:11:51.015629
[0m03:11:51.027764 [debug] [Thread-4 (]: Began executing node test.transform.not_null_int_products_Price_dollars.5790bc28fa
[0m03:11:51.031970 [debug] [Thread-6 (]: Writing runtime sql for node "test.transform.not_null_int_products_selling_proposition.d4ad05ad6a"
[0m03:11:51.032812 [debug] [Thread-5 (]: Began executing node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:11:51.036140 [debug] [Thread-4 (]: Writing runtime sql for node "test.transform.not_null_int_products_Price_dollars.5790bc28fa"
[0m03:11:51.041282 [debug] [Thread-5 (]: Writing runtime sql for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:11:51.047522 [debug] [Thread-6 (]: Using snowflake connection "test.transform.not_null_int_products_selling_proposition.d4ad05ad6a"
[0m03:11:51.048208 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.d4ad05ad6a: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_selling_proposition.d4ad05ad6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select selling-proposition
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where selling-proposition is null



      
    ) dbt_internal_test
[0m03:11:51.049213 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m03:11:51.051370 [debug] [Thread-5 (]: Using snowflake connection "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:11:51.052264 [debug] [Thread-4 (]: Using snowflake connection "test.transform.not_null_int_products_Price_dollars.5790bc28fa"
[0m03:11:51.053640 [debug] [Thread-5 (]: On test.transform.not_null_int_products_discount.0b2d52e328: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_discount.0b2d52e328"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select discount
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where discount is null



      
    ) dbt_internal_test
[0m03:11:51.054988 [debug] [Thread-4 (]: On test.transform.not_null_int_products_Price_dollars.5790bc28fa: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_Price_dollars.5790bc28fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Price_dollars
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where Price_dollars is null



      
    ) dbt_internal_test
[0m03:11:51.055952 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m03:11:51.056843 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:11:51.379665 [debug] [Thread-6 (]: Snowflake adapter: Snowflake query id: 01ba71bf-0000-fd29-0001-4c5e000df11e
[0m03:11:51.380400 [debug] [Thread-6 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'SELLING'
[0m03:11:51.381263 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.d4ad05ad6a (execute): 03:11:51.007450 => 03:11:51.381048
[0m03:11:51.381867 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.d4ad05ad6a: Close
[0m03:11:51.411575 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:11:51.418487 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_Price_dollars.5790bc28fa (execute): 03:11:51.033475 => 03:11:51.418223
[0m03:11:51.419485 [debug] [Thread-4 (]: On test.transform.not_null_int_products_Price_dollars.5790bc28fa: Close
[0m03:11:51.487336 [debug] [Thread-6 (]: Database Error in test not_null_int_products_selling_proposition (models/intermediate/generic_test.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SELLING'
  compiled Code at target/run/transform/models/intermediate/generic_test.yml/not_null_int_products_selling_proposition.sql
[0m03:11:51.488208 [error] [Thread-6 (]: 6 of 6 ERROR not_null_int_products_selling_proposition ......................... [[31mERROR[0m in 0.54s]
[0m03:11:51.489225 [debug] [Thread-6 (]: Finished running node test.transform.not_null_int_products_selling_proposition.d4ad05ad6a
[0m03:11:51.521431 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_products_Price_dollars ................................ [[32mPASS[0m in 0.58s]
[0m03:11:51.522588 [debug] [Thread-4 (]: Finished running node test.transform.not_null_int_products_Price_dollars.5790bc28fa
[0m03:11:51.574114 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:11:51.576494 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (execute): 03:11:51.037155 => 03:11:51.576247
[0m03:11:51.577142 [debug] [Thread-5 (]: On test.transform.not_null_int_products_discount.0b2d52e328: Close
[0m03:11:51.684265 [info ] [Thread-5 (]: 5 of 6 PASS not_null_int_products_discount ..................................... [[32mPASS[0m in 0.74s]
[0m03:11:51.685513 [debug] [Thread-5 (]: Finished running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:11:51.689101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:51.689690 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_Price_dollars__float.ae7ee27525' was properly closed.
[0m03:11:51.690079 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9' was properly closed.
[0m03:11:51.690452 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_selling_proposition__number.72827a62a2' was properly closed.
[0m03:11:51.690857 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_Price_dollars.5790bc28fa' was properly closed.
[0m03:11:51.691240 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_discount.0b2d52e328' was properly closed.
[0m03:11:51.691600 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_selling_proposition.d4ad05ad6a' was properly closed.
[0m03:11:51.692022 [info ] [MainThread]: 
[0m03:11:51.692687 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m03:11:51.697001 [debug] [MainThread]: Command end result
[0m03:11:51.712121 [info ] [MainThread]: 
[0m03:11:51.713193 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m03:11:51.714331 [info ] [MainThread]: 
[0m03:11:51.715666 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_Price_dollars__float (models/intermediate/generic_test.yml)[0m
[0m03:11:51.716702 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:51.718326 [info ] [MainThread]: 
[0m03:11:51.719577 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_discount__float (models/intermediate/generic_test.yml)[0m
[0m03:11:51.721080 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:51.722686 [info ] [MainThread]: 
[0m03:11:51.723790 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_selling_proposition__number (models/intermediate/generic_test.yml)[0m
[0m03:11:51.724852 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:11:51.725987 [info ] [MainThread]: 
[0m03:11:51.727063 [error] [MainThread]: [33mDatabase Error in test not_null_int_products_selling_proposition (models/intermediate/generic_test.yml)[0m
[0m03:11:51.727887 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
[0m03:11:51.728818 [error] [MainThread]:   invalid identifier 'SELLING'
[0m03:11:51.729595 [error] [MainThread]:   compiled Code at target/run/transform/models/intermediate/generic_test.yml/not_null_int_products_selling_proposition.sql
[0m03:11:51.730503 [info ] [MainThread]: 
[0m03:11:51.731689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m03:11:51.733231 [debug] [MainThread]: Command `dbt test` failed at 03:11:51.732919 after 3.72 seconds
[0m03:11:51.733946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa40057f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d4b2b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3fc7cce60>]}
[0m03:11:51.734509 [debug] [MainThread]: Flushing usage events
[0m03:13:20.209377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64a640830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649751160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649752180>]}


============================== 03:13:20.211510 | cfb59706-adcb-4d3c-8ac2-7fc373d775fe ==============================
[0m03:13:20.211510 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:13:20.212458 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'version_check': 'True'}
[0m03:13:20.241146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfb59706-adcb-4d3c-8ac2-7fc373d775fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649daf5f0>]}
[0m03:13:20.244358 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o_hx6bq9'
[0m03:13:20.245139 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:13:20.272933 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:13:20.273940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:13:20.336935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:13:20.344161 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:13:24.114501 [info ] [MainThread]: Installed from version 1.3.0
[0m03:13:24.115481 [info ] [MainThread]: Up to date!
[0m03:13:24.116832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cfb59706-adcb-4d3c-8ac2-7fc373d775fe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6491672f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649753d40>]}
[0m03:13:24.118322 [debug] [MainThread]: Command `dbt deps` succeeded at 03:13:24.118050 after 3.93 seconds
[0m03:13:24.119112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6498b9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64913c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64a640830>]}
[0m03:13:24.119829 [debug] [MainThread]: Flushing usage events
[0m03:13:31.300557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0770e7ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07712f6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07705aa420>]}


============================== 03:13:31.302507 | 38ce5f08-f65e-4395-82e4-68d1da5d258f ==============================
[0m03:13:31.302507 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:13:31.303271 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/transform', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None'}
[0m03:13:31.909976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07708d66f0>]}
[0m03:13:31.925762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f074933d2b0>]}
[0m03:13:31.946380 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m03:13:32.700701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:13:32.701530 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/generic_test.yml
[0m03:13:32.722713 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m03:13:32.750037 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m03:13:32.878744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0748c01a90>]}
[0m03:13:32.893815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0748cdd880>]}
[0m03:13:32.894510 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 437 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:13:32.895211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0748cdd760>]}
[0m03:13:32.897334 [info ] [MainThread]: 
[0m03:13:32.899050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:32.901015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m03:13:32.902491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m03:13:32.908950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m03:13:32.917845 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m03:13:32.920317 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m03:13:32.922759 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m03:13:32.923500 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m03:13:32.924191 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m03:13:32.924804 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m03:13:32.925537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:32.926143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:32.926707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:33.526506 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m03:13:33.528912 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m03:13:33.548128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:13:33.549949 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m03:13:33.556783 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:13:33.559009 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m03:13:33.671552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ce5f08-f65e-4395-82e4-68d1da5d258f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07491daae0>]}
[0m03:13:33.672825 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:13:33.673823 [info ] [MainThread]: 
[0m03:13:33.680682 [debug] [Thread-1 (]: Began running node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:13:33.681214 [debug] [Thread-2 (]: Began running node test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25
[0m03:13:33.681707 [debug] [Thread-3 (]: Began running node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e
[0m03:13:33.682625 [debug] [Thread-4 (]: Began running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:13:33.683283 [debug] [Thread-5 (]: Began running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:13:33.682179 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_type_check_int_products_discount__float ............ [RUN]
[0m03:13:33.684355 [debug] [Thread-6 (]: Began running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:13:33.685060 [info ] [Thread-2 (]: 2 of 6 START test dbt_utils_type_check_int_products_price_dollars__float ....... [RUN]
[0m03:13:33.686379 [info ] [Thread-3 (]: 3 of 6 START test dbt_utils_type_check_int_products_selling_proposition__number  [RUN]
[0m03:13:33.687619 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_products_discount ............................... [RUN]
[0m03:13:33.689059 [info ] [Thread-5 (]: 5 of 6 START test not_null_int_products_price_dollars .......................... [RUN]
[0m03:13:33.691019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9)
[0m03:13:33.691963 [info ] [Thread-6 (]: 6 of 6 START test not_null_int_products_selling_proposition .................... [RUN]
[0m03:13:33.693233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25)
[0m03:13:33.694473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e)
[0m03:13:33.695714 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_discount.0b2d52e328'
[0m03:13:33.696847 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_price_dollars.4dd5734042'
[0m03:13:33.697516 [debug] [Thread-1 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:13:33.698553 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_selling_proposition.729cd62036'
[0m03:13:33.699300 [debug] [Thread-2 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25
[0m03:13:33.700435 [debug] [Thread-3 (]: Began compiling node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e
[0m03:13:33.701304 [debug] [Thread-4 (]: Began compiling node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:13:33.702376 [debug] [Thread-5 (]: Began compiling node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:13:33.708134 [debug] [Thread-1 (]: Timing info for test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9 (compile): 03:13:33.703195 => 03:13:33.707743
[0m03:13:33.708756 [debug] [Thread-6 (]: Began compiling node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:13:33.713613 [debug] [Thread-2 (]: Timing info for test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25 (compile): 03:13:33.709530 => 03:13:33.713341
[0m03:13:33.719836 [debug] [Thread-3 (]: Timing info for test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e (compile): 03:13:33.714523 => 03:13:33.719348
[0m03:13:33.729113 [debug] [Thread-4 (]: Writing injected SQL for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:13:33.733813 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:13:33.740447 [debug] [Thread-6 (]: Writing injected SQL for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:13:33.745693 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_type_check_int_products_discount__float (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:33.747947 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_type_check_int_products_price_dollars__float (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:33.749253 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_type_check_int_products_selling_proposition__number (models/intermediate/generic_test.yml)
  'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:33.750757 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_type_check_int_products_discount__float ................. [[31mERROR[0m in 0.06s]
[0m03:13:33.751695 [error] [Thread-2 (]: 2 of 6 ERROR dbt_utils_type_check_int_products_price_dollars__float ............ [[31mERROR[0m in 0.06s]
[0m03:13:33.753213 [error] [Thread-3 (]: 3 of 6 ERROR dbt_utils_type_check_int_products_selling_proposition__number ..... [[31mERROR[0m in 0.06s]
[0m03:13:33.754751 [debug] [Thread-1 (]: Finished running node test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9
[0m03:13:33.755812 [debug] [Thread-2 (]: Finished running node test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25
[0m03:13:33.756807 [debug] [Thread-3 (]: Finished running node test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e
[0m03:13:33.761183 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (compile): 03:13:33.735850 => 03:13:33.760710
[0m03:13:33.762054 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (compile): 03:13:33.720251 => 03:13:33.761740
[0m03:13:33.762801 [debug] [Thread-6 (]: Began executing node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:13:33.763956 [debug] [Thread-4 (]: Began executing node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:13:33.764980 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (compile): 03:13:33.729738 => 03:13:33.764671
[0m03:13:33.794260 [debug] [Thread-4 (]: Writing runtime sql for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:13:33.794758 [debug] [Thread-5 (]: Began executing node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:13:33.795716 [debug] [Thread-6 (]: Writing runtime sql for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:13:33.803566 [debug] [Thread-5 (]: Writing runtime sql for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:13:33.811016 [debug] [Thread-4 (]: Using snowflake connection "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:13:33.812624 [debug] [Thread-5 (]: Using snowflake connection "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:13:33.813657 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_discount.0b2d52e328"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select discount
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where discount is null



      
    ) dbt_internal_test
[0m03:13:33.814978 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_price_dollars.4dd5734042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_dollars
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where price_dollars is null



      
    ) dbt_internal_test
[0m03:13:33.816191 [debug] [Thread-6 (]: Using snowflake connection "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:13:33.816776 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:13:33.817861 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m03:13:33.818832 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_selling_proposition.729cd62036"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select selling_proposition
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where selling_proposition is null



      
    ) dbt_internal_test
[0m03:13:33.822860 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m03:13:34.355112 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:13:34.361716 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (execute): 03:13:33.775957 => 03:13:34.361448
[0m03:13:34.362415 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: Close
[0m03:13:34.463985 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_products_discount ..................................... [[32mPASS[0m in 0.77s]
[0m03:13:34.465186 [debug] [Thread-4 (]: Finished running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:13:35.303182 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:13:35.305464 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (execute): 03:13:33.796621 => 03:13:35.305235
[0m03:13:35.306034 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: Close
[0m03:13:35.406315 [info ] [Thread-5 (]: 5 of 6 PASS not_null_int_products_price_dollars ................................ [[32mPASS[0m in 1.71s]
[0m03:13:35.407582 [debug] [Thread-5 (]: Finished running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:13:35.570827 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m03:13:35.573239 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (execute): 03:13:33.765350 => 03:13:35.572965
[0m03:13:35.573973 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: Close
[0m03:13:35.680472 [info ] [Thread-6 (]: 6 of 6 PASS not_null_int_products_selling_proposition .......................... [[32mPASS[0m in 1.98s]
[0m03:13:35.681559 [debug] [Thread-6 (]: Finished running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:13:35.685130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:35.685707 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_discount__float.b8101bf4d9' was properly closed.
[0m03:13:35.686095 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_selling_proposition__number.543408e22e' was properly closed.
[0m03:13:35.686464 [debug] [MainThread]: Connection 'test.transform.dbt_utils_type_check_int_products_price_dollars__float.e3739a8b25' was properly closed.
[0m03:13:35.686826 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_discount.0b2d52e328' was properly closed.
[0m03:13:35.687228 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_price_dollars.4dd5734042' was properly closed.
[0m03:13:35.687725 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_selling_proposition.729cd62036' was properly closed.
[0m03:13:35.688304 [info ] [MainThread]: 
[0m03:13:35.689163 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m03:13:35.691102 [debug] [MainThread]: Command end result
[0m03:13:35.705145 [info ] [MainThread]: 
[0m03:13:35.706222 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:13:35.707278 [info ] [MainThread]: 
[0m03:13:35.708654 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_discount__float (models/intermediate/generic_test.yml)[0m
[0m03:13:35.710048 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:35.711641 [info ] [MainThread]: 
[0m03:13:35.713316 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_price_dollars__float (models/intermediate/generic_test.yml)[0m
[0m03:13:35.714316 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:35.715320 [info ] [MainThread]: 
[0m03:13:35.716289 [error] [MainThread]: [33mCompilation Error in test dbt_utils_type_check_int_products_selling_proposition__number (models/intermediate/generic_test.yml)[0m
[0m03:13:35.717251 [error] [MainThread]:   'dict object' has no attribute 'test_type_check'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:35.718246 [info ] [MainThread]: 
[0m03:13:35.719694 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m03:13:35.720994 [debug] [MainThread]: Command `dbt test` failed at 03:13:35.720799 after 4.44 seconds
[0m03:13:35.721678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0774bb7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07493b17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07491daae0>]}
[0m03:13:35.722342 [debug] [MainThread]: Flushing usage events
[0m03:16:09.868735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7b82de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c838f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c915f5f0>]}


============================== 03:16:09.870652 | 6c87f703-afb6-471c-b53d-060f3e5a2362 ==============================
[0m03:16:09.870652 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:16:09.871500 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m03:16:10.524812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7eae870>]}
[0m03:16:10.542086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a049cb60>]}
[0m03:16:10.574179 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m03:16:11.647657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:16:11.648549 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/generic_test.yml
[0m03:16:11.670274 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m03:16:11.695417 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m03:16:11.821515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a23c76e0>]}
[0m03:16:11.837484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a02a5490>]}
[0m03:16:11.838156 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 437 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:16:11.838935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a0f98d10>]}
[0m03:16:11.841108 [info ] [MainThread]: 
[0m03:16:11.842605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:16:11.844749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m03:16:11.845771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m03:16:11.852247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m03:16:11.859047 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m03:16:11.861787 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m03:16:11.864661 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m03:16:11.865584 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m03:16:11.866437 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m03:16:11.867414 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m03:16:11.868154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:11.868833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:11.869682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:12.553544 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:16:12.555640 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m03:16:12.559848 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:16:12.561588 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m03:16:12.564763 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m03:16:12.566717 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m03:16:12.954512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c87f703-afb6-471c-b53d-060f3e5a2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a02a4b90>]}
[0m03:16:12.955580 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:16:12.956583 [info ] [MainThread]: 
[0m03:16:12.963358 [debug] [Thread-1 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:16:12.963930 [debug] [Thread-2 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:16:12.964389 [debug] [Thread-3 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:16:12.965311 [debug] [Thread-4 (]: Began running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:16:12.965976 [debug] [Thread-5 (]: Began running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:16:12.964870 [info ] [Thread-1 (]: 1 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float  [RUN]
[0m03:16:12.966838 [debug] [Thread-6 (]: Began running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:16:12.967587 [info ] [Thread-2 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float  [RUN]
[0m03:16:12.968777 [info ] [Thread-3 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number  [RUN]
[0m03:16:12.970131 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_products_discount ............................... [RUN]
[0m03:16:12.971333 [info ] [Thread-5 (]: 5 of 6 START test not_null_int_products_price_dollars .......................... [RUN]
[0m03:16:12.973234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4)
[0m03:16:12.974168 [info ] [Thread-6 (]: 6 of 6 START test not_null_int_products_selling_proposition .................... [RUN]
[0m03:16:12.975499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77)
[0m03:16:12.976906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237)
[0m03:16:12.978214 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_discount.0b2d52e328'
[0m03:16:12.979657 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_price_dollars.4dd5734042'
[0m03:16:12.980728 [debug] [Thread-1 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:16:12.982033 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_selling_proposition.729cd62036'
[0m03:16:12.983038 [debug] [Thread-2 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:16:12.983855 [debug] [Thread-3 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:16:12.984905 [debug] [Thread-4 (]: Began compiling node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:16:12.985775 [debug] [Thread-5 (]: Began compiling node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:16:12.991309 [debug] [Thread-1 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4 (compile): 03:16:12.986300 => 03:16:12.991020
[0m03:16:12.991772 [debug] [Thread-6 (]: Began compiling node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:16:12.996964 [debug] [Thread-2 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77 (compile): 03:16:12.992336 => 03:16:12.996676
[0m03:16:13.001778 [debug] [Thread-3 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237 (compile): 03:16:12.997702 => 03:16:13.001522
[0m03:16:13.011023 [debug] [Thread-4 (]: Writing injected SQL for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:16:13.015168 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:16:13.020931 [debug] [Thread-6 (]: Writing injected SQL for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:16:13.027648 [debug] [Thread-2 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float (models/intermediate/generic_test.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.029038 [debug] [Thread-3 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number (models/intermediate/generic_test.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.030745 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float (models/intermediate/generic_test.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.031753 [error] [Thread-2 (]: 2 of 6 ERROR dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float  [[31mERROR[0m in 0.06s]
[0m03:16:13.032848 [error] [Thread-3 (]: 3 of 6 ERROR dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number  [[31mERROR[0m in 0.06s]
[0m03:16:13.034809 [error] [Thread-1 (]: 1 of 6 ERROR dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float  [[31mERROR[0m in 0.06s]
[0m03:16:13.036575 [debug] [Thread-2 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:16:13.037619 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (compile): 03:16:13.002516 => 03:16:13.037313
[0m03:16:13.038295 [debug] [Thread-3 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:16:13.039464 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (compile): 03:16:13.017233 => 03:16:13.038935
[0m03:16:13.040367 [debug] [Thread-1 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:16:13.041345 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (compile): 03:16:13.011507 => 03:16:13.040802
[0m03:16:13.042582 [debug] [Thread-4 (]: Began executing node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:16:13.043884 [debug] [Thread-6 (]: Began executing node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:16:13.045062 [debug] [Thread-5 (]: Began executing node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:16:13.068172 [debug] [Thread-6 (]: Writing runtime sql for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:16:13.069074 [debug] [Thread-4 (]: Writing runtime sql for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:16:13.073523 [debug] [Thread-5 (]: Writing runtime sql for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:16:13.081152 [debug] [Thread-6 (]: Using snowflake connection "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:16:13.081996 [debug] [Thread-4 (]: Using snowflake connection "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:16:13.082454 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_selling_proposition.729cd62036"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select selling_proposition
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where selling_proposition is null



      
    ) dbt_internal_test
[0m03:16:13.083213 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_discount.0b2d52e328"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select discount
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where discount is null



      
    ) dbt_internal_test
[0m03:16:13.084517 [debug] [Thread-5 (]: Using snowflake connection "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:16:13.085204 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m03:16:13.086335 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:16:13.087667 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_price_dollars.4dd5734042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_dollars
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where price_dollars is null



      
    ) dbt_internal_test
[0m03:16:13.092325 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m03:16:13.414797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:16:13.428760 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (execute): 03:16:13.045706 => 03:16:13.428032
[0m03:16:13.429719 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: Close
[0m03:16:13.546747 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_products_discount ..................................... [[32mPASS[0m in 0.57s]
[0m03:16:13.549095 [debug] [Thread-4 (]: Finished running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:16:13.552009 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:16:13.555812 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (execute): 03:16:13.069671 => 03:16:13.555411
[0m03:16:13.556859 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: Close
[0m03:16:13.576307 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:16:13.580385 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (execute): 03:16:13.061491 => 03:16:13.579944
[0m03:16:13.581432 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: Close
[0m03:16:13.664929 [info ] [Thread-5 (]: 5 of 6 PASS not_null_int_products_price_dollars ................................ [[32mPASS[0m in 0.69s]
[0m03:16:13.667130 [debug] [Thread-5 (]: Finished running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:16:13.691097 [info ] [Thread-6 (]: 6 of 6 PASS not_null_int_products_selling_proposition .......................... [[32mPASS[0m in 0.71s]
[0m03:16:13.692960 [debug] [Thread-6 (]: Finished running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:16:13.698793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:16:13.699948 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4' was properly closed.
[0m03:16:13.701389 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237' was properly closed.
[0m03:16:13.702200 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77' was properly closed.
[0m03:16:13.702961 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_discount.0b2d52e328' was properly closed.
[0m03:16:13.703791 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_price_dollars.4dd5734042' was properly closed.
[0m03:16:13.704663 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_selling_proposition.729cd62036' was properly closed.
[0m03:16:13.705860 [info ] [MainThread]: 
[0m03:16:13.707113 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m03:16:13.710373 [debug] [MainThread]: Command end result
[0m03:16:13.735680 [info ] [MainThread]: 
[0m03:16:13.737865 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:16:13.739609 [info ] [MainThread]: 
[0m03:16:13.742384 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float (models/intermediate/generic_test.yml)[0m
[0m03:16:13.745384 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.748551 [info ] [MainThread]: 
[0m03:16:13.750366 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number (models/intermediate/generic_test.yml)[0m
[0m03:16:13.752602 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.754725 [info ] [MainThread]: 
[0m03:16:13.755917 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float (models/intermediate/generic_test.yml)[0m
[0m03:16:13.757226 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:16:13.758812 [info ] [MainThread]: 
[0m03:16:13.761479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m03:16:13.763449 [debug] [MainThread]: Command `dbt test` failed at 03:16:13.763075 after 3.91 seconds
[0m03:16:13.764520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c8874ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c90eb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a23dc350>]}
[0m03:16:13.765393 [debug] [MainThread]: Flushing usage events
[0m03:17:44.875254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838deec590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c6ab680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838c6ab980>]}


============================== 03:17:44.877244 | 210bd4c1-7d40-403b-8712-79a0fb943141 ==============================
[0m03:17:44.877244 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:17:44.877973 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m03:17:44.910714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '210bd4c1-7d40-403b-8712-79a0fb943141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838cff5a30>]}
[0m03:17:44.990632 [debug] [MainThread]: Command `dbt clean` succeeded at 03:17:44.990462 after 0.14 seconds
[0m03:17:44.991256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838d4a15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838cb2d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838cb2d220>]}
[0m03:17:44.991841 [debug] [MainThread]: Flushing usage events
[0m03:17:47.636256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee70b82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee6f67470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee5f2cec0>]}


============================== 03:17:47.638260 | 463304e2-eda9-4889-88cf-1b3b00453a69 ==============================
[0m03:17:47.638260 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:17:47.639160 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/transform', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m03:17:47.667601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463304e2-eda9-4889-88cf-1b3b00453a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee67c46b0>]}
[0m03:17:47.671533 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9t10nbqu'
[0m03:17:47.672479 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:17:47.710021 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:17:47.710970 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:17:47.859841 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:17:47.863838 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:17:47.918119 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:17:47.921555 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package calogica/dbt_expectations
  Requested range: =0.8.7, =0.8.7
  Compatible versions: ['0.5.0', '0.5.1', '0.5.2', '0.5.3', '0.5.4', '0.5.5', '0.5.6', '0.5.7', '0.5.8', '0.6.0', '0.6.1', '0.7.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.9.0', '0.10.0', '0.10.1', '0.10.2', '0.10.3', '0.10.4']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m03:17:47.922644 [debug] [MainThread]: Command `dbt deps` failed at 03:17:47.922484 after 0.31 seconds
[0m03:17:47.923303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea05b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee5f9b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee5aaa480>]}
[0m03:17:47.924116 [debug] [MainThread]: Flushing usage events
[0m03:18:04.655619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fa26870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f038680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f5a8b00>]}


============================== 03:18:04.657694 | a6600e3e-3a14-4213-9b0f-a39007cf0b60 ==============================
[0m03:18:04.657694 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:18:04.658642 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/transform/logs', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_format': 'default', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True'}
[0m03:18:05.244267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6600e3e-3a14-4213-9b0f-a39007cf0b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f3e4aa0>]}
[0m03:18:05.262968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6600e3e-3a14-4213-9b0f-a39007cf0b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f3951af0>]}
[0m03:18:05.269681 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 1 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m03:18:05.270925 [debug] [MainThread]: Command `dbt test` failed at 03:18:05.270682 after 0.63 seconds
[0m03:18:05.272042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f39ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f8def4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70faf769c0>]}
[0m03:18:05.272868 [debug] [MainThread]: Flushing usage events
[0m03:18:14.870779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8c873c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8d91dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8d5facc0>]}


============================== 03:18:14.873053 | 4ebad235-086e-466c-9261-8437fa86ea20 ==============================
[0m03:18:14.873053 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:18:14.874201 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/transform/logs', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False'}
[0m03:18:15.498289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ebad235-086e-466c-9261-8437fa86ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf90d03ce0>]}
[0m03:18:15.514600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ebad235-086e-466c-9261-8437fa86ea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf654bf680>]}
[0m03:18:15.520334 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 1 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m03:18:15.521232 [debug] [MainThread]: Command `dbt test` failed at 03:18:15.521092 after 0.67 seconds
[0m03:18:15.521817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8cd9ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf8bee1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf65de12e0>]}
[0m03:18:15.522487 [debug] [MainThread]: Flushing usage events
[0m03:18:22.886229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223e67e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223e9a6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223e966180>]}


============================== 03:18:22.888142 | 5e53a048-e462-4f64-adc8-f198cb061f7a ==============================
[0m03:18:22.888142 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:18:22.888960 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/dags/transform/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform'}
[0m03:18:22.919017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e53a048-e462-4f64-adc8-f198cb061f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223f330a40>]}
[0m03:18:22.922619 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fh_vk42t'
[0m03:18:22.923627 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:18:23.022364 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:18:23.023515 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:18:23.189450 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:18:23.194095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:18:23.473865 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:18:23.477360 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package calogica/dbt_expectations
  Requested range: =0.8.7, =0.8.7
  Compatible versions: ['0.5.0', '0.5.1', '0.5.2', '0.5.3', '0.5.4', '0.5.5', '0.5.6', '0.5.7', '0.5.8', '0.6.0', '0.6.1', '0.7.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.9.0', '0.10.0', '0.10.1', '0.10.2', '0.10.3', '0.10.4']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m03:18:23.478595 [debug] [MainThread]: Command `dbt deps` failed at 03:18:23.478421 after 0.61 seconds
[0m03:18:23.479419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223e9cc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ebe70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ea0fd70>]}
[0m03:18:23.480135 [debug] [MainThread]: Flushing usage events
[0m03:19:44.860750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718da11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171cf5a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1719477f80>]}


============================== 03:19:44.862888 | 0475ed74-2ff3-430d-9a2d-8811bddf0bf5 ==============================
[0m03:19:44.862888 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:19:44.863989 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m03:19:44.892985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0475ed74-2ff3-430d-9a2d-8811bddf0bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718ecf620>]}
[0m03:19:44.896844 [debug] [MainThread]: Command `dbt clean` succeeded at 03:19:44.896517 after 0.06 seconds
[0m03:19:44.897600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718d6afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718ecf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1719d67b00>]}
[0m03:19:44.898262 [debug] [MainThread]: Flushing usage events
[0m03:19:50.576751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7a2d0>]}


============================== 03:19:50.578712 | 930fce85-7b8d-46d7-b137-050f0c867861 ==============================
[0m03:19:50.578712 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:19:50.579536 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/transform', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m03:19:50.609860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '930fce85-7b8d-46d7-b137-050f0c867861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7b020>]}
[0m03:19:50.613370 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jd2mhv90'
[0m03:19:50.614124 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:19:50.642715 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:19:50.643690 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:19:50.668855 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:19:50.672699 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:19:50.696599 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:19:50.699907 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:19:50.730128 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:19:50.739633 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:19:54.738522 [info ] [MainThread]: Installed from version 1.3.0
[0m03:19:54.739579 [info ] [MainThread]: Up to date!
[0m03:19:54.740726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '930fce85-7b8d-46d7-b137-050f0c867861', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7e30f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a90529f0>]}
[0m03:19:54.741642 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:19:58.414431 [info ] [MainThread]: Installed from version 0.10.4
[0m03:19:58.415135 [info ] [MainThread]: Up to date!
[0m03:19:58.416063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '930fce85-7b8d-46d7-b137-050f0c867861', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a87f2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7be30>]}
[0m03:19:58.416920 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:20:00.169287 [info ] [MainThread]: Installed from version 0.10.1
[0m03:20:00.170099 [info ] [MainThread]: Up to date!
[0m03:20:00.171218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '930fce85-7b8d-46d7-b137-050f0c867861', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7a7a870>]}
[0m03:20:00.173612 [debug] [MainThread]: Command `dbt deps` succeeded at 03:20:00.173400 after 9.62 seconds
[0m03:20:00.174229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a7e0af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a87f4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67a87f2ab0>]}
[0m03:20:00.174836 [debug] [MainThread]: Flushing usage events
[0m03:20:05.179462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29150bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2915fad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29155a8b00>]}


============================== 03:20:05.181422 | 4e967b8e-dad4-4a28-9684-a8656140d954 ==============================
[0m03:20:05.181422 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:20:05.182217 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m03:20:05.770797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2915e9ccb0>]}
[0m03:20:05.786717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28eda49070>]}
[0m03:20:05.851044 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m03:20:05.864633 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:20:05.865411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28edb2bb60>]}
[0m03:20:12.744206 [debug] [MainThread]: 1603: static parser failed on analytics/agg_category_performance.sql
[0m03:20:12.785385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/agg_category_performance.sql
[0m03:20:12.788797 [debug] [MainThread]: 1603: static parser failed on analytics/dim_category.sql
[0m03:20:12.798981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_category.sql
[0m03:20:12.805461 [debug] [MainThread]: 1699: static parser successfully parsed analytics/dim_products.sql
[0m03:20:12.811646 [debug] [MainThread]: 1699: static parser successfully parsed analytics/fact_products_performance.sql
[0m03:20:12.818034 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m03:20:12.832194 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m03:20:12.835014 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_products.sql
[0m03:20:13.011651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c3d1cb00>]}
[0m03:20:13.034996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ed6d2de0>]}
[0m03:20:13.035751 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:20:13.036606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efa87560>]}
[0m03:20:13.038642 [info ] [MainThread]: 
[0m03:20:13.040115 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:20:13.042583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema'
[0m03:20:13.044143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m03:20:13.056020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m03:20:13.060822 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m03:20:13.064798 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m03:20:13.068220 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m03:20:13.068942 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m03:20:13.069720 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m03:20:13.070546 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m03:20:13.071330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:13.071980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:13.072583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:14.281092 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:20:14.282820 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m03:20:14.285234 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m03:20:14.288725 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m03:20:14.292063 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:20:14.293812 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m03:20:14.409994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e967b8e-dad4-4a28-9684-a8656140d954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ed6d1280>]}
[0m03:20:14.411121 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m03:20:14.411828 [info ] [MainThread]: 
[0m03:20:14.422276 [debug] [Thread-1 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:20:14.423089 [debug] [Thread-2 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:20:14.423846 [debug] [Thread-3 (]: Began running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:20:14.424715 [debug] [Thread-4 (]: Began running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:20:14.425324 [debug] [Thread-5 (]: Began running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:20:14.424325 [info ] [Thread-1 (]: 1 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float  [RUN]
[0m03:20:14.426277 [debug] [Thread-6 (]: Began running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:20:14.426980 [info ] [Thread-2 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float  [RUN]
[0m03:20:14.427956 [info ] [Thread-3 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number  [RUN]
[0m03:20:14.428977 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_products_discount ............................... [RUN]
[0m03:20:14.430040 [info ] [Thread-5 (]: 5 of 6 START test not_null_int_products_price_dollars .......................... [RUN]
[0m03:20:14.431217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4)
[0m03:20:14.432026 [info ] [Thread-6 (]: 6 of 6 START test not_null_int_products_selling_proposition .................... [RUN]
[0m03:20:14.433055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77)
[0m03:20:14.434101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237)
[0m03:20:14.435573 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_discount.0b2d52e328'
[0m03:20:14.437214 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_price_dollars.4dd5734042'
[0m03:20:14.438244 [debug] [Thread-1 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:20:14.439658 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.transform.not_null_int_products_selling_proposition.729cd62036'
[0m03:20:14.440611 [debug] [Thread-2 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:20:14.441400 [debug] [Thread-3 (]: Began compiling node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:20:14.442028 [debug] [Thread-4 (]: Began compiling node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:20:14.442624 [debug] [Thread-5 (]: Began compiling node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:20:14.453841 [debug] [Thread-6 (]: Began compiling node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:20:14.456563 [debug] [Thread-1 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"
[0m03:20:14.464857 [debug] [Thread-2 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"
[0m03:20:14.471952 [debug] [Thread-3 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"
[0m03:20:14.482664 [debug] [Thread-4 (]: Writing injected SQL for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:20:14.487042 [debug] [Thread-5 (]: Writing injected SQL for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:20:14.493692 [debug] [Thread-6 (]: Writing injected SQL for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:20:14.494201 [debug] [Thread-1 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"} */
describe table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
[0m03:20:14.494931 [debug] [Thread-2 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"} */
describe table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
[0m03:20:14.495585 [debug] [Thread-3 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"} */
describe table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
[0m03:20:14.497828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:20:14.498984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:20:14.499851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:20:14.521475 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (compile): 03:20:14.472709 => 03:20:14.521155
[0m03:20:14.522188 [debug] [Thread-4 (]: Began executing node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:20:14.542134 [debug] [Thread-4 (]: Writing runtime sql for node "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:20:14.544007 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (compile): 03:20:14.487815 => 03:20:14.543404
[0m03:20:14.545143 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (compile): 03:20:14.483163 => 03:20:14.544769
[0m03:20:14.545849 [debug] [Thread-6 (]: Began executing node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:20:14.548163 [debug] [Thread-5 (]: Began executing node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:20:14.553713 [debug] [Thread-6 (]: Writing runtime sql for node "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:20:14.558310 [debug] [Thread-5 (]: Writing runtime sql for node "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:20:14.574494 [debug] [Thread-4 (]: Using snowflake connection "test.transform.not_null_int_products_discount.0b2d52e328"
[0m03:20:14.575473 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_discount.0b2d52e328"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select discount
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where discount is null



      
    ) dbt_internal_test
[0m03:20:14.576231 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:20:14.578243 [debug] [Thread-6 (]: Using snowflake connection "test.transform.not_null_int_products_selling_proposition.729cd62036"
[0m03:20:14.579635 [debug] [Thread-5 (]: Using snowflake connection "test.transform.not_null_int_products_price_dollars.4dd5734042"
[0m03:20:14.580121 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_selling_proposition.729cd62036"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select selling_proposition
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where selling_proposition is null



      
    ) dbt_internal_test
[0m03:20:14.580899 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.not_null_int_products_price_dollars.4dd5734042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_dollars
from E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
where price_dollars is null



      
    ) dbt_internal_test
[0m03:20:14.581752 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m03:20:14.582656 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m03:20:14.935668 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.0 seconds
[0m03:20:14.949810 [debug] [Thread-3 (]: Writing injected SQL for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"
[0m03:20:14.958784 [debug] [Thread-3 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237 (compile): 03:20:14.465264 => 03:20:14.958431
[0m03:20:14.959435 [debug] [Thread-3 (]: Began executing node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:20:14.962742 [debug] [Thread-3 (]: Writing runtime sql for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"
[0m03:20:14.972672 [debug] [Thread-3 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"
[0m03:20:14.973514 [debug] [Thread-3 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('SK_ID' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('TITLE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('GOODS_TITLE_LINK_JUMP' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CATEGORY' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_TITLE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_SUB' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE_DOLLARS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('DISCOUNT' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('SELLING_PROPOSITION' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('COLOR_COUNTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('BLACKFRIDAY_SAVINGS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'SELLING_PROPOSITION'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:20:14.996083 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:20:15.003554 [debug] [Thread-5 (]: Timing info for test.transform.not_null_int_products_price_dollars.4dd5734042 (execute): 03:20:14.555249 => 03:20:15.003275
[0m03:20:15.004378 [debug] [Thread-5 (]: On test.transform.not_null_int_products_price_dollars.4dd5734042: Close
[0m03:20:15.016588 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 1.0 seconds
[0m03:20:15.026829 [debug] [Thread-1 (]: Writing injected SQL for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"
[0m03:20:15.036420 [debug] [Thread-1 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4 (compile): 03:20:14.443083 => 03:20:15.036063
[0m03:20:15.037243 [debug] [Thread-1 (]: Began executing node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:20:15.041011 [debug] [Thread-1 (]: Writing runtime sql for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"
[0m03:20:15.054110 [debug] [Thread-1 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"
[0m03:20:15.054835 [debug] [Thread-1 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('SK_ID' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('TITLE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('GOODS_TITLE_LINK_JUMP' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CATEGORY' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_TITLE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_SUB' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE_DOLLARS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('DISCOUNT' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('SELLING_PROPOSITION' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('COLOR_COUNTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('BLACKFRIDAY_SAVINGS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'DISCOUNT'
            and
            relation_column_type not in ('FLOAT')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:20:15.117282 [info ] [Thread-5 (]: 5 of 6 PASS not_null_int_products_price_dollars ................................ [[32mPASS[0m in 0.68s]
[0m03:20:15.118765 [debug] [Thread-5 (]: Finished running node test.transform.not_null_int_products_price_dollars.4dd5734042
[0m03:20:15.274751 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:20:15.277594 [debug] [Thread-4 (]: Timing info for test.transform.not_null_int_products_discount.0b2d52e328 (execute): 03:20:14.522639 => 03:20:15.277232
[0m03:20:15.278329 [debug] [Thread-4 (]: On test.transform.not_null_int_products_discount.0b2d52e328: Close
[0m03:20:15.308486 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 1.0 seconds
[0m03:20:15.324594 [debug] [Thread-2 (]: Writing injected SQL for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"
[0m03:20:15.326154 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:20:15.329431 [debug] [Thread-6 (]: Timing info for test.transform.not_null_int_products_selling_proposition.729cd62036 (execute): 03:20:14.549549 => 03:20:15.329100
[0m03:20:15.330806 [debug] [Thread-6 (]: On test.transform.not_null_int_products_selling_proposition.729cd62036: Close
[0m03:20:15.338201 [debug] [Thread-2 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77 (compile): 03:20:14.457300 => 03:20:15.337841
[0m03:20:15.338836 [debug] [Thread-2 (]: Began executing node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:20:15.343574 [debug] [Thread-2 (]: Writing runtime sql for node "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"
[0m03:20:15.355490 [debug] [Thread-2 (]: Using snowflake connection "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"
[0m03:20:15.356321 [debug] [Thread-2 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('SK_ID' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('TITLE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('GOODS_TITLE_LINK_JUMP' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CATEGORY' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_TITLE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('RANK_SUB' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE_DOLLARS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('DISCOUNT' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        union all
        
        select
            cast('SELLING_PROPOSITION' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('COLOR_COUNTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('BLACKFRIDAY_SAVINGS' as TEXT) as relation_column,
            cast('FLOAT' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE_DOLLARS'
            and
            relation_column_type not in ('FLOAT')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m03:20:15.389498 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_products_discount ..................................... [[32mPASS[0m in 0.95s]
[0m03:20:15.392193 [debug] [Thread-4 (]: Finished running node test.transform.not_null_int_products_discount.0b2d52e328
[0m03:20:15.432109 [info ] [Thread-6 (]: 6 of 6 PASS not_null_int_products_selling_proposition .......................... [[32mPASS[0m in 0.99s]
[0m03:20:15.433845 [debug] [Thread-6 (]: Finished running node test.transform.not_null_int_products_selling_proposition.729cd62036
[0m03:20:15.529972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:20:15.533035 [debug] [Thread-1 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4 (execute): 03:20:15.037858 => 03:20:15.532680
[0m03:20:15.533832 [debug] [Thread-1 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4: Close
[0m03:20:15.659367 [info ] [Thread-1 (]: 1 of 6 PASS dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float  [[32mPASS[0m in 1.23s]
[0m03:20:15.661050 [debug] [Thread-1 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4
[0m03:20:15.722787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:20:15.725658 [debug] [Thread-2 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77 (execute): 03:20:15.339338 => 03:20:15.725316
[0m03:20:15.726567 [debug] [Thread-2 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77: Close
[0m03:20:15.836166 [info ] [Thread-2 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float  [[32mPASS[0m in 1.40s]
[0m03:20:15.837601 [debug] [Thread-2 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77
[0m03:20:16.043243 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:20:16.045857 [debug] [Thread-3 (]: Timing info for test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237 (execute): 03:20:14.959968 => 03:20:16.045555
[0m03:20:16.046780 [debug] [Thread-3 (]: On test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237: Close
[0m03:20:16.155952 [info ] [Thread-3 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number  [[32mPASS[0m in 1.72s]
[0m03:20:16.157244 [debug] [Thread-3 (]: Finished running node test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237
[0m03:20:16.161261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:20:16.161994 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_discount__float.7547b73ab4' was properly closed.
[0m03:20:16.162812 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_selling_proposition__number.7a88145237' was properly closed.
[0m03:20:16.163442 [debug] [MainThread]: Connection 'test.transform.dbt_expectations_expect_column_values_to_be_of_type_int_products_price_dollars__float.8312b9ab77' was properly closed.
[0m03:20:16.164271 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_discount.0b2d52e328' was properly closed.
[0m03:20:16.165027 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_price_dollars.4dd5734042' was properly closed.
[0m03:20:16.165603 [debug] [MainThread]: Connection 'test.transform.not_null_int_products_selling_proposition.729cd62036' was properly closed.
[0m03:20:16.166329 [info ] [MainThread]: 
[0m03:20:16.167248 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m03:20:16.169990 [debug] [MainThread]: Command end result
[0m03:20:16.196692 [info ] [MainThread]: 
[0m03:20:16.197831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:20:16.199131 [info ] [MainThread]: 
[0m03:20:16.200227 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m03:20:16.201592 [debug] [MainThread]: Command `dbt test` succeeded at 03:20:16.201305 after 8.29 seconds
[0m03:20:16.202333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29153e0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2915d866f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2918ef3b00>]}
[0m03:20:16.202965 [debug] [MainThread]: Flushing usage events
[0m03:54:52.669512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd537eabf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd537e39e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538343980>]}


============================== 03:54:52.671525 | de3866e0-4afe-4916-85d7-9c502ad2f482 ==============================
[0m03:54:52.671525 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:54:52.672518 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/transform/logs', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m03:54:52.702328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de3866e0-4afe-4916-85d7-9c502ad2f482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53c117740>]}
[0m03:54:52.705655 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-et1p_oyl'
[0m03:54:52.706346 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:54:52.845957 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:54:52.846909 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:54:52.908588 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:54:52.912594 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:54:52.937968 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:54:52.941465 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:54:52.966828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:54:52.975984 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:54:56.560947 [info ] [MainThread]: Installed from version 1.3.0
[0m03:54:56.561703 [info ] [MainThread]: Up to date!
[0m03:54:56.562669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'de3866e0-4afe-4916-85d7-9c502ad2f482', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538e99fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5388236b0>]}
[0m03:54:56.563358 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:55:00.260742 [info ] [MainThread]: Installed from version 0.10.4
[0m03:55:00.261506 [info ] [MainThread]: Up to date!
[0m03:55:00.262413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'de3866e0-4afe-4916-85d7-9c502ad2f482', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd537e3a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd537f278c0>]}
[0m03:55:00.263187 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:55:04.612459 [info ] [MainThread]: Installed from version 0.10.1
[0m03:55:04.613219 [info ] [MainThread]: Up to date!
[0m03:55:04.614195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'de3866e0-4afe-4916-85d7-9c502ad2f482', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd537e3a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538e99fa0>]}
[0m03:55:04.616277 [debug] [MainThread]: Command `dbt deps` succeeded at 03:55:04.616075 after 8.99 seconds
[0m03:55:04.616916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538d61ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5386fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53c117740>]}
[0m03:55:04.617559 [debug] [MainThread]: Flushing usage events
[0m03:57:49.828688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c876d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35cd128a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35cb5d1f0>]}


============================== 03:57:49.830751 | 2d4941ae-70c6-4a3c-9cdd-a380f6a86400 ==============================
[0m03:57:49.830751 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:57:49.831785 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/transform/logs', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False'}
[0m03:57:49.862653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4941ae-70c6-4a3c-9cdd-a380f6a86400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35cb5d1f0>]}
[0m03:57:49.866543 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6k8gjzrr'
[0m03:57:49.867411 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:57:50.022536 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:57:50.024101 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:57:50.061305 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:57:50.066068 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:57:50.129140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:57:50.133912 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:57:50.209332 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:57:50.222421 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:57:54.045439 [info ] [MainThread]: Installed from version 1.3.0
[0m03:57:54.046289 [info ] [MainThread]: Up to date!
[0m03:57:54.046873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d4941ae-70c6-4a3c-9cdd-a380f6a86400', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35d259760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35d6dab70>]}
[0m03:57:54.047312 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:57:57.620796 [info ] [MainThread]: Installed from version 0.10.4
[0m03:57:57.621726 [info ] [MainThread]: Up to date!
[0m03:57:57.622874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d4941ae-70c6-4a3c-9cdd-a380f6a86400', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35d259760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c923e60>]}
[0m03:57:57.623457 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:57:59.079022 [info ] [MainThread]: Installed from version 0.10.1
[0m03:57:59.079740 [info ] [MainThread]: Up to date!
[0m03:57:59.080279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d4941ae-70c6-4a3c-9cdd-a380f6a86400', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c923dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c923e60>]}
[0m03:57:59.082137 [debug] [MainThread]: Command `dbt deps` succeeded at 03:57:59.081943 after 9.28 seconds
[0m03:57:59.082788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35cbc85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35d7b79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35d1ab740>]}
[0m03:57:59.083592 [debug] [MainThread]: Flushing usage events
[0m19:47:09.205398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e55574c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e55b75cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e56f8cd10>]}


============================== 19:47:09.207536 | 9a9ec79f-f2c8-4f99-9b51-eee7cce931be ==============================
[0m19:47:09.207536 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:47:09.209102 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default'}
[0m19:47:09.236604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a9ec79f-f2c8-4f99-9b51-eee7cce931be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e55574890>]}
[0m19:47:09.240764 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-me7idh9s'
[0m19:47:09.242312 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:47:09.686163 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:47:09.689194 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:47:09.754689 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:47:09.761199 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m19:47:09.829584 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m19:47:09.836051 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m19:47:09.916594 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m19:47:09.929220 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:47:15.777017 [info ] [MainThread]: Installed from version 1.3.0
[0m19:47:15.779422 [info ] [MainThread]: Up to date!
[0m19:47:15.781276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9a9ec79f-f2c8-4f99-9b51-eee7cce931be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5557c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5557f310>]}
[0m19:47:15.782910 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m19:47:19.434510 [info ] [MainThread]: Installed from version 0.10.4
[0m19:47:19.435570 [info ] [MainThread]: Up to date!
[0m19:47:19.436568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9a9ec79f-f2c8-4f99-9b51-eee7cce931be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e55585710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e555850d0>]}
[0m19:47:19.437393 [info ] [MainThread]: Installing calogica/dbt_date
[0m19:47:24.512214 [info ] [MainThread]: Installed from version 0.10.1
[0m19:47:24.513129 [info ] [MainThread]: Up to date!
[0m19:47:24.514073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9a9ec79f-f2c8-4f99-9b51-eee7cce931be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e55576310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e555fd5d0>]}
[0m19:47:24.516868 [debug] [MainThread]: Command `dbt deps` succeeded at 19:47:24.516593 after 12.07 seconds
[0m19:47:24.518068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59a83e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59c3c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59b0efd0>]}
[0m19:47:24.519054 [debug] [MainThread]: Flushing usage events
[0m19:53:43.120660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd330c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd333110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd331e50>]}


============================== 19:53:43.123275 | 0595e8cf-0d25-4c5f-9e61-a30ceb3982ec ==============================
[0m19:53:43.123275 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:53:43.124896 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True'}
[0m19:53:43.151824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0595e8cf-0d25-4c5f-9e61-a30ceb3982ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd338390>]}
[0m19:53:43.155116 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vms9jdpg'
[0m19:53:43.156347 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:53:43.310752 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:53:43.313469 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:53:43.382204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:53:43.387754 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m19:53:43.457770 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m19:53:43.462821 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m19:53:43.525303 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m19:53:43.536988 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:53:46.859330 [info ] [MainThread]: Installed from version 1.3.0
[0m19:53:46.860364 [info ] [MainThread]: Up to date!
[0m19:53:46.861427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0595e8cf-0d25-4c5f-9e61-a30ceb3982ec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd367ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd364510>]}
[0m19:53:46.862409 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m19:53:50.006378 [info ] [MainThread]: Installed from version 0.10.4
[0m19:53:50.007519 [info ] [MainThread]: Up to date!
[0m19:53:50.008604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0595e8cf-0d25-4c5f-9e61-a30ceb3982ec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd31b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd31a290>]}
[0m19:53:50.009471 [info ] [MainThread]: Installing calogica/dbt_date
[0m19:53:51.265967 [info ] [MainThread]: Installed from version 0.10.1
[0m19:53:51.267308 [info ] [MainThread]: Up to date!
[0m19:53:51.268660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0595e8cf-0d25-4c5f-9e61-a30ceb3982ec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd31a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd31ad50>]}
[0m19:53:51.271114 [debug] [MainThread]: Command `dbt deps` succeeded at 19:53:51.270954 after 8.17 seconds
[0m19:53:51.272232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330183fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330183ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33018cb010>]}
[0m19:53:51.273303 [debug] [MainThread]: Flushing usage events
[0m20:04:34.135532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b77690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b77d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b76e50>]}


============================== 20:04:34.137583 | 9c487e5c-2899-4481-abfe-a48a45e38c8b ==============================
[0m20:04:34.137583 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:04:34.138788 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False'}
[0m20:04:34.165335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c487e5c-2899-4481-abfe-a48a45e38c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc847fe18d0>]}
[0m20:04:34.172531 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2zsoavmy'
[0m20:04:34.173795 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:04:34.339277 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:04:34.341836 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:04:34.410623 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:04:34.416218 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:04:34.481487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:04:34.486998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:04:34.545835 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:04:34.557007 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:04:37.921552 [info ] [MainThread]: Installed from version 1.3.0
[0m20:04:37.922601 [info ] [MainThread]: Up to date!
[0m20:04:37.923659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c487e5c-2899-4481-abfe-a48a45e38c8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b94b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b62f50>]}
[0m20:04:37.924728 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:04:41.498508 [info ] [MainThread]: Installed from version 0.10.4
[0m20:04:41.499828 [info ] [MainThread]: Up to date!
[0m20:04:41.501264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c487e5c-2899-4481-abfe-a48a45e38c8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846e12c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b94b90>]}
[0m20:04:41.502565 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:04:42.809621 [info ] [MainThread]: Installed from version 0.10.1
[0m20:04:42.811050 [info ] [MainThread]: Up to date!
[0m20:04:42.812651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c487e5c-2899-4481-abfe-a48a45e38c8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846e12c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc846b84ad0>]}
[0m20:04:42.815514 [debug] [MainThread]: Command `dbt deps` succeeded at 20:04:42.815293 after 8.70 seconds
[0m20:04:42.816955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84b073ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84b229090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84b0fd4d0>]}
[0m20:04:42.818163 [debug] [MainThread]: Flushing usage events
[0m20:09:36.172372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7509930c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75099322d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7509931e50>]}


============================== 20:09:36.174415 | 6b697017-2af0-48c7-87b7-6eb7d696255b ==============================
[0m20:09:36.174415 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:09:36.175670 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/transform/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m20:09:36.201875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b697017-2af0-48c7-87b7-6eb7d696255b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7509931e50>]}
[0m20:09:36.205667 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qcfbe72h'
[0m20:09:36.207005 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:09:36.380610 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:09:36.383341 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:09:36.450503 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:09:36.456148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:09:36.531465 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:09:36.536212 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:09:36.600141 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:09:36.611359 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:09:39.932973 [info ] [MainThread]: Installed from version 1.3.0
[0m20:09:39.933947 [info ] [MainThread]: Up to date!
[0m20:09:39.934912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b697017-2af0-48c7-87b7-6eb7d696255b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750993cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750993ed50>]}
[0m20:09:39.935662 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:09:43.039120 [info ] [MainThread]: Installed from version 0.10.4
[0m20:09:43.040951 [info ] [MainThread]: Up to date!
[0m20:09:43.042500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b697017-2af0-48c7-87b7-6eb7d696255b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750993ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750993cf10>]}
[0m20:09:43.044295 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:09:44.356415 [info ] [MainThread]: Installed from version 0.10.1
[0m20:09:44.357560 [info ] [MainThread]: Up to date!
[0m20:09:44.358782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b697017-2af0-48c7-87b7-6eb7d696255b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750996d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750996c550>]}
[0m20:09:44.360955 [debug] [MainThread]: Command `dbt deps` succeeded at 20:09:44.360802 after 8.21 seconds
[0m20:09:44.361962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750de3fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750de3ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750decb010>]}
[0m20:09:44.363058 [debug] [MainThread]: Flushing usage events
[0m20:18:44.977778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8698f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8693210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c869bb50>]}


============================== 20:18:44.979791 | f79d5c5f-bf47-422a-88fe-6c650ee1a9e7 ==============================
[0m20:18:44.979791 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:18:44.981251 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/dags/transform/logs', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m20:18:45.010198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f79d5c5f-bf47-422a-88fe-6c650ee1a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c86b2910>]}
[0m20:18:45.015160 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7bi8r8bu'
[0m20:18:45.016483 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:18:45.159113 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:18:45.161787 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:18:45.231307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:18:45.236779 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:18:45.305124 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:18:45.310014 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:18:45.375442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:18:45.386791 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:19:00.442823 [info ] [MainThread]: Installed from version 1.3.0
[0m20:19:00.444113 [info ] [MainThread]: Up to date!
[0m20:19:00.445233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f79d5c5f-bf47-422a-88fe-6c650ee1a9e7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c86a8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c86cf3d0>]}
[0m20:19:00.446296 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:19:04.708008 [info ] [MainThread]: Installed from version 0.10.4
[0m20:19:04.709042 [info ] [MainThread]: Up to date!
[0m20:19:04.710154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f79d5c5f-bf47-422a-88fe-6c650ee1a9e7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8692d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8692750>]}
[0m20:19:04.711491 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:19:06.089264 [info ] [MainThread]: Installed from version 0.10.1
[0m20:19:06.090603 [info ] [MainThread]: Up to date!
[0m20:19:06.092351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f79d5c5f-bf47-422a-88fe-6c650ee1a9e7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8692d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c8692750>]}
[0m20:19:06.094828 [debug] [MainThread]: Command `dbt deps` succeeded at 20:19:06.094552 after 17.89 seconds
[0m20:19:06.096211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c9b46310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cca1bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cca1bfd0>]}
[0m20:19:06.097449 [debug] [MainThread]: Flushing usage events
[0m20:23:03.338225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffef20c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfff982b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffef09e10>]}


============================== 20:23:03.340210 | 76d8e402-1563-4257-9451-dd834c0d0b47 ==============================
[0m20:23:03.340210 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:23:03.341737 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/transform', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/transform/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m20:23:03.891389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc000794c50>]}
[0m20:23:03.907445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd863ee50>]}
[0m20:23:03.963096 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:23:06.651876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:06.652811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:06.658507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd3e54f50>]}
[0m20:23:06.680634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffef208d0>]}
[0m20:23:06.681907 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:23:06.683517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffef2c950>]}
[0m20:23:06.685996 [info ] [MainThread]: 
[0m20:23:06.687995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:06.690775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:23:06.691678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:23:06.692548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m20:23:06.704429 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:23:06.707141 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:23:06.710468 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m20:23:06.712077 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:23:06.713282 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:23:06.714316 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m20:23:06.715559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:06.716598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:06.717508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:07.380586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:23:07.382573 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:23:07.399717 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:23:07.401836 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:23:07.494546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:23:07.496711 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m20:23:07.606621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m20:23:07.607593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m20:23:07.608433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m20:23:07.615253 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m20:23:07.618208 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m20:23:07.621958 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m20:23:07.623471 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m20:23:07.624830 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m20:23:07.626097 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m20:23:07.627516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:07.628753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:07.630024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:07.965506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:23:07.967565 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m20:23:08.100175 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:23:08.102128 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m20:23:08.106401 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:23:08.108563 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m20:23:08.218983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfffcd4ad0>]}
[0m20:23:08.220528 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m20:23:08.221977 [info ] [MainThread]: 
[0m20:23:08.229968 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m20:23:08.231523 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m20:23:08.233265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.stg_products)
[0m20:23:08.234644 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m20:23:08.238005 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m20:23:08.250265 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 20:23:08.236071 => 20:23:08.249896
[0m20:23:08.251652 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m20:23:08.277543 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m20:23:08.290457 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m20:23:08.291771 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m20:23:08.292932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:08.746168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:23:08.764808 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 20:23:08.252811 => 20:23:08.764630
[0m20:23:08.766383 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m20:23:08.872467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd3f439d0>]}
[0m20:23:08.874020 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.64s]
[0m20:23:08.876037 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m20:23:08.877957 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m20:23:08.879385 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m20:23:08.881324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m20:23:08.882790 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m20:23:08.898532 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m20:23:08.912416 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 20:23:08.884046 => 20:23:08.912108
[0m20:23:08.913578 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m20:23:08.933238 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m20:23:08.942958 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m20:23:08.944194 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m20:23:08.945660 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:23:11.664955 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:23:11.668322 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 20:23:08.914615 => 20:23:11.668136
[0m20:23:11.669823 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m20:23:11.777053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd3e88a10>]}
[0m20:23:11.778736 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.90s]
[0m20:23:11.780747 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m20:23:11.782692 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m20:23:11.784170 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m20:23:11.786814 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m20:23:11.788281 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m20:23:11.793403 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m20:23:11.805991 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 20:23:11.789496 => 20:23:11.805687
[0m20:23:11.807192 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m20:23:11.812170 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m20:23:11.824645 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m20:23:11.826037 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m20:23:11.827543 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:23:12.568667 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:23:12.572034 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 20:23:11.808225 => 20:23:12.571841
[0m20:23:12.573381 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m20:23:12.680211 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd237b310>]}
[0m20:23:12.681757 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 0.89s]
[0m20:23:12.683635 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m20:23:12.685688 [debug] [Thread-7 (]: Began running node model.transform.agg_category_performance
[0m20:23:12.686205 [debug] [Thread-8 (]: Began running node model.transform.dim_products
[0m20:23:12.687506 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m20:23:12.689135 [info ] [Thread-8 (]: 5 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m20:23:12.691353 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.agg_category_performance'
[0m20:23:12.693406 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m20:23:12.694991 [debug] [Thread-7 (]: Began compiling node model.transform.agg_category_performance
[0m20:23:12.696648 [debug] [Thread-8 (]: Began compiling node model.transform.dim_products
[0m20:23:12.702153 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m20:23:12.706253 [debug] [Thread-8 (]: Writing injected SQL for node "model.transform.dim_products"
[0m20:23:12.713722 [debug] [Thread-7 (]: Timing info for model.transform.agg_category_performance (compile): 20:23:12.697892 => 20:23:12.713273
[0m20:23:12.715158 [debug] [Thread-7 (]: Began executing node model.transform.agg_category_performance
[0m20:23:12.715895 [debug] [Thread-8 (]: Timing info for model.transform.dim_products (compile): 20:23:12.703062 => 20:23:12.715570
[0m20:23:12.719529 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m20:23:12.721122 [debug] [Thread-8 (]: Began executing node model.transform.dim_products
[0m20:23:12.725969 [debug] [Thread-8 (]: Writing runtime sql for node "model.transform.dim_products"
[0m20:23:12.731700 [debug] [Thread-7 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m20:23:12.733368 [debug] [Thread-7 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cols_to_keep AS
(
    SELECT 
        inttable.category AS category,
        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(discount), 2) AS avg_discount,
        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
    GROUP BY inttable.category
    ORDER BY avg_price_dollars DESC
),

id_generated AS 
(
    SELECT 
        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
        avg_price_dollars,
        avg_discount,
        avg_sold_proposition
    FROM cols_to_keep
)

SELECT 
    *       
FROM id_generated
        );
[0m20:23:12.734376 [debug] [Thread-8 (]: Using snowflake connection "model.transform.dim_products"
[0m20:23:12.735473 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:23:12.736863 [debug] [Thread-8 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m20:23:12.740762 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:23:14.455872 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:23:14.459176 [debug] [Thread-8 (]: Timing info for model.transform.dim_products (execute): 20:23:12.723174 => 20:23:14.458989
[0m20:23:14.460604 [debug] [Thread-8 (]: On model.transform.dim_products: Close
[0m20:23:14.563545 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd3cb2f10>]}
[0m20:23:14.565072 [info ] [Thread-8 (]: 5 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.87s]
[0m20:23:14.572976 [debug] [Thread-8 (]: Finished running node model.transform.dim_products
[0m20:23:15.047666 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:23:15.051789 [debug] [Thread-7 (]: Timing info for model.transform.agg_category_performance (execute): 20:23:12.716769 => 20:23:15.051487
[0m20:23:15.053382 [debug] [Thread-7 (]: On model.transform.agg_category_performance: Close
[0m20:23:15.162488 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd3f97d50>]}
[0m20:23:15.163997 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 2.47s]
[0m20:23:15.165819 [debug] [Thread-7 (]: Finished running node model.transform.agg_category_performance
[0m20:23:15.167722 [debug] [Thread-10 ]: Began running node model.transform.fact_products_performance
[0m20:23:15.168935 [info ] [Thread-10 ]: 6 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m20:23:15.170779 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m20:23:15.172096 [debug] [Thread-10 ]: Began compiling node model.transform.fact_products_performance
[0m20:23:15.176486 [debug] [Thread-10 ]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m20:23:15.183290 [debug] [Thread-10 ]: Timing info for model.transform.fact_products_performance (compile): 20:23:15.173163 => 20:23:15.182977
[0m20:23:15.184375 [debug] [Thread-10 ]: Began executing node model.transform.fact_products_performance
[0m20:23:15.188766 [debug] [Thread-10 ]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m20:23:15.196763 [debug] [Thread-10 ]: Using snowflake connection "model.transform.fact_products_performance"
[0m20:23:15.197996 [debug] [Thread-10 ]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    sk_id AS prod_id,
    ct.category_id,
    price_dollars,
    discount,
    selling_proposition,
    blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct
        );
[0m20:23:15.199302 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:23:16.206424 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:23:16.210024 [debug] [Thread-10 ]: Timing info for model.transform.fact_products_performance (execute): 20:23:15.185574 => 20:23:16.209847
[0m20:23:16.211437 [debug] [Thread-10 ]: On model.transform.fact_products_performance: Close
[0m20:23:16.313351 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d8e402-1563-4257-9451-dd834c0d0b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd2301810>]}
[0m20:23:16.314993 [info ] [Thread-10 ]: 6 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.14s]
[0m20:23:16.316733 [debug] [Thread-10 ]: Finished running node model.transform.fact_products_performance
[0m20:23:16.320267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:16.321445 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m20:23:16.322522 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m20:23:16.323634 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m20:23:16.324586 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m20:23:16.325425 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m20:23:16.326355 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m20:23:16.327088 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m20:23:16.328185 [info ] [MainThread]: 
[0m20:23:16.329868 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m20:23:16.332706 [debug] [MainThread]: Command end result
[0m20:23:16.358850 [info ] [MainThread]: 
[0m20:23:16.361428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:16.363333 [info ] [MainThread]: 
[0m20:23:16.365316 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:23:16.367471 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:16.367290 after 13.05 seconds
[0m20:23:16.368661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0033d3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003461310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003463a50>]}
[0m20:23:16.369960 [debug] [MainThread]: Flushing usage events
[0m20:31:36.602889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d819e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d8795b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d819fc90>]}


============================== 20:31:36.605739 | 6859b22c-9966-44fc-8f33-42e8ac24e03f ==============================
[0m20:31:36.605739 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:31:36.607895 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'profiles_dir': '/usr/local/airflow/dags/transform', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m20:31:36.641394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6859b22c-9966-44fc-8f33-42e8ac24e03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81a0c50>]}
[0m20:31:36.645530 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iwv1qx8a'
[0m20:31:36.647019 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:31:36.816290 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:31:36.820050 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:31:36.887232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:31:36.892801 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:31:36.953088 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:31:36.958764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:31:37.031431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:31:37.042675 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:31:44.618781 [info ] [MainThread]: Installed from version 1.3.0
[0m20:31:44.620002 [info ] [MainThread]: Up to date!
[0m20:31:44.621287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6859b22c-9966-44fc-8f33-42e8ac24e03f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d9ab8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81c72d0>]}
[0m20:31:44.622420 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:31:48.220064 [info ] [MainThread]: Installed from version 0.10.4
[0m20:31:48.221614 [info ] [MainThread]: Up to date!
[0m20:31:48.222879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6859b22c-9966-44fc-8f33-42e8ac24e03f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81e4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81a0590>]}
[0m20:31:48.225261 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:31:50.298899 [info ] [MainThread]: Installed from version 0.10.1
[0m20:31:50.300368 [info ] [MainThread]: Up to date!
[0m20:31:50.301834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6859b22c-9966-44fc-8f33-42e8ac24e03f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81e4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d81b0190>]}
[0m20:31:50.305236 [debug] [MainThread]: Command `dbt deps` succeeded at 20:31:50.304939 after 10.55 seconds
[0m20:31:50.306820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3dc6abe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3dc860fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3dc736f90>]}
[0m20:31:50.308111 [debug] [MainThread]: Flushing usage events
[0m20:39:02.774879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a0308c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a05a6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a030a090>]}


============================== 20:39:02.776964 | 0112b2e1-8898-4c11-90c2-d5706c388791 ==============================
[0m20:39:02.776964 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:39:02.778415 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform', 'debug': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None'}
[0m20:39:02.807295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0112b2e1-8898-4c11-90c2-d5706c388791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a030a950>]}
[0m20:39:02.810754 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q0hl524g'
[0m20:39:02.812080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:39:02.939442 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:39:02.942193 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:39:03.001302 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:39:03.007117 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m20:39:03.076549 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m20:39:03.081462 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m20:39:03.147812 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m20:39:03.158966 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:39:06.666723 [info ] [MainThread]: Installed from version 1.3.0
[0m20:39:06.667821 [info ] [MainThread]: Up to date!
[0m20:39:06.669291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0112b2e1-8898-4c11-90c2-d5706c388791', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a02ffa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a031c150>]}
[0m20:39:06.670475 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m20:39:11.228979 [info ] [MainThread]: Installed from version 0.10.4
[0m20:39:11.230265 [info ] [MainThread]: Up to date!
[0m20:39:11.231359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0112b2e1-8898-4c11-90c2-d5706c388791', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a02ffa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a02f1f90>]}
[0m20:39:11.232268 [info ] [MainThread]: Installing calogica/dbt_date
[0m20:39:12.625733 [info ] [MainThread]: Installed from version 0.10.1
[0m20:39:12.627137 [info ] [MainThread]: Up to date!
[0m20:39:12.628574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0112b2e1-8898-4c11-90c2-d5706c388791', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a02ffa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a031cb90>]}
[0m20:39:12.631123 [debug] [MainThread]: Command `dbt deps` succeeded at 20:39:12.630943 after 9.88 seconds
[0m20:39:12.632190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a4807ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a4892f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a48914d0>]}
[0m20:39:12.633141 [debug] [MainThread]: Flushing usage events
[0m02:54:08.576998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1756b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17557210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1756bf90>]}


============================== 02:54:08.579219 | 2826e185-3acf-4ac2-b10b-572bc65e3706 ==============================
[0m02:54:08.579219 [info ] [MainThread]: Running with dbt=1.5.0
[0m02:54:08.580691 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'introspect': 'True'}
[0m02:54:08.612004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2826e185-3acf-4ac2-b10b-572bc65e3706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17557fd0>]}
[0m02:54:08.615038 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_s703zof'
[0m02:54:08.616408 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:54:10.353488 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:54:10.356164 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:54:10.448852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:54:10.455276 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m02:54:10.526754 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m02:54:10.532601 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m02:54:10.606861 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m02:54:10.620746 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:54:17.604929 [info ] [MainThread]: Installed from version 1.3.0
[0m02:54:17.605840 [info ] [MainThread]: Up to date!
[0m02:54:17.606998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2826e185-3acf-4ac2-b10b-572bc65e3706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a18a09ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17577350>]}
[0m02:54:17.608025 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m02:54:21.433210 [info ] [MainThread]: Installed from version 0.10.4
[0m02:54:21.434339 [info ] [MainThread]: Up to date!
[0m02:54:21.435517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2826e185-3acf-4ac2-b10b-572bc65e3706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17574d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17556950>]}
[0m02:54:21.436918 [info ] [MainThread]: Installing calogica/dbt_date
[0m02:54:22.958946 [info ] [MainThread]: Installed from version 0.10.1
[0m02:54:22.960226 [info ] [MainThread]: Up to date!
[0m02:54:22.961486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2826e185-3acf-4ac2-b10b-572bc65e3706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17574d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a17556950>]}
[0m02:54:22.963635 [debug] [MainThread]: Command `dbt deps` succeeded at 02:54:22.963481 after 11.83 seconds
[0m02:54:22.964655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1b8dff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1ba94610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1b96b010>]}
[0m02:54:22.965670 [debug] [MainThread]: Flushing usage events
[0m03:06:24.998284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b5f6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8ccf0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b5ffe50>]}


============================== 03:06:25.000349 | f3389cd8-1eb7-402f-91ec-0fe1267de770 ==============================
[0m03:06:25.000349 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:06:25.001469 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m03:06:25.027584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3389cd8-1eb7-402f-91ec-0fe1267de770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b61e250>]}
[0m03:06:25.031349 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-19tyuqoc'
[0m03:06:25.032692 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:06:25.177002 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:06:25.179698 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:06:25.252838 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:06:25.258484 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:06:25.320775 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:06:25.326449 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:06:25.399117 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:06:25.418005 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:06:29.087001 [info ] [MainThread]: Installed from version 1.3.0
[0m03:06:29.088028 [info ] [MainThread]: Up to date!
[0m03:06:29.088997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3389cd8-1eb7-402f-91ec-0fe1267de770', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b634550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b451310>]}
[0m03:06:29.089888 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:06:33.165303 [info ] [MainThread]: Installed from version 0.10.4
[0m03:06:33.166643 [info ] [MainThread]: Up to date!
[0m03:06:33.168075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3389cd8-1eb7-402f-91ec-0fe1267de770', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b634550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b63b010>]}
[0m03:06:33.169278 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:06:34.483386 [info ] [MainThread]: Installed from version 0.10.1
[0m03:06:34.484753 [info ] [MainThread]: Up to date!
[0m03:06:34.486332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3389cd8-1eb7-402f-91ec-0fe1267de770', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b634250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8b49d850>]}
[0m03:06:34.489178 [debug] [MainThread]: Command `dbt deps` succeeded at 03:06:34.488996 after 9.51 seconds
[0m03:06:34.490706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8beb1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8f987f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8fa11490>]}
[0m03:06:34.492267 [debug] [MainThread]: Flushing usage events
[0m03:28:46.941298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede3994b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede29b3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede21760f0>]}


============================== 03:28:46.943462 | 9b5ef577-8239-458d-b97e-c1e6a83730ae ==============================
[0m03:28:46.943462 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:28:46.944562 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False'}
[0m03:28:46.974636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b5ef577-8239-458d-b97e-c1e6a83730ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede2fede20>]}
[0m03:28:46.977939 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-srecwhzs'
[0m03:28:46.978777 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:28:47.151237 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:28:47.152366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:28:47.296607 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:28:47.301212 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:28:47.362245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:28:47.365946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:28:47.433617 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:28:47.445741 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:28:51.316046 [info ] [MainThread]: Installed from version 1.3.0
[0m03:28:51.316819 [info ] [MainThread]: Up to date!
[0m03:28:51.317457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b5ef577-8239-458d-b97e-c1e6a83730ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede2044080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede20440b0>]}
[0m03:28:51.317900 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:28:54.738272 [info ] [MainThread]: Installed from version 0.10.4
[0m03:28:54.739002 [info ] [MainThread]: Up to date!
[0m03:28:54.739625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b5ef577-8239-458d-b97e-c1e6a83730ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede220bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede2208950>]}
[0m03:28:54.740112 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:28:56.097543 [info ] [MainThread]: Installed from version 0.10.1
[0m03:28:56.098248 [info ] [MainThread]: Up to date!
[0m03:28:56.098828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9b5ef577-8239-458d-b97e-c1e6a83730ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede220b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede220bda0>]}
[0m03:28:56.100498 [debug] [MainThread]: Command `dbt deps` succeeded at 03:28:56.100348 after 9.18 seconds
[0m03:28:56.101007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede25c75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede2fede20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede2922150>]}
[0m03:28:56.101467 [debug] [MainThread]: Flushing usage events
[0m03:38:06.622576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135ce0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51365ad430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51360eb050>]}


============================== 03:38:06.624551 | 5780fab4-b1c1-455e-b217-c92d8753170c ==============================
[0m03:38:06.624551 [info ] [MainThread]: Running with dbt=1.5.0
[0m03:38:06.625380 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_colors': 'True'}
[0m03:38:06.652960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5780fab4-b1c1-455e-b217-c92d8753170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135f4b320>]}
[0m03:38:06.656464 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-go53bh9y'
[0m03:38:06.657248 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:38:06.783661 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:38:06.784638 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:38:06.852029 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:38:06.856346 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m03:38:06.942555 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m03:38:06.946218 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m03:38:07.017623 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m03:38:07.027240 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:38:11.496624 [info ] [MainThread]: Installed from version 1.3.0
[0m03:38:11.497301 [info ] [MainThread]: Up to date!
[0m03:38:11.497830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5780fab4-b1c1-455e-b217-c92d8753170c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135c2e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135c2e810>]}
[0m03:38:11.498285 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m03:38:14.869197 [info ] [MainThread]: Installed from version 0.10.4
[0m03:38:14.869943 [info ] [MainThread]: Up to date!
[0m03:38:14.870689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5780fab4-b1c1-455e-b217-c92d8753170c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135cf4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135cf7500>]}
[0m03:38:14.871188 [info ] [MainThread]: Installing calogica/dbt_date
[0m03:38:16.181623 [info ] [MainThread]: Installed from version 0.10.1
[0m03:38:16.182409 [info ] [MainThread]: Up to date!
[0m03:38:16.183258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5780fab4-b1c1-455e-b217-c92d8753170c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135d14ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135d157c0>]}
[0m03:38:16.185296 [debug] [MainThread]: Command `dbt deps` succeeded at 03:38:16.185132 after 9.58 seconds
[0m03:38:16.185872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51360eac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135f4b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135fa7b60>]}
[0m03:38:16.186381 [debug] [MainThread]: Flushing usage events
[0m04:18:08.662910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd717a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd7932000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd74a6f90>]}


============================== 04:18:08.665524 | a3006c1b-d517-4d1f-9bdb-a0794eb50f1a ==============================
[0m04:18:08.665524 [info ] [MainThread]: Running with dbt=1.5.0
[0m04:18:08.666324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m04:18:08.695707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3006c1b-d517-4d1f-9bdb-a0794eb50f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd745da00>]}
[0m04:18:08.698942 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-33pp245o'
[0m04:18:08.699765 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:18:08.953391 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:18:08.954654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:18:09.036430 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:18:09.040490 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:18:09.110010 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:18:09.113582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:18:09.188040 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:18:09.197279 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:18:13.483004 [info ] [MainThread]: Installed from version 1.3.0
[0m04:18:13.483720 [info ] [MainThread]: Up to date!
[0m04:18:13.484336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3006c1b-d517-4d1f-9bdb-a0794eb50f1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd7227bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd7227da0>]}
[0m04:18:13.484822 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:18:17.649370 [info ] [MainThread]: Installed from version 0.10.4
[0m04:18:17.650133 [info ] [MainThread]: Up to date!
[0m04:18:17.650764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3006c1b-d517-4d1f-9bdb-a0794eb50f1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd71f7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd71f7e60>]}
[0m04:18:17.651267 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:18:19.123400 [info ] [MainThread]: Installed from version 0.10.1
[0m04:18:19.124156 [info ] [MainThread]: Up to date!
[0m04:18:19.125015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3006c1b-d517-4d1f-9bdb-a0794eb50f1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd7563b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd71f7d10>]}
[0m04:18:19.127552 [debug] [MainThread]: Command `dbt deps` succeeded at 04:18:19.127385 after 10.49 seconds
[0m04:18:19.128177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd8251d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd807d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd7563b90>]}
[0m04:18:19.128848 [debug] [MainThread]: Flushing usage events
[0m04:21:18.073676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939549730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939e08680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9395ba4b0>]}


============================== 04:21:18.075877 | dcf41920-deab-459b-9707-0f5d9b9dd616 ==============================
[0m04:21:18.075877 [info ] [MainThread]: Running with dbt=1.5.0
[0m04:21:18.076841 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/transform', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'version_check': 'True'}
[0m04:21:18.115098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcf41920-deab-459b-9707-0f5d9b9dd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93a45f2f0>]}
[0m04:21:18.118804 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cqqmzqc2'
[0m04:21:18.119727 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:21:18.285381 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:21:18.286655 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:21:18.349923 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:21:18.355113 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m04:21:18.424688 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m04:21:18.429973 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m04:21:18.712662 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m04:21:18.726412 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:21:23.166910 [info ] [MainThread]: Installed from version 1.3.0
[0m04:21:23.167737 [info ] [MainThread]: Up to date!
[0m04:21:23.168481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dcf41920-deab-459b-9707-0f5d9b9dd616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9399dc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939923230>]}
[0m04:21:23.169203 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m04:21:26.993805 [info ] [MainThread]: Installed from version 0.10.4
[0m04:21:26.994608 [info ] [MainThread]: Up to date!
[0m04:21:26.995426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dcf41920-deab-459b-9707-0f5d9b9dd616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939f559a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939f555b0>]}
[0m04:21:26.996464 [info ] [MainThread]: Installing calogica/dbt_date
[0m04:21:28.351217 [info ] [MainThread]: Installed from version 0.10.1
[0m04:21:28.351872 [info ] [MainThread]: Up to date!
[0m04:21:28.352456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dcf41920-deab-459b-9707-0f5d9b9dd616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939f555b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc939f559a0>]}
[0m04:21:28.354483 [debug] [MainThread]: Command `dbt deps` succeeded at 04:21:28.354269 after 10.30 seconds
[0m04:21:28.355016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93c13de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93a6d51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc93a1067b0>]}
[0m04:21:28.355621 [debug] [MainThread]: Flushing usage events
[0m05:27:06.370542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ab7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5a34b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f64b0b90>]}


============================== 05:27:06.373508 | f9891d99-ad1e-4d5e-b703-0d697cb10d22 ==============================
[0m05:27:06.373508 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:27:06.375090 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/dags/transform', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None'}
[0m05:27:06.413265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9891d99-ad1e-4d5e-b703-0d697cb10d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5d478c0>]}
[0m05:27:06.416187 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7l1_fh5a'
[0m05:27:06.417234 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:27:06.557046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:27:06.558443 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:27:06.622523 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:27:06.627101 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m05:27:06.695177 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m05:27:06.699250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m05:27:06.783471 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m05:27:06.796968 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:27:11.729498 [info ] [MainThread]: Installed from version 1.3.0
[0m05:27:11.730401 [info ] [MainThread]: Up to date!
[0m05:27:11.731219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9891d99-ad1e-4d5e-b703-0d697cb10d22', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5d47950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f63ae3f0>]}
[0m05:27:11.732008 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m05:27:16.314210 [debug] [MainThread]: External call exception: [SSL: DECRYPTION_FAILED_OR_BAD_RECORD_MAC] decryption failed or bad record mac (_ssl.c:2570)
[0m05:27:16.314760 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m05:27:23.407587 [info ] [MainThread]: Installed from version 0.10.4
[0m05:27:23.408571 [info ] [MainThread]: Up to date!
[0m05:27:23.409556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9891d99-ad1e-4d5e-b703-0d697cb10d22', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ad50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ad5430>]}
[0m05:27:23.410208 [info ] [MainThread]: Installing calogica/dbt_date
[0m05:27:26.322270 [info ] [MainThread]: Installed from version 0.10.1
[0m05:27:26.323446 [info ] [MainThread]: Up to date!
[0m05:27:26.324451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f9891d99-ad1e-4d5e-b703-0d697cb10d22', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ad5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ad50a0>]}
[0m05:27:26.328254 [debug] [MainThread]: Command `dbt deps` succeeded at 05:27:26.327633 after 17.42 seconds
[0m05:27:26.329794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f69ed0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f67c9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f5ab71d0>]}
[0m05:27:26.330834 [debug] [MainThread]: Flushing usage events
[0m05:37:09.221670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092ab7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092ab7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092ab7260>]}


============================== 05:37:09.223634 | 7fc09c62-7204-47c9-8912-d648bf9bab27 ==============================
[0m05:37:09.223634 [info ] [MainThread]: Running with dbt=1.5.0
[0m05:37:09.224366 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/transform/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m05:37:09.252431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc09c62-7204-47c9-8912-d648bf9bab27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092e48410>]}
[0m05:37:09.256054 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8g561uol'
[0m05:37:09.256856 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:37:09.488267 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:37:09.490150 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:37:09.608849 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:37:09.613030 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m05:37:09.716038 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m05:37:09.719434 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m05:37:09.823251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m05:37:09.832990 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:37:13.668803 [info ] [MainThread]: Installed from version 1.3.0
[0m05:37:13.669446 [info ] [MainThread]: Up to date!
[0m05:37:13.670006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7fc09c62-7204-47c9-8912-d648bf9bab27', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80937ba540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8093a31a60>]}
[0m05:37:13.670479 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m05:37:18.045775 [info ] [MainThread]: Installed from version 0.10.4
[0m05:37:18.046462 [info ] [MainThread]: Up to date!
[0m05:37:18.047031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7fc09c62-7204-47c9-8912-d648bf9bab27', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092d438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80937ba540>]}
[0m05:37:18.047500 [info ] [MainThread]: Installing calogica/dbt_date
[0m05:37:21.160456 [info ] [MainThread]: Installed from version 0.10.1
[0m05:37:21.161056 [info ] [MainThread]: Up to date!
[0m05:37:21.161605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7fc09c62-7204-47c9-8912-d648bf9bab27', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092d438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092e9f890>]}
[0m05:37:21.163377 [debug] [MainThread]: Command `dbt deps` succeeded at 05:37:21.163215 after 11.96 seconds
[0m05:37:21.163937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8093acd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8093481460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8092ed1580>]}
[0m05:37:21.164409 [debug] [MainThread]: Flushing usage events
[0m06:16:18.224100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6ca7b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6dfe6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6d7e2e70>]}


============================== 06:16:18.226067 | 276552a2-4b4d-439d-a424-b4e8dc8d6bef ==============================
[0m06:16:18.226067 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:16:18.226888 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_cache_events': 'False'}
[0m06:16:18.254990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '276552a2-4b4d-439d-a424-b4e8dc8d6bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cdcca10>]}
[0m06:16:18.258233 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x439171j'
[0m06:16:18.258996 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:16:18.360348 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:16:18.361364 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:16:18.389648 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:16:18.393633 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m06:16:18.418238 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m06:16:18.421475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m06:16:18.447289 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m06:16:18.456483 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:16:25.347244 [info ] [MainThread]: Installed from version 1.3.0
[0m06:16:25.347941 [info ] [MainThread]: Up to date!
[0m06:16:25.348496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '276552a2-4b4d-439d-a424-b4e8dc8d6bef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cda6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6d3faf00>]}
[0m06:16:25.348926 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m06:16:28.541268 [info ] [MainThread]: Installed from version 0.10.4
[0m06:16:28.542005 [info ] [MainThread]: Up to date!
[0m06:16:28.542681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '276552a2-4b4d-439d-a424-b4e8dc8d6bef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cac7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cac5970>]}
[0m06:16:28.543121 [info ] [MainThread]: Installing calogica/dbt_date
[0m06:16:29.801889 [info ] [MainThread]: Installed from version 0.10.1
[0m06:16:29.802701 [info ] [MainThread]: Up to date!
[0m06:16:29.803302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '276552a2-4b4d-439d-a424-b4e8dc8d6bef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cac56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cac7c20>]}
[0m06:16:29.804840 [debug] [MainThread]: Command `dbt deps` succeeded at 06:16:29.804703 after 8.50 seconds
[0m06:16:29.805292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6db04230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6d214b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6dc203b0>]}
[0m06:16:29.805757 [debug] [MainThread]: Flushing usage events
[0m06:27:29.975867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b92e77b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b95787110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b931a0b00>]}


============================== 06:27:29.977880 | c9bcba68-6bc2-46a9-846d-acec2c9aa295 ==============================
[0m06:27:29.977880 [info ] [MainThread]: Running with dbt=1.5.0
[0m06:27:29.978613 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default'}
[0m06:27:30.006868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bcba68-6bc2-46a9-846d-acec2c9aa295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b93791ac0>]}
[0m06:27:30.009504 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tvd7hybz'
[0m06:27:30.010186 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:27:30.290920 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:27:30.291999 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:27:30.346629 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:27:30.350533 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m06:27:30.428450 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m06:27:30.431765 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m06:27:30.493826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m06:27:30.503949 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:27:34.119362 [info ] [MainThread]: Installed from version 1.3.0
[0m06:27:34.120112 [info ] [MainThread]: Up to date!
[0m06:27:34.120742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9bcba68-6bc2-46a9-846d-acec2c9aa295', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b931072c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b931da510>]}
[0m06:27:34.121176 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m06:27:37.510185 [info ] [MainThread]: Installed from version 0.10.4
[0m06:27:37.510898 [info ] [MainThread]: Up to date!
[0m06:27:37.511701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9bcba68-6bc2-46a9-846d-acec2c9aa295', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b931da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9322e4b0>]}
[0m06:27:37.512508 [info ] [MainThread]: Installing calogica/dbt_date
[0m06:27:38.783374 [info ] [MainThread]: Installed from version 0.10.1
[0m06:27:38.784001 [info ] [MainThread]: Up to date!
[0m06:27:38.784506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9bcba68-6bc2-46a9-846d-acec2c9aa295', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b931072c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b933df230>]}
[0m06:27:38.785930 [debug] [MainThread]: Command `dbt deps` succeeded at 06:27:38.785804 after 8.84 seconds
[0m06:27:38.786333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b93791ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b937d9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b93364a70>]}
[0m06:27:38.786708 [debug] [MainThread]: Flushing usage events
[0m08:31:16.859307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3a60f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3a711520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3a6aa870>]}


============================== 08:31:16.861971 | fe6f9c64-a400-468e-be69-6fc6955f5ad3 ==============================
[0m08:31:16.861971 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:31:16.862873 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/dags/transform', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80'}
[0m08:31:17.532332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3abd6150>]}
[0m08:31:17.552123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0ee830b0>]}
[0m08:31:17.615763 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:31:20.456854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:31:20.457617 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/fact_products_performance.sql
[0m08:31:20.458071 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m08:31:20.482336 [debug] [MainThread]: 1699: static parser successfully parsed analytics/fact_products_performance.sql
[0m08:31:20.494542 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m08:31:20.582593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e14ba6ba0>]}
[0m08:31:20.601576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0ea94650>]}
[0m08:31:20.602564 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:31:20.603661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0fe04b60>]}
[0m08:31:20.606395 [info ] [MainThread]: 
[0m08:31:20.607804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:31:20.609604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:31:20.610581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:31:20.617118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:31:20.625773 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:31:20.628892 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:31:20.631750 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:31:20.632534 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:31:20.633230 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:31:20.633958 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:31:20.634806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:20.635528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:20.636145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:21.624974 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:31:21.625868 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:31:21.627980 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:31:21.631137 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:31:21.707026 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:31:21.708860 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:31:21.831969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m08:31:21.833342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m08:31:21.842746 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m08:31:21.843966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m08:31:21.847639 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m08:31:21.848803 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m08:31:21.853124 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m08:31:21.854146 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m08:31:21.855233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:21.856410 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m08:31:21.857742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:21.861410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:22.316571 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m08:31:22.319168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m08:31:22.368906 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:31:22.370776 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m08:31:23.041114 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:31:23.044875 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m08:31:23.173056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0ea94440>]}
[0m08:31:23.174418 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m08:31:23.175526 [info ] [MainThread]: 
[0m08:31:23.187559 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m08:31:23.188767 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m08:31:23.190483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.stg_products)
[0m08:31:23.191797 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m08:31:23.195380 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m08:31:25.032482 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 08:31:23.192874 => 08:31:25.032085
[0m08:31:25.033259 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m08:31:25.068801 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m08:31:25.078436 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m08:31:25.079473 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m08:31:25.080338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:25.567115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:31:25.617443 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 08:31:25.034221 => 08:31:25.616971
[0m08:31:25.619187 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m08:31:25.733571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0ebf5490>]}
[0m08:31:25.735412 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 2.54s]
[0m08:31:25.738092 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m08:31:25.741527 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m08:31:25.742570 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m08:31:25.744345 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m08:31:25.745635 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m08:31:25.774288 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m08:31:25.781185 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 08:31:25.746807 => 08:31:25.780836
[0m08:31:25.781822 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m08:31:25.804234 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m08:31:25.813331 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m08:31:25.814141 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m08:31:25.814940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:31:29.949048 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m08:31:29.953052 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 08:31:25.782289 => 08:31:29.952767
[0m08:31:29.953741 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m08:31:30.068424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e077bf530>]}
[0m08:31:30.069306 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 4.32s]
[0m08:31:30.070370 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m08:31:30.072108 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m08:31:30.073129 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m08:31:30.074593 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m08:31:30.075495 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m08:31:30.084316 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m08:31:30.089615 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 08:31:30.076041 => 08:31:30.089203
[0m08:31:30.090647 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m08:31:30.096198 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m08:31:30.105152 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m08:31:30.106178 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m08:31:30.106774 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m08:31:32.352383 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:31:32.355790 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 08:31:30.091367 => 08:31:32.355598
[0m08:31:32.356768 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m08:31:32.460775 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3cc42ff0>]}
[0m08:31:32.461572 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.39s]
[0m08:31:32.462626 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m08:31:32.464145 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m08:31:32.464852 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m08:31:32.466014 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m08:31:32.466699 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m08:31:32.470119 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m08:31:32.479818 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 08:31:32.467113 => 08:31:32.479431
[0m08:31:32.480424 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m08:31:32.483480 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m08:31:32.495582 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m08:31:32.496708 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m08:31:32.497700 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m08:31:33.553246 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:31:33.556161 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 08:31:32.480806 => 08:31:33.555927
[0m08:31:33.557058 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m08:31:33.678580 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e07768a70>]}
[0m08:31:33.679563 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.21s]
[0m08:31:33.680579 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m08:31:33.682061 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m08:31:33.682781 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m08:31:33.684095 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m08:31:33.684756 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m08:31:33.688029 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m08:31:33.693331 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 08:31:33.685194 => 08:31:33.693025
[0m08:31:33.694016 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m08:31:33.697248 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m08:31:33.703924 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m08:31:33.704529 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m08:31:33.705003 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m08:37:44.324859 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 371.0 seconds
[0m08:37:44.328695 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 08:31:33.694433 => 08:37:44.328460
[0m08:37:44.329370 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m08:37:44.433667 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e07768920>]}
[0m08:37:44.434612 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 370.75s]
[0m08:37:44.435512 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m08:37:44.436953 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m08:37:44.437809 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m08:37:44.438843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.agg_category_performance)
[0m08:37:44.439518 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m08:37:44.443100 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m08:37:44.451850 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 08:37:44.439989 => 08:37:44.451511
[0m08:37:44.452560 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m08:37:44.455915 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m08:37:44.464465 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m08:37:44.465099 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT 
        ct.category AS category,
        ROUND(AVG(fct.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct.discount), 2) AS avg_discount,
        ROUND(AVG(fct.selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products,
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct.category_id = ct.category_id
    GROUP BY ct.category
    ORDER BY avg_price_dollars DESC
)

SELECT 
    *       
FROM cat_perf
        );
[0m08:37:44.465555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:37:45.176926 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba78a5-0000-fda3-0001-4c5e000f1122
[0m08:37:45.177646 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 18
invalid identifier 'FCT.PRICE_DOLLARS'
[0m08:37:45.178682 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 08:37:44.453030 => 08:37:45.178349
[0m08:37:45.179205 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m08:37:45.341139 [debug] [Thread-2 (]: Database Error in model agg_category_performance (models/analytics/agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 7 at position 18
  invalid identifier 'FCT.PRICE_DOLLARS'
  compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m08:37:45.341906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6f9c64-a400-468e-be69-6fc6955f5ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0662abd0>]}
[0m08:37:45.342628 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.90s]
[0m08:37:45.343431 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m08:37:45.346888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:45.347492 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m08:37:45.347940 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m08:37:45.348325 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m08:37:45.348698 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m08:37:45.349085 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m08:37:45.349473 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m08:37:45.349998 [info ] [MainThread]: 
[0m08:37:45.350562 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 6 minutes and 24.74 seconds (384.74s).
[0m08:37:45.352591 [debug] [MainThread]: Command end result
[0m08:37:45.370520 [info ] [MainThread]: 
[0m08:37:45.371281 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:37:45.372199 [info ] [MainThread]: 
[0m08:37:45.373442 [error] [MainThread]: [33mDatabase Error in model agg_category_performance (models/analytics/agg_category_performance.sql)[0m
[0m08:37:45.374474 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 7 at position 18
[0m08:37:45.375296 [error] [MainThread]:   invalid identifier 'FCT.PRICE_DOLLARS'
[0m08:37:45.376344 [error] [MainThread]:   compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m08:37:45.377366 [info ] [MainThread]: 
[0m08:37:45.378576 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:37:45.380230 [debug] [MainThread]: Command `dbt run` failed at 08:37:45.379826 after 361.78 seconds
[0m08:37:45.380945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3b3b7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3a711520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e0ed29d00>]}
[0m08:37:45.381882 [debug] [MainThread]: Flushing usage events
[0m08:57:56.795289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84fbaf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84fe93c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe853e9cbf0>]}


============================== 08:57:56.798230 | 7f4637c3-6294-48b9-952a-aa98a9f25d56 ==============================
[0m08:57:56.798230 [info ] [MainThread]: Running with dbt=1.5.0
[0m08:57:56.799175 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/transform', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m08:57:58.067737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84fe05d30>]}
[0m08:57:58.084386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82a5212e0>]}
[0m08:57:58.152413 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m08:58:00.537152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:58:00.537643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:58:00.542878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe828518c80>]}
[0m08:58:00.561749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82808f6e0>]}
[0m08:58:00.562505 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:58:00.563428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84f2240e0>]}
[0m08:58:00.565787 [info ] [MainThread]: 
[0m08:58:00.567183 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:58:00.569707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:58:00.576014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:58:00.655208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m08:58:00.656385 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:58:00.657215 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:58:00.659529 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m08:58:00.660204 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:58:00.660882 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:58:00.661529 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m08:58:00.662158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:00.662771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:00.663409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:01.527022 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:58:01.527909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:58:01.529504 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:58:01.531300 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:58:01.540713 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:58:01.542925 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m08:58:01.664576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m08:58:01.665562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m08:58:01.673100 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m08:58:01.675787 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m08:58:01.676588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m08:58:01.677411 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m08:58:01.678102 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m08:58:01.680580 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m08:58:01.681253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:01.681933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:01.682544 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m08:58:01.686932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:02.184696 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m08:58:02.186743 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m08:58:02.205818 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:58:02.207488 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m08:58:02.441287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:58:02.442951 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m08:58:02.561595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82818d2b0>]}
[0m08:58:02.562819 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m08:58:02.563652 [info ] [MainThread]: 
[0m08:58:02.575555 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m08:58:02.576445 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m08:58:02.577803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.stg_products)
[0m08:58:02.578639 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m08:58:02.581282 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m08:58:02.590249 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 08:58:02.579400 => 08:58:02.589945
[0m08:58:02.590923 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m08:58:02.617431 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m08:58:02.626126 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m08:58:02.626829 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m08:58:02.627472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:03.125376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:58:03.146111 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 08:58:02.591423 => 08:58:03.145925
[0m08:58:03.146932 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m08:58:03.272875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82262ba70>]}
[0m08:58:03.274191 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.70s]
[0m08:58:03.275686 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m08:58:03.277823 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m08:58:03.278945 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m08:58:03.280579 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m08:58:03.281636 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m08:58:03.303282 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m08:58:03.313906 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 08:58:03.282329 => 08:58:03.313561
[0m08:58:03.314579 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m08:58:03.336989 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m08:58:03.347179 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m08:58:03.348143 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m08:58:03.349199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:58:05.397092 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:58:05.400404 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 08:58:03.315064 => 08:58:05.400159
[0m08:58:05.401089 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m08:58:05.535399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82265b830>]}
[0m08:58:05.536380 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.26s]
[0m08:58:05.537530 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m08:58:05.539181 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m08:58:05.539970 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m08:58:05.541179 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m08:58:05.541980 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m08:58:05.546846 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m08:58:05.556408 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 08:58:05.542484 => 08:58:05.556081
[0m08:58:05.557020 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m08:58:05.561291 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m08:58:05.571748 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m08:58:05.573161 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m08:58:05.574150 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m08:58:07.679030 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:58:07.682181 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 08:58:05.557398 => 08:58:07.681998
[0m08:58:07.682801 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m08:58:07.815712 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8226b75c0>]}
[0m08:58:07.816665 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.27s]
[0m08:58:07.817845 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m08:58:07.819924 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m08:58:07.820994 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m08:58:07.822473 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m08:58:07.823474 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m08:58:07.827425 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m08:58:07.836882 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 08:58:07.824185 => 08:58:07.836570
[0m08:58:07.837599 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m08:58:07.840853 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m08:58:07.849487 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m08:58:07.850395 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m08:58:07.851347 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m08:58:09.082386 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:58:09.086309 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 08:58:07.838111 => 08:58:09.086037
[0m08:58:09.087205 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m08:58:09.255541 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f4637c3-6294-48b9-952a-aa98a9f25d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8226b5ee0>]}
[0m08:58:09.256441 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.43s]
[0m08:58:09.257631 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m08:58:09.259373 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m08:58:09.260254 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m08:58:09.261502 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m08:58:09.262268 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m08:58:09.265780 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m08:58:09.273874 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 08:58:09.262779 => 08:58:09.273394
[0m08:58:09.274728 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m08:58:09.278012 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m08:58:09.287365 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m08:58:09.288100 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m08:58:09.288668 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:01:30.807850 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.transform.fact_products_performance' (365441588412594)
[0m09:01:30.808808 [debug] [MainThread]: Using snowflake connection "master"
[0m09:01:30.809600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "master"} */
select system$abort_session(365441588412594)
[0m09:01:30.810165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:01:31.403046 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:01:31.404185 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.transform.fact_products_performance': ('session [365441588412594] terminated.',)
[0m09:01:31.405057 [error] [MainThread]: CANCEL query model.transform.int_products ...................................... [[31mCANCEL[0m]
[0m09:01:31.406044 [error] [MainThread]: CANCEL query model.transform.stg_products ...................................... [[31mCANCEL[0m]
[0m09:01:31.407090 [error] [MainThread]: CANCEL query list_E_COMMERCE_PRODUCT_products_schema_intermediate .............. [[31mCANCEL[0m]
[0m09:01:31.408169 [error] [MainThread]: CANCEL query model.transform.dim_category ...................................... [[31mCANCEL[0m]
[0m09:01:31.409042 [error] [MainThread]: CANCEL query model.transform.dim_products ...................................... [[31mCANCEL[0m]
[0m09:01:31.409944 [error] [MainThread]: CANCEL query model.transform.fact_products_performance ......................... [[31mCANCEL[0m]
[0m09:01:31.410756 [debug] [MainThread]: On master: Close
[0m09:01:42.075828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:42.076574 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m09:01:42.077234 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m09:01:42.077782 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m09:01:42.078308 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m09:01:42.078836 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m09:01:42.079339 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was left open.
[0m09:01:42.079870 [debug] [MainThread]: On model.transform.fact_products_performance: Close
[0m09:01:42.447225 [info ] [MainThread]: 
[0m09:01:42.448383 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 3 minutes and 41.88 seconds (221.88s).
[0m09:01:42.449683 [error] [MainThread]: Encountered an error:

[0m09:01:42.459805 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 350, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 258, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 567, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 332, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.12/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.12/threading.py", line 1149, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m09:01:42.461509 [debug] [MainThread]: Command `dbt run` failed at 09:01:42.461223 after 209.22 seconds
[0m09:01:42.462586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84fb2c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82262a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe82261dee0>]}
[0m09:01:42.463960 [debug] [MainThread]: Flushing usage events
[0m09:05:06.757938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ed370080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ed2e4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ecfbbf20>]}


============================== 09:05:06.760030 | 5007ca67-c214-44ee-a6b0-bc83e3014ce7 ==============================
[0m09:05:06.760030 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:05:06.761087 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m09:05:07.400737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5901640>]}
[0m09:05:07.417635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5873fe0>]}
[0m09:05:07.484529 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:05:10.316732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:05:10.317505 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m09:05:10.342355 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m09:05:10.429762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c54b6d20>]}
[0m09:05:10.451463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5494dd0>]}
[0m09:05:10.452212 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:05:10.453066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c6c35580>]}
[0m09:05:10.455221 [info ] [MainThread]: 
[0m09:05:10.456828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:05:10.458706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:05:10.465020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:05:10.471762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:05:10.478546 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:05:10.481493 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:05:10.484494 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:05:10.485395 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:05:10.486065 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:05:10.486680 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:05:10.487359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:10.488094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:10.488707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:11.192463 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:05:11.194222 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:05:11.292088 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:05:11.294021 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:05:11.294856 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:05:11.297496 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:05:11.430623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m09:05:11.431635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m09:05:11.432482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m09:05:11.438965 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m09:05:11.441738 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m09:05:11.444513 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m09:05:11.445277 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m09:05:11.446056 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m09:05:11.446772 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m09:05:11.447399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:11.448141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:11.448869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:11.839895 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:05:11.841762 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m09:05:11.980710 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:05:11.982836 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m09:05:12.308004 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:05:12.310093 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m09:05:12.429043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c57efb30>]}
[0m09:05:12.430129 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:05:12.430992 [info ] [MainThread]: 
[0m09:05:12.439920 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m09:05:12.440880 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m09:05:12.442127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.stg_products)
[0m09:05:12.443077 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m09:05:12.445558 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m09:05:12.454714 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 09:05:12.443762 => 09:05:12.454392
[0m09:05:12.455411 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m09:05:12.481949 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m09:05:12.492231 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m09:05:12.492892 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m09:05:12.493399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:12.928413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:05:12.950298 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 09:05:12.455818 => 09:05:12.950090
[0m09:05:12.951177 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m09:05:13.070314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22339b0>]}
[0m09:05:13.071397 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.63s]
[0m09:05:13.072709 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m09:05:13.074689 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m09:05:13.075680 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m09:05:13.076949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m09:05:13.077725 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m09:05:13.094350 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m09:05:13.104336 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 09:05:13.078299 => 09:05:13.103972
[0m09:05:13.105176 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m09:05:13.126546 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m09:05:13.137215 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m09:05:13.138015 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m09:05:13.138718 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:05:15.843510 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m09:05:15.846841 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 09:05:13.105752 => 09:05:15.846649
[0m09:05:15.847548 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m09:05:15.965608 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22334d0>]}
[0m09:05:15.966604 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.89s]
[0m09:05:15.967867 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m09:05:15.969482 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m09:05:15.970402 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m09:05:15.971680 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m09:05:15.972441 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m09:05:15.976618 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m09:05:15.984967 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 09:05:15.972922 => 09:05:15.984571
[0m09:05:15.985674 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m09:05:15.989903 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m09:05:15.998385 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m09:05:15.999662 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m09:05:16.000573 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m09:05:17.035640 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:05:17.039281 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 09:05:15.986090 => 09:05:17.039088
[0m09:05:17.040032 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m09:05:17.163814 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22b3bc0>]}
[0m09:05:17.164896 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.19s]
[0m09:05:17.166417 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m09:05:17.167821 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m09:05:17.168603 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m09:05:17.169940 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m09:05:17.170749 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m09:05:17.173961 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m09:05:17.182287 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 09:05:17.171224 => 09:05:17.181983
[0m09:05:17.182835 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m09:05:17.186077 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m09:05:17.195367 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m09:05:17.196035 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m09:05:17.196542 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m09:05:19.570888 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:05:19.574159 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 09:05:17.183251 => 09:05:19.573977
[0m09:05:19.574916 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m09:05:19.795332 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007ca67-c214-44ee-a6b0-bc83e3014ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22b1ac0>]}
[0m09:05:19.796433 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 2.63s]
[0m09:05:19.797771 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m09:05:19.799232 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m09:05:19.800014 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m09:05:19.801245 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m09:05:19.802042 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m09:05:19.805266 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m09:05:19.814734 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 09:05:19.802565 => 09:05:19.814296
[0m09:05:19.815359 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m09:05:19.818611 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m09:05:19.827482 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m09:05:19.828320 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m09:05:19.829020 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:07:09.461070 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.transform.fact_products_performance' (365441588432918)
[0m09:07:09.461978 [debug] [MainThread]: Using snowflake connection "master"
[0m09:07:09.462771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "master"} */
select system$abort_session(365441588432918)
[0m09:07:09.463397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:10.076456 [debug] [MainThread]: On master: Close
[0m09:07:10.329790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:10.330614 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m09:07:10.331269 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m09:07:10.331934 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m09:07:10.332530 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m09:07:10.333126 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m09:07:10.333790 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was left open.
[0m09:07:10.334497 [debug] [MainThread]: On model.transform.fact_products_performance: Close
[0m09:07:10.527037 [info ] [MainThread]: 
[0m09:07:10.527997 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 2 minutes and 0.07 seconds (120.07s).
[0m09:07:10.529188 [error] [MainThread]: Encountered an error:

[0m09:07:10.547053 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 567, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 323, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1099, in cancel_open_connections
    return self.connections.cancel_open()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 370, in cancel
    _, cursor = self.add_query(sql)
                ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 475, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 531, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 451, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 81, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 994, in execute
    ret = self._execute_helper(query, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 700, in _execute_helper
    ret = self._connection.cmd_query(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1368, in cmd_query
    ret = self.rest.request(
          ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 501, in request
    return self._post_request(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 749, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 864, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 914, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 1081, in _request_exec
    raw_ret = session.request(
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 467, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 462, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 330, in recv_into
    if not util.wait_for_read(self.socket, self.socket.gettimeout()):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 145, in wait_for_read
    return wait_for_socket(sock, read=True, timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 106, in poll_wait_for_socket
    return bool(_retry_on_intr(do_poll, timeout))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 43, in _retry_on_intr
    return fn(timeout)
           ^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 104, in do_poll
    return poll_obj.poll(t)
           ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 689, in interrupt_handler
    raise KeyboardInterrupt
KeyboardInterrupt

[0m09:07:10.548898 [debug] [MainThread]: Command `dbt run` failed at 09:07:10.548645 after 113.90 seconds
[0m09:07:10.549747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79ed747e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22b6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b22b10a0>]}
[0m09:07:10.550670 [debug] [MainThread]: Flushing usage events
[0m09:07:18.225073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2fe3eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa307fa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa301223c0>]}


============================== 09:07:18.227195 | e19ea522-5942-4007-9fc6-dd206447f83e ==============================
[0m09:07:18.227195 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:07:18.228143 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m09:07:18.833937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa3032c980>]}
[0m09:07:18.850025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa08904a70>]}
[0m09:07:18.916670 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:07:21.736419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:07:21.737382 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m09:07:21.761766 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m09:07:21.855166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa08ac2cf0>]}
[0m09:07:21.876628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa08574cb0>]}
[0m09:07:21.877387 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:07:21.878362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa085e9040>]}
[0m09:07:21.880695 [info ] [MainThread]: 
[0m09:07:21.882156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:07:21.884009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:07:21.890285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:07:21.902316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:07:21.906980 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:07:21.909800 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:07:21.912864 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:07:21.913681 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:07:21.914524 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:07:21.915294 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:07:21.915920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:21.916623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:21.917398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:22.538137 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:07:22.539793 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:07:22.548020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:07:22.549866 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:07:22.571939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:07:22.573801 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:07:22.686289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m09:07:22.687367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m09:07:22.693982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m09:07:22.694971 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m09:07:22.698188 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m09:07:22.701251 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m09:07:22.702121 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m09:07:22.702910 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m09:07:22.703695 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m09:07:22.704451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:22.705067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:22.705721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:23.165733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:07:23.167515 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m09:07:23.183135 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:07:23.184823 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m09:07:23.200679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:07:23.202470 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m09:07:23.315402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa08de3740>]}
[0m09:07:23.316740 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:07:23.317576 [info ] [MainThread]: 
[0m09:07:23.326656 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m09:07:23.327499 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m09:07:23.328719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.stg_products)
[0m09:07:23.329623 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m09:07:23.332366 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m09:07:23.341309 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 09:07:23.330338 => 09:07:23.340988
[0m09:07:23.342029 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m09:07:23.378114 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m09:07:23.388483 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m09:07:23.389355 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m09:07:23.390306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:23.829342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:07:23.851319 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 09:07:23.342786 => 09:07:23.851101
[0m09:07:23.852174 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m09:07:23.966839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa10a6b920>]}
[0m09:07:23.967979 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.64s]
[0m09:07:23.969532 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m09:07:23.971165 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m09:07:23.972201 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m09:07:23.973414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m09:07:23.974321 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m09:07:23.992900 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m09:07:24.002999 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 09:07:23.975019 => 09:07:24.002654
[0m09:07:24.003892 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m09:07:24.025028 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m09:07:24.035874 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m09:07:24.036673 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m09:07:24.037576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:07:26.338544 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:07:26.341946 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 09:07:24.004747 => 09:07:26.341732
[0m09:07:26.342759 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m09:07:26.454194 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa081566f0>]}
[0m09:07:26.455363 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.48s]
[0m09:07:26.456956 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m09:07:26.458721 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m09:07:26.459681 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m09:07:26.461064 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m09:07:26.461916 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m09:07:26.467675 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m09:07:26.477792 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 09:07:26.462535 => 09:07:26.477437
[0m09:07:26.478516 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m09:07:26.483069 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m09:07:26.494287 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m09:07:26.495223 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m09:07:26.495901 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m09:07:28.898000 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:07:28.901349 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 09:07:26.479095 => 09:07:28.901150
[0m09:07:28.902063 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m09:07:29.001825 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01130d70>]}
[0m09:07:29.002796 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.54s]
[0m09:07:29.004321 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m09:07:29.005745 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m09:07:29.006716 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m09:07:29.007913 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m09:07:29.008608 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m09:07:29.011943 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m09:07:29.021637 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 09:07:29.009034 => 09:07:29.021245
[0m09:07:29.022413 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m09:07:29.025591 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m09:07:29.035125 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m09:07:29.035910 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m09:07:29.036756 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m09:07:33.295988 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m09:07:33.299150 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 09:07:29.022885 => 09:07:33.298967
[0m09:07:33.299849 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m09:07:33.402566 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e19ea522-5942-4007-9fc6-dd206447f83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa011307d0>]}
[0m09:07:33.403492 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 4.40s]
[0m09:07:33.404759 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m09:07:33.406212 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m09:07:33.407148 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m09:07:33.408442 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m09:07:33.409261 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m09:07:33.413175 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m09:07:33.423278 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 09:07:33.409844 => 09:07:33.422865
[0m09:07:33.424270 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m09:07:33.427412 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m09:07:33.437450 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m09:07:33.438306 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m09:07:33.439238 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:18:30.740295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06957f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06a2d5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0698e18b0>]}


============================== 09:18:30.742455 | 60d52644-5970-413d-9354-4d48543fac9e ==============================
[0m09:18:30.742455 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:18:30.743538 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'introspect': 'True'}
[0m09:18:31.465634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd069daffe0>]}
[0m09:18:31.483154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03de82ff0>]}
[0m09:18:31.554884 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:18:34.175282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:18:34.175896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:18:34.180998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03de80560>]}
[0m09:18:34.200547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03daa7ef0>]}
[0m09:18:34.201254 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:18:34.202112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03e2bb6e0>]}
[0m09:18:34.204022 [info ] [MainThread]: 
[0m09:18:34.205528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:18:34.207320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:18:34.213959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:18:34.220246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:18:34.290111 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:18:34.292587 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:18:34.293389 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:18:34.293805 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:18:34.294589 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:18:34.295143 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:18:34.295736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:34.296299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:34.296981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:35.989924 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m09:18:35.990930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m09:18:35.992818 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:18:35.994003 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m09:18:35.999989 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:18:36.003047 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:18:36.118732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m09:18:36.119863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m09:18:36.126452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m09:18:36.127216 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m09:18:36.130930 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m09:18:36.133926 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m09:18:36.134747 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m09:18:36.135361 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m09:18:36.135992 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m09:18:36.136635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:36.137179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:36.137639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:36.677864 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:18:36.681045 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m09:18:36.690351 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:36.692298 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m09:18:36.726531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:36.728421 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m09:18:36.839590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03db029f0>]}
[0m09:18:36.840633 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:18:36.841388 [info ] [MainThread]: 
[0m09:18:36.849545 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m09:18:36.850639 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m09:18:36.851849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.stg_products)
[0m09:18:36.852615 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m09:18:36.855081 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m09:18:36.862008 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 09:18:36.853184 => 09:18:36.861595
[0m09:18:36.862702 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m09:18:36.897996 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m09:18:36.906933 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m09:18:36.907667 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m09:18:36.908308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:37.479777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:37.506673 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 09:18:36.863239 => 09:18:37.506405
[0m09:18:37.507577 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m09:18:37.619754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03de816d0>]}
[0m09:18:37.620705 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.77s]
[0m09:18:37.622029 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m09:18:37.623916 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m09:18:37.624838 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m09:18:37.626113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m09:18:37.626834 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m09:18:37.648735 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m09:18:37.657726 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 09:18:37.627391 => 09:18:37.657379
[0m09:18:37.658546 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m09:18:37.685947 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m09:18:37.695493 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m09:18:37.696324 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", COALESCE(AVG("PRICE($)") OVER(PARTITION BY category),0)) ,2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,
        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m09:18:37.697143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:18:39.620254 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:18:39.623478 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 09:18:37.659167 => 09:18:39.623286
[0m09:18:39.624227 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m09:18:39.738712 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03c0df740>]}
[0m09:18:39.739656 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.11s]
[0m09:18:39.740797 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m09:18:39.742384 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m09:18:39.743249 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m09:18:39.744518 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m09:18:39.745261 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m09:18:39.749887 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m09:18:39.757350 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 09:18:39.745742 => 09:18:39.756905
[0m09:18:39.758264 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m09:18:39.761744 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m09:18:39.768158 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m09:18:39.768759 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m09:18:39.769285 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m09:18:40.956842 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:40.960384 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 09:18:39.758923 => 09:18:40.960177
[0m09:18:40.961144 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m09:18:41.070563 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03c0eaff0>]}
[0m09:18:41.071612 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.33s]
[0m09:18:41.072662 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m09:18:41.074108 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m09:18:41.074848 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m09:18:41.076024 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m09:18:41.076755 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m09:18:41.079935 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m09:18:41.087047 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 09:18:41.077179 => 09:18:41.086756
[0m09:18:41.087639 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m09:18:41.090922 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m09:18:41.102314 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m09:18:41.103618 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m09:18:41.104440 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m09:18:42.487743 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:18:42.490630 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 09:18:41.088045 => 09:18:42.490450
[0m09:18:42.491343 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m09:18:42.596938 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03de816d0>]}
[0m09:18:42.597938 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.52s]
[0m09:18:42.599050 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m09:18:42.600667 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m09:18:42.601465 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m09:18:42.602960 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m09:18:42.603861 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m09:18:42.607114 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m09:18:42.615832 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 09:18:42.604289 => 09:18:42.615297
[0m09:18:42.616971 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m09:18:42.620826 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m09:18:42.630616 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m09:18:42.631487 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m09:18:42.632191 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:24:48.788859 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 366.0 seconds
[0m09:24:48.792793 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 09:18:42.617751 => 09:24:48.792564
[0m09:24:48.793529 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m09:24:48.894509 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c7332f0>]}
[0m09:24:48.895374 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 366.29s]
[0m09:24:48.896518 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m09:24:48.898213 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m09:24:48.899033 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m09:24:48.900357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.agg_category_performance)
[0m09:24:48.901043 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m09:24:48.906438 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m09:24:48.916093 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 09:24:48.901565 => 09:24:48.915662
[0m09:24:48.917041 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m09:24:48.924102 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m09:24:48.935224 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m09:24:48.936766 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT 
        ct.category AS category,
        ROUND(AVG(fct_prod.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct_prod.discount), 2) AS avg_discount,
        ROUND(AVG(fct_prod.selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct_prod.category_id = ct.category_id
    GROUP BY ct.category
)

SELECT 
    *       
FROM cat_perf
ORDER BY avg_price_dollars DESC
        );
[0m09:24:48.937853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:38.098255 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 49.0 seconds
[0m09:25:38.101713 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 09:24:48.917805 => 09:25:38.101455
[0m09:25:38.102379 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m09:25:38.487053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d52644-5970-413d-9354-4d48543fac9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03deb5610>]}
[0m09:25:38.487993 [info ] [Thread-2 (]: 6 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 49.59s]
[0m09:25:38.489031 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m09:25:38.492800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:38.493473 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m09:25:38.493930 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m09:25:38.494393 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m09:25:38.494828 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m09:25:38.495207 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m09:25:38.495557 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m09:25:38.496093 [info ] [MainThread]: 
[0m09:25:38.496617 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 7 minutes and 4.29 seconds (424.29s).
[0m09:25:38.498697 [debug] [MainThread]: Command end result
[0m09:25:38.521261 [info ] [MainThread]: 
[0m09:25:38.522359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:38.523398 [info ] [MainThread]: 
[0m09:25:38.524481 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:25:38.525908 [debug] [MainThread]: Command `dbt run` succeeded at 09:25:38.525684 after 395.43 seconds
[0m09:25:38.526706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd069938590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03fd1eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0698d0680>]}
[0m09:25:38.527294 [debug] [MainThread]: Flushing usage events
[0m09:30:07.610392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd667adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd69a4c20>]}


============================== 09:30:07.612257 | 09cea678-9f61-4aaa-a93e-e5106c78db58 ==============================
[0m09:30:07.612257 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:30:07.612875 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None'}
[0m09:30:07.638481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09cea678-9f61-4aaa-a93e-e5106c78db58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd690b770>]}
[0m09:30:07.641105 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_2voh5sm'
[0m09:30:07.641681 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:30:07.731456 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:30:07.732479 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:30:07.814922 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:30:07.818864 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m09:30:08.314956 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m09:30:08.318234 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m09:30:08.389639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m09:30:08.399069 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:30:12.876955 [info ] [MainThread]: Installed from version 1.3.0
[0m09:30:12.877750 [info ] [MainThread]: Up to date!
[0m09:30:12.878423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09cea678-9f61-4aaa-a93e-e5106c78db58', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd759cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd760a9c0>]}
[0m09:30:12.878873 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m09:30:16.399726 [info ] [MainThread]: Installed from version 0.10.4
[0m09:30:16.400504 [info ] [MainThread]: Up to date!
[0m09:30:16.401334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09cea678-9f61-4aaa-a93e-e5106c78db58', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd70b9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd669f290>]}
[0m09:30:16.401965 [info ] [MainThread]: Installing calogica/dbt_date
[0m09:30:17.815857 [info ] [MainThread]: Installed from version 0.10.1
[0m09:30:17.816601 [info ] [MainThread]: Up to date!
[0m09:30:17.817212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09cea678-9f61-4aaa-a93e-e5106c78db58', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd669e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd669f290>]}
[0m09:30:17.818893 [debug] [MainThread]: Command `dbt deps` succeeded at 09:30:17.818726 after 10.22 seconds
[0m09:30:17.819360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd7024740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda9797c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6962e70>]}
[0m09:30:17.819783 [debug] [MainThread]: Flushing usage events
[0m09:52:46.277659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e75c9d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e766652e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e75fa4b30>]}


============================== 09:52:46.279534 | fb9410b5-7935-4bf0-9b80-e72e9a7c4c01 ==============================
[0m09:52:46.279534 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:52:46.280388 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m09:52:49.970094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e790c1e50>]}
[0m09:52:49.985541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a570a70>]}
[0m09:52:50.045012 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:52:52.475936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:52.476731 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/int_products.sql
[0m09:52:52.497936 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m09:52:52.522394 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m09:52:52.657339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a24b560>]}
[0m09:52:52.675967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a1971a0>]}
[0m09:52:52.676615 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:52:52.677436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a3e73e0>]}
[0m09:52:52.679679 [info ] [MainThread]: 
[0m09:52:52.681271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:52:52.683493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:52:52.689934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:52:52.702037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:52:52.708520 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:52:52.711188 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:52:52.713566 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:52:52.714471 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:52:52.715140 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:52:52.715942 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:52:52.716676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:52.717259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:52.717819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:53.699002 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:52:53.701308 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:52:53.730372 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:52:53.733055 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:52:53.746099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:52:53.749158 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:52:53.903486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m09:52:53.904750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m09:52:53.914107 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m09:52:53.917369 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m09:52:53.918271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m09:52:53.919173 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m09:52:53.920110 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m09:52:53.923472 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m09:52:53.924467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:53.925578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:53.926549 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m09:52:53.932233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:54.362267 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:52:54.363851 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m09:52:54.385253 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:52:54.387195 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m09:52:54.416765 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:52:54.418515 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m09:52:54.547481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4b0592e0>]}
[0m09:52:54.548429 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:52:54.549020 [info ] [MainThread]: 
[0m09:52:54.556679 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m09:52:54.557481 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m09:52:54.558648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.stg_products)
[0m09:52:54.559361 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m09:52:54.561448 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m09:52:54.569028 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 09:52:54.559900 => 09:52:54.568664
[0m09:52:54.569714 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m09:52:54.599152 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m09:52:54.607677 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m09:52:54.608308 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m09:52:54.608897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:55.050840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:52:55.072392 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 09:52:54.570544 => 09:52:55.072206
[0m09:52:55.073081 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m09:52:55.183673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4878c530>]}
[0m09:52:55.184587 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.63s]
[0m09:52:55.185628 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m09:52:55.187355 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m09:52:55.188263 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m09:52:55.189473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m09:52:55.190311 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m09:52:55.196837 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m09:52:55.204221 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 09:52:55.190793 => 09:52:55.203918
[0m09:52:55.204753 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m09:52:55.224880 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m09:52:55.234762 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m09:52:55.235476 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m09:52:55.236028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:52:58.287521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m09:52:58.291062 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 09:52:55.205093 => 09:52:58.290869
[0m09:52:58.291978 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m09:52:58.404336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4878f2c0>]}
[0m09:52:58.405396 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.22s]
[0m09:52:58.406690 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m09:52:58.408274 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m09:52:58.409175 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m09:52:58.410580 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m09:52:58.411342 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m09:52:58.416558 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m09:52:58.424690 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 09:52:58.411832 => 09:52:58.424380
[0m09:52:58.425400 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m09:52:58.428617 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m09:52:58.436457 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m09:52:58.437256 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m09:52:58.437973 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m09:53:00.525111 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:53:00.528610 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 09:52:58.425882 => 09:53:00.528411
[0m09:53:00.529336 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m09:53:00.638895 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4878efc0>]}
[0m09:53:00.639971 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 2.23s]
[0m09:53:00.641094 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m09:53:00.642610 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m09:53:00.643364 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m09:53:00.644540 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m09:53:00.645321 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m09:53:00.649908 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m09:53:00.657687 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 09:53:00.645829 => 09:53:00.657353
[0m09:53:00.658388 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m09:53:00.661732 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m09:53:00.669557 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m09:53:00.670320 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m09:53:00.670975 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m09:53:01.871069 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:53:01.875458 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 09:53:00.658928 => 09:53:01.875148
[0m09:53:01.876332 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m09:53:01.984595 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9410b5-7935-4bf0-9b80-e72e9a7c4c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a152db0>]}
[0m09:53:01.985653 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.34s]
[0m09:53:01.986838 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m09:53:01.988476 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m09:53:01.989239 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m09:53:01.990462 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m09:53:01.991239 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m09:53:01.995236 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m09:53:02.003331 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 09:53:01.991786 => 09:53:02.003032
[0m09:53:02.003924 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m09:53:02.007025 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m09:53:02.015703 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m09:53:02.016468 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
        );
[0m09:53:02.016978 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:53:10.634777 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.transform.fact_products_performance' (365441588416730)
[0m09:53:10.635829 [debug] [MainThread]: Using snowflake connection "master"
[0m09:53:10.636608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "master"} */
select system$abort_session(365441588416730)
[0m09:53:10.637220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:10.792405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:10.792955 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m09:53:10.793440 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics' was properly closed.
[0m09:53:10.793895 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m09:53:10.794430 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m09:53:10.794988 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m09:53:10.795430 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was left open.
[0m09:53:10.795918 [debug] [MainThread]: On model.transform.fact_products_performance: Close
[0m09:53:11.003098 [info ] [MainThread]: 
[0m09:53:11.003860 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 18.32 seconds (18.32s).
[0m09:53:11.004933 [error] [MainThread]: Encountered an error:

[0m09:53:11.022537 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 567, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 441, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 404, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 358, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 323, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1099, in cancel_open_connections
    return self.connections.cancel_open()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 370, in cancel
    _, cursor = self.add_query(sql)
                ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 475, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 531, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 451, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/contracts/connection.py", line 94, in handle
    self._handle.resolve(self)
  File "/usr/local/lib/python3.12/site-packages/dbt/contracts/connection.py", line 118, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 351, in open
    return cls.retry_connection(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/connections.py", line 241, in retry_connection
    connection.handle = connect()
                        ^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 315, in connect
    handle = snowflake.connector.connect(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/__init__.py", line 55, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 467, in __init__
    self.connect(**kwargs)
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 786, in connect
    self.__open_connection()
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1116, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1404, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1432, in _authenticate
    auth.authenticate(
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/auth/_auth.py", line 265, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 749, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 864, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 914, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/network.py", line 1081, in _request_exec
    raw_ret = session.request(
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 467, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 462, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 330, in recv_into
    if not util.wait_for_read(self.socket, self.socket.gettimeout()):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 145, in wait_for_read
    return wait_for_socket(sock, read=True, timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 106, in poll_wait_for_socket
    return bool(_retry_on_intr(do_poll, timeout))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 43, in _retry_on_intr
    return fn(timeout)
           ^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/snowflake/connector/vendored/urllib3/util/wait.py", line 104, in do_poll
    return poll_obj.poll(t)
           ^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m09:53:11.024170 [debug] [MainThread]: Command `dbt run` failed at 09:53:11.023918 after 21.64 seconds
[0m09:53:11.025087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e765c6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a5ba270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4a378350>]}
[0m09:53:11.025970 [debug] [MainThread]: Flushing usage events
[0m09:54:11.481574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b13f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b61d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701bb6a360>]}


============================== 09:54:11.483476 | cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8 ==============================
[0m09:54:11.483476 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:54:11.484373 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_path': '/usr/local/airflow/dags/transform/logs', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m09:54:12.044652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b57f3b0>]}
[0m09:54:12.060361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff542bce0>]}
[0m09:54:12.120997 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m09:54:14.936776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:14.937642 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/fact_products_performance.sql
[0m09:54:14.965186 [debug] [MainThread]: 1699: static parser successfully parsed analytics/fact_products_performance.sql
[0m09:54:15.053004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fef4b03b0>]}
[0m09:54:15.077701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fef3b0380>]}
[0m09:54:15.078623 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:54:15.079719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fef3b0440>]}
[0m09:54:15.081980 [info ] [MainThread]: 
[0m09:54:15.083478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:15.085583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:54:15.087259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:54:15.109532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m09:54:15.110099 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:54:15.114187 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:54:15.117817 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m09:54:15.119021 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:54:15.120022 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:54:15.120848 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m09:54:15.121491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:15.122235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:15.123017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:15.776935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:54:15.777936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:54:15.779931 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:54:15.781409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m09:54:15.783119 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:54:15.787249 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m09:54:15.920624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m09:54:15.921560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m09:54:15.922369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m09:54:15.928986 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m09:54:15.931261 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m09:54:15.934094 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m09:54:15.934929 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m09:54:15.935729 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m09:54:15.936451 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m09:54:15.937049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:15.937769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:15.938418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:16.284577 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:16.286568 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m09:54:16.312492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:16.314270 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m09:54:16.427642 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:54:16.429467 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m09:54:16.537734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fef1815b0>]}
[0m09:54:16.538812 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:54:16.539572 [info ] [MainThread]: 
[0m09:54:16.546856 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m09:54:16.547709 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m09:54:16.548797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.stg_products)
[0m09:54:16.549522 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m09:54:16.551726 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m09:54:16.560894 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 09:54:16.550018 => 09:54:16.560572
[0m09:54:16.561496 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m09:54:16.588723 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m09:54:16.597362 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m09:54:16.598221 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m09:54:16.599147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:17.186417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:17.207488 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 09:54:16.561877 => 09:54:17.207296
[0m09:54:17.208348 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m09:54:17.320188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fafffb710>]}
[0m09:54:17.321197 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.77s]
[0m09:54:17.322300 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m09:54:17.323940 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m09:54:17.324698 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m09:54:17.325817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.int_products)
[0m09:54:17.326587 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m09:54:17.343035 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m09:54:17.350922 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 09:54:17.327071 => 09:54:17.350555
[0m09:54:17.351763 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m09:54:17.371639 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m09:54:17.381286 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m09:54:17.382088 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category)),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m09:54:17.382990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:20.899037 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m09:54:20.903704 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 09:54:17.352324 => 09:54:20.903476
[0m09:54:20.904579 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m09:54:21.018062 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fafe70e90>]}
[0m09:54:21.019104 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.69s]
[0m09:54:21.020219 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m09:54:21.022273 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m09:54:21.023070 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m09:54:21.024271 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m09:54:21.025023 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m09:54:21.032334 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m09:54:21.041194 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 09:54:21.025569 => 09:54:21.040879
[0m09:54:21.041770 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m09:54:21.044743 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m09:54:21.052526 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m09:54:21.053123 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m09:54:21.053596 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m09:54:22.222688 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:22.225816 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 09:54:21.042134 => 09:54:22.225624
[0m09:54:22.226904 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m09:54:22.475588 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6faff4d100>]}
[0m09:54:22.476508 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.45s]
[0m09:54:22.477617 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m09:54:22.479136 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m09:54:22.479989 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m09:54:22.481234 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m09:54:22.482131 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m09:54:22.485837 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m09:54:22.493583 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 09:54:22.482706 => 09:54:22.493270
[0m09:54:22.494270 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m09:54:22.497943 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m09:54:22.505860 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m09:54:22.506614 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."color_counts",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m09:54:22.507283 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m09:54:24.314705 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:54:24.318067 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 09:54:22.494759 => 09:54:24.317864
[0m09:54:24.318710 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m09:54:24.458621 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fafe12480>]}
[0m09:54:24.459596 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.98s]
[0m09:54:24.460680 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m09:54:24.462297 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m09:54:24.463151 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m09:54:24.464328 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m09:54:24.465058 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m09:54:24.468369 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m09:54:24.477137 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 09:54:24.465500 => 09:54:24.476830
[0m09:54:24.478007 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m09:54:24.481848 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m09:54:24.490089 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m09:54:24.490881 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
ON prod.prod_id = inttable.sk_id
        );
[0m09:54:24.491585 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m09:54:29.454384 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m09:54:29.457532 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 09:54:24.478718 => 09:54:29.457341
[0m09:54:29.458349 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m09:54:29.572490 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fafffb260>]}
[0m09:54:29.573526 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 5.11s]
[0m09:54:29.574832 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m09:54:29.576472 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m09:54:29.577402 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m09:54:29.578318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.agg_category_performance)
[0m09:54:29.578979 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m09:54:29.582061 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m09:54:29.588657 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 09:54:29.579368 => 09:54:29.588327
[0m09:54:29.589326 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m09:54:29.592865 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m09:54:29.601175 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m09:54:29.602067 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT 
        ct.category AS category,
        ROUND(AVG(fct_prod.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct_prod.discount), 2) AS avg_discount,
        ROUND(AVG(fct_prod.selling_proposition), 2) AS avg_sold_proposition,
        COUNT(*) AS total_products
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct_prod.category_id = ct.category_id
    GROUP BY ct.category
)

SELECT 
    *       
FROM cat_perf
ORDER BY avg_price_dollars DESC
        );
[0m09:54:29.602676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:54:31.447414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:54:31.450729 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 09:54:29.589798 => 09:54:31.450500
[0m09:54:31.451397 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m09:54:31.555167 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb4f8efc-dd61-47ce-85ef-6227bc5b4fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fac531430>]}
[0m09:54:31.556056 [info ] [Thread-2 (]: 6 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.98s]
[0m09:54:31.557197 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m09:54:31.561330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:31.562015 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m09:54:31.562627 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m09:54:31.563253 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m09:54:31.563784 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m09:54:31.564286 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m09:54:31.564760 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m09:54:31.565426 [info ] [MainThread]: 
[0m09:54:31.566335 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 16.48 seconds (16.48s).
[0m09:54:31.569009 [debug] [MainThread]: Command end result
[0m09:54:31.588644 [info ] [MainThread]: 
[0m09:54:31.589578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:31.590634 [info ] [MainThread]: 
[0m09:54:31.591968 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:54:31.593624 [debug] [MainThread]: Command `dbt run` succeeded at 09:54:31.593342 after 17.13 seconds
[0m09:54:31.594482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b061a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b66adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b13f2f0>]}
[0m09:54:31.595405 [debug] [MainThread]: Flushing usage events
[0m09:58:05.552432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b67aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b95cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25c5bee70>]}


============================== 09:58:05.554464 | f84584f9-c37c-4fd4-b438-c77341fbab2b ==============================
[0m09:58:05.554464 [info ] [MainThread]: Running with dbt=1.5.0
[0m09:58:05.555224 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m09:58:05.584231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f84584f9-c37c-4fd4-b438-c77341fbab2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b6d7500>]}
[0m09:58:05.587665 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y541wgxs'
[0m09:58:05.588641 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:58:05.804576 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:58:05.805524 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:58:05.870001 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:58:05.873812 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m09:58:05.902180 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m09:58:05.905771 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m09:58:05.936836 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m09:58:05.946139 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:58:09.600153 [info ] [MainThread]: Installed from version 1.3.0
[0m09:58:09.601101 [info ] [MainThread]: Up to date!
[0m09:58:09.601773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f84584f9-c37c-4fd4-b438-c77341fbab2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b698ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b6996a0>]}
[0m09:58:09.602295 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m09:58:13.138529 [info ] [MainThread]: Installed from version 0.10.4
[0m09:58:13.139258 [info ] [MainThread]: Up to date!
[0m09:58:13.139836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f84584f9-c37c-4fd4-b438-c77341fbab2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b7044a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b7048f0>]}
[0m09:58:13.140306 [info ] [MainThread]: Installing calogica/dbt_date
[0m09:58:16.037760 [info ] [MainThread]: Installed from version 0.10.1
[0m09:58:16.038341 [info ] [MainThread]: Up to date!
[0m09:58:16.038828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f84584f9-c37c-4fd4-b438-c77341fbab2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b9ddfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25bb68a70>]}
[0m09:58:16.040447 [debug] [MainThread]: Command `dbt deps` succeeded at 09:58:16.040315 after 10.51 seconds
[0m09:58:16.040839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25c5dc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25fb0b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b9a69f0>]}
[0m09:58:16.041198 [debug] [MainThread]: Flushing usage events
[0m10:26:31.272504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ac7d4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abf351c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abddca10>]}


============================== 10:26:31.274570 | 18e6c7cf-be08-4384-aa14-762dfd7427c0 ==============================
[0m10:26:31.274570 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:26:31.275622 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/dags/transform', 'debug': 'False', 'target_path': 'None'}
[0m10:26:31.306622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e6c7cf-be08-4384-aa14-762dfd7427c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ad14f470>]}
[0m10:26:31.309226 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-usuot5lq'
[0m10:26:31.309973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:26:32.789627 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:26:32.790744 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:26:34.980023 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:26:34.984235 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:26:35.090988 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:26:35.096413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:26:35.195564 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:26:35.204926 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:26:39.544128 [info ] [MainThread]: Installed from version 1.3.0
[0m10:26:39.544856 [info ] [MainThread]: Up to date!
[0m10:26:39.545457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18e6c7cf-be08-4384-aa14-762dfd7427c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abfdac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abfdb020>]}
[0m10:26:39.545961 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:26:43.635951 [info ] [MainThread]: Installed from version 0.10.4
[0m10:26:43.636720 [info ] [MainThread]: Up to date!
[0m10:26:43.637373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18e6c7cf-be08-4384-aa14-762dfd7427c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ab94f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ab94faa0>]}
[0m10:26:43.637850 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:26:45.291453 [info ] [MainThread]: Installed from version 0.10.1
[0m10:26:45.292345 [info ] [MainThread]: Up to date!
[0m10:26:45.293057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18e6c7cf-be08-4384-aa14-762dfd7427c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ab932c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ab932f00>]}
[0m10:26:45.295524 [debug] [MainThread]: Command `dbt deps` succeeded at 10:26:45.295350 after 10.76 seconds
[0m10:26:45.296174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13abf15a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ad14f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ac9d6480>]}
[0m10:26:45.296724 [debug] [MainThread]: Flushing usage events
[0m10:34:56.648223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73cd77c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73db7e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d058aa0>]}


============================== 10:34:56.650345 | 92a9be74-99af-450d-a626-de9c58eddd24 ==============================
[0m10:34:56.650345 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:34:56.651231 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'quiet': 'False', 'partial_parse': 'True'}
[0m10:34:57.255366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d6a1040>]}
[0m10:34:57.272092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe715a0baa0>]}
[0m10:34:57.343319 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m10:35:00.362148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:35:00.363079 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/generic_test.yml
[0m10:35:00.363656 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/int_products.sql
[0m10:35:00.385603 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m10:35:00.410227 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m10:35:00.603337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7156c5640>]}
[0m10:35:00.625881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe715518740>]}
[0m10:35:00.626695 [info ] [MainThread]: Found 6 models, 22 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:35:00.627523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe715478830>]}
[0m10:35:00.629597 [info ] [MainThread]: 
[0m10:35:00.631079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:00.632600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m10:35:00.645531 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m10:35:00.646168 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m10:35:00.646703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:01.409601 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:35:01.411319 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m10:35:01.517345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m10:35:01.518477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate'
[0m10:35:01.525452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT_products_schema_analytics'
[0m10:35:01.526298 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m10:35:01.530164 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m10:35:01.533014 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m10:35:01.533921 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m10:35:01.534842 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m10:35:01.535668 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m10:35:01.536458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:01.537227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:01.538073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:01.974710 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:35:01.976618 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m10:35:01.982714 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:35:01.984639 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m10:35:01.999454 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:35:02.001129 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m10:35:02.116106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe715172f60>]}
[0m10:35:02.117150 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:35:02.117902 [info ] [MainThread]: 
[0m10:35:02.125010 [debug] [Thread-1 (]: Began running node model.transform.int_products
[0m10:35:02.125813 [info ] [Thread-1 (]: 1 of 1 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m10:35:02.127135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m10:35:02.128188 [debug] [Thread-1 (]: Began compiling node model.transform.int_products
[0m10:35:02.134993 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.int_products"
[0m10:35:02.144315 [debug] [Thread-1 (]: Timing info for model.transform.int_products (compile): 10:35:02.128820 => 10:35:02.144001
[0m10:35:02.144889 [debug] [Thread-1 (]: Began executing node model.transform.int_products
[0m10:35:02.174510 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.int_products"
[0m10:35:02.184057 [debug] [Thread-1 (]: Using snowflake connection "model.transform.int_products"
[0m10:35:02.184919 [debug] [Thread-1 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category),0),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "color_counts",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("color_counts" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m10:35:02.185744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:04.408745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:35:04.430327 [debug] [Thread-1 (]: Timing info for model.transform.int_products (execute): 10:35:02.145395 => 10:35:04.430124
[0m10:35:04.431205 [debug] [Thread-1 (]: On model.transform.int_products: Close
[0m10:35:04.537936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a9be74-99af-450d-a626-de9c58eddd24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7154a1460>]}
[0m10:35:04.539000 [info ] [Thread-1 (]: 1 of 1 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 2.41s]
[0m10:35:04.540428 [debug] [Thread-1 (]: Finished running node model.transform.int_products
[0m10:35:04.543806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:04.544442 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema' was properly closed.
[0m10:35:04.544896 [debug] [MainThread]: Connection 'list_E_COMMERCE_PRODUCT_products_schema_intermediate' was properly closed.
[0m10:35:04.545336 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m10:35:04.545795 [info ] [MainThread]: 
[0m10:35:04.546614 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m10:35:04.548218 [debug] [MainThread]: Command end result
[0m10:35:04.568204 [info ] [MainThread]: 
[0m10:35:04.569474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:04.570907 [info ] [MainThread]: 
[0m10:35:04.572342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:35:04.573742 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:04.573527 after 7.94 seconds
[0m10:35:04.574549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d1d94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73db7e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d5b1a60>]}
[0m10:35:04.575305 [debug] [MainThread]: Flushing usage events
[0m10:38:26.641296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c0b32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029d01f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029cd8ecc0>]}


============================== 10:38:26.643395 | f0c3995c-9f20-4b6e-ae08-bf3e8c741410 ==============================
[0m10:38:26.643395 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:38:26.644171 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True'}
[0m10:38:26.673093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0c3995c-9f20-4b6e-ae08-bf3e8c741410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c306840>]}
[0m10:38:26.676147 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-78mi1gmb'
[0m10:38:26.676967 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:38:26.896704 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:38:26.897762 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:38:26.958909 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:38:26.962654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:38:27.017035 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:38:27.020342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:38:27.084513 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:38:27.093866 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:38:30.982525 [info ] [MainThread]: Installed from version 1.3.0
[0m10:38:30.983281 [info ] [MainThread]: Up to date!
[0m10:38:30.983994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0c3995c-9f20-4b6e-ae08-bf3e8c741410', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029cd8ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029d04d520>]}
[0m10:38:30.984585 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:38:35.200664 [info ] [MainThread]: Installed from version 0.10.4
[0m10:38:35.201466 [info ] [MainThread]: Up to date!
[0m10:38:35.202034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0c3995c-9f20-4b6e-ae08-bf3e8c741410', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029d04d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029cd8ecc0>]}
[0m10:38:35.202473 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:38:36.610221 [info ] [MainThread]: Installed from version 0.10.1
[0m10:38:36.610952 [info ] [MainThread]: Up to date!
[0m10:38:36.611549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0c3995c-9f20-4b6e-ae08-bf3e8c741410', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c9a72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029bf32840>]}
[0m10:38:36.613305 [debug] [MainThread]: Command `dbt deps` succeeded at 10:38:36.613155 after 9.99 seconds
[0m10:38:36.613803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c469070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c306840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029c343770>]}
[0m10:38:36.614307 [debug] [MainThread]: Flushing usage events
[0m10:45:54.396450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd2768d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd659af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd276750>]}


============================== 10:45:54.398456 | b5531d58-c428-4acd-ad17-d8cc6ef2f4d1 ==============================
[0m10:45:54.398456 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:45:54.399244 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform'}
[0m10:45:54.428719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5531d58-c428-4acd-ad17-d8cc6ef2f4d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdcb8410>]}
[0m10:45:54.432090 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ooe6fry4'
[0m10:45:54.432941 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:45:54.495403 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:45:54.496633 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:45:54.557943 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:45:54.562469 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:45:54.635558 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:45:54.638844 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:45:54.729159 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:45:54.738555 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:46:01.732052 [info ] [MainThread]: Installed from version 1.3.0
[0m10:46:01.733240 [info ] [MainThread]: Up to date!
[0m10:46:01.734424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5531d58-c428-4acd-ad17-d8cc6ef2f4d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd5f9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd320a40>]}
[0m10:46:01.735458 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:46:05.512577 [info ] [MainThread]: Installed from version 0.10.4
[0m10:46:05.513351 [info ] [MainThread]: Up to date!
[0m10:46:05.514052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5531d58-c428-4acd-ad17-d8cc6ef2f4d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd507650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd507680>]}
[0m10:46:05.514648 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:46:07.072864 [info ] [MainThread]: Installed from version 0.10.1
[0m10:46:07.073999 [info ] [MainThread]: Up to date!
[0m10:46:07.074776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5531d58-c428-4acd-ad17-d8cc6ef2f4d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd5f9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd5a3050>]}
[0m10:46:07.077271 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:07.077102 after 9.37 seconds
[0m10:46:07.077955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd5c89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cdc79df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cd5f9070>]}
[0m10:46:07.078600 [debug] [MainThread]: Flushing usage events
[0m10:54:34.500224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9161df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91739160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91fc8b00>]}


============================== 10:54:34.502181 | 21745e15-ab9b-41da-b12b-ca853a4b24c0 ==============================
[0m10:54:34.502181 [info ] [MainThread]: Running with dbt=1.5.0
[0m10:54:34.502843 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/transform', 'log_path': '/usr/local/airflow/dags/transform/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'printer_width': '80'}
[0m10:54:34.528599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21745e15-ab9b-41da-b12b-ca853a4b24c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91bfda30>]}
[0m10:54:34.531431 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-30igupuw'
[0m10:54:34.532102 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:54:34.599691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:54:34.600711 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:54:34.656311 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:54:34.660208 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:54:34.727447 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:54:34.730958 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:54:34.788566 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:54:34.798083 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:54:39.172179 [info ] [MainThread]: Installed from version 1.3.0
[0m10:54:39.173364 [info ] [MainThread]: Up to date!
[0m10:54:39.174249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21745e15-ab9b-41da-b12b-ca853a4b24c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a95515760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a915463f0>]}
[0m10:54:39.174933 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:54:42.714595 [info ] [MainThread]: Installed from version 0.10.4
[0m10:54:42.715326 [info ] [MainThread]: Up to date!
[0m10:54:42.716127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21745e15-ab9b-41da-b12b-ca853a4b24c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a95515760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a922eab70>]}
[0m10:54:42.716698 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:54:43.911984 [info ] [MainThread]: Installed from version 0.10.1
[0m10:54:43.912669 [info ] [MainThread]: Up to date!
[0m10:54:43.913257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21745e15-ab9b-41da-b12b-ca853a4b24c0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91245fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a913027b0>]}
[0m10:54:43.915427 [debug] [MainThread]: Command `dbt deps` succeeded at 10:54:43.915123 after 9.43 seconds
[0m10:54:43.916078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a958530e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a92b7c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a922eab70>]}
[0m10:54:43.916611 [debug] [MainThread]: Flushing usage events
[0m11:15:20.047160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276d7aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82770dd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827757cc20>]}


============================== 11:15:20.049267 | 246bb2d8-5edc-4985-8ef9-ac0e1a37dbd6 ==============================
[0m11:15:20.049267 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:15:20.050230 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'partial_parse': 'True'}
[0m11:15:20.080258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '246bb2d8-5edc-4985-8ef9-ac0e1a37dbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827752aa80>]}
[0m11:15:20.083161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ecf42fc_'
[0m11:15:20.083887 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:15:20.331006 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:15:20.332048 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:15:20.520056 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:15:20.524113 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m11:15:20.599841 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m11:15:20.604497 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m11:15:20.667959 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m11:15:20.679151 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:15:24.853596 [info ] [MainThread]: Installed from version 1.3.0
[0m11:15:24.854711 [info ] [MainThread]: Up to date!
[0m11:15:24.855643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '246bb2d8-5edc-4985-8ef9-ac0e1a37dbd6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276d983b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276d99760>]}
[0m11:15:24.856612 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m11:15:29.141097 [info ] [MainThread]: Installed from version 0.10.4
[0m11:15:29.142663 [info ] [MainThread]: Up to date!
[0m11:15:29.143595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '246bb2d8-5edc-4985-8ef9-ac0e1a37dbd6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276e04dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276e04710>]}
[0m11:15:29.144392 [info ] [MainThread]: Installing calogica/dbt_date
[0m11:15:30.656774 [info ] [MainThread]: Installed from version 0.10.1
[0m11:15:30.657663 [info ] [MainThread]: Up to date!
[0m11:15:30.658441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '246bb2d8-5edc-4985-8ef9-ac0e1a37dbd6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276e049e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8276e04710>]}
[0m11:15:30.661160 [debug] [MainThread]: Command `dbt deps` succeeded at 11:15:30.660782 after 10.64 seconds
[0m11:15:30.662167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8279a88470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827752aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827b173e60>]}
[0m11:15:30.663033 [debug] [MainThread]: Flushing usage events
[0m11:57:08.185618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b9e7ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bad23800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ba261700>]}


============================== 11:57:08.188054 | 89cd8831-ea77-4f51-84da-9afb090123c8 ==============================
[0m11:57:08.188054 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:57:08.189012 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True'}
[0m11:57:08.924678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bad23800>]}
[0m11:57:08.945454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e7386b0>]}
[0m11:57:09.011302 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:57:11.391025 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m11:57:11.392072 [debug] [MainThread]: Partial parsing: added file: transform://models/intermediate/int_product_test.yml
[0m11:57:11.392940 [debug] [MainThread]: Partial parsing: added file: transform://models/analytics/agg_cat_pef_test.yml
[0m11:57:11.393896 [debug] [MainThread]: Partial parsing: updated file: transform://models/intermediate/int_products.sql
[0m11:57:11.394615 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/dim_products.sql
[0m11:57:11.395336 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m11:57:11.424028 [debug] [MainThread]: 1603: static parser failed on intermediate/int_products.sql
[0m11:57:11.458966 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_products.sql
[0m11:57:11.462565 [debug] [MainThread]: 1699: static parser successfully parsed analytics/dim_products.sql
[0m11:57:11.467229 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m11:57:11.710283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e4d6930>]}
[0m11:57:11.728553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e30cf50>]}
[0m11:57:11.729172 [info ] [MainThread]: Found 6 models, 36 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:57:11.729729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e32d160>]}
[0m11:57:11.732043 [info ] [MainThread]: 
[0m11:57:11.733191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:11.734797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m11:57:11.741278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m11:57:11.747657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m11:57:11.758220 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m11:57:11.761926 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m11:57:11.764762 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m11:57:11.765520 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m11:57:11.766241 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m11:57:11.766892 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m11:57:11.767648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:11.768272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:11.768883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:12.776234 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:12.777950 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m11:57:12.783245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:12.784840 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m11:57:12.801681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:12.803434 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m11:57:12.912567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m11:57:12.913423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m11:57:12.914371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m11:57:12.922252 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m11:57:12.925705 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m11:57:12.928899 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m11:57:12.929691 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m11:57:12.930556 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m11:57:12.931336 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m11:57:12.932028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:12.932687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:12.933282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:13.416627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:57:13.418440 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m11:57:13.452278 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:13.453908 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m11:57:13.456868 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:13.458681 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m11:57:13.578367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e535eb0>]}
[0m11:57:13.579336 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:57:13.579922 [info ] [MainThread]: 
[0m11:57:13.586829 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m11:57:13.587619 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m11:57:13.588621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.stg_products)
[0m11:57:13.589410 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m11:57:13.591574 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m11:57:13.598707 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 11:57:13.590061 => 11:57:13.598395
[0m11:57:13.599361 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m11:57:13.627224 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m11:57:13.636812 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m11:57:13.637742 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m11:57:13.638603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:14.201820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:14.222654 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 11:57:13.599883 => 11:57:14.222462
[0m11:57:14.223392 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m11:57:14.334359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e348e60>]}
[0m11:57:14.335283 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.75s]
[0m11:57:14.336677 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m11:57:14.338573 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m11:57:14.339543 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m11:57:14.340748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m11:57:14.341692 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m11:57:14.350346 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m11:57:14.358239 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 11:57:14.342287 => 11:57:14.357936
[0m11:57:14.359010 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m11:57:14.379293 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m11:57:14.389363 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m11:57:14.390107 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category),0),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "COLOR_COUNTS",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("COLOR_COUNTS" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m11:57:14.390722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:57:17.733478 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:57:17.736787 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 11:57:14.359595 => 11:57:17.736599
[0m11:57:17.737454 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m11:57:17.849586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e4d62a0>]}
[0m11:57:17.850673 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.51s]
[0m11:57:17.852176 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m11:57:17.853626 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m11:57:17.854328 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m11:57:17.855850 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m11:57:17.856504 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m11:57:17.862561 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m11:57:17.873942 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 11:57:17.856909 => 11:57:17.873385
[0m11:57:17.874908 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m11:57:17.880303 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m11:57:17.888903 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m11:57:17.889566 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m11:57:17.890117 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m11:57:18.756140 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:18.758888 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 11:57:17.875480 => 11:57:18.758711
[0m11:57:18.759705 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m11:57:18.873879 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08c0f2ea0>]}
[0m11:57:18.875841 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.02s]
[0m11:57:18.878174 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m11:57:18.880358 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m11:57:18.881564 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m11:57:18.882883 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m11:57:18.883637 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m11:57:18.887195 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m11:57:18.894309 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 11:57:18.884145 => 11:57:18.894008
[0m11:57:18.895167 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m11:57:18.898689 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m11:57:18.907096 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m11:57:18.907779 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."COLOR_COUNTS",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m11:57:18.908427 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m11:57:24.503129 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m11:57:24.505924 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 11:57:18.895829 => 11:57:24.505749
[0m11:57:24.506568 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m11:57:24.617342 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08c0f2ea0>]}
[0m11:57:24.618240 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 5.73s]
[0m11:57:24.619286 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m11:57:24.620674 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m11:57:24.621419 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m11:57:24.622479 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m11:57:24.623164 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m11:57:24.626287 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m11:57:24.634269 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 11:57:24.623617 => 11:57:24.633889
[0m11:57:24.635121 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m11:57:24.639913 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m11:57:24.647918 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m11:57:24.648734 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
ON prod.prod_id = inttable.sk_id
        );
[0m11:57:24.649531 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m11:57:26.591154 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:57:26.593995 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 11:57:24.635755 => 11:57:26.593810
[0m11:57:26.594572 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m11:57:26.879831 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bc70b830>]}
[0m11:57:26.880704 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 2.26s]
[0m11:57:26.881640 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m11:57:26.882912 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m11:57:26.883825 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m11:57:26.884811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.agg_category_performance)
[0m11:57:26.885475 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m11:57:26.888882 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m11:57:26.896641 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 11:57:26.885900 => 11:57:26.896325
[0m11:57:26.897554 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m11:57:26.901314 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m11:57:26.908956 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m11:57:26.909653 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT
        ct.category AS category,
        SUM(fct_prod.price_dollars * fct_prod.selling_proposition) AS revenue,
        SUM(fct_prod.selling_proposition) AS total_units_sold,
        ROUND(AVG(fct_prod.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct_prod.discount), 2) AS avg_discount,
        COUNT(*) AS total_products,
        SUM(fct_prod.price_dollars * fct_prod.selling_proposition) / SUM(selling_proposition) AS avg_order_value
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct_prod.category_id = ct.category_id
    GROUP BY ct.category
)

SELECT 
    *       
FROM cat_perf
ORDER BY revenue DESC
        );
[0m11:57:26.910200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:57:33.510772 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba796d-0000-fda3-0001-4c5e000f5162
[0m11:57:33.511495 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 100051 (22012): Division by zero
[0m11:57:33.512181 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 11:57:26.898242 => 11:57:33.511986
[0m11:57:33.512777 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m11:57:33.627962 [debug] [Thread-2 (]: Database Error in model agg_category_performance (models/analytics/agg_category_performance.sql)
  100051 (22012): Division by zero
  compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m11:57:33.628721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89cd8831-ea77-4f51-84da-9afb090123c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0bc70b3e0>]}
[0m11:57:33.629563 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 6.74s]
[0m11:57:33.630459 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m11:57:33.633607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:33.634205 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m11:57:33.634572 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m11:57:33.634950 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m11:57:33.635422 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m11:57:33.635877 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m11:57:33.636270 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m11:57:33.636959 [info ] [MainThread]: 
[0m11:57:33.637635 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 21.90 seconds (21.90s).
[0m11:57:33.640072 [debug] [MainThread]: Command end result
[0m11:57:33.661346 [info ] [MainThread]: 
[0m11:57:33.662412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:57:33.663355 [info ] [MainThread]: 
[0m11:57:33.664338 [error] [MainThread]: [33mDatabase Error in model agg_category_performance (models/analytics/agg_category_performance.sql)[0m
[0m11:57:33.665264 [error] [MainThread]:   100051 (22012): Division by zero
[0m11:57:33.666130 [error] [MainThread]:   compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m11:57:33.667167 [info ] [MainThread]: 
[0m11:57:33.668105 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:57:33.669545 [debug] [MainThread]: Command `dbt run` failed at 11:57:33.669337 after 22.27 seconds
[0m11:57:33.670180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0babdad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08e677ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ba1a4a40>]}
[0m11:57:33.670799 [debug] [MainThread]: Flushing usage events
[0m12:17:03.336914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846ef1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846ad8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84aa8cbf0>]}


============================== 12:17:03.338909 | 00c26531-285b-4c38-9f20-ac910a0ae2ec ==============================
[0m12:17:03.338909 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:17:03.339831 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/transform/logs', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'partial_parse': 'True'}
[0m12:17:04.057585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846b93ce0>]}
[0m12:17:04.075793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa845e482f0>]}
[0m12:17:04.143677 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m12:17:07.074887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:07.075737 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m12:17:07.099233 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m12:17:07.273635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81ae245f0>]}
[0m12:17:07.292917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81acc72c0>]}
[0m12:17:07.293592 [info ] [MainThread]: Found 6 models, 36 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:17:07.294175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81bc4d610>]}
[0m12:17:07.296277 [info ] [MainThread]: 
[0m12:17:07.297359 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:07.298899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:17:07.299789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:17:07.300756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:17:07.319357 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:17:07.321178 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:17:07.323701 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:17:07.324318 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:17:07.324951 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:17:07.325584 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:17:07.326184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:07.326724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:07.327239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:08.480618 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:17:08.481470 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:17:08.483224 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:17:08.484110 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:17:08.485747 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:17:08.489362 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:17:08.624545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m12:17:08.625586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m12:17:08.626541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m12:17:08.634850 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m12:17:08.639471 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m12:17:08.642730 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:17:08.643544 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m12:17:08.644261 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m12:17:08.644866 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m12:17:08.645610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:08.646206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:08.646821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:08.988042 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:17:08.990238 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m12:17:09.114004 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:17:09.115639 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m12:17:09.137878 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:17:09.139287 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:17:09.263406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa847b96ab0>]}
[0m12:17:09.264480 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:17:09.265382 [info ] [MainThread]: 
[0m12:17:09.274181 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:17:09.275193 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:17:09.276438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.stg_products)
[0m12:17:09.277162 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:17:09.279824 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:17:09.291610 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 12:17:09.277733 => 12:17:09.291178
[0m12:17:09.292382 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:17:09.321206 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:17:09.330135 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:17:09.330751 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:17:09.331398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:09.894975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:17:09.920228 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 12:17:09.292903 => 12:17:09.920037
[0m12:17:09.920760 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:17:10.083551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8199b6810>]}
[0m12:17:10.084545 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.81s]
[0m12:17:10.086389 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:17:10.088528 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:17:10.089453 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m12:17:10.090935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.int_products)
[0m12:17:10.092000 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:17:10.111796 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:17:10.119897 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 12:17:10.092546 => 12:17:10.119490
[0m12:17:10.120499 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:17:10.142779 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:17:10.152497 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:17:10.153141 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category),0),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "COLOR_COUNTS",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("COLOR_COUNTS" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m12:17:10.153729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:17:13.412836 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:17:13.415779 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 12:17:10.120995 => 12:17:13.415590
[0m12:17:13.416462 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:17:13.527442 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813f75580>]}
[0m12:17:13.528432 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 3.44s]
[0m12:17:13.529776 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:17:13.531241 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m12:17:13.532187 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m12:17:13.533443 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m12:17:13.534212 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m12:17:13.538611 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m12:17:13.546893 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 12:17:13.534788 => 12:17:13.546527
[0m12:17:13.547704 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m12:17:13.551213 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m12:17:13.561471 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m12:17:13.562239 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m12:17:13.563008 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:17:17.727598 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:17:17.731722 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 12:17:13.548304 => 12:17:17.731431
[0m12:17:17.732569 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m12:17:17.841839 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813f76030>]}
[0m12:17:17.842793 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 4.31s]
[0m12:17:17.843998 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m12:17:17.845663 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m12:17:17.846371 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m12:17:17.847762 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m12:17:17.848582 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m12:17:17.852835 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m12:17:17.860035 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 12:17:17.849100 => 12:17:17.859507
[0m12:17:17.860882 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m12:17:17.865500 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m12:17:17.873238 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m12:17:17.874046 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."COLOR_COUNTS",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m12:17:17.874923 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:17:19.630813 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:17:19.633863 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 12:17:17.861411 => 12:17:19.633659
[0m12:17:19.634564 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m12:17:19.740451 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813f75130>]}
[0m12:17:19.741342 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 1.89s]
[0m12:17:19.742459 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m12:17:19.743900 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m12:17:19.744752 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m12:17:19.745995 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m12:17:19.746777 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m12:17:19.750815 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m12:17:19.758602 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 12:17:19.747308 => 12:17:19.758211
[0m12:17:19.759448 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m12:17:19.763333 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m12:17:19.771936 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m12:17:19.772728 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
ON prod.prod_id = inttable.sk_id
        );
[0m12:17:19.773313 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m12:17:21.794647 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:17:21.797695 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 12:17:19.760044 => 12:17:21.797510
[0m12:17:21.798379 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m12:17:21.907977 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa813fbaba0>]}
[0m12:17:21.908866 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 2.16s]
[0m12:17:21.910182 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m12:17:21.911798 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m12:17:21.912575 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m12:17:21.913792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.agg_category_performance)
[0m12:17:21.914500 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m12:17:21.917666 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m12:17:21.925348 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 12:17:21.914944 => 12:17:21.925048
[0m12:17:21.925850 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m12:17:21.928536 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m12:17:21.936168 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m12:17:21.936846 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT
        ct.category AS category,
        SUM(fct_prod.price_dollars * fct_prod.selling_proposition) AS revenue,
        SUM(fct_prod.selling_proposition) AS total_units_sold,
        ROUND(AVG(fct_prod.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct_prod.discount), 2) AS avg_discount,
        COUNT(*) AS total_products,
        CAST(
        CASE 
            WHEN SUM(selling_proposition) = 0 THEN 0  -- Returning 0 as a float
            ELSE SUM(price * selling_proposition) / SUM(selling_proposition)
        END
        AS FLOAT) AS avg_order_value
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct_prod.category_id = ct.category_id
    GROUP BY ct.category
)

SELECT 
    *       
FROM cat_perf
ORDER BY revenue DESC
        );
[0m12:17:21.937434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:22.421801 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba7981-0000-fda8-0001-4c5e000f328e
[0m12:17:22.422482 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 21
invalid identifier 'PRICE'
[0m12:17:22.423126 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 12:17:21.926158 => 12:17:22.422938
[0m12:17:22.423718 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m12:17:22.531663 [debug] [Thread-2 (]: Database Error in model agg_category_performance (models/analytics/agg_category_performance.sql)
  000904 (42000): SQL compilation error: error line 15 at position 21
  invalid identifier 'PRICE'
  compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m12:17:22.532449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c26531-285b-4c38-9f20-ac910a0ae2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8199fca70>]}
[0m12:17:22.533153 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model products_schema_analytics.agg_category_performance  [[31mERROR[0m in 0.62s]
[0m12:17:22.534000 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m12:17:22.537291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:22.537905 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:17:22.538361 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:17:22.538796 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m12:17:22.539255 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m12:17:22.539690 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m12:17:22.540113 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m12:17:22.540693 [info ] [MainThread]: 
[0m12:17:22.541297 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m12:17:22.543174 [debug] [MainThread]: Command end result
[0m12:17:22.562741 [info ] [MainThread]: 
[0m12:17:22.563610 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:17:22.564634 [info ] [MainThread]: 
[0m12:17:22.565750 [error] [MainThread]: [33mDatabase Error in model agg_category_performance (models/analytics/agg_category_performance.sql)[0m
[0m12:17:22.566690 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 21
[0m12:17:22.567825 [error] [MainThread]:   invalid identifier 'PRICE'
[0m12:17:22.568944 [error] [MainThread]:   compiled Code at target/run/transform/models/analytics/agg_category_performance.sql
[0m12:17:22.570227 [info ] [MainThread]: 
[0m12:17:22.571500 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m12:17:22.572656 [debug] [MainThread]: Command `dbt run` failed at 12:17:22.572433 after 16.13 seconds
[0m12:17:22.573353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846bce000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820456f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa846f32e40>]}
[0m12:17:22.574016 [debug] [MainThread]: Flushing usage events
[0m12:21:29.223705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105c83fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105d649fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105cb218b0>]}


============================== 12:21:29.225723 | 04a49020-89dc-44c3-a77c-55a844e42c80 ==============================
[0m12:21:29.225723 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:21:29.226399 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None'}
[0m12:21:29.785794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105d8746b0>]}
[0m12:21:29.801966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105c923b60>]}
[0m12:21:29.861997 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m12:21:32.279515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:32.280342 [debug] [MainThread]: Partial parsing: updated file: transform://models/analytics/agg_category_performance.sql
[0m12:21:32.303036 [debug] [MainThread]: 1699: static parser successfully parsed analytics/agg_category_performance.sql
[0m12:21:32.468837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035e1b290>]}
[0m12:21:32.491304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035170140>]}
[0m12:21:32.492289 [info ] [MainThread]: Found 6 models, 36 tests, 0 snapshots, 0 analyses, 704 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:21:32.493082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035e503b0>]}
[0m12:21:32.495222 [info ] [MainThread]: 
[0m12:21:32.496385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:32.498172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:21:32.499117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:21:32.505916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_E_COMMERCE_PRODUCT'
[0m12:21:32.518892 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:21:32.520400 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:21:32.523199 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT"
[0m12:21:32.523960 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:21:32.524570 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:21:32.525198 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT"} */
show terse schemas in database E_COMMERCE_PRODUCT
    limit 10000
[0m12:21:32.525761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:32.526266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:32.526880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:33.073811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:33.075575 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:33.076317 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:33.077844 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:21:33.079697 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:21:33.081502 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT: Close
[0m12:21:33.197321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_intermediate)
[0m12:21:33.198191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema)
[0m12:21:33.199044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT, now list_E_COMMERCE_PRODUCT_products_schema_analytics)
[0m12:21:33.205730 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_intermediate"
[0m12:21:33.208980 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema"
[0m12:21:33.212082 [debug] [ThreadPool]: Using snowflake connection "list_E_COMMERCE_PRODUCT_products_schema_analytics"
[0m12:21:33.212786 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_intermediate"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_intermediate
[0m12:21:33.213586 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema
[0m12:21:33.214231 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "connection_name": "list_E_COMMERCE_PRODUCT_products_schema_analytics"} */
show terse objects in E_COMMERCE_PRODUCT.products_schema_analytics
[0m12:21:33.214746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.215265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.215823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.720081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:33.721713 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema: Close
[0m12:21:33.742394 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:33.744100 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_intermediate: Close
[0m12:21:33.746165 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:33.748046 [debug] [ThreadPool]: On list_E_COMMERCE_PRODUCT_products_schema_analytics: Close
[0m12:21:33.862416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035302c60>]}
[0m12:21:33.863425 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:21:33.864107 [info ] [MainThread]: 
[0m12:21:33.871022 [debug] [Thread-1 (]: Began running node model.transform.stg_products
[0m12:21:33.871865 [info ] [Thread-1 (]: 1 of 6 START sql view model products_schema.stg_products ....................... [RUN]
[0m12:21:33.872983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_analytics, now model.transform.stg_products)
[0m12:21:33.873740 [debug] [Thread-1 (]: Began compiling node model.transform.stg_products
[0m12:21:33.875971 [debug] [Thread-1 (]: Writing injected SQL for node "model.transform.stg_products"
[0m12:21:33.884286 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (compile): 12:21:33.874301 => 12:21:33.883923
[0m12:21:33.885041 [debug] [Thread-1 (]: Began executing node model.transform.stg_products
[0m12:21:33.912808 [debug] [Thread-1 (]: Writing runtime sql for node "model.transform.stg_products"
[0m12:21:33.921126 [debug] [Thread-1 (]: Using snowflake connection "model.transform.stg_products"
[0m12:21:33.921786 [debug] [Thread-1 (]: On model.transform.stg_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.stg_products"} */
create or replace   view E_COMMERCE_PRODUCT.products_schema.stg_products
  
   as (
    SELECT 
    METADATA$FILENAME AS file_name,
    METADATA$FILE_ROW_NUMBER AS row_number,
    $1:"goods-title-link--jump"::STRING AS goods_title_link_jump, 
    $1:"goods-title-link--jump href"::STRING AS goods_title_link_href, 
    $1:"rank-title"::STRING AS rank_title,
    $1:"rank-sub"::STRING AS rank_sub,
    $1:"price"::STRING AS price,
    $1:"discount"::STRING AS discount,
    $1:"selling_proposition"::STRING AS selling_proposition,
    $1:"goods-title-link"::STRING AS goods_title_link,
    $1:"color-count"::INTEGER AS color_count,
    $1:"blackfridaybelts-bg src"::STRING AS blackfridaybelts_bg_src,
    $1:"blackfridaybelts-content"::STRING AS blackfridaybelts_content,
FROM 
    @product_stage
    (file_format => 'parquet_format', pattern => '.*.parquet')
  );
[0m12:21:33.922308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:34.358107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:21:34.379289 [debug] [Thread-1 (]: Timing info for model.transform.stg_products (execute): 12:21:33.885505 => 12:21:34.379101
[0m12:21:34.380028 [debug] [Thread-1 (]: On model.transform.stg_products: Close
[0m12:21:34.484731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105c868c20>]}
[0m12:21:34.485672 [info ] [Thread-1 (]: 1 of 6 OK created sql view model products_schema.stg_products .................. [[32mSUCCESS 1[0m in 0.61s]
[0m12:21:34.486763 [debug] [Thread-1 (]: Finished running node model.transform.stg_products
[0m12:21:34.488578 [debug] [Thread-3 (]: Began running node model.transform.int_products
[0m12:21:34.489444 [info ] [Thread-3 (]: 2 of 6 START sql table model products_schema_intermediate.int_products ......... [RUN]
[0m12:21:34.490628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema, now model.transform.int_products)
[0m12:21:34.491465 [debug] [Thread-3 (]: Began compiling node model.transform.int_products
[0m12:21:34.507521 [debug] [Thread-3 (]: Writing injected SQL for node "model.transform.int_products"
[0m12:21:34.516158 [debug] [Thread-3 (]: Timing info for model.transform.int_products (compile): 12:21:34.492073 => 12:21:34.515847
[0m12:21:34.516859 [debug] [Thread-3 (]: Began executing node model.transform.int_products
[0m12:21:34.537131 [debug] [Thread-3 (]: Writing runtime sql for node "model.transform.int_products"
[0m12:21:34.547021 [debug] [Thread-3 (]: Using snowflake connection "model.transform.int_products"
[0m12:21:34.547696 [debug] [Thread-3 (]: On model.transform.int_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.int_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
         as
        (WITH clean_cols AS 
    (
    SELECT
        goods_title_link,
        GOODS_TITLE_LINK_JUMP,
        SPLIT("FILE_NAME", '-')[2]::STRING AS category,
        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,
        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,
        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS "PRICE($)",
        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,
        CASE
            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' 
                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000
            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT
        END AS selling_proposition,
        COLOR_COUNT,
        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS "BLACKFRIDAYBELTS_CONTENT(Save $)"
    FROM E_COMMERCE_PRODUCT.products_schema.stg_products
    ),

null_filled AS (
    SELECT
        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,
        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  
        category,
        COALESCE(rank_title, -1) AS rank_title, 
        COALESCE(rank_sub, 'Unknown') AS rank_sub,
        ROUND(COALESCE("PRICE($)", AVG("PRICE($)") OVER(PARTITION BY category)),2) AS price_dollars,
        ROUND(COALESCE(DISCOUNT, AVG(DISCOUNT) OVER(PARTITION BY category)),2) AS discount,
        ROUND(COALESCE(selling_proposition, AVG(selling_proposition) OVER(PARTITION BY category),0),2)::INTEGER AS selling_proposition,
        COALESCE(COLOR_COUNT, 0) AS "COLOR_COUNTS",
        COALESCE("BLACKFRIDAYBELTS_CONTENT(Save $)", 0) AS blackfriday_savings
    FROM clean_cols
),

unique_rows AS (
SELECT 
    DISTINCT *
FROM null_filled
)

SELECT 
    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("COLOR_COUNTS" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,
     * 
FROM unique_rows
        );
[0m12:21:34.548423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:21:36.287461 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:21:36.290153 [debug] [Thread-3 (]: Timing info for model.transform.int_products (execute): 12:21:34.517360 => 12:21:36.289960
[0m12:21:36.290616 [debug] [Thread-3 (]: On model.transform.int_products: Close
[0m12:21:36.392898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1025ba91f0>]}
[0m12:21:36.393653 [info ] [Thread-3 (]: 2 of 6 OK created sql table model products_schema_intermediate.int_products .... [[32mSUCCESS 1[0m in 1.90s]
[0m12:21:36.394524 [debug] [Thread-3 (]: Finished running node model.transform.int_products
[0m12:21:36.396269 [debug] [Thread-5 (]: Began running node model.transform.dim_category
[0m12:21:36.397067 [info ] [Thread-5 (]: 3 of 6 START sql table model products_schema_analytics.dim_category ............ [RUN]
[0m12:21:36.398207 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.transform.dim_category'
[0m12:21:36.398868 [debug] [Thread-5 (]: Began compiling node model.transform.dim_category
[0m12:21:36.404226 [debug] [Thread-5 (]: Writing injected SQL for node "model.transform.dim_category"
[0m12:21:36.410806 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (compile): 12:21:36.399300 => 12:21:36.410465
[0m12:21:36.411325 [debug] [Thread-5 (]: Began executing node model.transform.dim_category
[0m12:21:36.414374 [debug] [Thread-5 (]: Writing runtime sql for node "model.transform.dim_category"
[0m12:21:36.422301 [debug] [Thread-5 (]: Using snowflake connection "model.transform.dim_category"
[0m12:21:36.422940 [debug] [Thread-5 (]: On model.transform.dim_category: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_category"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_category
         as
        (WITH cat_desc AS
(
    SELECT 
        DISTINCT category
    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products
)

SELECT 
    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,
    category
FROM cat_desc
        );
[0m12:21:36.423371 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:21:37.587938 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:37.591190 [debug] [Thread-5 (]: Timing info for model.transform.dim_category (execute): 12:21:36.411647 => 12:21:37.590993
[0m12:21:37.591828 [debug] [Thread-5 (]: On model.transform.dim_category: Close
[0m12:21:37.709657 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1025babd10>]}
[0m12:21:37.710522 [info ] [Thread-5 (]: 3 of 6 OK created sql table model products_schema_analytics.dim_category ....... [[32mSUCCESS 1[0m in 1.31s]
[0m12:21:37.711524 [debug] [Thread-5 (]: Finished running node model.transform.dim_category
[0m12:21:37.712798 [debug] [Thread-7 (]: Began running node model.transform.dim_products
[0m12:21:37.713531 [info ] [Thread-7 (]: 4 of 6 START sql table model products_schema_analytics.dim_products ............ [RUN]
[0m12:21:37.714663 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.transform.dim_products'
[0m12:21:37.715312 [debug] [Thread-7 (]: Began compiling node model.transform.dim_products
[0m12:21:37.718335 [debug] [Thread-7 (]: Writing injected SQL for node "model.transform.dim_products"
[0m12:21:37.724785 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (compile): 12:21:37.715689 => 12:21:37.724457
[0m12:21:37.725371 [debug] [Thread-7 (]: Began executing node model.transform.dim_products
[0m12:21:37.728225 [debug] [Thread-7 (]: Writing runtime sql for node "model.transform.dim_products"
[0m12:21:37.734132 [debug] [Thread-7 (]: Using snowflake connection "model.transform.dim_products"
[0m12:21:37.734961 [debug] [Thread-7 (]: On model.transform.dim_products: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.dim_products"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.dim_products
         as
        (SELECT 
    inttable.sk_id AS prod_id,
    inttable.title,
    ct.category_id,
    inttable.rank_title,
    inttable.rank_sub,
    inttable.GOODS_TITLE_LINK_JUMP,
    inttable."COLOR_COUNTS",
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON inttable.category = ct.category
        );
[0m12:21:37.735537 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:21:43.147821 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m12:21:43.151249 [debug] [Thread-7 (]: Timing info for model.transform.dim_products (execute): 12:21:37.725700 => 12:21:43.151055
[0m12:21:43.151944 [debug] [Thread-7 (]: On model.transform.dim_products: Close
[0m12:21:43.252903 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1025ba9010>]}
[0m12:21:43.253921 [info ] [Thread-7 (]: 4 of 6 OK created sql table model products_schema_analytics.dim_products ....... [[32mSUCCESS 1[0m in 5.54s]
[0m12:21:43.255258 [debug] [Thread-7 (]: Finished running node model.transform.dim_products
[0m12:21:43.256983 [debug] [Thread-9 (]: Began running node model.transform.fact_products_performance
[0m12:21:43.257836 [info ] [Thread-9 (]: 5 of 6 START sql table model products_schema_analytics.fact_products_performance  [RUN]
[0m12:21:43.259301 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.transform.fact_products_performance'
[0m12:21:43.260337 [debug] [Thread-9 (]: Began compiling node model.transform.fact_products_performance
[0m12:21:43.264548 [debug] [Thread-9 (]: Writing injected SQL for node "model.transform.fact_products_performance"
[0m12:21:43.277329 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (compile): 12:21:43.261187 => 12:21:43.276754
[0m12:21:43.278400 [debug] [Thread-9 (]: Began executing node model.transform.fact_products_performance
[0m12:21:43.283270 [debug] [Thread-9 (]: Writing runtime sql for node "model.transform.fact_products_performance"
[0m12:21:43.294524 [debug] [Thread-9 (]: Using snowflake connection "model.transform.fact_products_performance"
[0m12:21:43.295120 [debug] [Thread-9 (]: On model.transform.fact_products_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.fact_products_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance
         as
        (SELECT 
    prod.prod_id,
    prod.category_id,
    inttable.price_dollars,
    inttable.discount,
    inttable.selling_proposition,
    inttable.blackfriday_savings
FROM E_COMMERCE_PRODUCT.products_schema_analytics.dim_products AS prod
JOIN E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable
ON prod.prod_id = inttable.sk_id
        );
[0m12:21:43.295675 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m12:21:44.923876 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:21:44.927123 [debug] [Thread-9 (]: Timing info for model.transform.fact_products_performance (execute): 12:21:43.279425 => 12:21:44.926942
[0m12:21:44.927721 [debug] [Thread-9 (]: On model.transform.fact_products_performance: Close
[0m12:21:45.034515 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1024233230>]}
[0m12:21:45.035378 [info ] [Thread-9 (]: 5 of 6 OK created sql table model products_schema_analytics.fact_products_performance  [[32mSUCCESS 1[0m in 1.78s]
[0m12:21:45.036260 [debug] [Thread-9 (]: Finished running node model.transform.fact_products_performance
[0m12:21:45.037560 [debug] [Thread-2 (]: Began running node model.transform.agg_category_performance
[0m12:21:45.038275 [info ] [Thread-2 (]: 6 of 6 START sql table model products_schema_analytics.agg_category_performance  [RUN]
[0m12:21:45.039373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_E_COMMERCE_PRODUCT_products_schema_intermediate, now model.transform.agg_category_performance)
[0m12:21:45.040105 [debug] [Thread-2 (]: Began compiling node model.transform.agg_category_performance
[0m12:21:45.043255 [debug] [Thread-2 (]: Writing injected SQL for node "model.transform.agg_category_performance"
[0m12:21:45.051084 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (compile): 12:21:45.040495 => 12:21:45.050708
[0m12:21:45.051734 [debug] [Thread-2 (]: Began executing node model.transform.agg_category_performance
[0m12:21:45.054553 [debug] [Thread-2 (]: Writing runtime sql for node "model.transform.agg_category_performance"
[0m12:21:45.066381 [debug] [Thread-2 (]: Using snowflake connection "model.transform.agg_category_performance"
[0m12:21:45.067131 [debug] [Thread-2 (]: On model.transform.agg_category_performance: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "e-commerce", "target_name": "dev", "node_id": "model.transform.agg_category_performance"} */
create or replace transient table E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance
         as
        (WITH cat_perf AS
(
    SELECT
        ct.category AS category,
        SUM(fct_prod.price_dollars * fct_prod.selling_proposition) AS revenue,
        SUM(fct_prod.selling_proposition) AS total_units_sold,
        ROUND(AVG(fct_prod.price_dollars), 2) AS avg_price_dollars,
        ROUND(AVG(fct_prod.discount), 2) AS avg_discount,
        COUNT(*) AS total_products,
        CAST(
        CASE 
            WHEN SUM(fct_prod.selling_proposition) = 0 THEN 0  -- Returning 0 as a float
            ELSE SUM(fct_prod.price_dollars * fct_prod.selling_proposition) / SUM(selling_proposition)
        END
        AS FLOAT) AS avg_order_value
    FROM E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance AS fct_prod
    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct
    ON fct_prod.category_id = ct.category_id
    GROUP BY ct.category
)

SELECT 
    *       
FROM cat_perf
ORDER BY revenue DESC
        );
[0m12:21:45.067821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:21:46.117567 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:21:46.120575 [debug] [Thread-2 (]: Timing info for model.transform.agg_category_performance (execute): 12:21:45.052118 => 12:21:46.120373
[0m12:21:46.121272 [debug] [Thread-2 (]: On model.transform.agg_category_performance: Close
[0m12:21:46.233834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a49020-89dc-44c3-a77c-55a844e42c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1024231850>]}
[0m12:21:46.234819 [info ] [Thread-2 (]: 6 of 6 OK created sql table model products_schema_analytics.agg_category_performance  [[32mSUCCESS 1[0m in 1.19s]
[0m12:21:46.236133 [debug] [Thread-2 (]: Finished running node model.transform.agg_category_performance
[0m12:21:46.239599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:46.240294 [debug] [MainThread]: Connection 'model.transform.agg_category_performance' was properly closed.
[0m12:21:46.240771 [debug] [MainThread]: Connection 'model.transform.int_products' was properly closed.
[0m12:21:46.241188 [debug] [MainThread]: Connection 'model.transform.stg_products' was properly closed.
[0m12:21:46.241551 [debug] [MainThread]: Connection 'model.transform.dim_category' was properly closed.
[0m12:21:46.241886 [debug] [MainThread]: Connection 'model.transform.dim_products' was properly closed.
[0m12:21:46.242318 [debug] [MainThread]: Connection 'model.transform.fact_products_performance' was properly closed.
[0m12:21:46.242926 [info ] [MainThread]: 
[0m12:21:46.243828 [info ] [MainThread]: Finished running 1 view model, 5 table models in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m12:21:46.246285 [debug] [MainThread]: Command end result
[0m12:21:46.267086 [info ] [MainThread]: 
[0m12:21:46.268169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:46.269484 [info ] [MainThread]: 
[0m12:21:46.270893 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:21:46.272134 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:46.271929 after 13.92 seconds
[0m12:21:46.272924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105cd2cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1034ef8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035e503b0>]}
[0m12:21:46.273548 [debug] [MainThread]: Flushing usage events
[0m12:24:46.971178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb41b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb49d2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb49954f0>]}


============================== 12:24:46.973031 | d634d76a-bf34-4595-a311-baba335044ba ==============================
[0m12:24:46.973031 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:24:46.973790 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/transform', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False'}
[0m12:24:47.001476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd634d76a-bf34-4595-a311-baba335044ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb50a86b0>]}
[0m12:24:47.004337 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tpeuzfx4'
[0m12:24:47.005070 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:24:47.130110 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:24:47.131235 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:24:47.195975 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:24:47.200339 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:24:47.262862 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:24:47.267783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:24:47.346213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:24:47.359830 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:24:51.352111 [info ] [MainThread]: Installed from version 1.3.0
[0m12:24:51.352898 [info ] [MainThread]: Up to date!
[0m12:24:51.353557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd634d76a-bf34-4595-a311-baba335044ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4519460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb44e27e0>]}
[0m12:24:51.354033 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:24:56.479113 [info ] [MainThread]: Installed from version 0.10.4
[0m12:24:56.479873 [info ] [MainThread]: Up to date!
[0m12:24:56.480638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd634d76a-bf34-4595-a311-baba335044ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb49aab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb420aea0>]}
[0m12:24:56.481263 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:25:01.838475 [info ] [MainThread]: Installed from version 0.10.1
[0m12:25:01.839187 [info ] [MainThread]: Up to date!
[0m12:25:01.839867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd634d76a-bf34-4595-a311-baba335044ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb49aab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4419430>]}
[0m12:25:01.841750 [debug] [MainThread]: Command `dbt deps` succeeded at 12:25:01.841547 after 11.72 seconds
[0m12:25:01.842467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4b4d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4e84bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb50a86b0>]}
[0m12:25:01.843020 [debug] [MainThread]: Flushing usage events
[0m13:06:30.606273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbab21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafd0f2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbab3770>]}


============================== 13:06:30.608233 | 037459f3-e72b-4407-a596-9867e242f737 ==============================
[0m13:06:30.608233 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:06:30.608984 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/transform', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/transform/logs', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True'}
[0m13:06:30.636854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '037459f3-e72b-4407-a596-9867e242f737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbf733e0>]}
[0m13:06:30.639985 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oxwnem_0'
[0m13:06:30.640778 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:06:31.186351 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:06:31.187748 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:06:30.409154 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:06:30.413111 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:06:30.500222 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:06:30.503592 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:06:30.593351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:06:33.052664 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:06:37.354208 [info ] [MainThread]: Installed from version 1.3.0
[0m13:06:37.354942 [info ] [MainThread]: Up to date!
[0m13:06:37.355639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '037459f3-e72b-4407-a596-9867e242f737', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafd0bee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb959760>]}
[0m13:06:37.356176 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:06:44.234272 [info ] [MainThread]: Installed from version 0.10.4
[0m13:06:44.235013 [info ] [MainThread]: Up to date!
[0m13:06:44.235761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '037459f3-e72b-4407-a596-9867e242f737', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb959910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb9599d0>]}
[0m13:06:44.236375 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:06:45.612680 [info ] [MainThread]: Installed from version 0.10.1
[0m13:06:45.613848 [info ] [MainThread]: Up to date!
[0m13:06:45.614919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '037459f3-e72b-4407-a596-9867e242f737', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbab2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb959610>]}
[0m13:06:45.616923 [debug] [MainThread]: Command `dbt deps` succeeded at 13:06:45.616730 after 13.43 seconds
[0m13:06:45.617679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafc52bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafe427590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafeed8ce0>]}
[0m13:06:45.618510 [debug] [MainThread]: Flushing usage events
[0m13:25:04.868221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefda77b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdf9f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdd591f0>]}


============================== 13:25:04.871027 | a9dc1650-d3a7-482a-a158-3b1939c3c44d ==============================
[0m13:25:04.871027 [info ] [MainThread]: Running with dbt=1.5.0
[0m13:25:04.871933 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/transform/logs', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/transform', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False'}
[0m13:25:04.913993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9dc1650-d3a7-482a-a158-3b1939c3c44d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefde5ba70>]}
[0m13:25:04.919460 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oxscbhhq'
[0m13:25:04.920319 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:25:05.117900 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:25:05.118944 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:25:05.205728 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:25:05.209681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:25:05.299403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:25:05.302923 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:25:05.417153 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:25:05.426431 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:25:11.346299 [info ] [MainThread]: Installed from version 1.3.0
[0m13:25:11.347278 [info ] [MainThread]: Up to date!
[0m13:25:11.348244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a9dc1650-d3a7-482a-a158-3b1939c3c44d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdd064b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdaf33e0>]}
[0m13:25:11.348854 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:25:16.163540 [info ] [MainThread]: Installed from version 0.10.4
[0m13:25:16.165033 [info ] [MainThread]: Up to date!
[0m13:25:16.166489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a9dc1650-d3a7-482a-a158-3b1939c3c44d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefda76de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefda76ba0>]}
[0m13:25:16.167246 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:25:17.635250 [info ] [MainThread]: Installed from version 0.10.1
[0m13:25:17.636119 [info ] [MainThread]: Up to date!
[0m13:25:17.636677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a9dc1650-d3a7-482a-a158-3b1939c3c44d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdf12de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdf13680>]}
[0m13:25:17.638552 [debug] [MainThread]: Command `dbt deps` succeeded at 13:25:17.638355 after 12.79 seconds
[0m13:25:17.639159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefe317fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdd064b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefdf9eab0>]}
[0m13:25:17.639564 [debug] [MainThread]: Flushing usage events
