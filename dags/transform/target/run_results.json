{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-02-15T16:28:00.148188Z", "invocation_id": "30084629-b0cb-4168-9872-4372589f760c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:50.041473Z", "completed_at": "2025-02-15T16:27:50.048471Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:50.049466Z", "completed_at": "2025-02-15T16:27:50.797861Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8683412075042725, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699b-0000-fcd1-0001-4c5e000d33a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.stg_products", "compiled": true, "compiled_code": "SELECT \r\n    METADATA$FILENAME AS file_name,\r\n    METADATA$FILE_ROW_NUMBER AS row_number,\r\n    $1:\"goods-title-link--jump\"::STRING AS goods_title_link_jump, \r\n    $1:\"goods-title-link--jump href\"::STRING AS goods_title_link_href, \r\n    $1:\"rank-title\"::STRING AS rank_title,\r\n    $1:\"rank-sub\"::STRING AS rank_sub,\r\n    $1:\"price\"::STRING AS price,\r\n    $1:\"discount\"::STRING AS discount,\r\n    $1:\"selling_proposition\"::STRING AS selling_proposition,\r\n    $1:\"goods-title-link\"::STRING AS goods_title_link,\r\n    $1:\"color-count\"::INTEGER AS color_count,\r\n    $1:\"blackfridaybelts-bg src\"::STRING AS blackfridaybelts_bg_src,\r\n    $1:\"blackfridaybelts-content\"::STRING AS blackfridaybelts_content,\r\nFROM \r\n    @product_stage\r\n    (file_format => 'parquet_format', pattern => '.*.parquet')", "relation_name": "E_COMMERCE_PRODUCT.products_schema.stg_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:50.915809Z", "completed_at": "2025-02-15T16:27:50.920814Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:50.921806Z", "completed_at": "2025-02-15T16:27:52.771306Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.9687681198120117, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699b-0000-fd30-0001-4c5e000db0e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.int_products", "compiled": true, "compiled_code": "WITH clean_cols AS \n    (\n    SELECT\n        goods_title_link,\n        GOODS_TITLE_LINK_JUMP,\n        SPLIT(\"FILE_NAME\", '-')[2]::STRING AS category,\n        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,\n        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,\n        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS \"PRICE($)\",\n        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,\n        CASE\n            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' \n                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000\n            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT\n        END AS selling_proposition,\n        COLOR_COUNT,\n        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS \"BLACKFRIDAYBELTS_CONTENT(Save $)\"\n    FROM E_COMMERCE_PRODUCT.products_schema.stg_products\n    ),\n\nnull_filled AS (\n    SELECT\n        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,\n        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  \n        category,\n        COALESCE(rank_title, -1) AS rank_title, \n        COALESCE(rank_sub, 'Unknown') AS rank_sub,\n        ROUND(COALESCE(\"PRICE($)\", COALESCE(AVG(\"PRICE($)\") OVER(PARTITION BY category),0)) ,2) AS price_dollars,\n        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,\n        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,\n        COALESCE(COLOR_COUNT, 0) AS \"color_counts\",\n        COALESCE(\"BLACKFRIDAYBELTS_CONTENT(Save $)\", 0) AS blackfriday_savings\n    FROM clean_cols\n),\n\nunique_rows AS (\nSELECT \n    DISTINCT *\nFROM null_filled\n)\n\nSELECT \n    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"color_counts\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,\n     * \nFROM unique_rows", "relation_name": "E_COMMERCE_PRODUCT.products_schema_intermediate.int_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:52.888578Z", "completed_at": "2025-02-15T16:27:52.893572Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:52.893572Z", "completed_at": "2025-02-15T16:27:55.439372Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.677435874938965, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699b-0000-fd24-0001-4c5e000d6386"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.dim_category", "compiled": true, "compiled_code": "WITH cat_desc AS\n(\n    SELECT \n        DISTINCT category\n    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products\n)\n\nSELECT \n    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,\n    category\nFROM cat_desc", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.dim_category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:55.573018Z", "completed_at": "2025-02-15T16:27:55.582017Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:55.583014Z", "completed_at": "2025-02-15T16:27:58.535544Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 3.072467088699341, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699b-0000-fcd1-0001-4c5e000d33aa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.agg_category_performance", "compiled": true, "compiled_code": "WITH cols_to_keep AS\n(\n    SELECT \n        inttable.category AS category,\n        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,\n        ROUND(AVG(discount), 2) AS avg_discount,\n        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,\n        COUNT(*) AS total_products,\n    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\n    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct\n    ON inttable.category = ct.category\n    GROUP BY inttable.category\n    ORDER BY avg_price_dollars DESC\n),\n\nid_generated AS \n(\n    SELECT \n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,\n        avg_price_dollars,\n        avg_discount,\n        avg_sold_proposition\n    FROM cols_to_keep\n)\n\nSELECT \n    *       \nFROM id_generated", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:55.578015Z", "completed_at": "2025-02-15T16:27:55.586011Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:55.586011Z", "completed_at": "2025-02-15T16:27:58.672028Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 3.2132930755615234, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699b-0000-fcd1-0001-4c5e000d33ae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.dim_products", "compiled": true, "compiled_code": "SELECT \n    inttable.sk_id AS prod_id,\n    inttable.title,\n    ct.category_id,\n    inttable.rank_title,\n    inttable.rank_sub,\n    inttable.GOODS_TITLE_LINK_JUMP,\n    inttable.\"color_counts\",\n    inttable.blackfriday_savings\nFROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\nJOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct\n    ON inttable.category = ct.category", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:27:58.647489Z", "completed_at": "2025-02-15T16:27:58.651521Z"}, {"name": "execute", "started_at": "2025-02-15T16:27:58.652501Z", "completed_at": "2025-02-15T16:28:00.021573Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 1.488710880279541, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba699c-0000-fd30-0001-4c5e000db0ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.fact_products_performance", "compiled": true, "compiled_code": "SELECT \n    sk_id AS prod_id,\n    ct.category_id,\n    price_dollars,\n    discount,\n    selling_proposition,\n    blackfriday_savings\nFROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\nJOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance"}], "elapsed_time": 12.407130241394043, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "quiet": false, "log_path": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs", "write_json": true, "partial_parse": true, "project_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "printer_width": 80, "strict_mode": false, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "require_resource_names_without_spaces": false, "version_check": true, "log_file_max_bytes": 10485760, "populate_cache": true, "show_resource_report": false, "enable_legacy_logger": false, "empty": false, "static_parser": true, "macro_debugging": false, "use_colors": true, "favor_state": false, "indirect_selection": "eager", "log_level": "info", "log_level_file": "debug", "which": "run", "select": [], "introspect": true, "use_colors_file": true, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "defer": false, "exclude": [], "log_format": "default", "print": true, "invocation_command": "dbt run", "cache_selected_only": false, "profiles_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform"}}