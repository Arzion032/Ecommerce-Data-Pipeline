{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-02-15T16:23:33.381689Z", "invocation_id": "3be85147-13d7-4f80-a25a-60ec43be3908", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:24.431661Z", "completed_at": "2025-02-15T16:23:24.439668Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:24.440663Z", "completed_at": "2025-02-15T16:23:25.309825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9985966682434082, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fd34-0001-4c5e000da13e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.stg_products", "compiled": true, "compiled_code": "SELECT \r\n    METADATA$FILENAME AS file_name,\r\n    METADATA$FILE_ROW_NUMBER AS row_number,\r\n    $1:\"goods-title-link--jump\"::STRING AS goods_title_link_jump, \r\n    $1:\"goods-title-link--jump href\"::STRING AS goods_title_link_href, \r\n    $1:\"rank-title\"::STRING AS rank_title,\r\n    $1:\"rank-sub\"::STRING AS rank_sub,\r\n    $1:\"price\"::STRING AS price,\r\n    $1:\"discount\"::STRING AS discount,\r\n    $1:\"selling_proposition\"::STRING AS selling_proposition,\r\n    $1:\"goods-title-link\"::STRING AS goods_title_link,\r\n    $1:\"color-count\"::INTEGER AS color_count,\r\n    $1:\"blackfridaybelts-bg src\"::STRING AS blackfridaybelts_bg_src,\r\n    $1:\"blackfridaybelts-content\"::STRING AS blackfridaybelts_content,\r\nFROM \r\n    @product_stage\r\n    (file_format => 'parquet_format', pattern => '.*.parquet')", "relation_name": "E_COMMERCE_PRODUCT.products_schema.stg_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:25.435721Z", "completed_at": "2025-02-15T16:23:25.450738Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:25.451737Z", "completed_at": "2025-02-15T16:23:28.467618Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.157212495803833, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fd29-0001-4c5e000d13ba"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.int_products", "compiled": true, "compiled_code": "WITH clean_cols AS \n    (\n    SELECT\n        goods_title_link,\n        GOODS_TITLE_LINK_JUMP,\n        SPLIT(\"FILE_NAME\", '-')[2]::STRING AS category,\n        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,\n        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,\n        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS \"PRICE($)\",\n        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,\n        CASE\n            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' \n                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000\n            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT\n        END AS selling_proposition,\n        COLOR_COUNT,\n        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS \"BLACKFRIDAYBELTS_CONTENT(Save $)\"\n    FROM E_COMMERCE_PRODUCT.products_schema.stg_products\n    ),\n\nnull_filled AS (\n    SELECT\n        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,\n        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  \n        category,\n        COALESCE(rank_title, -1) AS rank_title, \n        COALESCE(rank_sub, 'Unknown') AS rank_sub,\n        ROUND(COALESCE(\"PRICE($)\", COALESCE(AVG(\"PRICE($)\") OVER(PARTITION BY category),0)) ,2) AS price_dollars,\n        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,\n        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,\n        COALESCE(COLOR_COUNT, 0) AS \"color_counts\",\n        COALESCE(\"BLACKFRIDAYBELTS_CONTENT(Save $)\", 0) AS blackfriday_savings\n    FROM clean_cols\n),\n\nunique_rows AS (\nSELECT \n    DISTINCT *\nFROM null_filled\n)\n\nSELECT \n    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"color_counts\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,\n     * \nFROM unique_rows", "relation_name": "E_COMMERCE_PRODUCT.products_schema_intermediate.int_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:28.597822Z", "completed_at": "2025-02-15T16:23:28.601837Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:28.602821Z", "completed_at": "2025-02-15T16:23:29.938474Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.45827317237854, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fcd1-0001-4c5e000d3366"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.dim_category", "compiled": true, "compiled_code": "WITH cat_desc AS\n(\n    SELECT \n        DISTINCT category\n    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products\n)\n\nSELECT \n    md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,\n    category\nFROM cat_desc", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.dim_category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:30.069618Z", "completed_at": "2025-02-15T16:23:30.078608Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:30.079620Z", "completed_at": "2025-02-15T16:23:31.725830Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 1.7747986316680908, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fd29-0001-4c5e000d13be"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.dim_products", "compiled": true, "compiled_code": "SELECT \n    inttable.sk_id AS prod_id,\n    inttable.title,\n    ct.category_id,\n    inttable.rank_title,\n    inttable.rank_sub,\n    inttable.GOODS_TITLE_LINK_JUMP,\n    inttable.\"color_counts\"\nFROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\nJOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct\n    ON inttable.category = ct.category", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.dim_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:30.065071Z", "completed_at": "2025-02-15T16:23:30.074609Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:30.075609Z", "completed_at": "2025-02-15T16:23:31.759486Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 1.8393995761871338, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fd30-0001-4c5e000db0b6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.agg_category_performance", "compiled": true, "compiled_code": "WITH cols_to_keep AS\n(\n    SELECT \n        inttable.category AS category,\n        ROUND(AVG(price_dollars), 2) AS avg_price_dollars,\n        ROUND(AVG(discount), 2) AS avg_discount,\n        ROUND(AVG(selling_proposition), 2) AS avg_sold_proposition,\n        COUNT(*) AS total_products,\n    FROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\n    JOIN E_COMMERCE_PRODUCT.products_schema_analytics.dim_category AS ct\n    ON inttable.category = ct.category\n    GROUP BY inttable.category\n    ORDER BY avg_price_dollars DESC\n),\n\nid_generated AS \n(\n    SELECT \n        md5(cast(coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS category_id,\n        avg_price_dollars,\n        avg_discount,\n        avg_sold_proposition\n    FROM cols_to_keep\n)\n\nSELECT \n    *       \nFROM id_generated", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T16:23:31.909489Z", "completed_at": "2025-02-15T16:23:31.912485Z"}, {"name": "execute", "started_at": "2025-02-15T16:23:31.913711Z", "completed_at": "2025-02-15T16:23:33.257895Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 1.4611742496490479, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba6997-0000-fd30-0001-4c5e000db0ba"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.fact_products_performance", "compiled": true, "compiled_code": "SELECT \n    sk_id AS prod_id,\n    ct.category_id,\n    price_dollars,\n    discount,\n    selling_proposition,\n    blackfriday_savings\nFROM E_COMMERCE_PRODUCT.products_schema_intermediate.int_products AS inttable\nJOIN E_COMMERCE_PRODUCT.products_schema_analytics.agg_category_performance AS ct", "relation_name": "E_COMMERCE_PRODUCT.products_schema_analytics.fact_products_performance"}], "elapsed_time": 11.172735214233398, "args": {"strict_mode": false, "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "defer": false, "which": "run", "print": true, "introspect": true, "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "enable_legacy_logger": false, "log_format": "default", "log_level_file": "debug", "printer_width": 80, "use_colors_file": true, "quiet": false, "macro_debugging": false, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "write_json": true, "select": [], "log_file_max_bytes": 10485760, "log_level": "info", "profiles_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "exclude": [], "static_parser": true, "invocation_command": "dbt run", "favor_state": false, "require_resource_names_without_spaces": false, "show_resource_report": false, "cache_selected_only": false, "log_path": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs", "populate_cache": true, "vars": {}, "project_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "version_check": true, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "empty": false}}