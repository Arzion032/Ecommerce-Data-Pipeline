{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-02-15T07:25:35.898232Z", "invocation_id": "c4451a2e-5a3a-4a40-bce7-c4a53679ed87", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T07:25:32.828567Z", "completed_at": "2025-02-15T07:25:32.835572Z"}, {"name": "execute", "started_at": "2025-02-15T07:25:32.836572Z", "completed_at": "2025-02-15T07:25:33.579460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8641657829284668, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba677d-0000-fd16-0001-4c5e000d20fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.stg_products", "compiled": true, "compiled_code": "SELECT \r\n    METADATA$FILENAME AS file_name,\r\n    METADATA$FILE_ROW_NUMBER AS row_number,\r\n    $1:\"goods-title-link--jump\"::STRING AS goods_title_link_jump, \r\n    $1:\"goods-title-link--jump href\"::STRING AS goods_title_link_href, \r\n    $1:\"rank-title\"::STRING AS rank_title,\r\n    $1:\"rank-sub\"::STRING AS rank_sub,\r\n    $1:\"price\"::STRING AS price,\r\n    $1:\"discount\"::STRING AS discount,\r\n    $1:\"selling_proposition\"::STRING AS selling_proposition,\r\n    $1:\"goods-title-link\"::STRING AS goods_title_link,\r\n    $1:\"color-count\"::INTEGER AS color_count,\r\n    $1:\"blackfridaybelts-bg src\"::STRING AS blackfridaybelts_bg_src,\r\n    $1:\"blackfridaybelts-content\"::STRING AS blackfridaybelts_content,\r\nFROM \r\n    @product_stage\r\n    (file_format => 'parquet_format', pattern => '.*.parquet')", "relation_name": "E_COMMERCE_PRODUCT.products_schema.stg_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-15T07:25:33.697727Z", "completed_at": "2025-02-15T07:25:33.702833Z"}, {"name": "execute", "started_at": "2025-02-15T07:25:33.703824Z", "completed_at": "2025-02-15T07:25:35.778053Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.1905064582824707, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba677d-0000-fd16-0001-4c5e000d2102"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.int_products", "compiled": true, "compiled_code": "WITH clean_cols AS \n    (\n    SELECT\n        goods_title_link,\n        GOODS_TITLE_LINK_JUMP,\n        SPLIT(\"FILE_NAME\", '-')[2]::STRING AS category,\n        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,\n        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,\n        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS \"PRICE($)\",\n        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,\n        CASE\n            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' \n                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000\n            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT\n        END AS selling_proposition,\n        COLOR_COUNT,\n        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS \"BLACKFRIDAYBELTS_CONTENT(Save $)\"\n    FROM E_COMMERCE_PRODUCT.products_schema.stg_products\n    ),\nnull_filled AS (\n    SELECT\n        LOWER(TRIM(COALESCE(goods_title_link, 'Unknown'))) AS title,\n        LOWER(TRIM(COALESCE(GOODS_TITLE_LINK_JUMP, 'No Link Available'))) AS goods_title_link_jump,  \n        category,\n        COALESCE(rank_title, -1) AS rank_title, \n        COALESCE(rank_sub, 'Unknown') AS rank_sub,\n        ROUND(COALESCE(\"PRICE($)\", COALESCE(AVG(\"PRICE($)\") OVER(PARTITION BY category),0)) ,2) AS price_dollars,\n        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,\n        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,\n        COALESCE(COLOR_COUNT, 0) AS \"color_count\",\n        COALESCE(\"BLACKFRIDAYBELTS_CONTENT(Save $)\", 0) AS blackfriday_savings\n    FROM clean_cols\n),\nunique_rows AS (\nSELECT \n    DISTINCT *\nFROM null_filled\n)\n\nSELECT \n    md5(cast(coalesce(cast(discount as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(price_dollars as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(selling_proposition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(category as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_sub as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rank_title as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"color_count\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS sk_id,\n     * \n    FROM unique_rows", "relation_name": "E_COMMERCE_PRODUCT.products_schema_intermediate.int_products"}], "elapsed_time": 5.141978979110718, "args": {"log_file_max_bytes": 10485760, "empty": false, "print": true, "send_anonymous_usage_stats": true, "show_resource_report": false, "partial_parse": true, "log_level_file": "debug", "static_parser": true, "vars": {}, "favor_state": false, "macro_debugging": false, "quiet": false, "enable_legacy_logger": false, "partial_parse_file_diff": true, "strict_mode": false, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "project_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "which": "run", "populate_cache": true, "invocation_command": "dbt run", "indirect_selection": "eager", "log_path": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs", "version_check": true, "exclude": [], "use_colors_file": true, "profiles_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "log_level": "info", "use_colors": true, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "log_format_file": "debug", "cache_selected_only": false, "source_freshness_run_project_hooks": false, "select": [], "require_resource_names_without_spaces": false, "introspect": true}}