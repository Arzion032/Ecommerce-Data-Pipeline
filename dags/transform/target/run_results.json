{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-02-14T15:05:17.987556Z", "invocation_id": "da06926b-6b1d-4a51-a166-b27cef658506", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T15:05:14.051848Z", "completed_at": "2025-02-14T15:05:14.058853Z"}, {"name": "execute", "started_at": "2025-02-14T15:05:14.059856Z", "completed_at": "2025-02-14T15:05:15.107589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1718626022338867, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba63a9-0000-fcd1-0001-4c5e000c91ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.stg_products", "compiled": true, "compiled_code": "SELECT \r\n    METADATA$FILENAME AS file_name,\r\n    METADATA$FILE_ROW_NUMBER AS row_number,\r\n    $1:\"goods-title-link--jump\"::STRING AS goods_title_link_jump, \r\n    $1:\"goods-title-link--jump href\"::STRING AS goods_title_link_href, \r\n    $1:\"rank-title\"::STRING AS rank_title,\r\n    $1:\"rank-sub\"::STRING AS rank_sub,\r\n    $1:\"price\"::STRING AS price,\r\n    $1:\"discount\"::STRING AS discount,\r\n    $1:\"selling_proposition\"::STRING AS selling_proposition,\r\n    $1:\"goods-title-link\"::STRING AS goods_title_link,\r\n    $1:\"color-count\"::INTEGER AS color_count,\r\n    $1:\"blackfridaybelts-bg src\"::STRING AS blackfridaybelts_bg_src,\r\n    $1:\"blackfridaybelts-content\"::STRING AS blackfridaybelts_content\r\nFROM \r\n    @product_stage\r\n    (file_format => 'parquet_format', pattern => '.*.parquet')", "relation_name": "E_COMMERCE_PRODUCT.products_schema.stg_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-14T15:05:15.229710Z", "completed_at": "2025-02-14T15:05:15.233249Z"}, {"name": "execute", "started_at": "2025-02-14T15:05:15.234252Z", "completed_at": "2025-02-14T15:05:17.869491Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.7502100467681885, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01ba63a9-0000-fd0b-0001-4c5e000ce0ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform.int_products", "compiled": true, "compiled_code": "WITH clean_cols AS \n    (\n    SELECT\n        GOODS_TITLE_LINK_JUMP,\n        SPLIT(\"FILE_NAME\", '-')[2]::STRING AS category,\n        SPLIT(LTRIM(RANK_TITLE, '#'), ' ')[0]::INTEGER AS rank_title,\n        LTRIM(INITCAP(RANK_SUB), 'In ') as rank_sub,\n        REGEXP_REPLACE(PRICE, '[$,]', '')::FLOAT AS \"PRICE($)\",\n        (SUBSTRING(DISCOUNT, 2, LENGTH(DISCOUNT)-2)::INTEGER / 100)::FLOAT AS DISCOUNT,\n        CASE\n            WHEN LEFT(selling_proposition, LENGTH(selling_proposition) - 15) LIKE '%k%' \n                THEN LEFT(selling_proposition, LENGTH(selling_proposition) - 16)::FLOAT * 1000\n            ELSE LEFT(selling_proposition, LENGTH(selling_proposition) - 15)::FLOAT\n        END AS selling_proposition,\n        COLOR_COUNT,\n        LTRIM(BLACKFRIDAYBELTS_CONTENT, 'Save $')::FLOAT AS \"BLACKFRIDAYBELTS_CONTENT(Save $)\"\n    FROM E_COMMERCE_PRODUCT.products_schema.stg_products\n    ),\nnull_filled AS (\n    SELECT\n        GOODS_TITLE_LINK_JUMP,\n        category,\n        rank_title,\n        rank_sub,\n        ROUND(COALESCE(\"PRICE($)\", COALESCE(AVG(\"PRICE($)\") OVER(PARTITION BY category),0)) ,2) AS price_dollars,\n        ROUND(COALESCE(DISCOUNT, COALESCE(AVG(DISCOUNT) OVER(PARTITION BY category),0)) ,2) AS discount,\n        COALESCE(selling_proposition, COALESCE(AVG(selling_proposition) OVER(PARTITION BY category),0))::INTEGER AS selling_proposition,\n        COLOR_COUNT,\n        \"BLACKFRIDAYBELTS_CONTENT(Save $)\"\n    FROM clean_cols\n)\n\n\nSELECT \n    * \nFROM null_filled", "relation_name": "E_COMMERCE_PRODUCT.products_schema_intermediate.int_products"}], "elapsed_time": 5.9262354373931885, "args": {"indirect_selection": "eager", "profiles_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "require_resource_names_without_spaces": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "cache_selected_only": false, "use_colors_file": true, "static_parser": true, "invocation_command": "dbt run", "use_colors": true, "source_freshness_run_project_hooks": false, "log_path": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform\\logs", "log_level_file": "debug", "macro_debugging": false, "select": [], "vars": {}, "which": "run", "print": true, "log_level": "info", "strict_mode": false, "partial_parse_file_diff": true, "enable_legacy_logger": false, "empty": false, "quiet": false, "send_anonymous_usage_stats": true, "exclude": [], "introspect": true, "log_file_max_bytes": 10485760, "log_format_file": "debug", "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "defer": false, "version_check": true, "favor_state": false, "project_dir": "C:\\Users\\User\\Downloads\\0MY FILES\\DATE ENGINEERING\\Retail-Data-Pipeline\\dags\\transform", "partial_parse": true, "printer_width": 80, "show_resource_report": false}}